/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 1, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_1.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 123.33
Starting training...
Average cost in epoch 0: 1.591150
training accuracy: 0.343750     test accuracy: 0.522478
Average cost in epoch 1: 1.391321
training accuracy: 0.531250     test accuracy: 0.509491
Average cost in epoch 2: 1.329444
training accuracy: 0.375000     test accuracy: 0.512488
Average cost in epoch 3: 1.312632
training accuracy: 0.531250     test accuracy: 0.513487
Average cost in epoch 4: 1.287267
training accuracy: 0.468750     test accuracy: 0.514486

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 5: 1.271819
training accuracy: 0.531250     test accuracy: 0.505495
lr decays to 0.009000
Average cost in epoch 6: 1.264512
training accuracy: 0.500000     test accuracy: 0.510490
Average cost in epoch 7: 1.252978
training accuracy: 0.531250     test accuracy: 0.521479
Average cost in epoch 8: 1.242088
training accuracy: 0.406250     test accuracy: 0.521479
Average cost in epoch 9: 1.235617
training accuracy: 0.562500     test accuracy: 0.500500

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 10: 1.224171
training accuracy: 0.468750     test accuracy: 0.520480
lr decays to 0.008100
Average cost in epoch 11: 1.218144
training accuracy: 0.343750     test accuracy: 0.522478
Average cost in epoch 12: 1.223754
training accuracy: 0.531250     test accuracy: 0.529471
Average cost in epoch 13: 1.208451
training accuracy: 0.343750     test accuracy: 0.522478
Average cost in epoch 14: 1.206623
training accuracy: 0.593750     test accuracy: 0.494505

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 15: 1.203295
training accuracy: 0.500000     test accuracy: 0.506494
lr decays to 0.007290
Average cost in epoch 16: 1.204282
training accuracy: 0.531250     test accuracy: 0.499500
Average cost in epoch 17: 1.197363
training accuracy: 0.562500     test accuracy: 0.520480
Average cost in epoch 18: 1.196680
training accuracy: 0.593750     test accuracy: 0.512488
Average cost in epoch 19: 1.188330
training accuracy: 0.562500     test accuracy: 0.507493

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 20: 1.183273
training accuracy: 0.625000     test accuracy: 0.514486
lr decays to 0.006561
Average cost in epoch 21: 1.181117
training accuracy: 0.562500     test accuracy: 0.500500
Average cost in epoch 22: 1.174979
training accuracy: 0.406250     test accuracy: 0.513487
Average cost in epoch 23: 1.171031
training accuracy: 0.500000     test accuracy: 0.500500
Average cost in epoch 24: 1.181810
training accuracy: 0.562500     test accuracy: 0.493506

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 25: 1.169603
training accuracy: 0.562500     test accuracy: 0.512488
lr decays to 0.005905
Average cost in epoch 26: 1.164509
training accuracy: 0.531250     test accuracy: 0.505495
Average cost in epoch 27: 1.164252
training accuracy: 0.375000     test accuracy: 0.501499
Average cost in epoch 28: 1.160052
training accuracy: 0.625000     test accuracy: 0.504496
Average cost in epoch 29: 1.149728
training accuracy: 0.593750     test accuracy: 0.499500

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 30: 1.156940
training accuracy: 0.343750     test accuracy: 0.491508
lr decays to 0.005314
Average cost in epoch 31: 1.148383
training accuracy: 0.531250     test accuracy: 0.495504
Average cost in epoch 32: 1.145423
training accuracy: 0.656250     test accuracy: 0.510490
Average cost in epoch 33: 1.143065
training accuracy: 0.531250     test accuracy: 0.497502
Average cost in epoch 34: 1.138122
training accuracy: 0.500000     test accuracy: 0.506494

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 35: 1.133827
training accuracy: 0.500000     test accuracy: 0.497502
lr decays to 0.004783
Average cost in epoch 36: 1.134847
training accuracy: 0.531250     test accuracy: 0.502498
Average cost in epoch 37: 1.130233
training accuracy: 0.375000     test accuracy: 0.498501
Average cost in epoch 38: 1.129240
training accuracy: 0.562500     test accuracy: 0.501499
Average cost in epoch 39: 1.127139
training accuracy: 0.531250     test accuracy: 0.501499

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 40: 1.125032
training accuracy: 0.625000     test accuracy: 0.516484
lr decays to 0.004305
Average cost in epoch 41: 1.123986
training accuracy: 0.437500     test accuracy: 0.512488
Average cost in epoch 42: 1.114478
training accuracy: 0.656250     test accuracy: 0.493506
Average cost in epoch 43: 1.105896
training accuracy: 0.531250     test accuracy: 0.498501
Average cost in epoch 44: 1.111227
training accuracy: 0.437500     test accuracy: 0.498501

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 45: 1.111175
training accuracy: 0.531250     test accuracy: 0.512488
lr decays to 0.003874
Average cost in epoch 46: 1.092490
training accuracy: 0.468750     test accuracy: 0.498501
Average cost in epoch 47: 1.097978
training accuracy: 0.562500     test accuracy: 0.510490
Average cost in epoch 48: 1.089251
training accuracy: 0.406250     test accuracy: 0.513487
Average cost in epoch 49: 1.099173
training accuracy: 0.718750     test accuracy: 0.515485

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 50: 1.089212
training accuracy: 0.531250     test accuracy: 0.525475
lr decays to 0.003487
Average cost in epoch 51: 1.078534
training accuracy: 0.625000     test accuracy: 0.534466
Average cost in epoch 52: 1.082367
training accuracy: 0.625000     test accuracy: 0.520480
Average cost in epoch 53: 1.073520
training accuracy: 0.593750     test accuracy: 0.528472
Average cost in epoch 54: 1.067213
training accuracy: 0.593750     test accuracy: 0.548452

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 55: 1.070974
training accuracy: 0.500000     test accuracy: 0.524476
lr decays to 0.003138
Average cost in epoch 56: 1.060754
training accuracy: 0.531250     test accuracy: 0.530470
Average cost in epoch 57: 1.055488
training accuracy: 0.593750     test accuracy: 0.545455
Average cost in epoch 58: 1.034102
training accuracy: 0.562500     test accuracy: 0.557443
Average cost in epoch 59: 1.061046
training accuracy: 0.468750     test accuracy: 0.540460

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 60: 1.056744
training accuracy: 0.625000     test accuracy: 0.549451
lr decays to 0.002824
Average cost in epoch 61: 1.041474
training accuracy: 0.531250     test accuracy: 0.557443
Average cost in epoch 62: 1.038461
training accuracy: 0.562500     test accuracy: 0.557443
Average cost in epoch 63: 1.040239
training accuracy: 0.500000     test accuracy: 0.557443
Average cost in epoch 64: 1.039683
training accuracy: 0.593750     test accuracy: 0.566434

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 65: 1.042768
training accuracy: 0.375000     test accuracy: 0.562438
lr decays to 0.002542
Average cost in epoch 66: 1.032689
training accuracy: 0.468750     test accuracy: 0.551449
Average cost in epoch 67: 1.035509
training accuracy: 0.687500     test accuracy: 0.561439
Average cost in epoch 68: 1.040702
training accuracy: 0.593750     test accuracy: 0.570430
Average cost in epoch 69: 1.024693
training accuracy: 0.625000     test accuracy: 0.561439

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 70: 1.040180
training accuracy: 0.656250     test accuracy: 0.555445
lr decays to 0.002288
Average cost in epoch 71: 1.023870
training accuracy: 0.531250     test accuracy: 0.560440
Average cost in epoch 72: 1.023703
training accuracy: 0.562500     test accuracy: 0.560440
Average cost in epoch 73: 1.011949
training accuracy: 0.437500     test accuracy: 0.577423
Average cost in epoch 74: 1.017124
training accuracy: 0.593750     test accuracy: 0.582418

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 75: 1.002684
training accuracy: 0.406250     test accuracy: 0.587413
lr decays to 0.002059
Average cost in epoch 76: 1.010150
training accuracy: 0.437500     test accuracy: 0.570430
Average cost in epoch 77: 1.001534
training accuracy: 0.625000     test accuracy: 0.587413
Average cost in epoch 78: 1.009028
training accuracy: 0.687500     test accuracy: 0.587413
Average cost in epoch 79: 1.012954
training accuracy: 0.468750     test accuracy: 0.581419

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 80: 1.014170
training accuracy: 0.625000     test accuracy: 0.588412
lr decays to 0.001853
Average cost in epoch 81: 0.992903
training accuracy: 0.531250     test accuracy: 0.586414
Average cost in epoch 82: 0.999193
training accuracy: 0.562500     test accuracy: 0.584416
Average cost in epoch 83: 0.984204
training accuracy: 0.562500     test accuracy: 0.598402
Average cost in epoch 84: 0.996857
training accuracy: 0.531250     test accuracy: 0.605395

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 85: 0.989291
training accuracy: 0.500000     test accuracy: 0.600400
lr decays to 0.001668
Average cost in epoch 86: 0.987664
training accuracy: 0.531250     test accuracy: 0.598402
Average cost in epoch 87: 0.975067
training accuracy: 0.625000     test accuracy: 0.599401
Average cost in epoch 88: 0.980302
training accuracy: 0.500000     test accuracy: 0.605395
Average cost in epoch 89: 0.974260
training accuracy: 0.562500     test accuracy: 0.622378

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 90: 0.972064
training accuracy: 0.406250     test accuracy: 0.615385
lr decays to 0.001501
Average cost in epoch 91: 0.979245
training accuracy: 0.500000     test accuracy: 0.622378
Average cost in epoch 92: 0.968604
training accuracy: 0.593750     test accuracy: 0.622378
Average cost in epoch 93: 0.971703
training accuracy: 0.625000     test accuracy: 0.620380
Average cost in epoch 94: 0.979475
training accuracy: 0.531250     test accuracy: 0.620380

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 95: 0.968189
training accuracy: 0.656250     test accuracy: 0.615385
lr decays to 0.001351
Average cost in epoch 96: 0.960528
training accuracy: 0.687500     test accuracy: 0.617383
Average cost in epoch 97: 0.957126
training accuracy: 0.625000     test accuracy: 0.620380
Average cost in epoch 98: 0.944812
training accuracy: 0.656250     test accuracy: 0.636364
Average cost in epoch 99: 0.943339
training accuracy: 0.593750     test accuracy: 0.630370

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 100: 0.960077
training accuracy: 0.562500     test accuracy: 0.629371
lr decays to 0.001216
Average cost in epoch 101: 0.960881
training accuracy: 0.718750     test accuracy: 0.621379
Average cost in epoch 102: 0.952578
training accuracy: 0.687500     test accuracy: 0.626374
Average cost in epoch 103: 0.959008
training accuracy: 0.562500     test accuracy: 0.630370
Average cost in epoch 104: 0.957672
training accuracy: 0.812500     test accuracy: 0.622378

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 105: 0.963937
training accuracy: 0.625000     test accuracy: 0.635365
Average cost in epoch 106: 0.951538
training accuracy: 0.718750     test accuracy: 0.631369
Average cost in epoch 107: 0.949110
training accuracy: 0.656250     test accuracy: 0.638362
Average cost in epoch 108: 0.950051
training accuracy: 0.656250     test accuracy: 0.636364
Average cost in epoch 109: 0.943202
training accuracy: 0.687500     test accuracy: 0.636364

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 110: 0.922147
training accuracy: 0.562500     test accuracy: 0.640360
Average cost in epoch 111: 0.950846
training accuracy: 0.718750     test accuracy: 0.644356
Average cost in epoch 112: 0.932750
training accuracy: 0.750000     test accuracy: 0.643357
Average cost in epoch 113: 0.926893
training accuracy: 0.656250     test accuracy: 0.636364
Average cost in epoch 114: 0.952643
training accuracy: 0.781250     test accuracy: 0.648352

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 115: 0.942121
training accuracy: 0.718750     test accuracy: 0.650350
Average cost in epoch 116: 0.940581
training accuracy: 0.718750     test accuracy: 0.650350
Average cost in epoch 117: 0.940036
training accuracy: 0.687500     test accuracy: 0.645355
Average cost in epoch 118: 0.933354
training accuracy: 0.625000     test accuracy: 0.652348
Average cost in epoch 119: 0.927344
training accuracy: 0.593750     test accuracy: 0.649351

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 120: 0.937300
training accuracy: 0.812500     test accuracy: 0.647353
Average cost in epoch 121: 0.929060
training accuracy: 0.656250     test accuracy: 0.647353
Average cost in epoch 122: 0.931593
training accuracy: 0.656250     test accuracy: 0.649351
Average cost in epoch 123: 0.938310
training accuracy: 0.750000     test accuracy: 0.648352
Average cost in epoch 124: 0.923204
training accuracy: 0.656250     test accuracy: 0.645355

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 125: 0.929012
training accuracy: 0.593750     test accuracy: 0.651349
Average cost in epoch 126: 0.933861
training accuracy: 0.500000     test accuracy: 0.656344
Average cost in epoch 127: 0.926372
training accuracy: 0.625000     test accuracy: 0.659341
Average cost in epoch 128: 0.928384
training accuracy: 0.531250     test accuracy: 0.662338
Average cost in epoch 129: 0.930877
training accuracy: 0.562500     test accuracy: 0.650350

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 130: 0.912623
training accuracy: 0.531250     test accuracy: 0.656344
Average cost in epoch 131: 0.922956
training accuracy: 0.656250     test accuracy: 0.665335
Average cost in epoch 132: 0.916873
training accuracy: 0.625000     test accuracy: 0.668332
Average cost in epoch 133: 0.917850
training accuracy: 0.718750     test accuracy: 0.666334
Average cost in epoch 134: 0.908587
training accuracy: 0.437500     test accuracy: 0.667333

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 135: 0.920903
training accuracy: 0.562500     test accuracy: 0.662338
Average cost in epoch 136: 0.918791
training accuracy: 0.687500     test accuracy: 0.665335
Average cost in epoch 137: 0.926126
training accuracy: 0.406250     test accuracy: 0.670330
Average cost in epoch 138: 0.921591
training accuracy: 0.500000     test accuracy: 0.651349
Average cost in epoch 139: 0.914703
training accuracy: 0.718750     test accuracy: 0.675325

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 140: 0.929203
training accuracy: 0.593750     test accuracy: 0.663337
Average cost in epoch 141: 0.901270
training accuracy: 0.718750     test accuracy: 0.664336
Average cost in epoch 142: 0.912109
training accuracy: 0.750000     test accuracy: 0.676324
Average cost in epoch 143: 0.907986
training accuracy: 0.562500     test accuracy: 0.670330
Average cost in epoch 144: 0.917941
training accuracy: 0.593750     test accuracy: 0.665335

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 145: 0.918779
training accuracy: 0.812500     test accuracy: 0.665335
Average cost in epoch 146: 0.905894
training accuracy: 0.437500     test accuracy: 0.672328
Average cost in epoch 147: 0.894136
training accuracy: 0.812500     test accuracy: 0.671329
Average cost in epoch 148: 0.905167
training accuracy: 0.593750     test accuracy: 0.671329
Average cost in epoch 149: 0.912816
training accuracy: 0.562500     test accuracy: 0.666334

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 150: 0.910379
training accuracy: 0.718750     test accuracy: 0.676324
Average cost in epoch 151: 0.905429
training accuracy: 0.593750     test accuracy: 0.672328
Average cost in epoch 152: 0.904986
training accuracy: 0.468750     test accuracy: 0.667333
Average cost in epoch 153: 0.901881
training accuracy: 0.656250     test accuracy: 0.685315
Average cost in epoch 154: 0.904356
training accuracy: 0.468750     test accuracy: 0.679321

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 155: 0.921968
training accuracy: 0.687500     test accuracy: 0.686314
Average cost in epoch 156: 0.893912
training accuracy: 0.625000     test accuracy: 0.681319
Average cost in epoch 157: 0.905205
training accuracy: 0.656250     test accuracy: 0.682318
Average cost in epoch 158: 0.898809
training accuracy: 0.687500     test accuracy: 0.671329
Average cost in epoch 159: 0.921482
training accuracy: 0.718750     test accuracy: 0.678322

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 160: 0.904672
training accuracy: 0.875000     test accuracy: 0.674326
Average cost in epoch 161: 0.895774
training accuracy: 0.718750     test accuracy: 0.664336
Average cost in epoch 162: 0.909401
training accuracy: 0.687500     test accuracy: 0.674326
Average cost in epoch 163: 0.901271
training accuracy: 0.625000     test accuracy: 0.685315
Average cost in epoch 164: 0.895941
training accuracy: 0.593750     test accuracy: 0.668332

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 165: 0.888405
training accuracy: 0.406250     test accuracy: 0.682318
Average cost in epoch 166: 0.889114
training accuracy: 0.656250     test accuracy: 0.671329
Average cost in epoch 167: 0.889927
training accuracy: 0.687500     test accuracy: 0.675325
Average cost in epoch 168: 0.894815
training accuracy: 0.687500     test accuracy: 0.679321
Average cost in epoch 169: 0.900918
training accuracy: 0.593750     test accuracy: 0.677323

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 170: 0.893516
training accuracy: 0.593750     test accuracy: 0.678322
Average cost in epoch 171: 0.896223
training accuracy: 0.593750     test accuracy: 0.669331
Average cost in epoch 172: 0.898117
training accuracy: 0.718750     test accuracy: 0.688312
Average cost in epoch 173: 0.886337
training accuracy: 0.562500     test accuracy: 0.679321
Average cost in epoch 174: 0.900563
training accuracy: 0.687500     test accuracy: 0.676324

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 175: 0.883662
training accuracy: 0.562500     test accuracy: 0.686314
Average cost in epoch 176: 0.901814
training accuracy: 0.562500     test accuracy: 0.689311
Average cost in epoch 177: 0.898848
training accuracy: 0.593750     test accuracy: 0.687313
Average cost in epoch 178: 0.883554
training accuracy: 0.718750     test accuracy: 0.697303
Average cost in epoch 179: 0.885743
training accuracy: 0.656250     test accuracy: 0.686314

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 180: 0.884449
training accuracy: 0.687500     test accuracy: 0.682318
Average cost in epoch 181: 0.895885
training accuracy: 0.718750     test accuracy: 0.676324
Average cost in epoch 182: 0.894331
training accuracy: 0.625000     test accuracy: 0.681319
Average cost in epoch 183: 0.874814
training accuracy: 0.531250     test accuracy: 0.683317
Average cost in epoch 184: 0.881254
training accuracy: 0.625000     test accuracy: 0.676324

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 185: 0.885304
training accuracy: 0.500000     test accuracy: 0.675325
Average cost in epoch 186: 0.865202
training accuracy: 0.656250     test accuracy: 0.686314
Average cost in epoch 187: 0.900905
training accuracy: 0.531250     test accuracy: 0.674326
Average cost in epoch 188: 0.889803
training accuracy: 0.625000     test accuracy: 0.674326
Average cost in epoch 189: 0.888661
training accuracy: 0.656250     test accuracy: 0.684316

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 190: 0.900778
training accuracy: 0.656250     test accuracy: 0.681319
Average cost in epoch 191: 0.891869
training accuracy: 0.593750     test accuracy: 0.691309
Average cost in epoch 192: 0.883438
training accuracy: 0.750000     test accuracy: 0.696304
Average cost in epoch 193: 0.876837
training accuracy: 0.718750     test accuracy: 0.698302
Average cost in epoch 194: 0.881418
training accuracy: 0.593750     test accuracy: 0.682318

dump to weights/att-lstm/att-lstm_1.pkl

Average cost in epoch 195: 0.883144
training accuracy: 0.625000     test accuracy: 0.692308
Average cost in epoch 196: 0.875525
training accuracy: 0.593750     test accuracy: 0.692308
Average cost in epoch 197: 0.865290
training accuracy: 0.687500     test accuracy: 0.678322
Average cost in epoch 198: 0.872279
training accuracy: 0.500000     test accuracy: 0.691309
Average cost in epoch 199: 0.899808
training accuracy: 0.687500     test accuracy: 0.694306

dump to weights/att-lstm/att-lstm_1.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 2, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_2.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 117.53
Starting training...
Average cost in epoch 0: 1.837142
training accuracy: 0.250000     test accuracy: 0.254745
Average cost in epoch 1: 1.744725
training accuracy: 0.156250     test accuracy: 0.298701
Average cost in epoch 2: 1.718899
training accuracy: 0.281250     test accuracy: 0.332667
Average cost in epoch 3: 1.695907
training accuracy: 0.218750     test accuracy: 0.362637
Average cost in epoch 4: 1.678192
training accuracy: 0.343750     test accuracy: 0.344655

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 5: 1.662922
training accuracy: 0.406250     test accuracy: 0.373626
lr decays to 0.009000
Average cost in epoch 6: 1.649726
training accuracy: 0.468750     test accuracy: 0.350649
Average cost in epoch 7: 1.632554
training accuracy: 0.187500     test accuracy: 0.386613
Average cost in epoch 8: 1.623576
training accuracy: 0.343750     test accuracy: 0.364635
Average cost in epoch 9: 1.635105
training accuracy: 0.218750     test accuracy: 0.367632

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 10: 1.629425
training accuracy: 0.406250     test accuracy: 0.364635
lr decays to 0.008100
Average cost in epoch 11: 1.616343
training accuracy: 0.406250     test accuracy: 0.375624
Average cost in epoch 12: 1.607753
training accuracy: 0.531250     test accuracy: 0.359640
Average cost in epoch 13: 1.608533
training accuracy: 0.375000     test accuracy: 0.359640
Average cost in epoch 14: 1.603334
training accuracy: 0.406250     test accuracy: 0.362637

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 15: 1.588214
training accuracy: 0.437500     test accuracy: 0.355644
lr decays to 0.007290
Average cost in epoch 16: 1.577735
training accuracy: 0.406250     test accuracy: 0.382617
Average cost in epoch 17: 1.577577
training accuracy: 0.500000     test accuracy: 0.367632
Average cost in epoch 18: 1.567112
training accuracy: 0.437500     test accuracy: 0.344655
Average cost in epoch 19: 1.570421
training accuracy: 0.375000     test accuracy: 0.347652

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 20: 1.562295
training accuracy: 0.500000     test accuracy: 0.381618
lr decays to 0.006561
Average cost in epoch 21: 1.557812
training accuracy: 0.343750     test accuracy: 0.352647
Average cost in epoch 22: 1.543450
training accuracy: 0.343750     test accuracy: 0.349650
Average cost in epoch 23: 1.553197
training accuracy: 0.375000     test accuracy: 0.356643
Average cost in epoch 24: 1.544474
training accuracy: 0.312500     test accuracy: 0.376623

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 25: 1.546594
training accuracy: 0.406250     test accuracy: 0.373626
lr decays to 0.005905
Average cost in epoch 26: 1.538759
training accuracy: 0.406250     test accuracy: 0.375624
Average cost in epoch 27: 1.517853
training accuracy: 0.531250     test accuracy: 0.355644
Average cost in epoch 28: 1.529390
training accuracy: 0.343750     test accuracy: 0.373626
Average cost in epoch 29: 1.517752
training accuracy: 0.687500     test accuracy: 0.353646

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 30: 1.516084
training accuracy: 0.468750     test accuracy: 0.371628
lr decays to 0.005314
Average cost in epoch 31: 1.511437
training accuracy: 0.437500     test accuracy: 0.376623
Average cost in epoch 32: 1.510769
training accuracy: 0.531250     test accuracy: 0.381618
Average cost in epoch 33: 1.502676
training accuracy: 0.437500     test accuracy: 0.364635
Average cost in epoch 34: 1.508070
training accuracy: 0.343750     test accuracy: 0.356643

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 35: 1.493597
training accuracy: 0.437500     test accuracy: 0.362637
lr decays to 0.004783
Average cost in epoch 36: 1.498024
training accuracy: 0.437500     test accuracy: 0.352647
Average cost in epoch 37: 1.495691
training accuracy: 0.437500     test accuracy: 0.363636
Average cost in epoch 38: 1.484723
training accuracy: 0.625000     test accuracy: 0.354645
Average cost in epoch 39: 1.494504
training accuracy: 0.468750     test accuracy: 0.365634

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 40: 1.492016
training accuracy: 0.687500     test accuracy: 0.335664
lr decays to 0.004305
Average cost in epoch 41: 1.470869
training accuracy: 0.343750     test accuracy: 0.350649
Average cost in epoch 42: 1.474116
training accuracy: 0.593750     test accuracy: 0.353646
Average cost in epoch 43: 1.481260
training accuracy: 0.375000     test accuracy: 0.341658
Average cost in epoch 44: 1.467473
training accuracy: 0.406250     test accuracy: 0.356643

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 45: 1.469893
training accuracy: 0.625000     test accuracy: 0.343656
lr decays to 0.003874
Average cost in epoch 46: 1.469528
training accuracy: 0.437500     test accuracy: 0.337662
Average cost in epoch 47: 1.458341
training accuracy: 0.468750     test accuracy: 0.362637
Average cost in epoch 48: 1.445696
training accuracy: 0.375000     test accuracy: 0.365634
Average cost in epoch 49: 1.441258
training accuracy: 0.531250     test accuracy: 0.350649

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 50: 1.444744
training accuracy: 0.406250     test accuracy: 0.338661
lr decays to 0.003487
Average cost in epoch 51: 1.456535
training accuracy: 0.531250     test accuracy: 0.354645
Average cost in epoch 52: 1.440225
training accuracy: 0.468750     test accuracy: 0.337662
Average cost in epoch 53: 1.435349
training accuracy: 0.406250     test accuracy: 0.340659
Average cost in epoch 54: 1.431589
training accuracy: 0.437500     test accuracy: 0.344655

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 55: 1.430888
training accuracy: 0.468750     test accuracy: 0.361638
lr decays to 0.003138
Average cost in epoch 56: 1.433389
training accuracy: 0.656250     test accuracy: 0.354645
Average cost in epoch 57: 1.420651
training accuracy: 0.343750     test accuracy: 0.364635
Average cost in epoch 58: 1.420766
training accuracy: 0.500000     test accuracy: 0.369630
Average cost in epoch 59: 1.429119
training accuracy: 0.468750     test accuracy: 0.372627

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 60: 1.405229
training accuracy: 0.406250     test accuracy: 0.345654
lr decays to 0.002824
Average cost in epoch 61: 1.411028
training accuracy: 0.500000     test accuracy: 0.353646
Average cost in epoch 62: 1.412320
training accuracy: 0.562500     test accuracy: 0.360639
Average cost in epoch 63: 1.410198
training accuracy: 0.562500     test accuracy: 0.367632
Average cost in epoch 64: 1.404605
training accuracy: 0.593750     test accuracy: 0.342657

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 65: 1.414013
training accuracy: 0.343750     test accuracy: 0.342657
lr decays to 0.002542
Average cost in epoch 66: 1.403282
training accuracy: 0.625000     test accuracy: 0.352647
Average cost in epoch 67: 1.390437
training accuracy: 0.375000     test accuracy: 0.355644
Average cost in epoch 68: 1.390969
training accuracy: 0.531250     test accuracy: 0.342657
Average cost in epoch 69: 1.389250
training accuracy: 0.437500     test accuracy: 0.343656

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 70: 1.385173
training accuracy: 0.562500     test accuracy: 0.339660
lr decays to 0.002288
Average cost in epoch 71: 1.378547
training accuracy: 0.562500     test accuracy: 0.347652
Average cost in epoch 72: 1.380961
training accuracy: 0.343750     test accuracy: 0.356643
Average cost in epoch 73: 1.363459
training accuracy: 0.437500     test accuracy: 0.342657
Average cost in epoch 74: 1.387682
training accuracy: 0.437500     test accuracy: 0.348651

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 75: 1.382968
training accuracy: 0.531250     test accuracy: 0.339660
lr decays to 0.002059
Average cost in epoch 76: 1.365318
training accuracy: 0.343750     test accuracy: 0.344655
Average cost in epoch 77: 1.376632
training accuracy: 0.375000     test accuracy: 0.344655
Average cost in epoch 78: 1.362260
training accuracy: 0.500000     test accuracy: 0.357642
Average cost in epoch 79: 1.367572
training accuracy: 0.437500     test accuracy: 0.343656

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 80: 1.361453
training accuracy: 0.468750     test accuracy: 0.355644
lr decays to 0.001853
Average cost in epoch 81: 1.365859
training accuracy: 0.531250     test accuracy: 0.336663
Average cost in epoch 82: 1.361488
training accuracy: 0.406250     test accuracy: 0.341658
Average cost in epoch 83: 1.340717
training accuracy: 0.500000     test accuracy: 0.345654
Average cost in epoch 84: 1.348898
training accuracy: 0.468750     test accuracy: 0.355644

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 85: 1.357500
training accuracy: 0.218750     test accuracy: 0.342657
lr decays to 0.001668
Average cost in epoch 86: 1.338570
training accuracy: 0.500000     test accuracy: 0.325674
Average cost in epoch 87: 1.340952
training accuracy: 0.593750     test accuracy: 0.336663
Average cost in epoch 88: 1.347743
training accuracy: 0.625000     test accuracy: 0.344655
Average cost in epoch 89: 1.347581
training accuracy: 0.406250     test accuracy: 0.349650

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 90: 1.333753
training accuracy: 0.593750     test accuracy: 0.363636
lr decays to 0.001501
Average cost in epoch 91: 1.333047
training accuracy: 0.468750     test accuracy: 0.364635
Average cost in epoch 92: 1.338740
training accuracy: 0.625000     test accuracy: 0.335664
Average cost in epoch 93: 1.343171
training accuracy: 0.281250     test accuracy: 0.349650
Average cost in epoch 94: 1.323331
training accuracy: 0.531250     test accuracy: 0.340659

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 95: 1.331496
training accuracy: 0.437500     test accuracy: 0.329670
lr decays to 0.001351
Average cost in epoch 96: 1.309258
training accuracy: 0.531250     test accuracy: 0.338661
Average cost in epoch 97: 1.330360
training accuracy: 0.437500     test accuracy: 0.340659
Average cost in epoch 98: 1.322755
training accuracy: 0.406250     test accuracy: 0.350649
Average cost in epoch 99: 1.329220
training accuracy: 0.500000     test accuracy: 0.347652

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 100: 1.324618
training accuracy: 0.437500     test accuracy: 0.327672
lr decays to 0.001216
Average cost in epoch 101: 1.322936
training accuracy: 0.531250     test accuracy: 0.336663
Average cost in epoch 102: 1.316700
training accuracy: 0.562500     test accuracy: 0.348651
Average cost in epoch 103: 1.310253
training accuracy: 0.593750     test accuracy: 0.332667
Average cost in epoch 104: 1.313455
training accuracy: 0.593750     test accuracy: 0.326673

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 105: 1.313484
training accuracy: 0.500000     test accuracy: 0.322677
Average cost in epoch 106: 1.320742
training accuracy: 0.500000     test accuracy: 0.321678
Average cost in epoch 107: 1.322484
training accuracy: 0.375000     test accuracy: 0.326673
Average cost in epoch 108: 1.314399
training accuracy: 0.531250     test accuracy: 0.327672
Average cost in epoch 109: 1.307383
training accuracy: 0.718750     test accuracy: 0.334665

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 110: 1.306046
training accuracy: 0.562500     test accuracy: 0.328671
Average cost in epoch 111: 1.308544
training accuracy: 0.531250     test accuracy: 0.323676
Average cost in epoch 112: 1.311810
training accuracy: 0.625000     test accuracy: 0.319680
Average cost in epoch 113: 1.306569
training accuracy: 0.656250     test accuracy: 0.333666
Average cost in epoch 114: 1.312004
training accuracy: 0.437500     test accuracy: 0.341658

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 115: 1.307470
training accuracy: 0.468750     test accuracy: 0.320679
Average cost in epoch 116: 1.290615
training accuracy: 0.593750     test accuracy: 0.325674
Average cost in epoch 117: 1.302874
training accuracy: 0.500000     test accuracy: 0.317682
Average cost in epoch 118: 1.300971
training accuracy: 0.531250     test accuracy: 0.335664
Average cost in epoch 119: 1.303158
training accuracy: 0.562500     test accuracy: 0.338661

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 120: 1.300453
training accuracy: 0.562500     test accuracy: 0.312687
Average cost in epoch 121: 1.298979
training accuracy: 0.593750     test accuracy: 0.328671
Average cost in epoch 122: 1.301409
training accuracy: 0.500000     test accuracy: 0.355644
Average cost in epoch 123: 1.303289
training accuracy: 0.593750     test accuracy: 0.325674
Average cost in epoch 124: 1.276563
training accuracy: 0.500000     test accuracy: 0.328671

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 125: 1.305985
training accuracy: 0.500000     test accuracy: 0.320679
Average cost in epoch 126: 1.306304
training accuracy: 0.531250     test accuracy: 0.336663
Average cost in epoch 127: 1.298572
training accuracy: 0.562500     test accuracy: 0.327672
Average cost in epoch 128: 1.291658
training accuracy: 0.500000     test accuracy: 0.331668
Average cost in epoch 129: 1.301139
training accuracy: 0.531250     test accuracy: 0.342657

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 130: 1.289988
training accuracy: 0.625000     test accuracy: 0.329670
Average cost in epoch 131: 1.291697
training accuracy: 0.625000     test accuracy: 0.324675
Average cost in epoch 132: 1.298732
training accuracy: 0.406250     test accuracy: 0.326673
Average cost in epoch 133: 1.283482
training accuracy: 0.687500     test accuracy: 0.332667
Average cost in epoch 134: 1.292553
training accuracy: 0.593750     test accuracy: 0.333666

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 135: 1.289407
training accuracy: 0.406250     test accuracy: 0.324675
Average cost in epoch 136: 1.284260
training accuracy: 0.562500     test accuracy: 0.329670
Average cost in epoch 137: 1.284266
training accuracy: 0.593750     test accuracy: 0.331668
Average cost in epoch 138: 1.284918
training accuracy: 0.531250     test accuracy: 0.347652
Average cost in epoch 139: 1.302870
training accuracy: 0.531250     test accuracy: 0.342657

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 140: 1.286058
training accuracy: 0.625000     test accuracy: 0.341658
Average cost in epoch 141: 1.304101
training accuracy: 0.562500     test accuracy: 0.343656
Average cost in epoch 142: 1.286389
training accuracy: 0.500000     test accuracy: 0.335664
Average cost in epoch 143: 1.302692
training accuracy: 0.625000     test accuracy: 0.332667
Average cost in epoch 144: 1.292316
training accuracy: 0.593750     test accuracy: 0.342657

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 145: 1.287500
training accuracy: 0.406250     test accuracy: 0.333666
Average cost in epoch 146: 1.298068
training accuracy: 0.625000     test accuracy: 0.334665
Average cost in epoch 147: 1.291939
training accuracy: 0.500000     test accuracy: 0.325674
Average cost in epoch 148: 1.296102
training accuracy: 0.625000     test accuracy: 0.332667
Average cost in epoch 149: 1.278667
training accuracy: 0.437500     test accuracy: 0.325674

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 150: 1.282326
training accuracy: 0.406250     test accuracy: 0.338661
Average cost in epoch 151: 1.282899
training accuracy: 0.656250     test accuracy: 0.323676
Average cost in epoch 152: 1.291234
training accuracy: 0.531250     test accuracy: 0.321678
Average cost in epoch 153: 1.286603
training accuracy: 0.437500     test accuracy: 0.338661
Average cost in epoch 154: 1.288886
training accuracy: 0.593750     test accuracy: 0.320679

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 155: 1.288018
training accuracy: 0.625000     test accuracy: 0.333666
Average cost in epoch 156: 1.286294
training accuracy: 0.375000     test accuracy: 0.326673
Average cost in epoch 157: 1.303384
training accuracy: 0.593750     test accuracy: 0.326673
Average cost in epoch 158: 1.279187
training accuracy: 0.593750     test accuracy: 0.328671
Average cost in epoch 159: 1.282605
training accuracy: 0.593750     test accuracy: 0.346653

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 160: 1.293049
training accuracy: 0.562500     test accuracy: 0.336663
Average cost in epoch 161: 1.292851
training accuracy: 0.687500     test accuracy: 0.335664
Average cost in epoch 162: 1.271823
training accuracy: 0.500000     test accuracy: 0.328671
Average cost in epoch 163: 1.277906
training accuracy: 0.531250     test accuracy: 0.340659
Average cost in epoch 164: 1.290641
training accuracy: 0.500000     test accuracy: 0.332667

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 165: 1.284724
training accuracy: 0.468750     test accuracy: 0.344655
Average cost in epoch 166: 1.286434
training accuracy: 0.625000     test accuracy: 0.335664
Average cost in epoch 167: 1.282755
training accuracy: 0.687500     test accuracy: 0.349650
Average cost in epoch 168: 1.275065
training accuracy: 0.406250     test accuracy: 0.350649
Average cost in epoch 169: 1.285203
training accuracy: 0.656250     test accuracy: 0.333666

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 170: 1.285589
training accuracy: 0.562500     test accuracy: 0.350649
Average cost in epoch 171: 1.286931
training accuracy: 0.500000     test accuracy: 0.343656
Average cost in epoch 172: 1.281014
training accuracy: 0.468750     test accuracy: 0.328671
Average cost in epoch 173: 1.273071
training accuracy: 0.625000     test accuracy: 0.321678
Average cost in epoch 174: 1.288079
training accuracy: 0.531250     test accuracy: 0.332667

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 175: 1.268105
training accuracy: 0.562500     test accuracy: 0.333666
Average cost in epoch 176: 1.273091
training accuracy: 0.375000     test accuracy: 0.327672
Average cost in epoch 177: 1.265368
training accuracy: 0.343750     test accuracy: 0.338661
Average cost in epoch 178: 1.292736
training accuracy: 0.656250     test accuracy: 0.326673
Average cost in epoch 179: 1.274072
training accuracy: 0.531250     test accuracy: 0.332667

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 180: 1.277476
training accuracy: 0.406250     test accuracy: 0.333666
Average cost in epoch 181: 1.274765
training accuracy: 0.437500     test accuracy: 0.352647
Average cost in epoch 182: 1.271804
training accuracy: 0.625000     test accuracy: 0.343656
Average cost in epoch 183: 1.286851
training accuracy: 0.343750     test accuracy: 0.335664
Average cost in epoch 184: 1.285376
training accuracy: 0.531250     test accuracy: 0.331668

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 185: 1.278233
training accuracy: 0.468750     test accuracy: 0.341658
Average cost in epoch 186: 1.282418
training accuracy: 0.625000     test accuracy: 0.333666
Average cost in epoch 187: 1.281753
training accuracy: 0.312500     test accuracy: 0.333666
Average cost in epoch 188: 1.272484
training accuracy: 0.500000     test accuracy: 0.344655
Average cost in epoch 189: 1.275452
training accuracy: 0.625000     test accuracy: 0.336663

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 190: 1.287727
training accuracy: 0.406250     test accuracy: 0.351648
Average cost in epoch 191: 1.271900
training accuracy: 0.531250     test accuracy: 0.342657
Average cost in epoch 192: 1.287046
training accuracy: 0.531250     test accuracy: 0.343656
Average cost in epoch 193: 1.284113
training accuracy: 0.281250     test accuracy: 0.352647
Average cost in epoch 194: 1.270879
training accuracy: 0.406250     test accuracy: 0.340659

dump to weights/att-lstm/att-lstm_2.pkl

Average cost in epoch 195: 1.260748
training accuracy: 0.531250     test accuracy: 0.326673
Average cost in epoch 196: 1.276984
training accuracy: 0.468750     test accuracy: 0.334665
Average cost in epoch 197: 1.281325
training accuracy: 0.437500     test accuracy: 0.336663
Average cost in epoch 198: 1.263049
training accuracy: 0.531250     test accuracy: 0.329670
Average cost in epoch 199: 1.272625
training accuracy: 0.406250     test accuracy: 0.340659

dump to weights/att-lstm/att-lstm_2.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 3, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_3.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 118.75
Starting training...
Average cost in epoch 0: 1.839121
training accuracy: 0.187500     test accuracy: 0.202797
Average cost in epoch 1: 1.753607
training accuracy: 0.312500     test accuracy: 0.219780
Average cost in epoch 2: 1.737847
training accuracy: 0.125000     test accuracy: 0.206793
Average cost in epoch 3: 1.733736
training accuracy: 0.312500     test accuracy: 0.175824
Average cost in epoch 4: 1.726932
training accuracy: 0.312500     test accuracy: 0.222777

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 5: 1.723198
training accuracy: 0.281250     test accuracy: 0.203796
lr decays to 0.009000
Average cost in epoch 6: 1.715834
training accuracy: 0.281250     test accuracy: 0.242757
Average cost in epoch 7: 1.712624
training accuracy: 0.125000     test accuracy: 0.213786
Average cost in epoch 8: 1.712817
training accuracy: 0.312500     test accuracy: 0.210789
Average cost in epoch 9: 1.707997
training accuracy: 0.250000     test accuracy: 0.222777

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 10: 1.702704
training accuracy: 0.312500     test accuracy: 0.213786
lr decays to 0.008100
Average cost in epoch 11: 1.703006
training accuracy: 0.250000     test accuracy: 0.220779
Average cost in epoch 12: 1.701615
training accuracy: 0.218750     test accuracy: 0.232767
Average cost in epoch 13: 1.701028
training accuracy: 0.218750     test accuracy: 0.216783
Average cost in epoch 14: 1.699165
training accuracy: 0.187500     test accuracy: 0.231768

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 15: 1.695662
training accuracy: 0.218750     test accuracy: 0.196803
lr decays to 0.007290
Average cost in epoch 16: 1.694295
training accuracy: 0.250000     test accuracy: 0.212787
Average cost in epoch 17: 1.691890
training accuracy: 0.281250     test accuracy: 0.206793
Average cost in epoch 18: 1.691403
training accuracy: 0.187500     test accuracy: 0.219780
Average cost in epoch 19: 1.691299
training accuracy: 0.187500     test accuracy: 0.203796

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 20: 1.694926
training accuracy: 0.281250     test accuracy: 0.211788
lr decays to 0.006561
Average cost in epoch 21: 1.684152
training accuracy: 0.187500     test accuracy: 0.222777
Average cost in epoch 22: 1.683403
training accuracy: 0.343750     test accuracy: 0.246753
Average cost in epoch 23: 1.684212
training accuracy: 0.187500     test accuracy: 0.193806
Average cost in epoch 24: 1.683659
training accuracy: 0.375000     test accuracy: 0.225774

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 25: 1.686544
training accuracy: 0.187500     test accuracy: 0.218781
lr decays to 0.005905
Average cost in epoch 26: 1.678869
training accuracy: 0.250000     test accuracy: 0.246753
Average cost in epoch 27: 1.674178
training accuracy: 0.187500     test accuracy: 0.222777
Average cost in epoch 28: 1.675490
training accuracy: 0.187500     test accuracy: 0.207792
Average cost in epoch 29: 1.675006
training accuracy: 0.125000     test accuracy: 0.218781

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 30: 1.672668
training accuracy: 0.218750     test accuracy: 0.245754
lr decays to 0.005314
Average cost in epoch 31: 1.671841
training accuracy: 0.218750     test accuracy: 0.252747
Average cost in epoch 32: 1.667688
training accuracy: 0.250000     test accuracy: 0.222777
Average cost in epoch 33: 1.667618
training accuracy: 0.187500     test accuracy: 0.212787
Average cost in epoch 34: 1.665399
training accuracy: 0.406250     test accuracy: 0.234765

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 35: 1.662162
training accuracy: 0.281250     test accuracy: 0.219780
lr decays to 0.004783
Average cost in epoch 36: 1.661689
training accuracy: 0.281250     test accuracy: 0.217782
Average cost in epoch 37: 1.661443
training accuracy: 0.250000     test accuracy: 0.233766
Average cost in epoch 38: 1.657852
training accuracy: 0.281250     test accuracy: 0.220779
Average cost in epoch 39: 1.660700
training accuracy: 0.156250     test accuracy: 0.219780

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 40: 1.655826
training accuracy: 0.312500     test accuracy: 0.215784
lr decays to 0.004305
Average cost in epoch 41: 1.657522
training accuracy: 0.250000     test accuracy: 0.226773
Average cost in epoch 42: 1.657457
training accuracy: 0.250000     test accuracy: 0.235764
Average cost in epoch 43: 1.652267
training accuracy: 0.312500     test accuracy: 0.230769
Average cost in epoch 44: 1.649985
training accuracy: 0.218750     test accuracy: 0.248751

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 45: 1.653316
training accuracy: 0.187500     test accuracy: 0.216783
lr decays to 0.003874
Average cost in epoch 46: 1.645554
training accuracy: 0.375000     test accuracy: 0.221778
Average cost in epoch 47: 1.642314
training accuracy: 0.218750     test accuracy: 0.216783
Average cost in epoch 48: 1.639008
training accuracy: 0.218750     test accuracy: 0.222777
Average cost in epoch 49: 1.643146
training accuracy: 0.187500     test accuracy: 0.222777

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 50: 1.641286
training accuracy: 0.406250     test accuracy: 0.242757
lr decays to 0.003487
Average cost in epoch 51: 1.634481
training accuracy: 0.125000     test accuracy: 0.216783
Average cost in epoch 52: 1.630867
training accuracy: 0.218750     test accuracy: 0.234765
Average cost in epoch 53: 1.639253
training accuracy: 0.468750     test accuracy: 0.224775
Average cost in epoch 54: 1.633917
training accuracy: 0.218750     test accuracy: 0.242757

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 55: 1.632349
training accuracy: 0.218750     test accuracy: 0.221778
lr decays to 0.003138
Average cost in epoch 56: 1.629037
training accuracy: 0.281250     test accuracy: 0.225774
Average cost in epoch 57: 1.628434
training accuracy: 0.343750     test accuracy: 0.222777
Average cost in epoch 58: 1.622765
training accuracy: 0.156250     test accuracy: 0.215784
Average cost in epoch 59: 1.628740
training accuracy: 0.468750     test accuracy: 0.212787

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 60: 1.621964
training accuracy: 0.218750     test accuracy: 0.255744
lr decays to 0.002824
Average cost in epoch 61: 1.615821
training accuracy: 0.250000     test accuracy: 0.221778
Average cost in epoch 62: 1.621854
training accuracy: 0.218750     test accuracy: 0.211788
Average cost in epoch 63: 1.614337
training accuracy: 0.406250     test accuracy: 0.221778
Average cost in epoch 64: 1.610432
training accuracy: 0.343750     test accuracy: 0.237762

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 65: 1.612776
training accuracy: 0.281250     test accuracy: 0.243756
lr decays to 0.002542
Average cost in epoch 66: 1.609322
training accuracy: 0.406250     test accuracy: 0.235764
Average cost in epoch 67: 1.610046
training accuracy: 0.468750     test accuracy: 0.233766
Average cost in epoch 68: 1.600517
training accuracy: 0.312500     test accuracy: 0.216783
Average cost in epoch 69: 1.604274
training accuracy: 0.281250     test accuracy: 0.232767

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 70: 1.606784
training accuracy: 0.375000     test accuracy: 0.224775
lr decays to 0.002288
Average cost in epoch 71: 1.606910
training accuracy: 0.218750     test accuracy: 0.215784
Average cost in epoch 72: 1.598335
training accuracy: 0.218750     test accuracy: 0.225774
Average cost in epoch 73: 1.601315
training accuracy: 0.218750     test accuracy: 0.237762
Average cost in epoch 74: 1.597746
training accuracy: 0.281250     test accuracy: 0.211788

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 75: 1.589802
training accuracy: 0.312500     test accuracy: 0.235764
lr decays to 0.002059
Average cost in epoch 76: 1.588392
training accuracy: 0.218750     test accuracy: 0.224775
Average cost in epoch 77: 1.594151
training accuracy: 0.437500     test accuracy: 0.238761
Average cost in epoch 78: 1.582207
training accuracy: 0.281250     test accuracy: 0.228771
Average cost in epoch 79: 1.585525
training accuracy: 0.406250     test accuracy: 0.232767

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 80: 1.595783
training accuracy: 0.437500     test accuracy: 0.247752
lr decays to 0.001853
Average cost in epoch 81: 1.588920
training accuracy: 0.375000     test accuracy: 0.226773
Average cost in epoch 82: 1.579919
training accuracy: 0.343750     test accuracy: 0.209790
Average cost in epoch 83: 1.585608
training accuracy: 0.312500     test accuracy: 0.208791
Average cost in epoch 84: 1.585696
training accuracy: 0.250000     test accuracy: 0.219780

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 85: 1.573621
training accuracy: 0.281250     test accuracy: 0.237762
lr decays to 0.001668
Average cost in epoch 86: 1.579648
training accuracy: 0.156250     test accuracy: 0.228771
Average cost in epoch 87: 1.583038
training accuracy: 0.312500     test accuracy: 0.220779
Average cost in epoch 88: 1.580848
training accuracy: 0.562500     test accuracy: 0.222777
Average cost in epoch 89: 1.579784
training accuracy: 0.281250     test accuracy: 0.227772

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 90: 1.576335
training accuracy: 0.343750     test accuracy: 0.220779
lr decays to 0.001501
Average cost in epoch 91: 1.575155
training accuracy: 0.312500     test accuracy: 0.215784
Average cost in epoch 92: 1.574507
training accuracy: 0.343750     test accuracy: 0.230769
Average cost in epoch 93: 1.571154
training accuracy: 0.250000     test accuracy: 0.244755
Average cost in epoch 94: 1.562427
training accuracy: 0.218750     test accuracy: 0.219780

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 95: 1.564490
training accuracy: 0.250000     test accuracy: 0.215784
lr decays to 0.001351
Average cost in epoch 96: 1.562916
training accuracy: 0.406250     test accuracy: 0.208791
Average cost in epoch 97: 1.561600
training accuracy: 0.156250     test accuracy: 0.219780
Average cost in epoch 98: 1.559104
training accuracy: 0.343750     test accuracy: 0.225774
Average cost in epoch 99: 1.556364
training accuracy: 0.312500     test accuracy: 0.206793

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 100: 1.569828
training accuracy: 0.343750     test accuracy: 0.209790
lr decays to 0.001216
Average cost in epoch 101: 1.562055
training accuracy: 0.218750     test accuracy: 0.214785
Average cost in epoch 102: 1.562003
training accuracy: 0.187500     test accuracy: 0.213786
Average cost in epoch 103: 1.554814
training accuracy: 0.281250     test accuracy: 0.209790
Average cost in epoch 104: 1.559958
training accuracy: 0.343750     test accuracy: 0.200799

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 105: 1.553705
training accuracy: 0.281250     test accuracy: 0.192807
Average cost in epoch 106: 1.557106
training accuracy: 0.250000     test accuracy: 0.198801
Average cost in epoch 107: 1.555718
training accuracy: 0.343750     test accuracy: 0.202797
Average cost in epoch 108: 1.552679
training accuracy: 0.406250     test accuracy: 0.208791
Average cost in epoch 109: 1.545946
training accuracy: 0.312500     test accuracy: 0.234765

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 110: 1.555063
training accuracy: 0.312500     test accuracy: 0.225774
Average cost in epoch 111: 1.548833
training accuracy: 0.281250     test accuracy: 0.198801
Average cost in epoch 112: 1.555365
training accuracy: 0.312500     test accuracy: 0.210789
Average cost in epoch 113: 1.560697
training accuracy: 0.437500     test accuracy: 0.213786
Average cost in epoch 114: 1.543594
training accuracy: 0.218750     test accuracy: 0.209790

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 115: 1.542666
training accuracy: 0.343750     test accuracy: 0.223776
Average cost in epoch 116: 1.546566
training accuracy: 0.281250     test accuracy: 0.205794
Average cost in epoch 117: 1.548940
training accuracy: 0.406250     test accuracy: 0.228771
Average cost in epoch 118: 1.548128
training accuracy: 0.468750     test accuracy: 0.223776
Average cost in epoch 119: 1.554705
training accuracy: 0.468750     test accuracy: 0.239760

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 120: 1.540416
training accuracy: 0.312500     test accuracy: 0.223776
Average cost in epoch 121: 1.540845
training accuracy: 0.281250     test accuracy: 0.223776
Average cost in epoch 122: 1.540007
training accuracy: 0.281250     test accuracy: 0.225774
Average cost in epoch 123: 1.555816
training accuracy: 0.375000     test accuracy: 0.217782
Average cost in epoch 124: 1.546265
training accuracy: 0.281250     test accuracy: 0.219780

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 125: 1.544000
training accuracy: 0.312500     test accuracy: 0.218781
Average cost in epoch 126: 1.548849
training accuracy: 0.312500     test accuracy: 0.213786
Average cost in epoch 127: 1.546242
training accuracy: 0.312500     test accuracy: 0.218781
Average cost in epoch 128: 1.540614
training accuracy: 0.468750     test accuracy: 0.218781
Average cost in epoch 129: 1.544767
training accuracy: 0.343750     test accuracy: 0.219780

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 130: 1.549705
training accuracy: 0.281250     test accuracy: 0.225774
Average cost in epoch 131: 1.534240
training accuracy: 0.312500     test accuracy: 0.218781
Average cost in epoch 132: 1.547649
training accuracy: 0.250000     test accuracy: 0.208791
Average cost in epoch 133: 1.542982
training accuracy: 0.562500     test accuracy: 0.218781
Average cost in epoch 134: 1.549046
training accuracy: 0.312500     test accuracy: 0.229770

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 135: 1.540840
training accuracy: 0.406250     test accuracy: 0.225774
Average cost in epoch 136: 1.543460
training accuracy: 0.062500     test accuracy: 0.213786
Average cost in epoch 137: 1.539818
training accuracy: 0.437500     test accuracy: 0.219780
Average cost in epoch 138: 1.543263
training accuracy: 0.281250     test accuracy: 0.210789
Average cost in epoch 139: 1.534978
training accuracy: 0.343750     test accuracy: 0.224775

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 140: 1.542702
training accuracy: 0.437500     test accuracy: 0.229770
Average cost in epoch 141: 1.534861
training accuracy: 0.312500     test accuracy: 0.222777
Average cost in epoch 142: 1.543907
training accuracy: 0.437500     test accuracy: 0.231768
Average cost in epoch 143: 1.536733
training accuracy: 0.375000     test accuracy: 0.240759
Average cost in epoch 144: 1.548054
training accuracy: 0.406250     test accuracy: 0.229770

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 145: 1.535642
training accuracy: 0.312500     test accuracy: 0.213786
Average cost in epoch 146: 1.527719
training accuracy: 0.375000     test accuracy: 0.228771
Average cost in epoch 147: 1.534172
training accuracy: 0.375000     test accuracy: 0.224775
Average cost in epoch 148: 1.533546
training accuracy: 0.281250     test accuracy: 0.229770
Average cost in epoch 149: 1.536718
training accuracy: 0.437500     test accuracy: 0.213786

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 150: 1.542888
training accuracy: 0.375000     test accuracy: 0.223776
Average cost in epoch 151: 1.539304
training accuracy: 0.375000     test accuracy: 0.221778
Average cost in epoch 152: 1.531368
training accuracy: 0.312500     test accuracy: 0.230769
Average cost in epoch 153: 1.539863
training accuracy: 0.406250     test accuracy: 0.227772
Average cost in epoch 154: 1.538330
training accuracy: 0.343750     test accuracy: 0.224775

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 155: 1.542638
training accuracy: 0.312500     test accuracy: 0.230769
Average cost in epoch 156: 1.530770
training accuracy: 0.406250     test accuracy: 0.210789
Average cost in epoch 157: 1.543184
training accuracy: 0.312500     test accuracy: 0.210789
Average cost in epoch 158: 1.535802
training accuracy: 0.375000     test accuracy: 0.231768
Average cost in epoch 159: 1.529266
training accuracy: 0.343750     test accuracy: 0.212787

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 160: 1.526555
training accuracy: 0.343750     test accuracy: 0.220779
Average cost in epoch 161: 1.533739
training accuracy: 0.343750     test accuracy: 0.220779
Average cost in epoch 162: 1.538322
training accuracy: 0.406250     test accuracy: 0.235764
Average cost in epoch 163: 1.532806
training accuracy: 0.343750     test accuracy: 0.222777
Average cost in epoch 164: 1.528705
training accuracy: 0.375000     test accuracy: 0.229770

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 165: 1.540011
training accuracy: 0.562500     test accuracy: 0.223776
Average cost in epoch 166: 1.522774
training accuracy: 0.281250     test accuracy: 0.221778
Average cost in epoch 167: 1.538038
training accuracy: 0.531250     test accuracy: 0.216783
Average cost in epoch 168: 1.527219
training accuracy: 0.343750     test accuracy: 0.215784
Average cost in epoch 169: 1.529681
training accuracy: 0.406250     test accuracy: 0.238761

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 170: 1.529812
training accuracy: 0.468750     test accuracy: 0.234765
Average cost in epoch 171: 1.528247
training accuracy: 0.343750     test accuracy: 0.219780
Average cost in epoch 172: 1.533674
training accuracy: 0.406250     test accuracy: 0.228771
Average cost in epoch 173: 1.527712
training accuracy: 0.437500     test accuracy: 0.219780
Average cost in epoch 174: 1.531212
training accuracy: 0.406250     test accuracy: 0.227772

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 175: 1.525858
training accuracy: 0.312500     test accuracy: 0.219780
Average cost in epoch 176: 1.526298
training accuracy: 0.375000     test accuracy: 0.229770
Average cost in epoch 177: 1.532889
training accuracy: 0.375000     test accuracy: 0.239760
Average cost in epoch 178: 1.521868
training accuracy: 0.437500     test accuracy: 0.223776
Average cost in epoch 179: 1.534882
training accuracy: 0.343750     test accuracy: 0.217782

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 180: 1.526386
training accuracy: 0.437500     test accuracy: 0.239760
Average cost in epoch 181: 1.524613
training accuracy: 0.406250     test accuracy: 0.229770
Average cost in epoch 182: 1.527199
training accuracy: 0.531250     test accuracy: 0.220779
Average cost in epoch 183: 1.534068
training accuracy: 0.437500     test accuracy: 0.237762
Average cost in epoch 184: 1.527327
training accuracy: 0.437500     test accuracy: 0.224775

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 185: 1.532174
training accuracy: 0.125000     test accuracy: 0.212787
Average cost in epoch 186: 1.522586
training accuracy: 0.468750     test accuracy: 0.225774
Average cost in epoch 187: 1.530593
training accuracy: 0.343750     test accuracy: 0.231768
Average cost in epoch 188: 1.527522
training accuracy: 0.437500     test accuracy: 0.238761
Average cost in epoch 189: 1.527203
training accuracy: 0.281250     test accuracy: 0.236763

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 190: 1.542089
training accuracy: 0.406250     test accuracy: 0.236763
Average cost in epoch 191: 1.519227
training accuracy: 0.312500     test accuracy: 0.228771
Average cost in epoch 192: 1.530220
training accuracy: 0.187500     test accuracy: 0.226773
Average cost in epoch 193: 1.528840
training accuracy: 0.562500     test accuracy: 0.220779
Average cost in epoch 194: 1.522171
training accuracy: 0.375000     test accuracy: 0.243756

dump to weights/att-lstm/att-lstm_3.pkl

Average cost in epoch 195: 1.526450
training accuracy: 0.312500     test accuracy: 0.232767
Average cost in epoch 196: 1.517846
training accuracy: 0.281250     test accuracy: 0.243756
Average cost in epoch 197: 1.528228
training accuracy: 0.218750     test accuracy: 0.231768
Average cost in epoch 198: 1.526495
training accuracy: 0.312500     test accuracy: 0.217782
Average cost in epoch 199: 1.526931
training accuracy: 0.406250     test accuracy: 0.226773

dump to weights/att-lstm/att-lstm_3.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 4, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_4.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 123.79
Starting training...
Average cost in epoch 0: 1.686239
training accuracy: 0.375000     test accuracy: 0.549451
Average cost in epoch 1: 1.452855
training accuracy: 0.343750     test accuracy: 0.560440
Average cost in epoch 2: 1.345338
training accuracy: 0.593750     test accuracy: 0.582418
Average cost in epoch 3: 1.245646
training accuracy: 0.406250     test accuracy: 0.603397
Average cost in epoch 4: 1.171340
training accuracy: 0.531250     test accuracy: 0.618382

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 5: 1.123163
training accuracy: 0.437500     test accuracy: 0.624376
lr decays to 0.009000
Average cost in epoch 6: 1.062042
training accuracy: 0.687500     test accuracy: 0.639361
Average cost in epoch 7: 1.043508
training accuracy: 0.562500     test accuracy: 0.622378
Average cost in epoch 8: 1.002383
training accuracy: 0.468750     test accuracy: 0.629371
Average cost in epoch 9: 0.988280
training accuracy: 0.562500     test accuracy: 0.639361

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 10: 0.968389
training accuracy: 0.593750     test accuracy: 0.551449
lr decays to 0.008100
Average cost in epoch 11: 0.962274
training accuracy: 0.718750     test accuracy: 0.663337
Average cost in epoch 12: 0.950225
training accuracy: 0.625000     test accuracy: 0.661339
Average cost in epoch 13: 0.941804
training accuracy: 0.625000     test accuracy: 0.654346
Average cost in epoch 14: 0.931652
training accuracy: 0.687500     test accuracy: 0.687313

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 15: 0.923353
training accuracy: 0.500000     test accuracy: 0.652348
lr decays to 0.007290
Average cost in epoch 16: 0.901474
training accuracy: 0.562500     test accuracy: 0.694306
Average cost in epoch 17: 0.879525
training accuracy: 0.625000     test accuracy: 0.693307
Average cost in epoch 18: 0.854449
training accuracy: 0.593750     test accuracy: 0.675325
Average cost in epoch 19: 0.832709
training accuracy: 0.718750     test accuracy: 0.719281

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 20: 0.837794
training accuracy: 0.625000     test accuracy: 0.688312
lr decays to 0.006561
Average cost in epoch 21: 0.821819
training accuracy: 0.781250     test accuracy: 0.721279
Average cost in epoch 22: 0.823994
training accuracy: 0.562500     test accuracy: 0.726274
Average cost in epoch 23: 0.814704
training accuracy: 0.562500     test accuracy: 0.724276
Average cost in epoch 24: 0.809860
training accuracy: 0.562500     test accuracy: 0.717283

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 25: 0.805272
training accuracy: 0.625000     test accuracy: 0.712288
lr decays to 0.005905
Average cost in epoch 26: 0.794670
training accuracy: 0.375000     test accuracy: 0.712288
Average cost in epoch 27: 0.783641
training accuracy: 0.656250     test accuracy: 0.712288
Average cost in epoch 28: 0.780121
training accuracy: 0.625000     test accuracy: 0.712288
Average cost in epoch 29: 0.784119
training accuracy: 0.656250     test accuracy: 0.723277

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 30: 0.767583
training accuracy: 0.781250     test accuracy: 0.708292
lr decays to 0.005314
Average cost in epoch 31: 0.767591
training accuracy: 0.750000     test accuracy: 0.721279
Average cost in epoch 32: 0.762577
training accuracy: 0.687500     test accuracy: 0.732268
Average cost in epoch 33: 0.764752
training accuracy: 0.500000     test accuracy: 0.711289
Average cost in epoch 34: 0.754689
training accuracy: 0.718750     test accuracy: 0.726274

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 35: 0.743290
training accuracy: 0.687500     test accuracy: 0.724276
lr decays to 0.004783
Average cost in epoch 36: 0.742559
training accuracy: 0.750000     test accuracy: 0.737263
Average cost in epoch 37: 0.755280
training accuracy: 0.718750     test accuracy: 0.736264
Average cost in epoch 38: 0.739265
training accuracy: 0.718750     test accuracy: 0.730270
Average cost in epoch 39: 0.737024
training accuracy: 0.656250     test accuracy: 0.748252

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 40: 0.728872
training accuracy: 0.437500     test accuracy: 0.738262
lr decays to 0.004305
Average cost in epoch 41: 0.728634
training accuracy: 0.656250     test accuracy: 0.744256
Average cost in epoch 42: 0.734364
training accuracy: 0.843750     test accuracy: 0.737263
Average cost in epoch 43: 0.731584
training accuracy: 0.781250     test accuracy: 0.737263
Average cost in epoch 44: 0.732378
training accuracy: 0.593750     test accuracy: 0.736264

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 45: 0.720273
training accuracy: 0.656250     test accuracy: 0.729271
lr decays to 0.003874
Average cost in epoch 46: 0.718345
training accuracy: 0.750000     test accuracy: 0.728272
Average cost in epoch 47: 0.717240
training accuracy: 0.656250     test accuracy: 0.729271
Average cost in epoch 48: 0.708688
training accuracy: 0.531250     test accuracy: 0.732268
Average cost in epoch 49: 0.716971
training accuracy: 0.625000     test accuracy: 0.735265

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 50: 0.703970
training accuracy: 0.750000     test accuracy: 0.737263
lr decays to 0.003487
Average cost in epoch 51: 0.701916
training accuracy: 0.625000     test accuracy: 0.745255
Average cost in epoch 52: 0.712144
training accuracy: 0.750000     test accuracy: 0.730270
Average cost in epoch 53: 0.698914
training accuracy: 0.687500     test accuracy: 0.723277
Average cost in epoch 54: 0.700129
training accuracy: 0.625000     test accuracy: 0.733267

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 55: 0.699907
training accuracy: 0.750000     test accuracy: 0.740260
lr decays to 0.003138
Average cost in epoch 56: 0.694818
training accuracy: 0.625000     test accuracy: 0.745255
Average cost in epoch 57: 0.694226
training accuracy: 0.718750     test accuracy: 0.726274
Average cost in epoch 58: 0.702035
training accuracy: 0.687500     test accuracy: 0.724276
Average cost in epoch 59: 0.694191
training accuracy: 0.687500     test accuracy: 0.717283

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 60: 0.678138
training accuracy: 0.718750     test accuracy: 0.741259
lr decays to 0.002824
Average cost in epoch 61: 0.690854
training accuracy: 0.781250     test accuracy: 0.734266
Average cost in epoch 62: 0.689499
training accuracy: 0.562500     test accuracy: 0.734266
Average cost in epoch 63: 0.682246
training accuracy: 0.812500     test accuracy: 0.737263
Average cost in epoch 64: 0.681218
training accuracy: 0.656250     test accuracy: 0.728272

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 65: 0.689294
training accuracy: 0.625000     test accuracy: 0.737263
lr decays to 0.002542
Average cost in epoch 66: 0.688855
training accuracy: 0.687500     test accuracy: 0.736264
Average cost in epoch 67: 0.678849
training accuracy: 0.500000     test accuracy: 0.721279
Average cost in epoch 68: 0.678821
training accuracy: 0.687500     test accuracy: 0.739261
Average cost in epoch 69: 0.684569
training accuracy: 0.718750     test accuracy: 0.748252

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 70: 0.671331
training accuracy: 0.625000     test accuracy: 0.743257
lr decays to 0.002288
Average cost in epoch 71: 0.668963
training accuracy: 0.593750     test accuracy: 0.746254
Average cost in epoch 72: 0.678811
training accuracy: 0.718750     test accuracy: 0.741259
Average cost in epoch 73: 0.678631
training accuracy: 0.500000     test accuracy: 0.725275
Average cost in epoch 74: 0.672332
training accuracy: 0.687500     test accuracy: 0.734266

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 75: 0.674039
training accuracy: 0.750000     test accuracy: 0.731269
lr decays to 0.002059
Average cost in epoch 76: 0.669907
training accuracy: 0.750000     test accuracy: 0.744256
Average cost in epoch 77: 0.662647
training accuracy: 0.656250     test accuracy: 0.743257
Average cost in epoch 78: 0.671857
training accuracy: 0.656250     test accuracy: 0.742258
Average cost in epoch 79: 0.668103
training accuracy: 0.687500     test accuracy: 0.746254

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 80: 0.668734
training accuracy: 0.750000     test accuracy: 0.732268
lr decays to 0.001853
Average cost in epoch 81: 0.660469
training accuracy: 0.562500     test accuracy: 0.746254
Average cost in epoch 82: 0.665138
training accuracy: 0.781250     test accuracy: 0.741259
Average cost in epoch 83: 0.667504
training accuracy: 0.625000     test accuracy: 0.743257
Average cost in epoch 84: 0.661266
training accuracy: 0.531250     test accuracy: 0.726274

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 85: 0.668093
training accuracy: 0.687500     test accuracy: 0.730270
lr decays to 0.001668
Average cost in epoch 86: 0.653307
training accuracy: 0.625000     test accuracy: 0.740260
Average cost in epoch 87: 0.662660
training accuracy: 0.593750     test accuracy: 0.738262
Average cost in epoch 88: 0.661957
training accuracy: 0.718750     test accuracy: 0.745255
Average cost in epoch 89: 0.651713
training accuracy: 0.687500     test accuracy: 0.750250

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 90: 0.660599
training accuracy: 0.750000     test accuracy: 0.749251
lr decays to 0.001501
Average cost in epoch 91: 0.661495
training accuracy: 0.593750     test accuracy: 0.742258
Average cost in epoch 92: 0.654601
training accuracy: 0.781250     test accuracy: 0.730270
Average cost in epoch 93: 0.655264
training accuracy: 0.687500     test accuracy: 0.748252
Average cost in epoch 94: 0.657790
training accuracy: 0.656250     test accuracy: 0.752248

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 95: 0.655184
training accuracy: 0.625000     test accuracy: 0.752248
lr decays to 0.001351
Average cost in epoch 96: 0.652436
training accuracy: 0.531250     test accuracy: 0.753247
Average cost in epoch 97: 0.644565
training accuracy: 0.750000     test accuracy: 0.737263
Average cost in epoch 98: 0.652635
training accuracy: 0.718750     test accuracy: 0.745255
Average cost in epoch 99: 0.658895
training accuracy: 0.843750     test accuracy: 0.751249

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 100: 0.659952
training accuracy: 0.562500     test accuracy: 0.739261
lr decays to 0.001216
Average cost in epoch 101: 0.646372
training accuracy: 0.781250     test accuracy: 0.749251
Average cost in epoch 102: 0.647524
training accuracy: 0.781250     test accuracy: 0.744256
Average cost in epoch 103: 0.657116
training accuracy: 0.781250     test accuracy: 0.745255
Average cost in epoch 104: 0.653732
training accuracy: 0.812500     test accuracy: 0.748252

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 105: 0.651332
training accuracy: 0.718750     test accuracy: 0.735265
Average cost in epoch 106: 0.644260
training accuracy: 0.687500     test accuracy: 0.732268
Average cost in epoch 107: 0.649840
training accuracy: 0.718750     test accuracy: 0.746254
Average cost in epoch 108: 0.648668
training accuracy: 0.812500     test accuracy: 0.753247
Average cost in epoch 109: 0.637012
training accuracy: 0.656250     test accuracy: 0.733267

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 110: 0.642396
training accuracy: 0.718750     test accuracy: 0.748252
Average cost in epoch 111: 0.649849
training accuracy: 0.656250     test accuracy: 0.746254
Average cost in epoch 112: 0.647190
training accuracy: 0.718750     test accuracy: 0.745255
Average cost in epoch 113: 0.644387
training accuracy: 0.750000     test accuracy: 0.752248
Average cost in epoch 114: 0.649462
training accuracy: 0.843750     test accuracy: 0.751249

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 115: 0.647065
training accuracy: 0.718750     test accuracy: 0.738262
Average cost in epoch 116: 0.642566
training accuracy: 0.687500     test accuracy: 0.750250
Average cost in epoch 117: 0.640398
training accuracy: 0.562500     test accuracy: 0.748252
Average cost in epoch 118: 0.644929
training accuracy: 0.781250     test accuracy: 0.751249
Average cost in epoch 119: 0.644470
training accuracy: 0.656250     test accuracy: 0.743257

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 120: 0.646464
training accuracy: 0.656250     test accuracy: 0.750250
Average cost in epoch 121: 0.647035
training accuracy: 0.656250     test accuracy: 0.747253
Average cost in epoch 122: 0.637703
training accuracy: 0.750000     test accuracy: 0.748252
Average cost in epoch 123: 0.644281
training accuracy: 0.687500     test accuracy: 0.736264
Average cost in epoch 124: 0.646592
training accuracy: 0.625000     test accuracy: 0.743257

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 125: 0.649754
training accuracy: 0.562500     test accuracy: 0.745255
Average cost in epoch 126: 0.641901
training accuracy: 0.781250     test accuracy: 0.742258
Average cost in epoch 127: 0.650498
training accuracy: 0.562500     test accuracy: 0.741259
Average cost in epoch 128: 0.633171
training accuracy: 0.812500     test accuracy: 0.753247
Average cost in epoch 129: 0.633552
training accuracy: 0.687500     test accuracy: 0.744256

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 130: 0.635199
training accuracy: 0.687500     test accuracy: 0.754246
Average cost in epoch 131: 0.633146
training accuracy: 0.718750     test accuracy: 0.750250
Average cost in epoch 132: 0.643124
training accuracy: 0.500000     test accuracy: 0.744256
Average cost in epoch 133: 0.638079
training accuracy: 0.812500     test accuracy: 0.754246
Average cost in epoch 134: 0.642902
training accuracy: 0.781250     test accuracy: 0.751249

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 135: 0.640924
training accuracy: 0.781250     test accuracy: 0.751249
Average cost in epoch 136: 0.641512
training accuracy: 0.687500     test accuracy: 0.739261
Average cost in epoch 137: 0.629180
training accuracy: 0.718750     test accuracy: 0.750250
Average cost in epoch 138: 0.629113
training accuracy: 0.593750     test accuracy: 0.737263
Average cost in epoch 139: 0.643368
training accuracy: 0.718750     test accuracy: 0.745255

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 140: 0.632193
training accuracy: 0.687500     test accuracy: 0.739261
Average cost in epoch 141: 0.648242
training accuracy: 0.781250     test accuracy: 0.737263
Average cost in epoch 142: 0.639652
training accuracy: 0.750000     test accuracy: 0.746254
Average cost in epoch 143: 0.642750
training accuracy: 0.718750     test accuracy: 0.742258
Average cost in epoch 144: 0.639328
training accuracy: 0.531250     test accuracy: 0.745255

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 145: 0.648801
training accuracy: 0.625000     test accuracy: 0.749251
Average cost in epoch 146: 0.629802
training accuracy: 0.750000     test accuracy: 0.744256
Average cost in epoch 147: 0.638320
training accuracy: 0.656250     test accuracy: 0.753247
Average cost in epoch 148: 0.639076
training accuracy: 0.531250     test accuracy: 0.744256
Average cost in epoch 149: 0.635901
training accuracy: 0.625000     test accuracy: 0.752248

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 150: 0.632265
training accuracy: 0.687500     test accuracy: 0.755245
Average cost in epoch 151: 0.633492
training accuracy: 0.750000     test accuracy: 0.732268
Average cost in epoch 152: 0.632634
training accuracy: 0.687500     test accuracy: 0.747253
Average cost in epoch 153: 0.644462
training accuracy: 0.656250     test accuracy: 0.740260
Average cost in epoch 154: 0.619667
training accuracy: 0.812500     test accuracy: 0.752248

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 155: 0.639733
training accuracy: 0.812500     test accuracy: 0.754246
Average cost in epoch 156: 0.641685
training accuracy: 0.687500     test accuracy: 0.746254
Average cost in epoch 157: 0.640642
training accuracy: 0.843750     test accuracy: 0.751249
Average cost in epoch 158: 0.634083
training accuracy: 0.718750     test accuracy: 0.747253
Average cost in epoch 159: 0.637870
training accuracy: 0.625000     test accuracy: 0.744256

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 160: 0.646507
training accuracy: 0.687500     test accuracy: 0.738262
Average cost in epoch 161: 0.619578
training accuracy: 0.718750     test accuracy: 0.746254
Average cost in epoch 162: 0.637825
training accuracy: 0.687500     test accuracy: 0.748252
Average cost in epoch 163: 0.631719
training accuracy: 0.625000     test accuracy: 0.744256
Average cost in epoch 164: 0.637438
training accuracy: 0.718750     test accuracy: 0.747253

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 165: 0.644139
training accuracy: 0.718750     test accuracy: 0.735265
Average cost in epoch 166: 0.631091
training accuracy: 0.812500     test accuracy: 0.747253
Average cost in epoch 167: 0.637305
training accuracy: 0.687500     test accuracy: 0.732268
Average cost in epoch 168: 0.637165
training accuracy: 0.687500     test accuracy: 0.753247
Average cost in epoch 169: 0.633804
training accuracy: 0.687500     test accuracy: 0.750250

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 170: 0.641543
training accuracy: 0.687500     test accuracy: 0.755245
Average cost in epoch 171: 0.626089
training accuracy: 0.781250     test accuracy: 0.744256
Average cost in epoch 172: 0.634257
training accuracy: 0.718750     test accuracy: 0.754246
Average cost in epoch 173: 0.631241
training accuracy: 0.750000     test accuracy: 0.751249
Average cost in epoch 174: 0.630705
training accuracy: 0.656250     test accuracy: 0.744256

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 175: 0.633864
training accuracy: 0.625000     test accuracy: 0.742258
Average cost in epoch 176: 0.630850
training accuracy: 0.718750     test accuracy: 0.747253
Average cost in epoch 177: 0.625701
training accuracy: 0.687500     test accuracy: 0.745255
Average cost in epoch 178: 0.625960
training accuracy: 0.781250     test accuracy: 0.747253
Average cost in epoch 179: 0.627250
training accuracy: 0.750000     test accuracy: 0.745255

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 180: 0.630297
training accuracy: 0.812500     test accuracy: 0.751249
Average cost in epoch 181: 0.627371
training accuracy: 0.500000     test accuracy: 0.747253
Average cost in epoch 182: 0.637781
training accuracy: 0.656250     test accuracy: 0.743257
Average cost in epoch 183: 0.634311
training accuracy: 0.625000     test accuracy: 0.750250
Average cost in epoch 184: 0.626378
training accuracy: 0.750000     test accuracy: 0.741259

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 185: 0.627999
training accuracy: 0.718750     test accuracy: 0.743257
Average cost in epoch 186: 0.630627
training accuracy: 0.687500     test accuracy: 0.741259
Average cost in epoch 187: 0.619653
training accuracy: 0.718750     test accuracy: 0.750250
Average cost in epoch 188: 0.637189
training accuracy: 0.750000     test accuracy: 0.753247
Average cost in epoch 189: 0.633129
training accuracy: 0.625000     test accuracy: 0.749251

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 190: 0.633269
training accuracy: 0.843750     test accuracy: 0.736264
Average cost in epoch 191: 0.626322
training accuracy: 0.625000     test accuracy: 0.750250
Average cost in epoch 192: 0.639175
training accuracy: 0.750000     test accuracy: 0.757243
Average cost in epoch 193: 0.634905
training accuracy: 0.687500     test accuracy: 0.747253
Average cost in epoch 194: 0.628533
training accuracy: 0.812500     test accuracy: 0.757243

dump to weights/att-lstm/att-lstm_4.pkl

Average cost in epoch 195: 0.629642
training accuracy: 0.812500     test accuracy: 0.740260
Average cost in epoch 196: 0.621331
training accuracy: 0.843750     test accuracy: 0.754246
Average cost in epoch 197: 0.625888
training accuracy: 0.718750     test accuracy: 0.750250
Average cost in epoch 198: 0.640363
training accuracy: 0.437500     test accuracy: 0.746254
Average cost in epoch 199: 0.640035
training accuracy: 0.718750     test accuracy: 0.752248

dump to weights/att-lstm/att-lstm_4.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 5, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_5.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 120.13
Starting training...
Average cost in epoch 0: 1.404171
training accuracy: 0.281250     test accuracy: 0.338661
Average cost in epoch 1: 1.293932
training accuracy: 0.281250     test accuracy: 0.400599
Average cost in epoch 2: 1.232749
training accuracy: 0.281250     test accuracy: 0.433566
Average cost in epoch 3: 1.182732
training accuracy: 0.343750     test accuracy: 0.463536
Average cost in epoch 4: 1.158956
training accuracy: 0.468750     test accuracy: 0.449550

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 5: 1.129681
training accuracy: 0.468750     test accuracy: 0.501499
lr decays to 0.009000
Average cost in epoch 6: 1.106712
training accuracy: 0.375000     test accuracy: 0.523477
Average cost in epoch 7: 1.089581
training accuracy: 0.375000     test accuracy: 0.461538
Average cost in epoch 8: 1.085466
training accuracy: 0.437500     test accuracy: 0.460539
Average cost in epoch 9: 1.073926
training accuracy: 0.468750     test accuracy: 0.470529

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 10: 1.067144
training accuracy: 0.375000     test accuracy: 0.505495
lr decays to 0.008100
Average cost in epoch 11: 1.059979
training accuracy: 0.593750     test accuracy: 0.510490
Average cost in epoch 12: 1.059777
training accuracy: 0.406250     test accuracy: 0.511489
Average cost in epoch 13: 1.055508
training accuracy: 0.531250     test accuracy: 0.512488
Average cost in epoch 14: 1.049154
training accuracy: 0.468750     test accuracy: 0.466533

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 15: 1.049167
training accuracy: 0.500000     test accuracy: 0.490509
lr decays to 0.007290
Average cost in epoch 16: 1.034149
training accuracy: 0.625000     test accuracy: 0.511489
Average cost in epoch 17: 1.034350
training accuracy: 0.562500     test accuracy: 0.503497
Average cost in epoch 18: 1.031070
training accuracy: 0.625000     test accuracy: 0.502498
Average cost in epoch 19: 1.034441
training accuracy: 0.562500     test accuracy: 0.520480

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 20: 1.019962
training accuracy: 0.437500     test accuracy: 0.503497
lr decays to 0.006561
Average cost in epoch 21: 1.026197
training accuracy: 0.562500     test accuracy: 0.499500
Average cost in epoch 22: 1.023869
training accuracy: 0.531250     test accuracy: 0.503497
Average cost in epoch 23: 1.022464
training accuracy: 0.375000     test accuracy: 0.503497
Average cost in epoch 24: 1.015301
training accuracy: 0.500000     test accuracy: 0.517483

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 25: 1.015515
training accuracy: 0.468750     test accuracy: 0.515485
lr decays to 0.005905
Average cost in epoch 26: 1.006810
training accuracy: 0.531250     test accuracy: 0.504496
Average cost in epoch 27: 1.010661
training accuracy: 0.406250     test accuracy: 0.465534
Average cost in epoch 28: 1.008109
training accuracy: 0.562500     test accuracy: 0.481518
Average cost in epoch 29: 1.009522
training accuracy: 0.468750     test accuracy: 0.514486

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 30: 1.011560
training accuracy: 0.500000     test accuracy: 0.511489
lr decays to 0.005314
Average cost in epoch 31: 0.997351
training accuracy: 0.687500     test accuracy: 0.471528
Average cost in epoch 32: 1.009568
training accuracy: 0.468750     test accuracy: 0.522478
Average cost in epoch 33: 0.995375
training accuracy: 0.500000     test accuracy: 0.520480
Average cost in epoch 34: 1.000948
training accuracy: 0.531250     test accuracy: 0.500500

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 35: 0.989676
training accuracy: 0.562500     test accuracy: 0.521479
lr decays to 0.004783
Average cost in epoch 36: 0.990637
training accuracy: 0.531250     test accuracy: 0.516484
Average cost in epoch 37: 0.994887
training accuracy: 0.562500     test accuracy: 0.510490
Average cost in epoch 38: 0.988943
training accuracy: 0.406250     test accuracy: 0.525475
Average cost in epoch 39: 0.982920
training accuracy: 0.406250     test accuracy: 0.508492

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 40: 0.984604
training accuracy: 0.375000     test accuracy: 0.504496
lr decays to 0.004305
Average cost in epoch 41: 0.982763
training accuracy: 0.500000     test accuracy: 0.506494
Average cost in epoch 42: 0.973066
training accuracy: 0.500000     test accuracy: 0.513487
Average cost in epoch 43: 0.978194
training accuracy: 0.500000     test accuracy: 0.472527
Average cost in epoch 44: 0.978106
training accuracy: 0.562500     test accuracy: 0.447552

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 45: 0.978804
training accuracy: 0.562500     test accuracy: 0.460539
lr decays to 0.003874
Average cost in epoch 46: 0.973691
training accuracy: 0.406250     test accuracy: 0.511489
Average cost in epoch 47: 0.979125
training accuracy: 0.625000     test accuracy: 0.515485
Average cost in epoch 48: 0.973238
training accuracy: 0.593750     test accuracy: 0.502498
Average cost in epoch 49: 0.965812
training accuracy: 0.500000     test accuracy: 0.508492

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 50: 0.967890
training accuracy: 0.500000     test accuracy: 0.509491
lr decays to 0.003487
Average cost in epoch 51: 0.974325
training accuracy: 0.593750     test accuracy: 0.505495
Average cost in epoch 52: 0.968966
training accuracy: 0.593750     test accuracy: 0.490509
Average cost in epoch 53: 0.963374
training accuracy: 0.593750     test accuracy: 0.517483
Average cost in epoch 54: 0.962866
training accuracy: 0.687500     test accuracy: 0.474525

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 55: 0.960186
training accuracy: 0.406250     test accuracy: 0.522478
lr decays to 0.003138
Average cost in epoch 56: 0.958944
training accuracy: 0.531250     test accuracy: 0.510490
Average cost in epoch 57: 0.963499
training accuracy: 0.312500     test accuracy: 0.515485
Average cost in epoch 58: 0.941864
training accuracy: 0.625000     test accuracy: 0.486513
Average cost in epoch 59: 0.959038
training accuracy: 0.625000     test accuracy: 0.512488

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 60: 0.960331
training accuracy: 0.437500     test accuracy: 0.513487
lr decays to 0.002824
Average cost in epoch 61: 0.944339
training accuracy: 0.562500     test accuracy: 0.519481
Average cost in epoch 62: 0.951843
training accuracy: 0.593750     test accuracy: 0.505495
Average cost in epoch 63: 0.945434
training accuracy: 0.500000     test accuracy: 0.514486
Average cost in epoch 64: 0.950991
training accuracy: 0.656250     test accuracy: 0.468531

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 65: 0.944648
training accuracy: 0.531250     test accuracy: 0.509491
lr decays to 0.002542
Average cost in epoch 66: 0.944876
training accuracy: 0.468750     test accuracy: 0.496503
Average cost in epoch 67: 0.940086
training accuracy: 0.531250     test accuracy: 0.506494
Average cost in epoch 68: 0.946612
training accuracy: 0.562500     test accuracy: 0.482517
Average cost in epoch 69: 0.934972
training accuracy: 0.531250     test accuracy: 0.518482

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 70: 0.941566
training accuracy: 0.406250     test accuracy: 0.522478
lr decays to 0.002288
Average cost in epoch 71: 0.936622
training accuracy: 0.562500     test accuracy: 0.524476
Average cost in epoch 72: 0.930676
training accuracy: 0.656250     test accuracy: 0.517483
Average cost in epoch 73: 0.940584
training accuracy: 0.343750     test accuracy: 0.480519
Average cost in epoch 74: 0.933024
training accuracy: 0.625000     test accuracy: 0.522478

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 75: 0.931611
training accuracy: 0.593750     test accuracy: 0.513487
lr decays to 0.002059
Average cost in epoch 76: 0.937085
training accuracy: 0.500000     test accuracy: 0.514486
Average cost in epoch 77: 0.925795
training accuracy: 0.500000     test accuracy: 0.489510
Average cost in epoch 78: 0.930676
training accuracy: 0.562500     test accuracy: 0.523477
Average cost in epoch 79: 0.933857
training accuracy: 0.500000     test accuracy: 0.519481

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 80: 0.937315
training accuracy: 0.531250     test accuracy: 0.520480
lr decays to 0.001853
Average cost in epoch 81: 0.925986
training accuracy: 0.500000     test accuracy: 0.521479
Average cost in epoch 82: 0.926441
training accuracy: 0.656250     test accuracy: 0.532468
Average cost in epoch 83: 0.939318
training accuracy: 0.531250     test accuracy: 0.520480
Average cost in epoch 84: 0.920490
training accuracy: 0.562500     test accuracy: 0.516484

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 85: 0.928731
training accuracy: 0.625000     test accuracy: 0.510490
lr decays to 0.001668
Average cost in epoch 86: 0.918706
training accuracy: 0.437500     test accuracy: 0.516484
Average cost in epoch 87: 0.915275
training accuracy: 0.656250     test accuracy: 0.522478
Average cost in epoch 88: 0.914024
training accuracy: 0.593750     test accuracy: 0.482517
Average cost in epoch 89: 0.916375
training accuracy: 0.562500     test accuracy: 0.529471

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 90: 0.916335
training accuracy: 0.437500     test accuracy: 0.516484
lr decays to 0.001501
Average cost in epoch 91: 0.920011
training accuracy: 0.437500     test accuracy: 0.525475
Average cost in epoch 92: 0.913227
training accuracy: 0.593750     test accuracy: 0.515485
Average cost in epoch 93: 0.919774
training accuracy: 0.468750     test accuracy: 0.527473
Average cost in epoch 94: 0.918063
training accuracy: 0.625000     test accuracy: 0.526474

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 95: 0.922681
training accuracy: 0.593750     test accuracy: 0.521479
lr decays to 0.001351
Average cost in epoch 96: 0.907521
training accuracy: 0.718750     test accuracy: 0.519481
Average cost in epoch 97: 0.913920
training accuracy: 0.656250     test accuracy: 0.501499
Average cost in epoch 98: 0.908857
training accuracy: 0.625000     test accuracy: 0.505495
Average cost in epoch 99: 0.915292
training accuracy: 0.625000     test accuracy: 0.524476

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 100: 0.909820
training accuracy: 0.656250     test accuracy: 0.515485
lr decays to 0.001216
Average cost in epoch 101: 0.904388
training accuracy: 0.406250     test accuracy: 0.518482
Average cost in epoch 102: 0.904784
training accuracy: 0.406250     test accuracy: 0.509491
Average cost in epoch 103: 0.913724
training accuracy: 0.500000     test accuracy: 0.508492
Average cost in epoch 104: 0.902935
training accuracy: 0.562500     test accuracy: 0.527473

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 105: 0.914252
training accuracy: 0.468750     test accuracy: 0.518482
Average cost in epoch 106: 0.906260
training accuracy: 0.625000     test accuracy: 0.529471
Average cost in epoch 107: 0.899675
training accuracy: 0.656250     test accuracy: 0.521479
Average cost in epoch 108: 0.893789
training accuracy: 0.687500     test accuracy: 0.526474
Average cost in epoch 109: 0.908929
training accuracy: 0.625000     test accuracy: 0.521479

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 110: 0.906535
training accuracy: 0.687500     test accuracy: 0.518482
Average cost in epoch 111: 0.902251
training accuracy: 0.656250     test accuracy: 0.526474
Average cost in epoch 112: 0.900604
training accuracy: 0.593750     test accuracy: 0.528472
Average cost in epoch 113: 0.907904
training accuracy: 0.562500     test accuracy: 0.521479
Average cost in epoch 114: 0.907291
training accuracy: 0.687500     test accuracy: 0.521479

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 115: 0.893135
training accuracy: 0.562500     test accuracy: 0.520480
Average cost in epoch 116: 0.914929
training accuracy: 0.468750     test accuracy: 0.523477
Average cost in epoch 117: 0.901302
training accuracy: 0.500000     test accuracy: 0.525475
Average cost in epoch 118: 0.899630
training accuracy: 0.656250     test accuracy: 0.526474
Average cost in epoch 119: 0.896085
training accuracy: 0.625000     test accuracy: 0.533467

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 120: 0.905482
training accuracy: 0.500000     test accuracy: 0.516484
Average cost in epoch 121: 0.910015
training accuracy: 0.625000     test accuracy: 0.523477
Average cost in epoch 122: 0.898665
training accuracy: 0.687500     test accuracy: 0.518482
Average cost in epoch 123: 0.895557
training accuracy: 0.437500     test accuracy: 0.517483
Average cost in epoch 124: 0.900486
training accuracy: 0.531250     test accuracy: 0.526474

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 125: 0.897600
training accuracy: 0.562500     test accuracy: 0.523477
Average cost in epoch 126: 0.902180
training accuracy: 0.562500     test accuracy: 0.506494
Average cost in epoch 127: 0.895572
training accuracy: 0.562500     test accuracy: 0.522478
Average cost in epoch 128: 0.890732
training accuracy: 0.562500     test accuracy: 0.530470
Average cost in epoch 129: 0.906244
training accuracy: 0.562500     test accuracy: 0.525475

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 130: 0.903632
training accuracy: 0.625000     test accuracy: 0.515485
Average cost in epoch 131: 0.894674
training accuracy: 0.468750     test accuracy: 0.536464
Average cost in epoch 132: 0.895835
training accuracy: 0.656250     test accuracy: 0.532468
Average cost in epoch 133: 0.898177
training accuracy: 0.312500     test accuracy: 0.515485
Average cost in epoch 134: 0.893387
training accuracy: 0.625000     test accuracy: 0.525475

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 135: 0.895390
training accuracy: 0.531250     test accuracy: 0.526474
Average cost in epoch 136: 0.891807
training accuracy: 0.437500     test accuracy: 0.509491
Average cost in epoch 137: 0.894274
training accuracy: 0.562500     test accuracy: 0.515485
Average cost in epoch 138: 0.897074
training accuracy: 0.406250     test accuracy: 0.514486
Average cost in epoch 139: 0.894330
training accuracy: 0.656250     test accuracy: 0.526474

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 140: 0.896443
training accuracy: 0.625000     test accuracy: 0.522478
Average cost in epoch 141: 0.884002
training accuracy: 0.531250     test accuracy: 0.523477
Average cost in epoch 142: 0.890839
training accuracy: 0.500000     test accuracy: 0.529471
Average cost in epoch 143: 0.897559
training accuracy: 0.437500     test accuracy: 0.517483
Average cost in epoch 144: 0.895246
training accuracy: 0.625000     test accuracy: 0.518482

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 145: 0.895569
training accuracy: 0.625000     test accuracy: 0.527473
Average cost in epoch 146: 0.892096
training accuracy: 0.656250     test accuracy: 0.526474
Average cost in epoch 147: 0.900458
training accuracy: 0.593750     test accuracy: 0.526474
Average cost in epoch 148: 0.892117
training accuracy: 0.531250     test accuracy: 0.516484
Average cost in epoch 149: 0.896471
training accuracy: 0.593750     test accuracy: 0.533467

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 150: 0.893668
training accuracy: 0.687500     test accuracy: 0.522478
Average cost in epoch 151: 0.892337
training accuracy: 0.625000     test accuracy: 0.526474
Average cost in epoch 152: 0.891653
training accuracy: 0.687500     test accuracy: 0.511489
Average cost in epoch 153: 0.895818
training accuracy: 0.562500     test accuracy: 0.513487
Average cost in epoch 154: 0.891302
training accuracy: 0.625000     test accuracy: 0.507493

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 155: 0.882629
training accuracy: 0.625000     test accuracy: 0.528472
Average cost in epoch 156: 0.887039
training accuracy: 0.531250     test accuracy: 0.531469
Average cost in epoch 157: 0.898558
training accuracy: 0.562500     test accuracy: 0.524476
Average cost in epoch 158: 0.877157
training accuracy: 0.531250     test accuracy: 0.527473
Average cost in epoch 159: 0.889832
training accuracy: 0.562500     test accuracy: 0.519481

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 160: 0.884562
training accuracy: 0.468750     test accuracy: 0.522478
Average cost in epoch 161: 0.895403
training accuracy: 0.500000     test accuracy: 0.516484
Average cost in epoch 162: 0.886226
training accuracy: 0.656250     test accuracy: 0.522478
Average cost in epoch 163: 0.876401
training accuracy: 0.593750     test accuracy: 0.535465
Average cost in epoch 164: 0.892268
training accuracy: 0.437500     test accuracy: 0.510490

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 165: 0.889362
training accuracy: 0.656250     test accuracy: 0.529471
Average cost in epoch 166: 0.885031
training accuracy: 0.531250     test accuracy: 0.526474
Average cost in epoch 167: 0.880981
training accuracy: 0.656250     test accuracy: 0.520480
Average cost in epoch 168: 0.882620
training accuracy: 0.562500     test accuracy: 0.534466
Average cost in epoch 169: 0.888890
training accuracy: 0.500000     test accuracy: 0.536464

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 170: 0.891300
training accuracy: 0.625000     test accuracy: 0.517483
Average cost in epoch 171: 0.886622
training accuracy: 0.593750     test accuracy: 0.531469
Average cost in epoch 172: 0.888464
training accuracy: 0.500000     test accuracy: 0.510490
Average cost in epoch 173: 0.891595
training accuracy: 0.562500     test accuracy: 0.508492
Average cost in epoch 174: 0.884502
training accuracy: 0.500000     test accuracy: 0.514486

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 175: 0.885561
training accuracy: 0.468750     test accuracy: 0.522478
Average cost in epoch 176: 0.894779
training accuracy: 0.562500     test accuracy: 0.524476
Average cost in epoch 177: 0.898439
training accuracy: 0.531250     test accuracy: 0.521479
Average cost in epoch 178: 0.876536
training accuracy: 0.562500     test accuracy: 0.514486
Average cost in epoch 179: 0.886030
training accuracy: 0.593750     test accuracy: 0.512488

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 180: 0.887979
training accuracy: 0.687500     test accuracy: 0.513487
Average cost in epoch 181: 0.880106
training accuracy: 0.468750     test accuracy: 0.524476
Average cost in epoch 182: 0.884945
training accuracy: 0.375000     test accuracy: 0.522478
Average cost in epoch 183: 0.887866
training accuracy: 0.562500     test accuracy: 0.517483
Average cost in epoch 184: 0.892187
training accuracy: 0.750000     test accuracy: 0.521479

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 185: 0.882912
training accuracy: 0.656250     test accuracy: 0.522478
Average cost in epoch 186: 0.884739
training accuracy: 0.500000     test accuracy: 0.520480
Average cost in epoch 187: 0.880489
training accuracy: 0.531250     test accuracy: 0.521479
Average cost in epoch 188: 0.878455
training accuracy: 0.625000     test accuracy: 0.521479
Average cost in epoch 189: 0.881935
training accuracy: 0.687500     test accuracy: 0.521479

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 190: 0.877812
training accuracy: 0.562500     test accuracy: 0.522478
Average cost in epoch 191: 0.880295
training accuracy: 0.562500     test accuracy: 0.504496
Average cost in epoch 192: 0.879815
training accuracy: 0.687500     test accuracy: 0.509491
Average cost in epoch 193: 0.889916
training accuracy: 0.687500     test accuracy: 0.510490
Average cost in epoch 194: 0.871266
training accuracy: 0.562500     test accuracy: 0.519481

dump to weights/att-lstm/att-lstm_5.pkl

Average cost in epoch 195: 0.886869
training accuracy: 0.656250     test accuracy: 0.521479
Average cost in epoch 196: 0.881324
training accuracy: 0.656250     test accuracy: 0.505495
Average cost in epoch 197: 0.882301
training accuracy: 0.531250     test accuracy: 0.508492
Average cost in epoch 198: 0.887651
training accuracy: 0.656250     test accuracy: 0.511489
Average cost in epoch 199: 0.866374
training accuracy: 0.656250     test accuracy: 0.520480

dump to weights/att-lstm/att-lstm_5.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 6, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_6.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 119.43
Starting training...
Average cost in epoch 0: 0.740849
training accuracy: 0.500000     test accuracy: 0.502498
Average cost in epoch 1: 0.699746
training accuracy: 0.593750     test accuracy: 0.502498
Average cost in epoch 2: 0.698470
training accuracy: 0.531250     test accuracy: 0.497502
Average cost in epoch 3: 0.695787
training accuracy: 0.468750     test accuracy: 0.502498
Average cost in epoch 4: 0.697556
training accuracy: 0.531250     test accuracy: 0.502498

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 5: 0.695662
training accuracy: 0.500000     test accuracy: 0.502498
lr decays to 0.009000
Average cost in epoch 6: 0.694691
training accuracy: 0.437500     test accuracy: 0.500500
Average cost in epoch 7: 0.695176
training accuracy: 0.531250     test accuracy: 0.496503
Average cost in epoch 8: 0.694148
training accuracy: 0.500000     test accuracy: 0.500500
Average cost in epoch 9: 0.693536
training accuracy: 0.500000     test accuracy: 0.505495

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 10: 0.695178
training accuracy: 0.406250     test accuracy: 0.497502
lr decays to 0.008100
Average cost in epoch 11: 0.694013
training accuracy: 0.593750     test accuracy: 0.502498
Average cost in epoch 12: 0.694188
training accuracy: 0.625000     test accuracy: 0.493506
Average cost in epoch 13: 0.694105
training accuracy: 0.437500     test accuracy: 0.497502
Average cost in epoch 14: 0.694195
training accuracy: 0.562500     test accuracy: 0.507493

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 15: 0.693974
training accuracy: 0.500000     test accuracy: 0.498501
lr decays to 0.007290
Average cost in epoch 16: 0.693786
training accuracy: 0.656250     test accuracy: 0.491508
Average cost in epoch 17: 0.696851
training accuracy: 0.593750     test accuracy: 0.497502
Average cost in epoch 18: 0.694422
training accuracy: 0.468750     test accuracy: 0.496503
Average cost in epoch 19: 0.694172
training accuracy: 0.343750     test accuracy: 0.501499

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 20: 0.693805
training accuracy: 0.437500     test accuracy: 0.502498
lr decays to 0.006561
Average cost in epoch 21: 0.694257
training accuracy: 0.437500     test accuracy: 0.502498
Average cost in epoch 22: 0.694703
training accuracy: 0.437500     test accuracy: 0.508492
Average cost in epoch 23: 0.694675
training accuracy: 0.625000     test accuracy: 0.506494
Average cost in epoch 24: 0.694239
training accuracy: 0.500000     test accuracy: 0.502498

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 25: 0.693323
training accuracy: 0.500000     test accuracy: 0.521479
lr decays to 0.005905
Average cost in epoch 26: 0.694171
training accuracy: 0.593750     test accuracy: 0.539461
Average cost in epoch 27: 0.692877
training accuracy: 0.468750     test accuracy: 0.553447
Average cost in epoch 28: 0.690660
training accuracy: 0.593750     test accuracy: 0.511489
Average cost in epoch 29: 0.688762
training accuracy: 0.375000     test accuracy: 0.543457

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 30: 0.689182
training accuracy: 0.531250     test accuracy: 0.555445
lr decays to 0.005314
Average cost in epoch 31: 0.690743
training accuracy: 0.656250     test accuracy: 0.550450
Average cost in epoch 32: 0.688546
training accuracy: 0.531250     test accuracy: 0.543457
Average cost in epoch 33: 0.689056
training accuracy: 0.468750     test accuracy: 0.544456
Average cost in epoch 34: 0.686494
training accuracy: 0.468750     test accuracy: 0.560440

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 35: 0.690676
training accuracy: 0.406250     test accuracy: 0.540460
lr decays to 0.004783
Average cost in epoch 36: 0.687612
training accuracy: 0.468750     test accuracy: 0.543457
Average cost in epoch 37: 0.685310
training accuracy: 0.406250     test accuracy: 0.550450
Average cost in epoch 38: 0.685570
training accuracy: 0.750000     test accuracy: 0.592408
Average cost in epoch 39: 0.686250
training accuracy: 0.500000     test accuracy: 0.595405

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 40: 0.684811
training accuracy: 0.500000     test accuracy: 0.591409
lr decays to 0.004305
Average cost in epoch 41: 0.684580
training accuracy: 0.593750     test accuracy: 0.557443
Average cost in epoch 42: 0.682817
training accuracy: 0.687500     test accuracy: 0.587413
Average cost in epoch 43: 0.682896
training accuracy: 0.531250     test accuracy: 0.589411
Average cost in epoch 44: 0.683706
training accuracy: 0.500000     test accuracy: 0.573427

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 45: 0.680705
training accuracy: 0.718750     test accuracy: 0.556444
lr decays to 0.003874
Average cost in epoch 46: 0.680282
training accuracy: 0.625000     test accuracy: 0.566434
Average cost in epoch 47: 0.680063
training accuracy: 0.625000     test accuracy: 0.572428
Average cost in epoch 48: 0.677464
training accuracy: 0.718750     test accuracy: 0.572428
Average cost in epoch 49: 0.677964
training accuracy: 0.656250     test accuracy: 0.567433

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 50: 0.676876
training accuracy: 0.562500     test accuracy: 0.580420
lr decays to 0.003487
Average cost in epoch 51: 0.677236
training accuracy: 0.531250     test accuracy: 0.579421
Average cost in epoch 52: 0.674462
training accuracy: 0.656250     test accuracy: 0.580420
Average cost in epoch 53: 0.673088
training accuracy: 0.625000     test accuracy: 0.582418
Average cost in epoch 54: 0.671455
training accuracy: 0.562500     test accuracy: 0.591409

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 55: 0.671088
training accuracy: 0.562500     test accuracy: 0.588412
lr decays to 0.003138
Average cost in epoch 56: 0.671193
training accuracy: 0.656250     test accuracy: 0.586414
Average cost in epoch 57: 0.669996
training accuracy: 0.562500     test accuracy: 0.594406
Average cost in epoch 58: 0.664283
training accuracy: 0.437500     test accuracy: 0.592408
Average cost in epoch 59: 0.668688
training accuracy: 0.625000     test accuracy: 0.594406

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 60: 0.665627
training accuracy: 0.625000     test accuracy: 0.601399
lr decays to 0.002824
Average cost in epoch 61: 0.659616
training accuracy: 0.593750     test accuracy: 0.595405
Average cost in epoch 62: 0.661981
training accuracy: 0.531250     test accuracy: 0.608392
Average cost in epoch 63: 0.657622
training accuracy: 0.718750     test accuracy: 0.604396
Average cost in epoch 64: 0.650115
training accuracy: 0.687500     test accuracy: 0.606394

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 65: 0.645101
training accuracy: 0.656250     test accuracy: 0.606394
lr decays to 0.002542
Average cost in epoch 66: 0.645210
training accuracy: 0.437500     test accuracy: 0.621379
Average cost in epoch 67: 0.641941
training accuracy: 0.625000     test accuracy: 0.614386
Average cost in epoch 68: 0.639669
training accuracy: 0.625000     test accuracy: 0.604396
Average cost in epoch 69: 0.639852
training accuracy: 0.531250     test accuracy: 0.613387

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 70: 0.641959
training accuracy: 0.625000     test accuracy: 0.610390
lr decays to 0.002288
Average cost in epoch 71: 0.636799
training accuracy: 0.718750     test accuracy: 0.598402
Average cost in epoch 72: 0.634984
training accuracy: 0.718750     test accuracy: 0.603397
Average cost in epoch 73: 0.636138
training accuracy: 0.718750     test accuracy: 0.607393
Average cost in epoch 74: 0.637206
training accuracy: 0.593750     test accuracy: 0.605395

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 75: 0.635092
training accuracy: 0.562500     test accuracy: 0.610390
lr decays to 0.002059
Average cost in epoch 76: 0.630956
training accuracy: 0.750000     test accuracy: 0.605395
Average cost in epoch 77: 0.631476
training accuracy: 0.593750     test accuracy: 0.604396
Average cost in epoch 78: 0.637277
training accuracy: 0.656250     test accuracy: 0.607393
Average cost in epoch 79: 0.630463
training accuracy: 0.656250     test accuracy: 0.602398

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 80: 0.631150
training accuracy: 0.656250     test accuracy: 0.609391
lr decays to 0.001853
Average cost in epoch 81: 0.629623
training accuracy: 0.656250     test accuracy: 0.608392
Average cost in epoch 82: 0.628896
training accuracy: 0.656250     test accuracy: 0.598402
Average cost in epoch 83: 0.623068
training accuracy: 0.406250     test accuracy: 0.605395
Average cost in epoch 84: 0.628941
training accuracy: 0.562500     test accuracy: 0.609391

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 85: 0.626758
training accuracy: 0.625000     test accuracy: 0.616384
lr decays to 0.001668
Average cost in epoch 86: 0.627278
training accuracy: 0.781250     test accuracy: 0.603397
Average cost in epoch 87: 0.627069
training accuracy: 0.500000     test accuracy: 0.608392
Average cost in epoch 88: 0.626814
training accuracy: 0.781250     test accuracy: 0.608392
Average cost in epoch 89: 0.628357
training accuracy: 0.687500     test accuracy: 0.607393

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 90: 0.627290
training accuracy: 0.500000     test accuracy: 0.600400
lr decays to 0.001501
Average cost in epoch 91: 0.630749
training accuracy: 0.687500     test accuracy: 0.596404
Average cost in epoch 92: 0.623712
training accuracy: 0.531250     test accuracy: 0.607393
Average cost in epoch 93: 0.619992
training accuracy: 0.531250     test accuracy: 0.606394
Average cost in epoch 94: 0.623874
training accuracy: 0.656250     test accuracy: 0.606394

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 95: 0.623505
training accuracy: 0.656250     test accuracy: 0.609391
lr decays to 0.001351
Average cost in epoch 96: 0.629163
training accuracy: 0.625000     test accuracy: 0.607393
Average cost in epoch 97: 0.617395
training accuracy: 0.531250     test accuracy: 0.605395
Average cost in epoch 98: 0.618984
training accuracy: 0.687500     test accuracy: 0.602398
Average cost in epoch 99: 0.622727
training accuracy: 0.593750     test accuracy: 0.610390

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 100: 0.619754
training accuracy: 0.750000     test accuracy: 0.607393
lr decays to 0.001216
Average cost in epoch 101: 0.620035
training accuracy: 0.531250     test accuracy: 0.606394
Average cost in epoch 102: 0.619531
training accuracy: 0.750000     test accuracy: 0.608392
Average cost in epoch 103: 0.621479
training accuracy: 0.625000     test accuracy: 0.607393
Average cost in epoch 104: 0.624783
training accuracy: 0.750000     test accuracy: 0.603397

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 105: 0.617693
training accuracy: 0.656250     test accuracy: 0.603397
Average cost in epoch 106: 0.614978
training accuracy: 0.656250     test accuracy: 0.606394
Average cost in epoch 107: 0.624698
training accuracy: 0.656250     test accuracy: 0.604396
Average cost in epoch 108: 0.616100
training accuracy: 0.500000     test accuracy: 0.602398
Average cost in epoch 109: 0.616334
training accuracy: 0.562500     test accuracy: 0.604396

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 110: 0.618462
training accuracy: 0.562500     test accuracy: 0.608392
Average cost in epoch 111: 0.616487
training accuracy: 0.718750     test accuracy: 0.609391
Average cost in epoch 112: 0.617588
training accuracy: 0.437500     test accuracy: 0.601399
Average cost in epoch 113: 0.617440
training accuracy: 0.718750     test accuracy: 0.605395
Average cost in epoch 114: 0.615102
training accuracy: 0.812500     test accuracy: 0.603397

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 115: 0.611070
training accuracy: 0.718750     test accuracy: 0.603397
Average cost in epoch 116: 0.615662
training accuracy: 0.656250     test accuracy: 0.604396
Average cost in epoch 117: 0.614131
training accuracy: 0.687500     test accuracy: 0.623377
Average cost in epoch 118: 0.616511
training accuracy: 0.562500     test accuracy: 0.605395
Average cost in epoch 119: 0.613353
training accuracy: 0.656250     test accuracy: 0.608392

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 120: 0.615463
training accuracy: 0.656250     test accuracy: 0.609391
Average cost in epoch 121: 0.615381
training accuracy: 0.625000     test accuracy: 0.611389
Average cost in epoch 122: 0.614335
training accuracy: 0.718750     test accuracy: 0.606394
Average cost in epoch 123: 0.613261
training accuracy: 0.656250     test accuracy: 0.606394
Average cost in epoch 124: 0.615428
training accuracy: 0.718750     test accuracy: 0.609391

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 125: 0.610405
training accuracy: 0.656250     test accuracy: 0.611389
Average cost in epoch 126: 0.616972
training accuracy: 0.593750     test accuracy: 0.611389
Average cost in epoch 127: 0.608796
training accuracy: 0.656250     test accuracy: 0.602398
Average cost in epoch 128: 0.613748
training accuracy: 0.562500     test accuracy: 0.607393
Average cost in epoch 129: 0.610126
training accuracy: 0.562500     test accuracy: 0.604396

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 130: 0.610582
training accuracy: 0.562500     test accuracy: 0.609391
Average cost in epoch 131: 0.613202
training accuracy: 0.687500     test accuracy: 0.608392
Average cost in epoch 132: 0.611944
training accuracy: 0.562500     test accuracy: 0.620380
Average cost in epoch 133: 0.612494
training accuracy: 0.625000     test accuracy: 0.611389
Average cost in epoch 134: 0.614800
training accuracy: 0.656250     test accuracy: 0.618382

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 135: 0.606878
training accuracy: 0.750000     test accuracy: 0.611389
Average cost in epoch 136: 0.609364
training accuracy: 0.562500     test accuracy: 0.615385
Average cost in epoch 137: 0.607996
training accuracy: 0.531250     test accuracy: 0.608392
Average cost in epoch 138: 0.612184
training accuracy: 0.718750     test accuracy: 0.610390
Average cost in epoch 139: 0.611995
training accuracy: 0.687500     test accuracy: 0.605395

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 140: 0.612999
training accuracy: 0.437500     test accuracy: 0.604396
Average cost in epoch 141: 0.608432
training accuracy: 0.781250     test accuracy: 0.604396
Average cost in epoch 142: 0.610195
training accuracy: 0.656250     test accuracy: 0.610390
Average cost in epoch 143: 0.605750
training accuracy: 0.656250     test accuracy: 0.604396
Average cost in epoch 144: 0.610146
training accuracy: 0.562500     test accuracy: 0.610390

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 145: 0.610008
training accuracy: 0.593750     test accuracy: 0.602398
Average cost in epoch 146: 0.605965
training accuracy: 0.562500     test accuracy: 0.603397
Average cost in epoch 147: 0.607150
training accuracy: 0.593750     test accuracy: 0.598402
Average cost in epoch 148: 0.609438
training accuracy: 0.625000     test accuracy: 0.607393
Average cost in epoch 149: 0.603776
training accuracy: 0.562500     test accuracy: 0.606394

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 150: 0.610611
training accuracy: 0.562500     test accuracy: 0.600400
Average cost in epoch 151: 0.606736
training accuracy: 0.625000     test accuracy: 0.602398
Average cost in epoch 152: 0.615578
training accuracy: 0.656250     test accuracy: 0.599401
Average cost in epoch 153: 0.602177
training accuracy: 0.593750     test accuracy: 0.609391
Average cost in epoch 154: 0.607639
training accuracy: 0.625000     test accuracy: 0.607393

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 155: 0.605435
training accuracy: 0.437500     test accuracy: 0.603397
Average cost in epoch 156: 0.602778
training accuracy: 0.656250     test accuracy: 0.601399
Average cost in epoch 157: 0.605972
training accuracy: 0.812500     test accuracy: 0.598402
Average cost in epoch 158: 0.610329
training accuracy: 0.656250     test accuracy: 0.597403
Average cost in epoch 159: 0.602337
training accuracy: 0.468750     test accuracy: 0.599401

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 160: 0.613174
training accuracy: 0.843750     test accuracy: 0.593407
Average cost in epoch 161: 0.602968
training accuracy: 0.531250     test accuracy: 0.600400
Average cost in epoch 162: 0.604234
training accuracy: 0.562500     test accuracy: 0.608392
Average cost in epoch 163: 0.605148
training accuracy: 0.562500     test accuracy: 0.598402
Average cost in epoch 164: 0.599916
training accuracy: 0.437500     test accuracy: 0.606394

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 165: 0.601836
training accuracy: 0.531250     test accuracy: 0.601399
Average cost in epoch 166: 0.607311
training accuracy: 0.625000     test accuracy: 0.599401
Average cost in epoch 167: 0.601037
training accuracy: 0.531250     test accuracy: 0.605395
Average cost in epoch 168: 0.605024
training accuracy: 0.562500     test accuracy: 0.603397
Average cost in epoch 169: 0.604798
training accuracy: 0.625000     test accuracy: 0.604396

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 170: 0.599300
training accuracy: 0.656250     test accuracy: 0.600400
Average cost in epoch 171: 0.600770
training accuracy: 0.625000     test accuracy: 0.584416
Average cost in epoch 172: 0.607054
training accuracy: 0.562500     test accuracy: 0.599401
Average cost in epoch 173: 0.598651
training accuracy: 0.781250     test accuracy: 0.609391
Average cost in epoch 174: 0.595909
training accuracy: 0.718750     test accuracy: 0.590410

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 175: 0.606139
training accuracy: 0.500000     test accuracy: 0.606394
Average cost in epoch 176: 0.603539
training accuracy: 0.687500     test accuracy: 0.600400
Average cost in epoch 177: 0.598212
training accuracy: 0.687500     test accuracy: 0.608392
Average cost in epoch 178: 0.599837
training accuracy: 0.625000     test accuracy: 0.592408
Average cost in epoch 179: 0.601406
training accuracy: 0.625000     test accuracy: 0.609391

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 180: 0.616192
training accuracy: 0.625000     test accuracy: 0.604396
Average cost in epoch 181: 0.604759
training accuracy: 0.437500     test accuracy: 0.600400
Average cost in epoch 182: 0.598172
training accuracy: 0.656250     test accuracy: 0.595405
Average cost in epoch 183: 0.602539
training accuracy: 0.593750     test accuracy: 0.590410
Average cost in epoch 184: 0.601570
training accuracy: 0.625000     test accuracy: 0.599401

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 185: 0.599031
training accuracy: 0.625000     test accuracy: 0.601399
Average cost in epoch 186: 0.596522
training accuracy: 0.406250     test accuracy: 0.597403
Average cost in epoch 187: 0.596954
training accuracy: 0.531250     test accuracy: 0.604396
Average cost in epoch 188: 0.596733
training accuracy: 0.593750     test accuracy: 0.595405
Average cost in epoch 189: 0.603321
training accuracy: 0.687500     test accuracy: 0.590410

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 190: 0.592315
training accuracy: 0.625000     test accuracy: 0.600400
Average cost in epoch 191: 0.598548
training accuracy: 0.625000     test accuracy: 0.595405
Average cost in epoch 192: 0.605988
training accuracy: 0.531250     test accuracy: 0.601399
Average cost in epoch 193: 0.597018
training accuracy: 0.656250     test accuracy: 0.595405
Average cost in epoch 194: 0.598933
training accuracy: 0.593750     test accuracy: 0.587413

dump to weights/att-lstm/att-lstm_6.pkl

Average cost in epoch 195: 0.593389
training accuracy: 0.625000     test accuracy: 0.593407
Average cost in epoch 196: 0.604056
training accuracy: 0.687500     test accuracy: 0.594406
Average cost in epoch 197: 0.597314
training accuracy: 0.562500     test accuracy: 0.594406
Average cost in epoch 198: 0.597492
training accuracy: 0.625000     test accuracy: 0.591409
Average cost in epoch 199: 0.601559
training accuracy: 0.687500     test accuracy: 0.597403

dump to weights/att-lstm/att-lstm_6.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 7, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_7.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 118.59
Starting training...
Average cost in epoch 0: 0.812836
training accuracy: 0.687500     test accuracy: 0.748252
Average cost in epoch 1: 0.635163
training accuracy: 0.875000     test accuracy: 0.779221
Average cost in epoch 2: 0.616756
training accuracy: 0.718750     test accuracy: 0.790210
Average cost in epoch 3: 0.590594
training accuracy: 0.687500     test accuracy: 0.781219
Average cost in epoch 4: 0.567625
training accuracy: 0.750000     test accuracy: 0.784216

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 5: 0.553899
training accuracy: 0.656250     test accuracy: 0.790210
lr decays to 0.009000
Average cost in epoch 6: 0.541428
training accuracy: 0.843750     test accuracy: 0.778222
Average cost in epoch 7: 0.528172
training accuracy: 0.812500     test accuracy: 0.781219
Average cost in epoch 8: 0.529722
training accuracy: 0.687500     test accuracy: 0.775225
Average cost in epoch 9: 0.520889
training accuracy: 0.812500     test accuracy: 0.792208

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 10: 0.523214
training accuracy: 0.812500     test accuracy: 0.790210
lr decays to 0.008100
Average cost in epoch 11: 0.512491
training accuracy: 0.843750     test accuracy: 0.786214
Average cost in epoch 12: 0.513241
training accuracy: 0.781250     test accuracy: 0.801199
Average cost in epoch 13: 0.509076
training accuracy: 0.781250     test accuracy: 0.803197
Average cost in epoch 14: 0.506412
training accuracy: 0.781250     test accuracy: 0.806194

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 15: 0.497892
training accuracy: 0.750000     test accuracy: 0.796204
lr decays to 0.007290
Average cost in epoch 16: 0.485367
training accuracy: 0.718750     test accuracy: 0.798202
Average cost in epoch 17: 0.485074
training accuracy: 0.781250     test accuracy: 0.783217
Average cost in epoch 18: 0.483994
training accuracy: 0.906250     test accuracy: 0.794206
Average cost in epoch 19: 0.484925
training accuracy: 0.593750     test accuracy: 0.790210

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 20: 0.480740
training accuracy: 0.750000     test accuracy: 0.796204
lr decays to 0.006561
Average cost in epoch 21: 0.483401
training accuracy: 0.875000     test accuracy: 0.799201
Average cost in epoch 22: 0.472748
training accuracy: 0.781250     test accuracy: 0.789211
Average cost in epoch 23: 0.475145
training accuracy: 0.781250     test accuracy: 0.797203
Average cost in epoch 24: 0.468389
training accuracy: 0.843750     test accuracy: 0.786214

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 25: 0.472566
training accuracy: 0.750000     test accuracy: 0.797203
lr decays to 0.005905
Average cost in epoch 26: 0.463949
training accuracy: 0.875000     test accuracy: 0.795205
Average cost in epoch 27: 0.458917
training accuracy: 0.750000     test accuracy: 0.791209
Average cost in epoch 28: 0.458210
training accuracy: 0.812500     test accuracy: 0.794206
Average cost in epoch 29: 0.457591
training accuracy: 0.812500     test accuracy: 0.797203

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 30: 0.464469
training accuracy: 0.750000     test accuracy: 0.803197
lr decays to 0.005314
Average cost in epoch 31: 0.444847
training accuracy: 0.781250     test accuracy: 0.796204
Average cost in epoch 32: 0.459861
training accuracy: 0.906250     test accuracy: 0.802198
Average cost in epoch 33: 0.450303
training accuracy: 0.750000     test accuracy: 0.800200
Average cost in epoch 34: 0.450418
training accuracy: 0.875000     test accuracy: 0.796204

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 35: 0.445981
training accuracy: 0.781250     test accuracy: 0.801199
lr decays to 0.004783
Average cost in epoch 36: 0.445094
training accuracy: 0.875000     test accuracy: 0.809191
Average cost in epoch 37: 0.445061
training accuracy: 0.875000     test accuracy: 0.810190
Average cost in epoch 38: 0.440533
training accuracy: 0.937500     test accuracy: 0.809191
Average cost in epoch 39: 0.440670
training accuracy: 0.843750     test accuracy: 0.811189

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 40: 0.435666
training accuracy: 0.687500     test accuracy: 0.804196
lr decays to 0.004305
Average cost in epoch 41: 0.434808
training accuracy: 0.750000     test accuracy: 0.799201
Average cost in epoch 42: 0.436587
training accuracy: 0.812500     test accuracy: 0.801199
Average cost in epoch 43: 0.425003
training accuracy: 0.750000     test accuracy: 0.812188
Average cost in epoch 44: 0.426415
training accuracy: 0.687500     test accuracy: 0.813187

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 45: 0.426563
training accuracy: 0.812500     test accuracy: 0.793207
lr decays to 0.003874
Average cost in epoch 46: 0.428125
training accuracy: 0.843750     test accuracy: 0.800200
Average cost in epoch 47: 0.427142
training accuracy: 0.906250     test accuracy: 0.798202
Average cost in epoch 48: 0.419671
training accuracy: 0.687500     test accuracy: 0.797203
Average cost in epoch 49: 0.421771
training accuracy: 0.937500     test accuracy: 0.803197

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 50: 0.419351
training accuracy: 0.781250     test accuracy: 0.800200
lr decays to 0.003487
Average cost in epoch 51: 0.417993
training accuracy: 0.843750     test accuracy: 0.812188
Average cost in epoch 52: 0.420543
training accuracy: 0.843750     test accuracy: 0.807193
Average cost in epoch 53: 0.410485
training accuracy: 0.718750     test accuracy: 0.808192
Average cost in epoch 54: 0.411791
training accuracy: 0.843750     test accuracy: 0.811189

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 55: 0.415399
training accuracy: 0.718750     test accuracy: 0.803197
lr decays to 0.003138
Average cost in epoch 56: 0.412759
training accuracy: 0.718750     test accuracy: 0.792208
Average cost in epoch 57: 0.412483
training accuracy: 0.718750     test accuracy: 0.813187
Average cost in epoch 58: 0.409547
training accuracy: 0.718750     test accuracy: 0.793207
Average cost in epoch 59: 0.405474
training accuracy: 0.812500     test accuracy: 0.801199

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 60: 0.408207
training accuracy: 0.812500     test accuracy: 0.809191
lr decays to 0.002824
Average cost in epoch 61: 0.411540
training accuracy: 0.812500     test accuracy: 0.815185
Average cost in epoch 62: 0.402126
training accuracy: 0.812500     test accuracy: 0.805195
Average cost in epoch 63: 0.404265
training accuracy: 0.812500     test accuracy: 0.804196
Average cost in epoch 64: 0.395552
training accuracy: 0.906250     test accuracy: 0.794206

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 65: 0.394605
training accuracy: 0.843750     test accuracy: 0.804196
lr decays to 0.002542
Average cost in epoch 66: 0.397057
training accuracy: 0.812500     test accuracy: 0.801199
Average cost in epoch 67: 0.396360
training accuracy: 0.843750     test accuracy: 0.802198
Average cost in epoch 68: 0.389376
training accuracy: 0.812500     test accuracy: 0.793207
Average cost in epoch 69: 0.398184
training accuracy: 0.843750     test accuracy: 0.799201

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 70: 0.380919
training accuracy: 0.843750     test accuracy: 0.796204
lr decays to 0.002288
Average cost in epoch 71: 0.389811
training accuracy: 0.875000     test accuracy: 0.808192
Average cost in epoch 72: 0.389300
training accuracy: 0.906250     test accuracy: 0.808192
Average cost in epoch 73: 0.378055
training accuracy: 0.843750     test accuracy: 0.801199
Average cost in epoch 74: 0.382936
training accuracy: 0.812500     test accuracy: 0.804196

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 75: 0.384710
training accuracy: 0.875000     test accuracy: 0.792208
lr decays to 0.002059
Average cost in epoch 76: 0.380816
training accuracy: 0.875000     test accuracy: 0.796204
Average cost in epoch 77: 0.384745
training accuracy: 0.875000     test accuracy: 0.808192
Average cost in epoch 78: 0.375439
training accuracy: 0.781250     test accuracy: 0.794206
Average cost in epoch 79: 0.372113
training accuracy: 0.718750     test accuracy: 0.806194

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 80: 0.372950
training accuracy: 0.843750     test accuracy: 0.800200
lr decays to 0.001853
Average cost in epoch 81: 0.375576
training accuracy: 0.937500     test accuracy: 0.789211
Average cost in epoch 82: 0.372894
training accuracy: 0.750000     test accuracy: 0.805195
Average cost in epoch 83: 0.357585
training accuracy: 0.875000     test accuracy: 0.796204
Average cost in epoch 84: 0.372444
training accuracy: 0.812500     test accuracy: 0.798202

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 85: 0.365509
training accuracy: 0.750000     test accuracy: 0.803197
lr decays to 0.001668
Average cost in epoch 86: 0.364960
training accuracy: 0.687500     test accuracy: 0.794206
Average cost in epoch 87: 0.366670
training accuracy: 0.843750     test accuracy: 0.793207
Average cost in epoch 88: 0.371322
training accuracy: 0.906250     test accuracy: 0.792208
Average cost in epoch 89: 0.364023
training accuracy: 0.843750     test accuracy: 0.795205

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 90: 0.358369
training accuracy: 0.843750     test accuracy: 0.785215
lr decays to 0.001501
Average cost in epoch 91: 0.357972
training accuracy: 0.875000     test accuracy: 0.791209
Average cost in epoch 92: 0.371782
training accuracy: 0.875000     test accuracy: 0.799201
Average cost in epoch 93: 0.357698
training accuracy: 0.875000     test accuracy: 0.788212
Average cost in epoch 94: 0.352199
training accuracy: 0.937500     test accuracy: 0.799201

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 95: 0.356465
training accuracy: 0.906250     test accuracy: 0.803197
lr decays to 0.001351
Average cost in epoch 96: 0.356942
training accuracy: 0.906250     test accuracy: 0.788212
Average cost in epoch 97: 0.351615
training accuracy: 0.843750     test accuracy: 0.790210
Average cost in epoch 98: 0.357991
training accuracy: 0.875000     test accuracy: 0.800200
Average cost in epoch 99: 0.353575
training accuracy: 0.750000     test accuracy: 0.792208

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 100: 0.354540
training accuracy: 0.750000     test accuracy: 0.808192
lr decays to 0.001216
Average cost in epoch 101: 0.346908
training accuracy: 0.875000     test accuracy: 0.794206
Average cost in epoch 102: 0.353943
training accuracy: 0.843750     test accuracy: 0.797203
Average cost in epoch 103: 0.345632
training accuracy: 0.875000     test accuracy: 0.799201
Average cost in epoch 104: 0.353397
training accuracy: 0.937500     test accuracy: 0.796204

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 105: 0.347727
training accuracy: 0.937500     test accuracy: 0.794206
Average cost in epoch 106: 0.353314
training accuracy: 0.875000     test accuracy: 0.800200
Average cost in epoch 107: 0.341552
training accuracy: 0.750000     test accuracy: 0.793207
Average cost in epoch 108: 0.349363
training accuracy: 0.906250     test accuracy: 0.803197
Average cost in epoch 109: 0.342788
training accuracy: 0.812500     test accuracy: 0.805195

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 110: 0.346911
training accuracy: 0.906250     test accuracy: 0.806194
Average cost in epoch 111: 0.344142
training accuracy: 0.875000     test accuracy: 0.793207
Average cost in epoch 112: 0.346350
training accuracy: 0.843750     test accuracy: 0.789211
Average cost in epoch 113: 0.345913
training accuracy: 0.875000     test accuracy: 0.793207
Average cost in epoch 114: 0.348432
training accuracy: 0.875000     test accuracy: 0.798202

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 115: 0.345487
training accuracy: 0.875000     test accuracy: 0.790210
Average cost in epoch 116: 0.344018
training accuracy: 0.906250     test accuracy: 0.796204
Average cost in epoch 117: 0.339725
training accuracy: 0.843750     test accuracy: 0.800200
Average cost in epoch 118: 0.343526
training accuracy: 0.875000     test accuracy: 0.789211
Average cost in epoch 119: 0.342467
training accuracy: 0.750000     test accuracy: 0.796204

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 120: 0.341515
training accuracy: 0.906250     test accuracy: 0.788212
Average cost in epoch 121: 0.341990
training accuracy: 0.750000     test accuracy: 0.793207
Average cost in epoch 122: 0.333568
training accuracy: 0.781250     test accuracy: 0.790210
Average cost in epoch 123: 0.344748
training accuracy: 0.906250     test accuracy: 0.795205
Average cost in epoch 124: 0.350702
training accuracy: 0.875000     test accuracy: 0.793207

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 125: 0.339103
training accuracy: 0.937500     test accuracy: 0.794206
Average cost in epoch 126: 0.343519
training accuracy: 0.718750     test accuracy: 0.796204
Average cost in epoch 127: 0.339660
training accuracy: 0.906250     test accuracy: 0.788212
Average cost in epoch 128: 0.341053
training accuracy: 0.781250     test accuracy: 0.789211
Average cost in epoch 129: 0.337690
training accuracy: 0.906250     test accuracy: 0.794206

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 130: 0.339079
training accuracy: 0.906250     test accuracy: 0.792208
Average cost in epoch 131: 0.339574
training accuracy: 0.875000     test accuracy: 0.791209
Average cost in epoch 132: 0.341746
training accuracy: 0.906250     test accuracy: 0.793207
Average cost in epoch 133: 0.335570
training accuracy: 0.906250     test accuracy: 0.793207
Average cost in epoch 134: 0.342720
training accuracy: 0.781250     test accuracy: 0.786214

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 135: 0.338228
training accuracy: 0.875000     test accuracy: 0.796204
Average cost in epoch 136: 0.336438
training accuracy: 0.906250     test accuracy: 0.796204
Average cost in epoch 137: 0.335027
training accuracy: 0.937500     test accuracy: 0.791209
Average cost in epoch 138: 0.344561
training accuracy: 0.937500     test accuracy: 0.791209
Average cost in epoch 139: 0.336086
training accuracy: 0.875000     test accuracy: 0.794206

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 140: 0.331597
training accuracy: 0.750000     test accuracy: 0.796204
Average cost in epoch 141: 0.333536
training accuracy: 0.781250     test accuracy: 0.798202
Average cost in epoch 142: 0.333705
training accuracy: 0.843750     test accuracy: 0.792208
Average cost in epoch 143: 0.333963
training accuracy: 0.906250     test accuracy: 0.791209
Average cost in epoch 144: 0.331964
training accuracy: 0.781250     test accuracy: 0.794206

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 145: 0.341911
training accuracy: 0.875000     test accuracy: 0.794206
Average cost in epoch 146: 0.338023
training accuracy: 0.937500     test accuracy: 0.790210
Average cost in epoch 147: 0.333425
training accuracy: 0.843750     test accuracy: 0.784216
Average cost in epoch 148: 0.335081
training accuracy: 0.812500     test accuracy: 0.787213
Average cost in epoch 149: 0.340238
training accuracy: 0.843750     test accuracy: 0.803197

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 150: 0.330965
training accuracy: 0.781250     test accuracy: 0.791209
Average cost in epoch 151: 0.324390
training accuracy: 0.812500     test accuracy: 0.792208
Average cost in epoch 152: 0.342366
training accuracy: 0.781250     test accuracy: 0.795205
Average cost in epoch 153: 0.332555
training accuracy: 0.937500     test accuracy: 0.798202
Average cost in epoch 154: 0.333030
training accuracy: 0.937500     test accuracy: 0.793207

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 155: 0.329095
training accuracy: 0.968750     test accuracy: 0.793207
Average cost in epoch 156: 0.339536
training accuracy: 0.718750     test accuracy: 0.791209
Average cost in epoch 157: 0.327882
training accuracy: 0.843750     test accuracy: 0.789211
Average cost in epoch 158: 0.342708
training accuracy: 0.906250     test accuracy: 0.784216
Average cost in epoch 159: 0.327528
training accuracy: 0.906250     test accuracy: 0.785215

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 160: 0.332711
training accuracy: 0.781250     test accuracy: 0.792208
Average cost in epoch 161: 0.330164
training accuracy: 0.875000     test accuracy: 0.783217
Average cost in epoch 162: 0.324983
training accuracy: 0.750000     test accuracy: 0.787213
Average cost in epoch 163: 0.333093
training accuracy: 0.906250     test accuracy: 0.785215
Average cost in epoch 164: 0.329454
training accuracy: 0.906250     test accuracy: 0.798202

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 165: 0.330753
training accuracy: 0.875000     test accuracy: 0.784216
Average cost in epoch 166: 0.328999
training accuracy: 0.843750     test accuracy: 0.790210
Average cost in epoch 167: 0.335192
training accuracy: 0.875000     test accuracy: 0.791209
Average cost in epoch 168: 0.331909
training accuracy: 0.906250     test accuracy: 0.791209
Average cost in epoch 169: 0.338217
training accuracy: 0.937500     test accuracy: 0.786214

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 170: 0.332690
training accuracy: 0.875000     test accuracy: 0.778222
Average cost in epoch 171: 0.326183
training accuracy: 0.937500     test accuracy: 0.783217
Average cost in epoch 172: 0.330993
training accuracy: 0.750000     test accuracy: 0.784216
Average cost in epoch 173: 0.328302
training accuracy: 0.781250     test accuracy: 0.784216
Average cost in epoch 174: 0.319526
training accuracy: 0.750000     test accuracy: 0.788212

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 175: 0.336386
training accuracy: 0.968750     test accuracy: 0.783217
Average cost in epoch 176: 0.319727
training accuracy: 0.968750     test accuracy: 0.780220
Average cost in epoch 177: 0.332155
training accuracy: 0.906250     test accuracy: 0.784216
Average cost in epoch 178: 0.327675
training accuracy: 0.875000     test accuracy: 0.788212
Average cost in epoch 179: 0.333811
training accuracy: 0.875000     test accuracy: 0.797203

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 180: 0.317138
training accuracy: 0.781250     test accuracy: 0.794206
Average cost in epoch 181: 0.335207
training accuracy: 0.781250     test accuracy: 0.791209
Average cost in epoch 182: 0.333755
training accuracy: 0.937500     test accuracy: 0.787213
Average cost in epoch 183: 0.332068
training accuracy: 0.812500     test accuracy: 0.786214
Average cost in epoch 184: 0.322744
training accuracy: 0.906250     test accuracy: 0.787213

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 185: 0.334293
training accuracy: 0.812500     test accuracy: 0.783217
Average cost in epoch 186: 0.321868
training accuracy: 0.906250     test accuracy: 0.795205
Average cost in epoch 187: 0.328217
training accuracy: 0.937500     test accuracy: 0.795205
Average cost in epoch 188: 0.332254
training accuracy: 0.781250     test accuracy: 0.789211
Average cost in epoch 189: 0.323116
training accuracy: 0.875000     test accuracy: 0.788212

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 190: 0.328729
training accuracy: 0.906250     test accuracy: 0.793207
Average cost in epoch 191: 0.323038
training accuracy: 0.875000     test accuracy: 0.793207
Average cost in epoch 192: 0.333177
training accuracy: 0.812500     test accuracy: 0.784216
Average cost in epoch 193: 0.334879
training accuracy: 0.781250     test accuracy: 0.790210
Average cost in epoch 194: 0.320730
training accuracy: 0.812500     test accuracy: 0.778222

dump to weights/att-lstm/att-lstm_7.pkl

Average cost in epoch 195: 0.325793
training accuracy: 0.687500     test accuracy: 0.777223
Average cost in epoch 196: 0.319126
training accuracy: 0.812500     test accuracy: 0.769231
Average cost in epoch 197: 0.319736
training accuracy: 0.750000     test accuracy: 0.789211
Average cost in epoch 198: 0.327860
training accuracy: 0.843750     test accuracy: 0.787213
Average cost in epoch 199: 0.323031
training accuracy: 0.937500     test accuracy: 0.782218

dump to weights/att-lstm/att-lstm_7.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 8, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_8.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 119.17
Starting training...
Average cost in epoch 0: 1.615360
training accuracy: 0.656250     test accuracy: 0.453546
Average cost in epoch 1: 1.343590
training accuracy: 0.625000     test accuracy: 0.610390
Average cost in epoch 2: 1.159321
training accuracy: 0.437500     test accuracy: 0.612388
Average cost in epoch 3: 1.110712
training accuracy: 0.687500     test accuracy: 0.703297
Average cost in epoch 4: 0.984376
training accuracy: 0.875000     test accuracy: 0.717283

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 5: 0.942559
training accuracy: 0.781250     test accuracy: 0.723277
lr decays to 0.009000
Average cost in epoch 6: 0.896727
training accuracy: 0.781250     test accuracy: 0.711289
Average cost in epoch 7: 0.881143
training accuracy: 0.781250     test accuracy: 0.725275
Average cost in epoch 8: 0.860193
training accuracy: 0.750000     test accuracy: 0.730270
Average cost in epoch 9: 0.845113
training accuracy: 0.562500     test accuracy: 0.733267

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 10: 0.827976
training accuracy: 0.593750     test accuracy: 0.727273
lr decays to 0.008100
Average cost in epoch 11: 0.816995
training accuracy: 0.562500     test accuracy: 0.731269
Average cost in epoch 12: 0.814962
training accuracy: 0.781250     test accuracy: 0.718282
Average cost in epoch 13: 0.809474
training accuracy: 0.750000     test accuracy: 0.710290
Average cost in epoch 14: 0.796308
training accuracy: 0.750000     test accuracy: 0.719281

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 15: 0.802875
training accuracy: 0.812500     test accuracy: 0.731269
lr decays to 0.007290
Average cost in epoch 16: 0.790151
training accuracy: 0.812500     test accuracy: 0.738262
Average cost in epoch 17: 0.779747
training accuracy: 0.812500     test accuracy: 0.724276
Average cost in epoch 18: 0.781160
training accuracy: 0.812500     test accuracy: 0.727273
Average cost in epoch 19: 0.764066
training accuracy: 0.656250     test accuracy: 0.727273

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 20: 0.771832
training accuracy: 0.687500     test accuracy: 0.734266
lr decays to 0.006561
Average cost in epoch 21: 0.757515
training accuracy: 0.687500     test accuracy: 0.729271
Average cost in epoch 22: 0.754971
training accuracy: 0.781250     test accuracy: 0.729271
Average cost in epoch 23: 0.740508
training accuracy: 0.781250     test accuracy: 0.730270
Average cost in epoch 24: 0.748161
training accuracy: 0.906250     test accuracy: 0.734266

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 25: 0.730000
training accuracy: 0.812500     test accuracy: 0.730270
lr decays to 0.005905
Average cost in epoch 26: 0.721861
training accuracy: 0.781250     test accuracy: 0.726274
Average cost in epoch 27: 0.728625
training accuracy: 0.781250     test accuracy: 0.729271
Average cost in epoch 28: 0.724283
training accuracy: 0.687500     test accuracy: 0.729271
Average cost in epoch 29: 0.713316
training accuracy: 0.750000     test accuracy: 0.721279

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 30: 0.718325
training accuracy: 0.875000     test accuracy: 0.737263
lr decays to 0.005314
Average cost in epoch 31: 0.707581
training accuracy: 0.906250     test accuracy: 0.730270
Average cost in epoch 32: 0.706682
training accuracy: 0.750000     test accuracy: 0.723277
Average cost in epoch 33: 0.704634
training accuracy: 0.750000     test accuracy: 0.737263
Average cost in epoch 34: 0.694793
training accuracy: 0.625000     test accuracy: 0.725275

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 35: 0.692996
training accuracy: 0.843750     test accuracy: 0.737263
lr decays to 0.004783
Average cost in epoch 36: 0.695951
training accuracy: 0.687500     test accuracy: 0.737263
Average cost in epoch 37: 0.679763
training accuracy: 0.781250     test accuracy: 0.731269
Average cost in epoch 38: 0.688300
training accuracy: 0.656250     test accuracy: 0.733267
Average cost in epoch 39: 0.694724
training accuracy: 0.656250     test accuracy: 0.731269

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 40: 0.676616
training accuracy: 0.875000     test accuracy: 0.721279
lr decays to 0.004305
Average cost in epoch 41: 0.671218
training accuracy: 0.812500     test accuracy: 0.725275
Average cost in epoch 42: 0.671411
training accuracy: 0.781250     test accuracy: 0.723277
Average cost in epoch 43: 0.663255
training accuracy: 0.656250     test accuracy: 0.732268
Average cost in epoch 44: 0.671984
training accuracy: 0.656250     test accuracy: 0.732268

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 45: 0.667049
training accuracy: 0.750000     test accuracy: 0.736264
lr decays to 0.003874
Average cost in epoch 46: 0.660883
training accuracy: 0.812500     test accuracy: 0.732268
Average cost in epoch 47: 0.659445
training accuracy: 0.656250     test accuracy: 0.726274
Average cost in epoch 48: 0.655097
training accuracy: 0.750000     test accuracy: 0.726274
Average cost in epoch 49: 0.663210
training accuracy: 0.781250     test accuracy: 0.728272

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 50: 0.659534
training accuracy: 0.843750     test accuracy: 0.732268
lr decays to 0.003487
Average cost in epoch 51: 0.653590
training accuracy: 0.812500     test accuracy: 0.731269
Average cost in epoch 52: 0.646012
training accuracy: 0.781250     test accuracy: 0.730270
Average cost in epoch 53: 0.653895
training accuracy: 0.718750     test accuracy: 0.732268
Average cost in epoch 54: 0.641627
training accuracy: 0.750000     test accuracy: 0.737263

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 55: 0.651231
training accuracy: 0.781250     test accuracy: 0.723277
lr decays to 0.003138
Average cost in epoch 56: 0.639172
training accuracy: 0.687500     test accuracy: 0.733267
Average cost in epoch 57: 0.638856
training accuracy: 0.781250     test accuracy: 0.729271
Average cost in epoch 58: 0.624684
training accuracy: 0.875000     test accuracy: 0.727273
Average cost in epoch 59: 0.636851
training accuracy: 0.687500     test accuracy: 0.730270

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 60: 0.625428
training accuracy: 0.781250     test accuracy: 0.732268
lr decays to 0.002824
Average cost in epoch 61: 0.638579
training accuracy: 0.843750     test accuracy: 0.734266
Average cost in epoch 62: 0.632066
training accuracy: 0.875000     test accuracy: 0.731269
Average cost in epoch 63: 0.630403
training accuracy: 0.718750     test accuracy: 0.732268
Average cost in epoch 64: 0.629532
training accuracy: 0.718750     test accuracy: 0.729271

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 65: 0.612336
training accuracy: 0.812500     test accuracy: 0.731269
lr decays to 0.002542
Average cost in epoch 66: 0.630185
training accuracy: 0.937500     test accuracy: 0.732268
Average cost in epoch 67: 0.622286
training accuracy: 0.718750     test accuracy: 0.730270
Average cost in epoch 68: 0.603155
training accuracy: 0.781250     test accuracy: 0.733267
Average cost in epoch 69: 0.611296
training accuracy: 0.750000     test accuracy: 0.722278

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 70: 0.627538
training accuracy: 0.812500     test accuracy: 0.730270
lr decays to 0.002288
Average cost in epoch 71: 0.608183
training accuracy: 0.781250     test accuracy: 0.737263
Average cost in epoch 72: 0.607899
training accuracy: 0.718750     test accuracy: 0.734266
Average cost in epoch 73: 0.608875
training accuracy: 0.625000     test accuracy: 0.730270
Average cost in epoch 74: 0.615581
training accuracy: 0.812500     test accuracy: 0.732268

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 75: 0.609004
training accuracy: 0.843750     test accuracy: 0.724276
lr decays to 0.002059
Average cost in epoch 76: 0.606161
training accuracy: 0.906250     test accuracy: 0.733267
Average cost in epoch 77: 0.598827
training accuracy: 0.750000     test accuracy: 0.733267
Average cost in epoch 78: 0.602972
training accuracy: 0.687500     test accuracy: 0.729271
Average cost in epoch 79: 0.599988
training accuracy: 0.781250     test accuracy: 0.739261

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 80: 0.597966
training accuracy: 0.750000     test accuracy: 0.733267
lr decays to 0.001853
Average cost in epoch 81: 0.602808
training accuracy: 0.687500     test accuracy: 0.732268
Average cost in epoch 82: 0.597870
training accuracy: 0.687500     test accuracy: 0.742258
Average cost in epoch 83: 0.591947
training accuracy: 0.750000     test accuracy: 0.725275
Average cost in epoch 84: 0.588871
training accuracy: 0.843750     test accuracy: 0.731269

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 85: 0.583267
training accuracy: 0.718750     test accuracy: 0.733267
lr decays to 0.001668
Average cost in epoch 86: 0.595832
training accuracy: 0.812500     test accuracy: 0.731269
Average cost in epoch 87: 0.594598
training accuracy: 0.781250     test accuracy: 0.730270
Average cost in epoch 88: 0.591707
training accuracy: 0.812500     test accuracy: 0.733267
Average cost in epoch 89: 0.583297
training accuracy: 0.812500     test accuracy: 0.733267

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 90: 0.581052
training accuracy: 0.781250     test accuracy: 0.734266
lr decays to 0.001501
Average cost in epoch 91: 0.586698
training accuracy: 0.750000     test accuracy: 0.736264
Average cost in epoch 92: 0.579142
training accuracy: 0.687500     test accuracy: 0.735265
Average cost in epoch 93: 0.582139
training accuracy: 0.750000     test accuracy: 0.743257
Average cost in epoch 94: 0.577074
training accuracy: 0.812500     test accuracy: 0.741259

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 95: 0.578043
training accuracy: 0.750000     test accuracy: 0.735265
lr decays to 0.001351
Average cost in epoch 96: 0.577350
training accuracy: 0.781250     test accuracy: 0.728272
Average cost in epoch 97: 0.567780
training accuracy: 0.812500     test accuracy: 0.740260
Average cost in epoch 98: 0.576759
training accuracy: 0.875000     test accuracy: 0.726274
Average cost in epoch 99: 0.578315
training accuracy: 0.718750     test accuracy: 0.737263

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 100: 0.565123
training accuracy: 0.781250     test accuracy: 0.738262
lr decays to 0.001216
Average cost in epoch 101: 0.576169
training accuracy: 0.812500     test accuracy: 0.737263
Average cost in epoch 102: 0.571405
training accuracy: 0.937500     test accuracy: 0.734266
Average cost in epoch 103: 0.565878
training accuracy: 0.750000     test accuracy: 0.733267
Average cost in epoch 104: 0.574045
training accuracy: 0.875000     test accuracy: 0.729271

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 105: 0.571528
training accuracy: 0.593750     test accuracy: 0.730270
Average cost in epoch 106: 0.567552
training accuracy: 0.625000     test accuracy: 0.723277
Average cost in epoch 107: 0.567369
training accuracy: 0.718750     test accuracy: 0.730270
Average cost in epoch 108: 0.553665
training accuracy: 0.875000     test accuracy: 0.737263
Average cost in epoch 109: 0.572824
training accuracy: 0.781250     test accuracy: 0.733267

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 110: 0.561848
training accuracy: 0.906250     test accuracy: 0.734266
Average cost in epoch 111: 0.561964
training accuracy: 0.687500     test accuracy: 0.737263
Average cost in epoch 112: 0.559556
training accuracy: 0.718750     test accuracy: 0.741259
Average cost in epoch 113: 0.563182
training accuracy: 0.812500     test accuracy: 0.730270
Average cost in epoch 114: 0.563524
training accuracy: 0.781250     test accuracy: 0.726274

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 115: 0.552936
training accuracy: 0.812500     test accuracy: 0.733267
Average cost in epoch 116: 0.568595
training accuracy: 0.812500     test accuracy: 0.732268
Average cost in epoch 117: 0.553433
training accuracy: 0.781250     test accuracy: 0.724276
Average cost in epoch 118: 0.570820
training accuracy: 0.937500     test accuracy: 0.733267
Average cost in epoch 119: 0.561761
training accuracy: 0.875000     test accuracy: 0.735265

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 120: 0.563756
training accuracy: 0.812500     test accuracy: 0.727273
Average cost in epoch 121: 0.555890
training accuracy: 0.656250     test accuracy: 0.738262
Average cost in epoch 122: 0.553689
training accuracy: 0.843750     test accuracy: 0.736264
Average cost in epoch 123: 0.556997
training accuracy: 0.656250     test accuracy: 0.731269
Average cost in epoch 124: 0.567128
training accuracy: 0.781250     test accuracy: 0.732268

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 125: 0.554460
training accuracy: 0.906250     test accuracy: 0.736264
Average cost in epoch 126: 0.573561
training accuracy: 0.687500     test accuracy: 0.730270
Average cost in epoch 127: 0.546209
training accuracy: 0.843750     test accuracy: 0.729271
Average cost in epoch 128: 0.558994
training accuracy: 0.718750     test accuracy: 0.727273
Average cost in epoch 129: 0.557763
training accuracy: 0.875000     test accuracy: 0.732268

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 130: 0.550406
training accuracy: 0.937500     test accuracy: 0.735265
Average cost in epoch 131: 0.556489
training accuracy: 0.750000     test accuracy: 0.730270
Average cost in epoch 132: 0.542950
training accuracy: 0.812500     test accuracy: 0.726274
Average cost in epoch 133: 0.557354
training accuracy: 0.812500     test accuracy: 0.730270
Average cost in epoch 134: 0.556844
training accuracy: 0.718750     test accuracy: 0.728272

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 135: 0.540084
training accuracy: 0.718750     test accuracy: 0.733267
Average cost in epoch 136: 0.557622
training accuracy: 0.843750     test accuracy: 0.726274
Average cost in epoch 137: 0.559373
training accuracy: 0.875000     test accuracy: 0.726274
Average cost in epoch 138: 0.558313
training accuracy: 0.812500     test accuracy: 0.730270
Average cost in epoch 139: 0.544396
training accuracy: 0.937500     test accuracy: 0.729271

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 140: 0.551824
training accuracy: 0.750000     test accuracy: 0.733267
Average cost in epoch 141: 0.555528
training accuracy: 0.781250     test accuracy: 0.732268
Average cost in epoch 142: 0.560997
training accuracy: 0.937500     test accuracy: 0.740260
Average cost in epoch 143: 0.546113
training accuracy: 0.687500     test accuracy: 0.730270
Average cost in epoch 144: 0.554537
training accuracy: 0.875000     test accuracy: 0.735265

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 145: 0.561746
training accuracy: 0.812500     test accuracy: 0.731269
Average cost in epoch 146: 0.538040
training accuracy: 0.750000     test accuracy: 0.730270
Average cost in epoch 147: 0.549966
training accuracy: 0.906250     test accuracy: 0.732268
Average cost in epoch 148: 0.539147
training accuracy: 0.812500     test accuracy: 0.735265
Average cost in epoch 149: 0.550608
training accuracy: 0.750000     test accuracy: 0.731269

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 150: 0.556617
training accuracy: 0.750000     test accuracy: 0.732268
Average cost in epoch 151: 0.538164
training accuracy: 0.687500     test accuracy: 0.729271
Average cost in epoch 152: 0.550292
training accuracy: 0.875000     test accuracy: 0.731269
Average cost in epoch 153: 0.544770
training accuracy: 0.781250     test accuracy: 0.727273
Average cost in epoch 154: 0.533509
training accuracy: 0.750000     test accuracy: 0.726274

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 155: 0.558839
training accuracy: 0.781250     test accuracy: 0.732268
Average cost in epoch 156: 0.538599
training accuracy: 0.781250     test accuracy: 0.731269
Average cost in epoch 157: 0.565069
training accuracy: 0.750000     test accuracy: 0.733267
Average cost in epoch 158: 0.534695
training accuracy: 0.718750     test accuracy: 0.726274
Average cost in epoch 159: 0.544458
training accuracy: 0.906250     test accuracy: 0.726274

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 160: 0.542602
training accuracy: 0.906250     test accuracy: 0.733267
Average cost in epoch 161: 0.540206
training accuracy: 0.750000     test accuracy: 0.731269
Average cost in epoch 162: 0.547233
training accuracy: 0.812500     test accuracy: 0.733267
Average cost in epoch 163: 0.544749
training accuracy: 0.843750     test accuracy: 0.728272
Average cost in epoch 164: 0.540123
training accuracy: 0.906250     test accuracy: 0.729271

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 165: 0.545922
training accuracy: 0.937500     test accuracy: 0.723277
Average cost in epoch 166: 0.543116
training accuracy: 0.843750     test accuracy: 0.735265
Average cost in epoch 167: 0.541157
training accuracy: 0.812500     test accuracy: 0.730270
Average cost in epoch 168: 0.542273
training accuracy: 0.812500     test accuracy: 0.729271
Average cost in epoch 169: 0.549448
training accuracy: 0.781250     test accuracy: 0.726274

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 170: 0.548199
training accuracy: 0.812500     test accuracy: 0.728272
Average cost in epoch 171: 0.535619
training accuracy: 0.750000     test accuracy: 0.723277
Average cost in epoch 172: 0.541297
training accuracy: 0.812500     test accuracy: 0.727273
Average cost in epoch 173: 0.536027
training accuracy: 0.781250     test accuracy: 0.731269
Average cost in epoch 174: 0.544336
training accuracy: 0.781250     test accuracy: 0.732268

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 175: 0.539910
training accuracy: 0.781250     test accuracy: 0.733267
Average cost in epoch 176: 0.536592
training accuracy: 0.750000     test accuracy: 0.726274
Average cost in epoch 177: 0.533712
training accuracy: 0.593750     test accuracy: 0.734266
Average cost in epoch 178: 0.541132
training accuracy: 0.812500     test accuracy: 0.732268
Average cost in epoch 179: 0.541702
training accuracy: 0.843750     test accuracy: 0.726274

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 180: 0.536965
training accuracy: 0.781250     test accuracy: 0.728272
Average cost in epoch 181: 0.538692
training accuracy: 0.781250     test accuracy: 0.725275
Average cost in epoch 182: 0.532279
training accuracy: 0.750000     test accuracy: 0.728272
Average cost in epoch 183: 0.534895
training accuracy: 0.812500     test accuracy: 0.725275
Average cost in epoch 184: 0.535015
training accuracy: 0.687500     test accuracy: 0.728272

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 185: 0.545089
training accuracy: 0.687500     test accuracy: 0.733267
Average cost in epoch 186: 0.526384
training accuracy: 0.750000     test accuracy: 0.726274
Average cost in epoch 187: 0.542770
training accuracy: 0.781250     test accuracy: 0.735265
Average cost in epoch 188: 0.542175
training accuracy: 0.906250     test accuracy: 0.727273
Average cost in epoch 189: 0.541359
training accuracy: 0.875000     test accuracy: 0.725275

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 190: 0.531519
training accuracy: 0.718750     test accuracy: 0.731269
Average cost in epoch 191: 0.546309
training accuracy: 0.812500     test accuracy: 0.728272
Average cost in epoch 192: 0.525118
training accuracy: 0.656250     test accuracy: 0.728272
Average cost in epoch 193: 0.530997
training accuracy: 0.906250     test accuracy: 0.731269
Average cost in epoch 194: 0.532896
training accuracy: 0.781250     test accuracy: 0.730270

dump to weights/att-lstm/att-lstm_8.pkl

Average cost in epoch 195: 0.519374
training accuracy: 0.875000     test accuracy: 0.738262
Average cost in epoch 196: 0.552647
training accuracy: 0.906250     test accuracy: 0.725275
Average cost in epoch 197: 0.533959
training accuracy: 0.875000     test accuracy: 0.723277
Average cost in epoch 198: 0.519058
training accuracy: 0.875000     test accuracy: 0.736264
Average cost in epoch 199: 0.534694
training accuracy: 0.781250     test accuracy: 0.727273

dump to weights/att-lstm/att-lstm_8.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 9, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_9.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 117.81
Starting training...
Average cost in epoch 0: 0.706244
training accuracy: 0.750000     test accuracy: 0.638362
Average cost in epoch 1: 0.652678
training accuracy: 0.531250     test accuracy: 0.628372
Average cost in epoch 2: 0.641252
training accuracy: 0.562500     test accuracy: 0.638362
Average cost in epoch 3: 0.636657
training accuracy: 0.625000     test accuracy: 0.635365
Average cost in epoch 4: 0.637285
training accuracy: 0.562500     test accuracy: 0.639361

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 5: 0.634402
training accuracy: 0.500000     test accuracy: 0.638362
lr decays to 0.009000
Average cost in epoch 6: 0.633727
training accuracy: 0.468750     test accuracy: 0.633367
Average cost in epoch 7: 0.630147
training accuracy: 0.687500     test accuracy: 0.638362
Average cost in epoch 8: 0.631325
training accuracy: 0.625000     test accuracy: 0.636364
Average cost in epoch 9: 0.629476
training accuracy: 0.656250     test accuracy: 0.632368

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 10: 0.631306
training accuracy: 0.531250     test accuracy: 0.623377
lr decays to 0.008100
Average cost in epoch 11: 0.626033
training accuracy: 0.500000     test accuracy: 0.623377
Average cost in epoch 12: 0.626146
training accuracy: 0.625000     test accuracy: 0.631369
Average cost in epoch 13: 0.626317
training accuracy: 0.531250     test accuracy: 0.640360
Average cost in epoch 14: 0.624860
training accuracy: 0.687500     test accuracy: 0.631369

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 15: 0.625661
training accuracy: 0.562500     test accuracy: 0.638362
lr decays to 0.007290
Average cost in epoch 16: 0.626148
training accuracy: 0.812500     test accuracy: 0.636364
Average cost in epoch 17: 0.624317
training accuracy: 0.687500     test accuracy: 0.637363
Average cost in epoch 18: 0.622721
training accuracy: 0.531250     test accuracy: 0.629371
Average cost in epoch 19: 0.623282
training accuracy: 0.843750     test accuracy: 0.641359

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 20: 0.622627
training accuracy: 0.437500     test accuracy: 0.631369
lr decays to 0.006561
Average cost in epoch 21: 0.621265
training accuracy: 0.593750     test accuracy: 0.643357
Average cost in epoch 22: 0.619886
training accuracy: 0.562500     test accuracy: 0.626374
Average cost in epoch 23: 0.618833
training accuracy: 0.656250     test accuracy: 0.638362
Average cost in epoch 24: 0.620127
training accuracy: 0.750000     test accuracy: 0.642358

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 25: 0.617213
training accuracy: 0.625000     test accuracy: 0.636364
lr decays to 0.005905
Average cost in epoch 26: 0.615314
training accuracy: 0.468750     test accuracy: 0.615385
Average cost in epoch 27: 0.619684
training accuracy: 0.625000     test accuracy: 0.631369
Average cost in epoch 28: 0.616536
training accuracy: 0.625000     test accuracy: 0.631369
Average cost in epoch 29: 0.620188
training accuracy: 0.781250     test accuracy: 0.632368

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 30: 0.613665
training accuracy: 0.687500     test accuracy: 0.630370
lr decays to 0.005314
Average cost in epoch 31: 0.612628
training accuracy: 0.718750     test accuracy: 0.629371
Average cost in epoch 32: 0.613119
training accuracy: 0.656250     test accuracy: 0.631369
Average cost in epoch 33: 0.610815
training accuracy: 0.656250     test accuracy: 0.636364
Average cost in epoch 34: 0.609827
training accuracy: 0.625000     test accuracy: 0.616384

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 35: 0.609354
training accuracy: 0.593750     test accuracy: 0.639361
lr decays to 0.004783
Average cost in epoch 36: 0.607796
training accuracy: 0.687500     test accuracy: 0.637363
Average cost in epoch 37: 0.605538
training accuracy: 0.718750     test accuracy: 0.624376
Average cost in epoch 38: 0.605117
training accuracy: 0.562500     test accuracy: 0.637363
Average cost in epoch 39: 0.604829
training accuracy: 0.500000     test accuracy: 0.632368

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 40: 0.603100
training accuracy: 0.687500     test accuracy: 0.626374
lr decays to 0.004305
Average cost in epoch 41: 0.597751
training accuracy: 0.562500     test accuracy: 0.633367
Average cost in epoch 42: 0.600315
training accuracy: 0.718750     test accuracy: 0.617383
Average cost in epoch 43: 0.598944
training accuracy: 0.718750     test accuracy: 0.634366
Average cost in epoch 44: 0.597392
training accuracy: 0.656250     test accuracy: 0.637363

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 45: 0.597113
training accuracy: 0.687500     test accuracy: 0.636364
lr decays to 0.003874
Average cost in epoch 46: 0.593809
training accuracy: 0.562500     test accuracy: 0.627373
Average cost in epoch 47: 0.593452
training accuracy: 0.625000     test accuracy: 0.612388
Average cost in epoch 48: 0.592084
training accuracy: 0.687500     test accuracy: 0.631369
Average cost in epoch 49: 0.593975
training accuracy: 0.625000     test accuracy: 0.629371

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 50: 0.591264
training accuracy: 0.687500     test accuracy: 0.622378
lr decays to 0.003487
Average cost in epoch 51: 0.590626
training accuracy: 0.718750     test accuracy: 0.628372
Average cost in epoch 52: 0.587288
training accuracy: 0.843750     test accuracy: 0.625375
Average cost in epoch 53: 0.587683
training accuracy: 0.781250     test accuracy: 0.639361
Average cost in epoch 54: 0.586355
training accuracy: 0.687500     test accuracy: 0.627373

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 55: 0.584077
training accuracy: 0.625000     test accuracy: 0.628372
lr decays to 0.003138
Average cost in epoch 56: 0.585284
training accuracy: 0.687500     test accuracy: 0.631369
Average cost in epoch 57: 0.581700
training accuracy: 0.687500     test accuracy: 0.636364
Average cost in epoch 58: 0.579983
training accuracy: 0.718750     test accuracy: 0.628372
Average cost in epoch 59: 0.585413
training accuracy: 0.656250     test accuracy: 0.629371

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 60: 0.579279
training accuracy: 0.468750     test accuracy: 0.647353
lr decays to 0.002824
Average cost in epoch 61: 0.579490
training accuracy: 0.656250     test accuracy: 0.635365
Average cost in epoch 62: 0.571284
training accuracy: 0.687500     test accuracy: 0.625375
Average cost in epoch 63: 0.569550
training accuracy: 0.625000     test accuracy: 0.634366
Average cost in epoch 64: 0.579524
training accuracy: 0.656250     test accuracy: 0.632368

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 65: 0.574732
training accuracy: 0.562500     test accuracy: 0.631369
lr decays to 0.002542
Average cost in epoch 66: 0.573704
training accuracy: 0.656250     test accuracy: 0.645355
Average cost in epoch 67: 0.569162
training accuracy: 0.812500     test accuracy: 0.627373
Average cost in epoch 68: 0.574705
training accuracy: 0.750000     test accuracy: 0.623377
Average cost in epoch 69: 0.567582
training accuracy: 0.687500     test accuracy: 0.634366

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 70: 0.565491
training accuracy: 0.718750     test accuracy: 0.640360
lr decays to 0.002288
Average cost in epoch 71: 0.569754
training accuracy: 0.625000     test accuracy: 0.636364
Average cost in epoch 72: 0.562080
training accuracy: 0.687500     test accuracy: 0.633367
Average cost in epoch 73: 0.565033
training accuracy: 0.718750     test accuracy: 0.629371
Average cost in epoch 74: 0.569480
training accuracy: 0.750000     test accuracy: 0.655345

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 75: 0.561962
training accuracy: 0.687500     test accuracy: 0.633367
lr decays to 0.002059
Average cost in epoch 76: 0.558179
training accuracy: 0.593750     test accuracy: 0.624376
Average cost in epoch 77: 0.558412
training accuracy: 0.750000     test accuracy: 0.633367
Average cost in epoch 78: 0.561406
training accuracy: 0.875000     test accuracy: 0.643357
Average cost in epoch 79: 0.557143
training accuracy: 0.750000     test accuracy: 0.654346

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 80: 0.560479
training accuracy: 0.687500     test accuracy: 0.637363
lr decays to 0.001853
Average cost in epoch 81: 0.558313
training accuracy: 0.687500     test accuracy: 0.650350
Average cost in epoch 82: 0.551607
training accuracy: 0.593750     test accuracy: 0.640360
Average cost in epoch 83: 0.555060
training accuracy: 0.656250     test accuracy: 0.642358
Average cost in epoch 84: 0.552225
training accuracy: 0.812500     test accuracy: 0.649351

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 85: 0.556163
training accuracy: 0.781250     test accuracy: 0.658342
lr decays to 0.001668
Average cost in epoch 86: 0.550279
training accuracy: 0.812500     test accuracy: 0.646354
Average cost in epoch 87: 0.552395
training accuracy: 0.750000     test accuracy: 0.650350
Average cost in epoch 88: 0.545394
training accuracy: 0.500000     test accuracy: 0.659341
Average cost in epoch 89: 0.547820
training accuracy: 0.843750     test accuracy: 0.645355

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 90: 0.547218
training accuracy: 0.718750     test accuracy: 0.648352
lr decays to 0.001501
Average cost in epoch 91: 0.546274
training accuracy: 0.687500     test accuracy: 0.651349
Average cost in epoch 92: 0.543517
training accuracy: 0.812500     test accuracy: 0.652348
Average cost in epoch 93: 0.546309
training accuracy: 0.625000     test accuracy: 0.639361
Average cost in epoch 94: 0.539747
training accuracy: 0.625000     test accuracy: 0.647353

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 95: 0.541649
training accuracy: 0.656250     test accuracy: 0.649351
lr decays to 0.001351
Average cost in epoch 96: 0.541271
training accuracy: 0.718750     test accuracy: 0.644356
Average cost in epoch 97: 0.538014
training accuracy: 0.718750     test accuracy: 0.652348
Average cost in epoch 98: 0.537601
training accuracy: 0.718750     test accuracy: 0.643357
Average cost in epoch 99: 0.541525
training accuracy: 0.812500     test accuracy: 0.633367

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 100: 0.538661
training accuracy: 0.750000     test accuracy: 0.648352
lr decays to 0.001216
Average cost in epoch 101: 0.536864
training accuracy: 0.687500     test accuracy: 0.638362
Average cost in epoch 102: 0.535591
training accuracy: 0.718750     test accuracy: 0.639361
Average cost in epoch 103: 0.534058
training accuracy: 0.718750     test accuracy: 0.635365
Average cost in epoch 104: 0.533931
training accuracy: 0.687500     test accuracy: 0.639361

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 105: 0.537901
training accuracy: 0.687500     test accuracy: 0.633367
Average cost in epoch 106: 0.532915
training accuracy: 0.687500     test accuracy: 0.638362
Average cost in epoch 107: 0.535533
training accuracy: 0.875000     test accuracy: 0.638362
Average cost in epoch 108: 0.530768
training accuracy: 0.718750     test accuracy: 0.647353
Average cost in epoch 109: 0.531291
training accuracy: 0.468750     test accuracy: 0.643357

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 110: 0.536653
training accuracy: 0.625000     test accuracy: 0.642358
Average cost in epoch 111: 0.530896
training accuracy: 0.656250     test accuracy: 0.631369
Average cost in epoch 112: 0.535342
training accuracy: 0.656250     test accuracy: 0.644356
Average cost in epoch 113: 0.532770
training accuracy: 0.718750     test accuracy: 0.630370
Average cost in epoch 114: 0.532817
training accuracy: 0.750000     test accuracy: 0.641359

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 115: 0.531929
training accuracy: 0.656250     test accuracy: 0.647353
Average cost in epoch 116: 0.532085
training accuracy: 0.718750     test accuracy: 0.635365
Average cost in epoch 117: 0.529441
training accuracy: 0.875000     test accuracy: 0.625375
Average cost in epoch 118: 0.525298
training accuracy: 0.718750     test accuracy: 0.643357
Average cost in epoch 119: 0.531481
training accuracy: 0.750000     test accuracy: 0.639361

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 120: 0.525023
training accuracy: 0.781250     test accuracy: 0.639361
Average cost in epoch 121: 0.527096
training accuracy: 0.687500     test accuracy: 0.642358
Average cost in epoch 122: 0.526202
training accuracy: 0.750000     test accuracy: 0.639361
Average cost in epoch 123: 0.528862
training accuracy: 0.625000     test accuracy: 0.641359
Average cost in epoch 124: 0.529326
training accuracy: 0.718750     test accuracy: 0.644356

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 125: 0.527252
training accuracy: 0.750000     test accuracy: 0.650350
Average cost in epoch 126: 0.529021
training accuracy: 0.718750     test accuracy: 0.649351
Average cost in epoch 127: 0.523588
training accuracy: 0.843750     test accuracy: 0.644356
Average cost in epoch 128: 0.525015
training accuracy: 0.750000     test accuracy: 0.636364
Average cost in epoch 129: 0.530185
training accuracy: 0.687500     test accuracy: 0.642358

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 130: 0.523683
training accuracy: 0.781250     test accuracy: 0.646354
Average cost in epoch 131: 0.525675
training accuracy: 0.625000     test accuracy: 0.638362
Average cost in epoch 132: 0.528671
training accuracy: 0.812500     test accuracy: 0.641359
Average cost in epoch 133: 0.524415
training accuracy: 0.750000     test accuracy: 0.641359
Average cost in epoch 134: 0.529124
training accuracy: 0.625000     test accuracy: 0.635365

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 135: 0.524638
training accuracy: 0.656250     test accuracy: 0.641359
Average cost in epoch 136: 0.517339
training accuracy: 0.750000     test accuracy: 0.639361
Average cost in epoch 137: 0.530539
training accuracy: 0.687500     test accuracy: 0.645355
Average cost in epoch 138: 0.518232
training accuracy: 0.687500     test accuracy: 0.641359
Average cost in epoch 139: 0.529444
training accuracy: 0.593750     test accuracy: 0.646354

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 140: 0.523166
training accuracy: 0.750000     test accuracy: 0.644356
Average cost in epoch 141: 0.524953
training accuracy: 0.781250     test accuracy: 0.626374
Average cost in epoch 142: 0.525650
training accuracy: 0.687500     test accuracy: 0.642358
Average cost in epoch 143: 0.519588
training accuracy: 0.687500     test accuracy: 0.636364
Average cost in epoch 144: 0.519922
training accuracy: 0.718750     test accuracy: 0.639361

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 145: 0.523964
training accuracy: 0.718750     test accuracy: 0.645355
Average cost in epoch 146: 0.520331
training accuracy: 0.687500     test accuracy: 0.639361
Average cost in epoch 147: 0.518912
training accuracy: 0.656250     test accuracy: 0.639361
Average cost in epoch 148: 0.529498
training accuracy: 0.750000     test accuracy: 0.635365
Average cost in epoch 149: 0.525484
training accuracy: 0.656250     test accuracy: 0.649351

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 150: 0.525947
training accuracy: 0.562500     test accuracy: 0.645355
Average cost in epoch 151: 0.523495
training accuracy: 0.750000     test accuracy: 0.640360
Average cost in epoch 152: 0.529029
training accuracy: 0.718750     test accuracy: 0.631369
Average cost in epoch 153: 0.518796
training accuracy: 0.750000     test accuracy: 0.645355
Average cost in epoch 154: 0.521304
training accuracy: 0.656250     test accuracy: 0.639361

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 155: 0.522998
training accuracy: 0.656250     test accuracy: 0.644356
Average cost in epoch 156: 0.521693
training accuracy: 0.781250     test accuracy: 0.639361
Average cost in epoch 157: 0.523895
training accuracy: 0.718750     test accuracy: 0.635365
Average cost in epoch 158: 0.517890
training accuracy: 0.718750     test accuracy: 0.631369
Average cost in epoch 159: 0.522597
training accuracy: 0.656250     test accuracy: 0.626374

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 160: 0.518070
training accuracy: 0.718750     test accuracy: 0.639361
Average cost in epoch 161: 0.528112
training accuracy: 0.718750     test accuracy: 0.642358
Average cost in epoch 162: 0.515042
training accuracy: 0.656250     test accuracy: 0.644356
Average cost in epoch 163: 0.522388
training accuracy: 0.812500     test accuracy: 0.636364
Average cost in epoch 164: 0.523132
training accuracy: 0.625000     test accuracy: 0.646354

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 165: 0.521348
training accuracy: 0.687500     test accuracy: 0.638362
Average cost in epoch 166: 0.522456
training accuracy: 0.593750     test accuracy: 0.632368
Average cost in epoch 167: 0.518294
training accuracy: 0.750000     test accuracy: 0.628372
Average cost in epoch 168: 0.522000
training accuracy: 0.750000     test accuracy: 0.633367
Average cost in epoch 169: 0.513596
training accuracy: 0.750000     test accuracy: 0.629371

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 170: 0.523287
training accuracy: 0.750000     test accuracy: 0.628372
Average cost in epoch 171: 0.522231
training accuracy: 0.625000     test accuracy: 0.643357
Average cost in epoch 172: 0.513439
training accuracy: 0.718750     test accuracy: 0.637363
Average cost in epoch 173: 0.524375
training accuracy: 0.781250     test accuracy: 0.631369
Average cost in epoch 174: 0.516456
training accuracy: 0.593750     test accuracy: 0.637363

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 175: 0.516014
training accuracy: 0.750000     test accuracy: 0.642358
Average cost in epoch 176: 0.517439
training accuracy: 0.781250     test accuracy: 0.642358
Average cost in epoch 177: 0.519131
training accuracy: 0.531250     test accuracy: 0.647353
Average cost in epoch 178: 0.514294
training accuracy: 0.812500     test accuracy: 0.646354
Average cost in epoch 179: 0.523161
training accuracy: 0.781250     test accuracy: 0.645355

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 180: 0.519465
training accuracy: 0.687500     test accuracy: 0.640360
Average cost in epoch 181: 0.512619
training accuracy: 0.781250     test accuracy: 0.646354
Average cost in epoch 182: 0.523077
training accuracy: 0.562500     test accuracy: 0.629371
Average cost in epoch 183: 0.513243
training accuracy: 0.718750     test accuracy: 0.653347
Average cost in epoch 184: 0.521223
training accuracy: 0.656250     test accuracy: 0.640360

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 185: 0.518554
training accuracy: 0.718750     test accuracy: 0.642358
Average cost in epoch 186: 0.518707
training accuracy: 0.687500     test accuracy: 0.632368
Average cost in epoch 187: 0.510997
training accuracy: 0.750000     test accuracy: 0.643357
Average cost in epoch 188: 0.516359
training accuracy: 0.937500     test accuracy: 0.632368
Average cost in epoch 189: 0.517919
training accuracy: 0.812500     test accuracy: 0.629371

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 190: 0.509250
training accuracy: 0.687500     test accuracy: 0.639361
Average cost in epoch 191: 0.520422
training accuracy: 0.750000     test accuracy: 0.628372
Average cost in epoch 192: 0.516750
training accuracy: 0.750000     test accuracy: 0.645355
Average cost in epoch 193: 0.519369
training accuracy: 0.625000     test accuracy: 0.632368
Average cost in epoch 194: 0.516193
training accuracy: 0.750000     test accuracy: 0.643357

dump to weights/att-lstm/att-lstm_9.pkl

Average cost in epoch 195: 0.513005
training accuracy: 0.812500     test accuracy: 0.640360
Average cost in epoch 196: 0.512984
training accuracy: 0.718750     test accuracy: 0.645355
Average cost in epoch 197: 0.505990
training accuracy: 0.718750     test accuracy: 0.641359
Average cost in epoch 198: 0.516905
training accuracy: 0.750000     test accuracy: 0.648352
Average cost in epoch 199: 0.518551
training accuracy: 0.500000     test accuracy: 0.647353

dump to weights/att-lstm/att-lstm_9.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 10, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_10.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 118.19
Starting training...
Average cost in epoch 0: 1.027732
training accuracy: 0.500000     test accuracy: 0.486513
Average cost in epoch 1: 0.933961
training accuracy: 0.593750     test accuracy: 0.478521
Average cost in epoch 2: 0.930714
training accuracy: 0.531250     test accuracy: 0.480519
Average cost in epoch 3: 0.925338
training accuracy: 0.437500     test accuracy: 0.462537
Average cost in epoch 4: 0.922067
training accuracy: 0.468750     test accuracy: 0.460539

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 5: 0.921129
training accuracy: 0.406250     test accuracy: 0.435564
lr decays to 0.009000
Average cost in epoch 6: 0.918811
training accuracy: 0.437500     test accuracy: 0.478521
Average cost in epoch 7: 0.913402
training accuracy: 0.437500     test accuracy: 0.430569
Average cost in epoch 8: 0.914798
training accuracy: 0.593750     test accuracy: 0.427572
Average cost in epoch 9: 0.916352
training accuracy: 0.531250     test accuracy: 0.472527

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 10: 0.914733
training accuracy: 0.500000     test accuracy: 0.466533
lr decays to 0.008100
Average cost in epoch 11: 0.910735
training accuracy: 0.625000     test accuracy: 0.479520
Average cost in epoch 12: 0.909736
training accuracy: 0.531250     test accuracy: 0.463536
Average cost in epoch 13: 0.913897
training accuracy: 0.531250     test accuracy: 0.476523
Average cost in epoch 14: 0.908346
training accuracy: 0.375000     test accuracy: 0.447552

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 15: 0.909640
training accuracy: 0.468750     test accuracy: 0.459540
lr decays to 0.007290
Average cost in epoch 16: 0.910146
training accuracy: 0.500000     test accuracy: 0.459540
Average cost in epoch 17: 0.909029
training accuracy: 0.593750     test accuracy: 0.429570
Average cost in epoch 18: 0.907515
training accuracy: 0.406250     test accuracy: 0.469530
Average cost in epoch 19: 0.907758
training accuracy: 0.500000     test accuracy: 0.429570

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 20: 0.907198
training accuracy: 0.468750     test accuracy: 0.467532
lr decays to 0.006561
Average cost in epoch 21: 0.907188
training accuracy: 0.562500     test accuracy: 0.428571
Average cost in epoch 22: 0.904394
training accuracy: 0.500000     test accuracy: 0.467532
Average cost in epoch 23: 0.905727
training accuracy: 0.593750     test accuracy: 0.459540
Average cost in epoch 24: 0.906284
training accuracy: 0.562500     test accuracy: 0.461538

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 25: 0.902540
training accuracy: 0.593750     test accuracy: 0.471528
lr decays to 0.005905
Average cost in epoch 26: 0.900969
training accuracy: 0.406250     test accuracy: 0.463536
Average cost in epoch 27: 0.898680
training accuracy: 0.593750     test accuracy: 0.450549
Average cost in epoch 28: 0.901430
training accuracy: 0.375000     test accuracy: 0.468531
Average cost in epoch 29: 0.900328
training accuracy: 0.593750     test accuracy: 0.425574

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 30: 0.899480
training accuracy: 0.500000     test accuracy: 0.473526
lr decays to 0.005314
Average cost in epoch 31: 0.897277
training accuracy: 0.593750     test accuracy: 0.476523
Average cost in epoch 32: 0.900037
training accuracy: 0.343750     test accuracy: 0.459540
Average cost in epoch 33: 0.895228
training accuracy: 0.406250     test accuracy: 0.458541
Average cost in epoch 34: 0.896652
training accuracy: 0.406250     test accuracy: 0.462537

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 35: 0.893336
training accuracy: 0.437500     test accuracy: 0.465534
lr decays to 0.004783
Average cost in epoch 36: 0.895893
training accuracy: 0.500000     test accuracy: 0.469530
Average cost in epoch 37: 0.895401
training accuracy: 0.468750     test accuracy: 0.429570
Average cost in epoch 38: 0.891697
training accuracy: 0.562500     test accuracy: 0.435564
Average cost in epoch 39: 0.894893
training accuracy: 0.531250     test accuracy: 0.433566

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 40: 0.889791
training accuracy: 0.468750     test accuracy: 0.444555
lr decays to 0.004305
Average cost in epoch 41: 0.893238
training accuracy: 0.593750     test accuracy: 0.438561
Average cost in epoch 42: 0.889450
training accuracy: 0.468750     test accuracy: 0.453546
Average cost in epoch 43: 0.888872
training accuracy: 0.656250     test accuracy: 0.463536
Average cost in epoch 44: 0.886747
training accuracy: 0.500000     test accuracy: 0.431568

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 45: 0.891038
training accuracy: 0.500000     test accuracy: 0.435564
lr decays to 0.003874
Average cost in epoch 46: 0.888609
training accuracy: 0.500000     test accuracy: 0.462537
Average cost in epoch 47: 0.886205
training accuracy: 0.312500     test accuracy: 0.459540
Average cost in epoch 48: 0.884346
training accuracy: 0.562500     test accuracy: 0.461538
Average cost in epoch 49: 0.884462
training accuracy: 0.468750     test accuracy: 0.451548

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 50: 0.883226
training accuracy: 0.656250     test accuracy: 0.432567
lr decays to 0.003487
Average cost in epoch 51: 0.885007
training accuracy: 0.468750     test accuracy: 0.456543
Average cost in epoch 52: 0.884507
training accuracy: 0.531250     test accuracy: 0.446553
Average cost in epoch 53: 0.880110
training accuracy: 0.406250     test accuracy: 0.456543
Average cost in epoch 54: 0.882952
training accuracy: 0.312500     test accuracy: 0.472527

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 55: 0.881518
training accuracy: 0.687500     test accuracy: 0.438561
lr decays to 0.003138
Average cost in epoch 56: 0.879525
training accuracy: 0.437500     test accuracy: 0.438561
Average cost in epoch 57: 0.873884
training accuracy: 0.531250     test accuracy: 0.463536
Average cost in epoch 58: 0.879148
training accuracy: 0.281250     test accuracy: 0.463536
Average cost in epoch 59: 0.874711
training accuracy: 0.375000     test accuracy: 0.463536

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 60: 0.874842
training accuracy: 0.625000     test accuracy: 0.439560
lr decays to 0.002824
Average cost in epoch 61: 0.872459
training accuracy: 0.593750     test accuracy: 0.439560
Average cost in epoch 62: 0.873353
training accuracy: 0.531250     test accuracy: 0.436563
Average cost in epoch 63: 0.872700
training accuracy: 0.593750     test accuracy: 0.435564
Average cost in epoch 64: 0.871519
training accuracy: 0.500000     test accuracy: 0.449550

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 65: 0.869312
training accuracy: 0.375000     test accuracy: 0.468531
lr decays to 0.002542
Average cost in epoch 66: 0.869370
training accuracy: 0.531250     test accuracy: 0.448551
Average cost in epoch 67: 0.867758
training accuracy: 0.468750     test accuracy: 0.457542
Average cost in epoch 68: 0.868093
training accuracy: 0.593750     test accuracy: 0.451548
Average cost in epoch 69: 0.867718
training accuracy: 0.437500     test accuracy: 0.437562

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 70: 0.867516
training accuracy: 0.468750     test accuracy: 0.446553
lr decays to 0.002288
Average cost in epoch 71: 0.861789
training accuracy: 0.500000     test accuracy: 0.449550
Average cost in epoch 72: 0.865595
training accuracy: 0.343750     test accuracy: 0.450549
Average cost in epoch 73: 0.859973
training accuracy: 0.593750     test accuracy: 0.443556
Average cost in epoch 74: 0.862646
training accuracy: 0.468750     test accuracy: 0.431568

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 75: 0.863869
training accuracy: 0.531250     test accuracy: 0.439560
lr decays to 0.002059
Average cost in epoch 76: 0.854884
training accuracy: 0.593750     test accuracy: 0.457542
Average cost in epoch 77: 0.858486
training accuracy: 0.562500     test accuracy: 0.460539
Average cost in epoch 78: 0.859896
training accuracy: 0.562500     test accuracy: 0.442557
Average cost in epoch 79: 0.857695
training accuracy: 0.656250     test accuracy: 0.442557

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 80: 0.856808
training accuracy: 0.531250     test accuracy: 0.454545
lr decays to 0.001853
Average cost in epoch 81: 0.853749
training accuracy: 0.437500     test accuracy: 0.461538
Average cost in epoch 82: 0.854646
training accuracy: 0.531250     test accuracy: 0.457542
Average cost in epoch 83: 0.853219
training accuracy: 0.593750     test accuracy: 0.444555
Average cost in epoch 84: 0.851058
training accuracy: 0.625000     test accuracy: 0.454545

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 85: 0.854387
training accuracy: 0.406250     test accuracy: 0.444555
lr decays to 0.001668
Average cost in epoch 86: 0.848502
training accuracy: 0.562500     test accuracy: 0.444555
Average cost in epoch 87: 0.851705
training accuracy: 0.562500     test accuracy: 0.460539
Average cost in epoch 88: 0.846648
training accuracy: 0.531250     test accuracy: 0.443556
Average cost in epoch 89: 0.848358
training accuracy: 0.468750     test accuracy: 0.441558

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 90: 0.849273
training accuracy: 0.656250     test accuracy: 0.443556
lr decays to 0.001501
Average cost in epoch 91: 0.842150
training accuracy: 0.625000     test accuracy: 0.440559
Average cost in epoch 92: 0.848971
training accuracy: 0.468750     test accuracy: 0.446553
Average cost in epoch 93: 0.844016
training accuracy: 0.656250     test accuracy: 0.446553
Average cost in epoch 94: 0.846966
training accuracy: 0.468750     test accuracy: 0.428571

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 95: 0.844709
training accuracy: 0.687500     test accuracy: 0.443556
lr decays to 0.001351
Average cost in epoch 96: 0.843908
training accuracy: 0.656250     test accuracy: 0.455544
Average cost in epoch 97: 0.837262
training accuracy: 0.593750     test accuracy: 0.434565
Average cost in epoch 98: 0.840728
training accuracy: 0.500000     test accuracy: 0.429570
Average cost in epoch 99: 0.839843
training accuracy: 0.531250     test accuracy: 0.446553

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 100: 0.839205
training accuracy: 0.531250     test accuracy: 0.443556
lr decays to 0.001216
Average cost in epoch 101: 0.835108
training accuracy: 0.593750     test accuracy: 0.443556
Average cost in epoch 102: 0.832448
training accuracy: 0.718750     test accuracy: 0.439560
Average cost in epoch 103: 0.837956
training accuracy: 0.625000     test accuracy: 0.446553
Average cost in epoch 104: 0.831214
training accuracy: 0.562500     test accuracy: 0.458541

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 105: 0.838324
training accuracy: 0.781250     test accuracy: 0.437562
Average cost in epoch 106: 0.829715
training accuracy: 0.500000     test accuracy: 0.440559
Average cost in epoch 107: 0.831193
training accuracy: 0.593750     test accuracy: 0.450549
Average cost in epoch 108: 0.834320
training accuracy: 0.593750     test accuracy: 0.436563
Average cost in epoch 109: 0.833917
training accuracy: 0.625000     test accuracy: 0.440559

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 110: 0.832543
training accuracy: 0.500000     test accuracy: 0.440559
Average cost in epoch 111: 0.833017
training accuracy: 0.656250     test accuracy: 0.441558
Average cost in epoch 112: 0.836416
training accuracy: 0.437500     test accuracy: 0.449550
Average cost in epoch 113: 0.830619
training accuracy: 0.500000     test accuracy: 0.442557
Average cost in epoch 114: 0.828783
training accuracy: 0.437500     test accuracy: 0.452547

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 115: 0.834367
training accuracy: 0.468750     test accuracy: 0.435564
Average cost in epoch 116: 0.825316
training accuracy: 0.687500     test accuracy: 0.444555
Average cost in epoch 117: 0.826422
training accuracy: 0.562500     test accuracy: 0.440559
Average cost in epoch 118: 0.831226
training accuracy: 0.687500     test accuracy: 0.434565
Average cost in epoch 119: 0.827853
training accuracy: 0.625000     test accuracy: 0.446553

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 120: 0.826006
training accuracy: 0.625000     test accuracy: 0.433566
Average cost in epoch 121: 0.827506
training accuracy: 0.375000     test accuracy: 0.426573
Average cost in epoch 122: 0.823094
training accuracy: 0.468750     test accuracy: 0.430569
Average cost in epoch 123: 0.826232
training accuracy: 0.562500     test accuracy: 0.436563
Average cost in epoch 124: 0.824496
training accuracy: 0.531250     test accuracy: 0.433566

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 125: 0.828487
training accuracy: 0.625000     test accuracy: 0.433566
Average cost in epoch 126: 0.825376
training accuracy: 0.500000     test accuracy: 0.430569
Average cost in epoch 127: 0.823523
training accuracy: 0.500000     test accuracy: 0.452547
Average cost in epoch 128: 0.824491
training accuracy: 0.625000     test accuracy: 0.430569
Average cost in epoch 129: 0.821200
training accuracy: 0.531250     test accuracy: 0.431568

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 130: 0.823971
training accuracy: 0.687500     test accuracy: 0.437562
Average cost in epoch 131: 0.820420
training accuracy: 0.531250     test accuracy: 0.430569
Average cost in epoch 132: 0.816960
training accuracy: 0.562500     test accuracy: 0.440559
Average cost in epoch 133: 0.819643
training accuracy: 0.625000     test accuracy: 0.427572
Average cost in epoch 134: 0.823522
training accuracy: 0.437500     test accuracy: 0.440559

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 135: 0.818034
training accuracy: 0.437500     test accuracy: 0.437562
Average cost in epoch 136: 0.817693
training accuracy: 0.593750     test accuracy: 0.463536
Average cost in epoch 137: 0.819368
training accuracy: 0.625000     test accuracy: 0.433566
Average cost in epoch 138: 0.818681
training accuracy: 0.687500     test accuracy: 0.442557
Average cost in epoch 139: 0.818541
training accuracy: 0.500000     test accuracy: 0.450549

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 140: 0.817504
training accuracy: 0.531250     test accuracy: 0.448551
Average cost in epoch 141: 0.818928
training accuracy: 0.437500     test accuracy: 0.436563
Average cost in epoch 142: 0.823836
training accuracy: 0.656250     test accuracy: 0.440559
Average cost in epoch 143: 0.813949
training accuracy: 0.562500     test accuracy: 0.437562
Average cost in epoch 144: 0.823534
training accuracy: 0.468750     test accuracy: 0.442557

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 145: 0.813930
training accuracy: 0.562500     test accuracy: 0.440559
Average cost in epoch 146: 0.817567
training accuracy: 0.468750     test accuracy: 0.437562
Average cost in epoch 147: 0.813837
training accuracy: 0.531250     test accuracy: 0.439560
Average cost in epoch 148: 0.826246
training accuracy: 0.531250     test accuracy: 0.415584
Average cost in epoch 149: 0.813355
training accuracy: 0.531250     test accuracy: 0.425574

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 150: 0.815196
training accuracy: 0.562500     test accuracy: 0.422577
Average cost in epoch 151: 0.813778
training accuracy: 0.750000     test accuracy: 0.422577
Average cost in epoch 152: 0.818182
training accuracy: 0.468750     test accuracy: 0.435564
Average cost in epoch 153: 0.818404
training accuracy: 0.656250     test accuracy: 0.434565
Average cost in epoch 154: 0.818420
training accuracy: 0.656250     test accuracy: 0.440559

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 155: 0.813609
training accuracy: 0.468750     test accuracy: 0.424575
Average cost in epoch 156: 0.815655
training accuracy: 0.718750     test accuracy: 0.432567
Average cost in epoch 157: 0.812426
training accuracy: 0.500000     test accuracy: 0.427572
Average cost in epoch 158: 0.810574
training accuracy: 0.531250     test accuracy: 0.428571
Average cost in epoch 159: 0.811761
training accuracy: 0.593750     test accuracy: 0.419580

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 160: 0.808986
training accuracy: 0.562500     test accuracy: 0.439560
Average cost in epoch 161: 0.815037
training accuracy: 0.500000     test accuracy: 0.431568
Average cost in epoch 162: 0.815477
training accuracy: 0.500000     test accuracy: 0.440559
Average cost in epoch 163: 0.807736
training accuracy: 0.593750     test accuracy: 0.435564
Average cost in epoch 164: 0.818728
training accuracy: 0.750000     test accuracy: 0.441558

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 165: 0.811262
training accuracy: 0.593750     test accuracy: 0.445554
Average cost in epoch 166: 0.814526
training accuracy: 0.562500     test accuracy: 0.429570
Average cost in epoch 167: 0.813292
training accuracy: 0.375000     test accuracy: 0.438561
Average cost in epoch 168: 0.817459
training accuracy: 0.593750     test accuracy: 0.414585
Average cost in epoch 169: 0.815457
training accuracy: 0.437500     test accuracy: 0.426573

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 170: 0.808140
training accuracy: 0.437500     test accuracy: 0.425574
Average cost in epoch 171: 0.816992
training accuracy: 0.750000     test accuracy: 0.440559
Average cost in epoch 172: 0.818143
training accuracy: 0.468750     test accuracy: 0.452547
Average cost in epoch 173: 0.816763
training accuracy: 0.531250     test accuracy: 0.426573
Average cost in epoch 174: 0.808978
training accuracy: 0.656250     test accuracy: 0.448551

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 175: 0.810399
training accuracy: 0.656250     test accuracy: 0.433566
Average cost in epoch 176: 0.807181
training accuracy: 0.718750     test accuracy: 0.449550
Average cost in epoch 177: 0.809560
training accuracy: 0.500000     test accuracy: 0.444555
Average cost in epoch 178: 0.810346
training accuracy: 0.625000     test accuracy: 0.434565
Average cost in epoch 179: 0.810137
training accuracy: 0.593750     test accuracy: 0.441558

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 180: 0.812930
training accuracy: 0.593750     test accuracy: 0.438561
Average cost in epoch 181: 0.808700
training accuracy: 0.718750     test accuracy: 0.447552
Average cost in epoch 182: 0.814605
training accuracy: 0.656250     test accuracy: 0.444555
Average cost in epoch 183: 0.808563
training accuracy: 0.656250     test accuracy: 0.445554
Average cost in epoch 184: 0.808730
training accuracy: 0.531250     test accuracy: 0.431568

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 185: 0.807448
training accuracy: 0.437500     test accuracy: 0.428571
Average cost in epoch 186: 0.808628
training accuracy: 0.500000     test accuracy: 0.423576
Average cost in epoch 187: 0.809801
training accuracy: 0.593750     test accuracy: 0.447552
Average cost in epoch 188: 0.807344
training accuracy: 0.625000     test accuracy: 0.436563
Average cost in epoch 189: 0.811020
training accuracy: 0.593750     test accuracy: 0.440559

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 190: 0.809174
training accuracy: 0.562500     test accuracy: 0.444555
Average cost in epoch 191: 0.807650
training accuracy: 0.531250     test accuracy: 0.445554
Average cost in epoch 192: 0.810060
training accuracy: 0.562500     test accuracy: 0.460539
Average cost in epoch 193: 0.808503
training accuracy: 0.531250     test accuracy: 0.437562
Average cost in epoch 194: 0.803320
training accuracy: 0.625000     test accuracy: 0.429570

dump to weights/att-lstm/att-lstm_10.pkl

Average cost in epoch 195: 0.805055
training accuracy: 0.625000     test accuracy: 0.439560
Average cost in epoch 196: 0.804935
training accuracy: 0.562500     test accuracy: 0.440559
Average cost in epoch 197: 0.801446
training accuracy: 0.500000     test accuracy: 0.451548
Average cost in epoch 198: 0.808579
training accuracy: 0.656250     test accuracy: 0.437562
Average cost in epoch 199: 0.808039
training accuracy: 0.531250     test accuracy: 0.428571

dump to weights/att-lstm/att-lstm_10.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 11, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_11.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 117.09
Starting training...
Average cost in epoch 0: 1.379027
training accuracy: 0.625000     test accuracy: 0.751249
Average cost in epoch 1: 1.140220
training accuracy: 0.625000     test accuracy: 0.742258
Average cost in epoch 2: 1.070009
training accuracy: 0.625000     test accuracy: 0.737263
Average cost in epoch 3: 1.010841
training accuracy: 0.687500     test accuracy: 0.741259
Average cost in epoch 4: 0.971872
training accuracy: 0.843750     test accuracy: 0.732268

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 5: 0.945297
training accuracy: 0.625000     test accuracy: 0.730270
lr decays to 0.009000
Average cost in epoch 6: 0.908891
training accuracy: 0.750000     test accuracy: 0.727273
Average cost in epoch 7: 0.891065
training accuracy: 0.625000     test accuracy: 0.717283
Average cost in epoch 8: 0.888276
training accuracy: 0.656250     test accuracy: 0.704296
Average cost in epoch 9: 0.879776
training accuracy: 0.625000     test accuracy: 0.728272

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 10: 0.877210
training accuracy: 0.656250     test accuracy: 0.736264
lr decays to 0.008100
Average cost in epoch 11: 0.838347
training accuracy: 0.750000     test accuracy: 0.723277
Average cost in epoch 12: 0.832071
training accuracy: 0.656250     test accuracy: 0.733267
Average cost in epoch 13: 0.844101
training accuracy: 0.656250     test accuracy: 0.713287
Average cost in epoch 14: 0.835882
training accuracy: 0.593750     test accuracy: 0.718282

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 15: 0.827234
training accuracy: 0.718750     test accuracy: 0.712288
lr decays to 0.007290
Average cost in epoch 16: 0.814388
training accuracy: 0.812500     test accuracy: 0.720280
Average cost in epoch 17: 0.798974
training accuracy: 0.906250     test accuracy: 0.720280
Average cost in epoch 18: 0.799914
training accuracy: 0.625000     test accuracy: 0.701299
Average cost in epoch 19: 0.805566
training accuracy: 0.781250     test accuracy: 0.724276

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 20: 0.792856
training accuracy: 0.750000     test accuracy: 0.724276
lr decays to 0.006561
Average cost in epoch 21: 0.788872
training accuracy: 0.812500     test accuracy: 0.713287
Average cost in epoch 22: 0.795116
training accuracy: 0.750000     test accuracy: 0.684316
Average cost in epoch 23: 0.791616
training accuracy: 0.750000     test accuracy: 0.679321
Average cost in epoch 24: 0.769732
training accuracy: 0.687500     test accuracy: 0.712288

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 25: 0.783705
training accuracy: 0.687500     test accuracy: 0.679321
lr decays to 0.005905
Average cost in epoch 26: 0.775452
training accuracy: 0.687500     test accuracy: 0.700300
Average cost in epoch 27: 0.783126
training accuracy: 0.687500     test accuracy: 0.710290
Average cost in epoch 28: 0.768525
training accuracy: 0.750000     test accuracy: 0.693307
Average cost in epoch 29: 0.768819
training accuracy: 0.656250     test accuracy: 0.702298

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 30: 0.770473
training accuracy: 0.750000     test accuracy: 0.684316
lr decays to 0.005314
Average cost in epoch 31: 0.765622
training accuracy: 0.781250     test accuracy: 0.700300
Average cost in epoch 32: 0.757976
training accuracy: 0.687500     test accuracy: 0.678322
Average cost in epoch 33: 0.773771
training accuracy: 0.625000     test accuracy: 0.704296
Average cost in epoch 34: 0.787068
training accuracy: 0.781250     test accuracy: 0.696304

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 35: 0.767755
training accuracy: 0.875000     test accuracy: 0.681319
lr decays to 0.004783
Average cost in epoch 36: 0.748380
training accuracy: 0.687500     test accuracy: 0.681319
Average cost in epoch 37: 0.744872
training accuracy: 0.718750     test accuracy: 0.708292
Average cost in epoch 38: 0.743817
training accuracy: 0.593750     test accuracy: 0.684316
Average cost in epoch 39: 0.741007
training accuracy: 0.468750     test accuracy: 0.685315

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 40: 0.740535
training accuracy: 0.750000     test accuracy: 0.671329
lr decays to 0.004305
Average cost in epoch 41: 0.742594
training accuracy: 0.781250     test accuracy: 0.688312
Average cost in epoch 42: 0.738595
training accuracy: 0.843750     test accuracy: 0.691309
Average cost in epoch 43: 0.738149
training accuracy: 0.718750     test accuracy: 0.678322
Average cost in epoch 44: 0.719746
training accuracy: 0.718750     test accuracy: 0.694306

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 45: 0.726828
training accuracy: 0.687500     test accuracy: 0.675325
lr decays to 0.003874
Average cost in epoch 46: 0.716952
training accuracy: 0.718750     test accuracy: 0.678322
Average cost in epoch 47: 0.733056
training accuracy: 0.625000     test accuracy: 0.668332
Average cost in epoch 48: 0.711888
training accuracy: 0.593750     test accuracy: 0.664336
Average cost in epoch 49: 0.716925
training accuracy: 0.843750     test accuracy: 0.678322

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 50: 0.704570
training accuracy: 0.781250     test accuracy: 0.691309
lr decays to 0.003487
Average cost in epoch 51: 0.714960
training accuracy: 0.625000     test accuracy: 0.686314
Average cost in epoch 52: 0.712420
training accuracy: 0.687500     test accuracy: 0.685315
Average cost in epoch 53: 0.701012
training accuracy: 0.687500     test accuracy: 0.684316
Average cost in epoch 54: 0.705845
training accuracy: 0.625000     test accuracy: 0.683317

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 55: 0.714421
training accuracy: 0.562500     test accuracy: 0.673327
lr decays to 0.003138
Average cost in epoch 56: 0.713110
training accuracy: 0.687500     test accuracy: 0.683317
Average cost in epoch 57: 0.691674
training accuracy: 0.656250     test accuracy: 0.680320
Average cost in epoch 58: 0.695236
training accuracy: 0.843750     test accuracy: 0.675325
Average cost in epoch 59: 0.701041
training accuracy: 0.843750     test accuracy: 0.660340

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 60: 0.696663
training accuracy: 0.656250     test accuracy: 0.688312
lr decays to 0.002824
Average cost in epoch 61: 0.701471
training accuracy: 0.875000     test accuracy: 0.679321
Average cost in epoch 62: 0.687455
training accuracy: 0.718750     test accuracy: 0.680320
Average cost in epoch 63: 0.700191
training accuracy: 0.687500     test accuracy: 0.672328
Average cost in epoch 64: 0.681576
training accuracy: 0.687500     test accuracy: 0.672328

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 65: 0.675496
training accuracy: 0.812500     test accuracy: 0.654346
lr decays to 0.002542
Average cost in epoch 66: 0.673823
training accuracy: 0.812500     test accuracy: 0.676324
Average cost in epoch 67: 0.682307
training accuracy: 0.718750     test accuracy: 0.690310
Average cost in epoch 68: 0.673123
training accuracy: 0.781250     test accuracy: 0.679321
Average cost in epoch 69: 0.678856
training accuracy: 0.718750     test accuracy: 0.695305

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 70: 0.669249
training accuracy: 0.781250     test accuracy: 0.680320
lr decays to 0.002288
Average cost in epoch 71: 0.681677
training accuracy: 0.750000     test accuracy: 0.674326
Average cost in epoch 72: 0.664384
training accuracy: 0.687500     test accuracy: 0.691309
Average cost in epoch 73: 0.662557
training accuracy: 0.812500     test accuracy: 0.694306
Average cost in epoch 74: 0.680756
training accuracy: 0.750000     test accuracy: 0.676324

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 75: 0.670454
training accuracy: 0.781250     test accuracy: 0.675325
lr decays to 0.002059
Average cost in epoch 76: 0.666007
training accuracy: 0.718750     test accuracy: 0.663337
Average cost in epoch 77: 0.658173
training accuracy: 0.812500     test accuracy: 0.683317
Average cost in epoch 78: 0.668826
training accuracy: 0.625000     test accuracy: 0.677323
Average cost in epoch 79: 0.661275
training accuracy: 0.687500     test accuracy: 0.675325

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 80: 0.662527
training accuracy: 0.687500     test accuracy: 0.691309
lr decays to 0.001853
Average cost in epoch 81: 0.648251
training accuracy: 0.750000     test accuracy: 0.679321
Average cost in epoch 82: 0.647378
training accuracy: 0.812500     test accuracy: 0.669331
Average cost in epoch 83: 0.657394
training accuracy: 0.812500     test accuracy: 0.675325
Average cost in epoch 84: 0.652906
training accuracy: 0.625000     test accuracy: 0.670330

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 85: 0.654339
training accuracy: 0.687500     test accuracy: 0.686314
lr decays to 0.001668
Average cost in epoch 86: 0.650409
training accuracy: 0.750000     test accuracy: 0.668332
Average cost in epoch 87: 0.639629
training accuracy: 0.718750     test accuracy: 0.677323
Average cost in epoch 88: 0.643508
training accuracy: 0.531250     test accuracy: 0.690310
Average cost in epoch 89: 0.635913
training accuracy: 0.750000     test accuracy: 0.678322

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 90: 0.656166
training accuracy: 0.812500     test accuracy: 0.679321
lr decays to 0.001501
Average cost in epoch 91: 0.636888
training accuracy: 0.812500     test accuracy: 0.662338
Average cost in epoch 92: 0.644130
training accuracy: 0.750000     test accuracy: 0.669331
Average cost in epoch 93: 0.633842
training accuracy: 0.781250     test accuracy: 0.678322
Average cost in epoch 94: 0.640591
training accuracy: 0.781250     test accuracy: 0.666334

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 95: 0.631000
training accuracy: 0.625000     test accuracy: 0.669331
lr decays to 0.001351
Average cost in epoch 96: 0.625203
training accuracy: 0.750000     test accuracy: 0.679321
Average cost in epoch 97: 0.631287
training accuracy: 0.718750     test accuracy: 0.668332
Average cost in epoch 98: 0.631516
training accuracy: 0.906250     test accuracy: 0.672328
Average cost in epoch 99: 0.633527
training accuracy: 0.593750     test accuracy: 0.672328

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 100: 0.625237
training accuracy: 0.750000     test accuracy: 0.688312
lr decays to 0.001216
Average cost in epoch 101: 0.624852
training accuracy: 0.687500     test accuracy: 0.673327
Average cost in epoch 102: 0.620104
training accuracy: 0.781250     test accuracy: 0.678322
Average cost in epoch 103: 0.628590
training accuracy: 0.625000     test accuracy: 0.671329
Average cost in epoch 104: 0.622171
training accuracy: 0.718750     test accuracy: 0.660340

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 105: 0.613815
training accuracy: 0.781250     test accuracy: 0.669331
Average cost in epoch 106: 0.624323
training accuracy: 0.781250     test accuracy: 0.673327
Average cost in epoch 107: 0.624150
training accuracy: 0.718750     test accuracy: 0.691309
Average cost in epoch 108: 0.616122
training accuracy: 0.625000     test accuracy: 0.676324
Average cost in epoch 109: 0.606361
training accuracy: 0.781250     test accuracy: 0.671329

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 110: 0.613993
training accuracy: 0.718750     test accuracy: 0.676324
Average cost in epoch 111: 0.614606
training accuracy: 0.812500     test accuracy: 0.678322
Average cost in epoch 112: 0.625456
training accuracy: 0.781250     test accuracy: 0.668332
Average cost in epoch 113: 0.610977
training accuracy: 0.656250     test accuracy: 0.675325
Average cost in epoch 114: 0.618866
training accuracy: 0.718750     test accuracy: 0.681319

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 115: 0.614951
training accuracy: 0.812500     test accuracy: 0.679321
Average cost in epoch 116: 0.609251
training accuracy: 0.781250     test accuracy: 0.680320
Average cost in epoch 117: 0.610341
training accuracy: 0.812500     test accuracy: 0.666334
Average cost in epoch 118: 0.609401
training accuracy: 0.562500     test accuracy: 0.678322
Average cost in epoch 119: 0.613329
training accuracy: 0.812500     test accuracy: 0.681319

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 120: 0.612159
training accuracy: 0.750000     test accuracy: 0.675325
Average cost in epoch 121: 0.603727
training accuracy: 0.781250     test accuracy: 0.685315
Average cost in epoch 122: 0.599841
training accuracy: 0.906250     test accuracy: 0.678322
Average cost in epoch 123: 0.599066
training accuracy: 0.781250     test accuracy: 0.677323
Average cost in epoch 124: 0.614170
training accuracy: 0.718750     test accuracy: 0.670330

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 125: 0.602262
training accuracy: 0.750000     test accuracy: 0.674326
Average cost in epoch 126: 0.612549
training accuracy: 0.687500     test accuracy: 0.669331
Average cost in epoch 127: 0.616749
training accuracy: 0.843750     test accuracy: 0.674326
Average cost in epoch 128: 0.598014
training accuracy: 0.843750     test accuracy: 0.674326
Average cost in epoch 129: 0.610376
training accuracy: 0.687500     test accuracy: 0.674326

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 130: 0.604679
training accuracy: 0.625000     test accuracy: 0.675325
Average cost in epoch 131: 0.607525
training accuracy: 0.875000     test accuracy: 0.670330
Average cost in epoch 132: 0.599125
training accuracy: 0.687500     test accuracy: 0.670330
Average cost in epoch 133: 0.602747
training accuracy: 0.656250     test accuracy: 0.679321
Average cost in epoch 134: 0.613741
training accuracy: 0.781250     test accuracy: 0.674326

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 135: 0.597245
training accuracy: 0.562500     test accuracy: 0.674326
Average cost in epoch 136: 0.594794
training accuracy: 0.843750     test accuracy: 0.665335
Average cost in epoch 137: 0.593263
training accuracy: 0.750000     test accuracy: 0.677323
Average cost in epoch 138: 0.605072
training accuracy: 0.750000     test accuracy: 0.662338
Average cost in epoch 139: 0.598446
training accuracy: 0.812500     test accuracy: 0.679321

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 140: 0.600187
training accuracy: 0.843750     test accuracy: 0.670330
Average cost in epoch 141: 0.591805
training accuracy: 0.843750     test accuracy: 0.674326
Average cost in epoch 142: 0.591423
training accuracy: 0.812500     test accuracy: 0.666334
Average cost in epoch 143: 0.610353
training accuracy: 0.750000     test accuracy: 0.661339
Average cost in epoch 144: 0.600265
training accuracy: 0.750000     test accuracy: 0.671329

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 145: 0.589952
training accuracy: 0.750000     test accuracy: 0.670330
Average cost in epoch 146: 0.605078
training accuracy: 0.687500     test accuracy: 0.668332
Average cost in epoch 147: 0.601638
training accuracy: 0.718750     test accuracy: 0.673327
Average cost in epoch 148: 0.600116
training accuracy: 0.687500     test accuracy: 0.671329
Average cost in epoch 149: 0.592238
training accuracy: 0.687500     test accuracy: 0.668332

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 150: 0.608311
training accuracy: 0.781250     test accuracy: 0.674326
Average cost in epoch 151: 0.600650
training accuracy: 0.843750     test accuracy: 0.682318
Average cost in epoch 152: 0.597997
training accuracy: 0.718750     test accuracy: 0.675325
Average cost in epoch 153: 0.592439
training accuracy: 0.843750     test accuracy: 0.669331
Average cost in epoch 154: 0.602446
training accuracy: 0.843750     test accuracy: 0.660340

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 155: 0.601955
training accuracy: 0.687500     test accuracy: 0.675325
Average cost in epoch 156: 0.597051
training accuracy: 0.718750     test accuracy: 0.671329
Average cost in epoch 157: 0.579086
training accuracy: 0.656250     test accuracy: 0.666334
Average cost in epoch 158: 0.602075
training accuracy: 0.812500     test accuracy: 0.675325
Average cost in epoch 159: 0.613939
training accuracy: 0.781250     test accuracy: 0.678322

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 160: 0.593021
training accuracy: 0.718750     test accuracy: 0.665335
Average cost in epoch 161: 0.593782
training accuracy: 0.750000     test accuracy: 0.684316
Average cost in epoch 162: 0.589114
training accuracy: 0.812500     test accuracy: 0.673327
Average cost in epoch 163: 0.591633
training accuracy: 0.781250     test accuracy: 0.667333
Average cost in epoch 164: 0.588835
training accuracy: 0.812500     test accuracy: 0.678322

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 165: 0.590093
training accuracy: 0.656250     test accuracy: 0.669331
Average cost in epoch 166: 0.598075
training accuracy: 0.750000     test accuracy: 0.683317
Average cost in epoch 167: 0.591648
training accuracy: 0.656250     test accuracy: 0.670330
Average cost in epoch 168: 0.603620
training accuracy: 0.750000     test accuracy: 0.675325
Average cost in epoch 169: 0.592374
training accuracy: 0.812500     test accuracy: 0.682318

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 170: 0.588778
training accuracy: 0.687500     test accuracy: 0.670330
Average cost in epoch 171: 0.586260
training accuracy: 0.843750     test accuracy: 0.679321
Average cost in epoch 172: 0.587829
training accuracy: 0.843750     test accuracy: 0.677323
Average cost in epoch 173: 0.589310
training accuracy: 0.718750     test accuracy: 0.664336
Average cost in epoch 174: 0.573462
training accuracy: 0.750000     test accuracy: 0.688312

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 175: 0.588081
training accuracy: 0.812500     test accuracy: 0.681319
Average cost in epoch 176: 0.578719
training accuracy: 0.750000     test accuracy: 0.682318
Average cost in epoch 177: 0.587492
training accuracy: 0.875000     test accuracy: 0.677323
Average cost in epoch 178: 0.601004
training accuracy: 0.843750     test accuracy: 0.680320
Average cost in epoch 179: 0.576634
training accuracy: 0.718750     test accuracy: 0.684316

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 180: 0.588733
training accuracy: 0.656250     test accuracy: 0.671329
Average cost in epoch 181: 0.587580
training accuracy: 0.687500     test accuracy: 0.679321
Average cost in epoch 182: 0.584433
training accuracy: 0.656250     test accuracy: 0.676324
Average cost in epoch 183: 0.589195
training accuracy: 0.625000     test accuracy: 0.676324
Average cost in epoch 184: 0.584430
training accuracy: 0.718750     test accuracy: 0.679321

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 185: 0.591283
training accuracy: 0.843750     test accuracy: 0.670330
Average cost in epoch 186: 0.591158
training accuracy: 0.750000     test accuracy: 0.666334
Average cost in epoch 187: 0.583559
training accuracy: 0.687500     test accuracy: 0.681319
Average cost in epoch 188: 0.587065
training accuracy: 0.625000     test accuracy: 0.687313
Average cost in epoch 189: 0.578121
training accuracy: 0.750000     test accuracy: 0.677323

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 190: 0.579351
training accuracy: 0.718750     test accuracy: 0.674326
Average cost in epoch 191: 0.584644
training accuracy: 0.875000     test accuracy: 0.678322
Average cost in epoch 192: 0.589780
training accuracy: 0.750000     test accuracy: 0.678322
Average cost in epoch 193: 0.580763
training accuracy: 0.718750     test accuracy: 0.664336
Average cost in epoch 194: 0.577409
training accuracy: 0.750000     test accuracy: 0.675325

dump to weights/att-lstm/att-lstm_11.pkl

Average cost in epoch 195: 0.588056
training accuracy: 0.750000     test accuracy: 0.671329
Average cost in epoch 196: 0.585354
training accuracy: 0.718750     test accuracy: 0.681319
Average cost in epoch 197: 0.578631
training accuracy: 0.718750     test accuracy: 0.676324
Average cost in epoch 198: 0.581950
training accuracy: 0.937500     test accuracy: 0.678322
Average cost in epoch 199: 0.590438
training accuracy: 0.906250     test accuracy: 0.675325

dump to weights/att-lstm/att-lstm_11.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 12, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_12.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 115.88
Starting training...
Average cost in epoch 0: 1.315188
training accuracy: 0.781250     test accuracy: 0.772228
Average cost in epoch 1: 1.107593
training accuracy: 0.718750     test accuracy: 0.772228
Average cost in epoch 2: 1.031453
training accuracy: 0.562500     test accuracy: 0.752248
Average cost in epoch 3: 0.992367
training accuracy: 0.781250     test accuracy: 0.772228
Average cost in epoch 4: 0.972338
training accuracy: 0.625000     test accuracy: 0.768232

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 5: 0.966348
training accuracy: 0.593750     test accuracy: 0.757243
lr decays to 0.009000
Average cost in epoch 6: 0.949402
training accuracy: 0.781250     test accuracy: 0.764236
Average cost in epoch 7: 0.939546
training accuracy: 0.625000     test accuracy: 0.759241
Average cost in epoch 8: 0.925089
training accuracy: 0.781250     test accuracy: 0.772228
Average cost in epoch 9: 0.921739
training accuracy: 0.656250     test accuracy: 0.756244

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 10: 0.899649
training accuracy: 0.718750     test accuracy: 0.765235
lr decays to 0.008100
Average cost in epoch 11: 0.897806
training accuracy: 0.718750     test accuracy: 0.771229
Average cost in epoch 12: 0.892144
training accuracy: 0.750000     test accuracy: 0.760240
Average cost in epoch 13: 0.882648
training accuracy: 0.718750     test accuracy: 0.766234
Average cost in epoch 14: 0.883223
training accuracy: 0.718750     test accuracy: 0.759241

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 15: 0.876649
training accuracy: 0.781250     test accuracy: 0.742258
lr decays to 0.007290
Average cost in epoch 16: 0.862371
training accuracy: 0.750000     test accuracy: 0.767233
Average cost in epoch 17: 0.867154
training accuracy: 0.781250     test accuracy: 0.765235
Average cost in epoch 18: 0.863304
training accuracy: 0.656250     test accuracy: 0.759241
Average cost in epoch 19: 0.853963
training accuracy: 0.812500     test accuracy: 0.769231

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 20: 0.857328
training accuracy: 0.625000     test accuracy: 0.772228
lr decays to 0.006561
Average cost in epoch 21: 0.847769
training accuracy: 0.781250     test accuracy: 0.731269
Average cost in epoch 22: 0.851155
training accuracy: 0.562500     test accuracy: 0.770230
Average cost in epoch 23: 0.847057
training accuracy: 0.593750     test accuracy: 0.749251
Average cost in epoch 24: 0.839472
training accuracy: 0.750000     test accuracy: 0.762238

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 25: 0.839977
training accuracy: 0.718750     test accuracy: 0.742258
lr decays to 0.005905
Average cost in epoch 26: 0.833206
training accuracy: 0.843750     test accuracy: 0.758242
Average cost in epoch 27: 0.839514
training accuracy: 0.656250     test accuracy: 0.747253
Average cost in epoch 28: 0.833641
training accuracy: 0.656250     test accuracy: 0.761239
Average cost in epoch 29: 0.838269
training accuracy: 0.687500     test accuracy: 0.770230

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 30: 0.834595
training accuracy: 0.500000     test accuracy: 0.768232
lr decays to 0.005314
Average cost in epoch 31: 0.815748
training accuracy: 0.843750     test accuracy: 0.759241
Average cost in epoch 32: 0.815046
training accuracy: 0.718750     test accuracy: 0.769231
Average cost in epoch 33: 0.822602
training accuracy: 0.718750     test accuracy: 0.747253
Average cost in epoch 34: 0.805692
training accuracy: 0.625000     test accuracy: 0.766234

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 35: 0.814326
training accuracy: 0.718750     test accuracy: 0.754246
lr decays to 0.004783
Average cost in epoch 36: 0.822205
training accuracy: 0.687500     test accuracy: 0.760240
Average cost in epoch 37: 0.810759
training accuracy: 0.843750     test accuracy: 0.760240
Average cost in epoch 38: 0.809574
training accuracy: 0.875000     test accuracy: 0.753247
Average cost in epoch 39: 0.807530
training accuracy: 0.687500     test accuracy: 0.766234

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 40: 0.809079
training accuracy: 0.750000     test accuracy: 0.768232
lr decays to 0.004305
Average cost in epoch 41: 0.794187
training accuracy: 0.750000     test accuracy: 0.765235
Average cost in epoch 42: 0.803820
training accuracy: 0.687500     test accuracy: 0.760240
Average cost in epoch 43: 0.799608
training accuracy: 0.718750     test accuracy: 0.761239
Average cost in epoch 44: 0.802587
training accuracy: 0.718750     test accuracy: 0.762238

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 45: 0.789124
training accuracy: 0.906250     test accuracy: 0.760240
lr decays to 0.003874
Average cost in epoch 46: 0.785523
training accuracy: 0.718750     test accuracy: 0.749251
Average cost in epoch 47: 0.789400
training accuracy: 0.593750     test accuracy: 0.761239
Average cost in epoch 48: 0.789750
training accuracy: 0.593750     test accuracy: 0.761239
Average cost in epoch 49: 0.798892
training accuracy: 0.562500     test accuracy: 0.730270

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 50: 0.782284
training accuracy: 0.750000     test accuracy: 0.740260
lr decays to 0.003487
Average cost in epoch 51: 0.787233
training accuracy: 0.562500     test accuracy: 0.724276
Average cost in epoch 52: 0.777755
training accuracy: 0.656250     test accuracy: 0.752248
Average cost in epoch 53: 0.771288
training accuracy: 0.750000     test accuracy: 0.755245
Average cost in epoch 54: 0.783365
training accuracy: 0.656250     test accuracy: 0.752248

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 55: 0.776691
training accuracy: 0.656250     test accuracy: 0.765235
lr decays to 0.003138
Average cost in epoch 56: 0.778194
training accuracy: 0.625000     test accuracy: 0.752248
Average cost in epoch 57: 0.772240
training accuracy: 0.750000     test accuracy: 0.743257
Average cost in epoch 58: 0.767497
training accuracy: 0.718750     test accuracy: 0.748252
Average cost in epoch 59: 0.762413
training accuracy: 0.781250     test accuracy: 0.756244

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 60: 0.766226
training accuracy: 0.625000     test accuracy: 0.749251
lr decays to 0.002824
Average cost in epoch 61: 0.759878
training accuracy: 0.812500     test accuracy: 0.750250
Average cost in epoch 62: 0.768071
training accuracy: 0.687500     test accuracy: 0.758242
Average cost in epoch 63: 0.750714
training accuracy: 0.750000     test accuracy: 0.733267
Average cost in epoch 64: 0.747128
training accuracy: 0.593750     test accuracy: 0.758242

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 65: 0.761471
training accuracy: 0.593750     test accuracy: 0.763237
lr decays to 0.002542
Average cost in epoch 66: 0.752678
training accuracy: 0.687500     test accuracy: 0.736264
Average cost in epoch 67: 0.747454
training accuracy: 0.750000     test accuracy: 0.753247
Average cost in epoch 68: 0.756171
training accuracy: 0.718750     test accuracy: 0.734266
Average cost in epoch 69: 0.744250
training accuracy: 0.718750     test accuracy: 0.737263

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 70: 0.751620
training accuracy: 0.656250     test accuracy: 0.747253
lr decays to 0.002288
Average cost in epoch 71: 0.748601
training accuracy: 0.750000     test accuracy: 0.750250
Average cost in epoch 72: 0.742798
training accuracy: 0.718750     test accuracy: 0.746254
Average cost in epoch 73: 0.743680
training accuracy: 0.625000     test accuracy: 0.739261
Average cost in epoch 74: 0.742193
training accuracy: 0.625000     test accuracy: 0.746254

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 75: 0.737821
training accuracy: 0.812500     test accuracy: 0.736264
lr decays to 0.002059
Average cost in epoch 76: 0.734307
training accuracy: 0.687500     test accuracy: 0.762238
Average cost in epoch 77: 0.735804
training accuracy: 0.843750     test accuracy: 0.754246
Average cost in epoch 78: 0.733003
training accuracy: 0.781250     test accuracy: 0.753247
Average cost in epoch 79: 0.740547
training accuracy: 0.656250     test accuracy: 0.730270

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 80: 0.729939
training accuracy: 0.687500     test accuracy: 0.741259
lr decays to 0.001853
Average cost in epoch 81: 0.745137
training accuracy: 0.562500     test accuracy: 0.736264
Average cost in epoch 82: 0.741960
training accuracy: 0.718750     test accuracy: 0.734266
Average cost in epoch 83: 0.712001
training accuracy: 0.562500     test accuracy: 0.739261
Average cost in epoch 84: 0.735555
training accuracy: 0.687500     test accuracy: 0.745255

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 85: 0.712697
training accuracy: 0.750000     test accuracy: 0.745255
lr decays to 0.001668
Average cost in epoch 86: 0.729900
training accuracy: 0.812500     test accuracy: 0.747253
Average cost in epoch 87: 0.719902
training accuracy: 0.531250     test accuracy: 0.734266
Average cost in epoch 88: 0.727503
training accuracy: 0.843750     test accuracy: 0.742258
Average cost in epoch 89: 0.713437
training accuracy: 0.750000     test accuracy: 0.739261

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 90: 0.725330
training accuracy: 0.781250     test accuracy: 0.740260
lr decays to 0.001501
Average cost in epoch 91: 0.711514
training accuracy: 0.781250     test accuracy: 0.746254
Average cost in epoch 92: 0.716187
training accuracy: 0.750000     test accuracy: 0.740260
Average cost in epoch 93: 0.711280
training accuracy: 0.656250     test accuracy: 0.735265
Average cost in epoch 94: 0.726255
training accuracy: 0.781250     test accuracy: 0.743257

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 95: 0.713862
training accuracy: 0.718750     test accuracy: 0.730270
lr decays to 0.001351
Average cost in epoch 96: 0.708030
training accuracy: 0.781250     test accuracy: 0.731269
Average cost in epoch 97: 0.709920
training accuracy: 0.781250     test accuracy: 0.743257
Average cost in epoch 98: 0.716426
training accuracy: 0.781250     test accuracy: 0.727273
Average cost in epoch 99: 0.696973
training accuracy: 0.750000     test accuracy: 0.748252

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 100: 0.714363
training accuracy: 0.656250     test accuracy: 0.739261
lr decays to 0.001216
Average cost in epoch 101: 0.701113
training accuracy: 0.625000     test accuracy: 0.738262
Average cost in epoch 102: 0.691912
training accuracy: 0.812500     test accuracy: 0.742258
Average cost in epoch 103: 0.696350
training accuracy: 0.625000     test accuracy: 0.739261
Average cost in epoch 104: 0.711980
training accuracy: 0.656250     test accuracy: 0.736264

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 105: 0.695367
training accuracy: 0.812500     test accuracy: 0.747253
Average cost in epoch 106: 0.698792
training accuracy: 0.875000     test accuracy: 0.733267
Average cost in epoch 107: 0.710915
training accuracy: 0.656250     test accuracy: 0.737263
Average cost in epoch 108: 0.703251
training accuracy: 0.718750     test accuracy: 0.737263
Average cost in epoch 109: 0.692637
training accuracy: 0.812500     test accuracy: 0.735265

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 110: 0.704601
training accuracy: 0.687500     test accuracy: 0.737263
Average cost in epoch 111: 0.696262
training accuracy: 0.593750     test accuracy: 0.727273
Average cost in epoch 112: 0.698750
training accuracy: 0.718750     test accuracy: 0.730270
Average cost in epoch 113: 0.695376
training accuracy: 0.843750     test accuracy: 0.733267
Average cost in epoch 114: 0.689624
training accuracy: 0.593750     test accuracy: 0.732268

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 115: 0.692745
training accuracy: 0.687500     test accuracy: 0.734266
Average cost in epoch 116: 0.690635
training accuracy: 0.687500     test accuracy: 0.733267
Average cost in epoch 117: 0.694079
training accuracy: 0.750000     test accuracy: 0.733267
Average cost in epoch 118: 0.681744
training accuracy: 0.562500     test accuracy: 0.727273
Average cost in epoch 119: 0.694454
training accuracy: 0.718750     test accuracy: 0.739261

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 120: 0.693417
training accuracy: 0.812500     test accuracy: 0.732268
Average cost in epoch 121: 0.697340
training accuracy: 0.625000     test accuracy: 0.738262
Average cost in epoch 122: 0.692325
training accuracy: 0.843750     test accuracy: 0.737263
Average cost in epoch 123: 0.698910
training accuracy: 0.843750     test accuracy: 0.740260
Average cost in epoch 124: 0.679376
training accuracy: 0.875000     test accuracy: 0.739261

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 125: 0.697185
training accuracy: 0.843750     test accuracy: 0.724276
Average cost in epoch 126: 0.698195
training accuracy: 0.781250     test accuracy: 0.721279
Average cost in epoch 127: 0.692483
training accuracy: 0.812500     test accuracy: 0.719281
Average cost in epoch 128: 0.696449
training accuracy: 0.718750     test accuracy: 0.724276
Average cost in epoch 129: 0.700850
training accuracy: 0.656250     test accuracy: 0.744256

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 130: 0.682497
training accuracy: 0.750000     test accuracy: 0.731269
Average cost in epoch 131: 0.684501
training accuracy: 0.812500     test accuracy: 0.733267
Average cost in epoch 132: 0.682087
training accuracy: 0.718750     test accuracy: 0.727273
Average cost in epoch 133: 0.688480
training accuracy: 0.781250     test accuracy: 0.731269
Average cost in epoch 134: 0.683021
training accuracy: 0.750000     test accuracy: 0.720280

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 135: 0.686696
training accuracy: 0.750000     test accuracy: 0.734266
Average cost in epoch 136: 0.681802
training accuracy: 0.843750     test accuracy: 0.739261
Average cost in epoch 137: 0.681762
training accuracy: 0.781250     test accuracy: 0.733267
Average cost in epoch 138: 0.676443
training accuracy: 0.843750     test accuracy: 0.730270
Average cost in epoch 139: 0.693051
training accuracy: 0.718750     test accuracy: 0.736264

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 140: 0.688501
training accuracy: 0.750000     test accuracy: 0.738262
Average cost in epoch 141: 0.684978
training accuracy: 0.687500     test accuracy: 0.731269
Average cost in epoch 142: 0.675545
training accuracy: 0.781250     test accuracy: 0.734266
Average cost in epoch 143: 0.685792
training accuracy: 0.781250     test accuracy: 0.736264
Average cost in epoch 144: 0.680289
training accuracy: 0.843750     test accuracy: 0.732268

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 145: 0.685645
training accuracy: 0.656250     test accuracy: 0.730270
Average cost in epoch 146: 0.676533
training accuracy: 0.750000     test accuracy: 0.730270
Average cost in epoch 147: 0.679114
training accuracy: 0.687500     test accuracy: 0.726274
Average cost in epoch 148: 0.690397
training accuracy: 0.843750     test accuracy: 0.726274
Average cost in epoch 149: 0.681485
training accuracy: 0.656250     test accuracy: 0.735265

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 150: 0.678873
training accuracy: 0.593750     test accuracy: 0.728272
Average cost in epoch 151: 0.689419
training accuracy: 0.718750     test accuracy: 0.716284
Average cost in epoch 152: 0.682893
training accuracy: 0.812500     test accuracy: 0.731269
Average cost in epoch 153: 0.681918
training accuracy: 0.687500     test accuracy: 0.735265
Average cost in epoch 154: 0.679063
training accuracy: 0.656250     test accuracy: 0.729271

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 155: 0.678588
training accuracy: 0.750000     test accuracy: 0.722278
Average cost in epoch 156: 0.675490
training accuracy: 0.781250     test accuracy: 0.726274
Average cost in epoch 157: 0.689662
training accuracy: 0.750000     test accuracy: 0.737263
Average cost in epoch 158: 0.670839
training accuracy: 0.656250     test accuracy: 0.737263
Average cost in epoch 159: 0.681196
training accuracy: 0.687500     test accuracy: 0.732268

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 160: 0.682841
training accuracy: 0.718750     test accuracy: 0.730270
Average cost in epoch 161: 0.671216
training accuracy: 0.812500     test accuracy: 0.733267
Average cost in epoch 162: 0.678897
training accuracy: 0.812500     test accuracy: 0.729271
Average cost in epoch 163: 0.678222
training accuracy: 0.718750     test accuracy: 0.729271
Average cost in epoch 164: 0.674600
training accuracy: 0.781250     test accuracy: 0.736264

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 165: 0.683163
training accuracy: 0.750000     test accuracy: 0.738262
Average cost in epoch 166: 0.674718
training accuracy: 0.718750     test accuracy: 0.719281
Average cost in epoch 167: 0.667900
training accuracy: 0.625000     test accuracy: 0.721279
Average cost in epoch 168: 0.672488
training accuracy: 0.781250     test accuracy: 0.730270
Average cost in epoch 169: 0.685769
training accuracy: 0.656250     test accuracy: 0.730270

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 170: 0.674535
training accuracy: 0.812500     test accuracy: 0.742258
Average cost in epoch 171: 0.674463
training accuracy: 0.812500     test accuracy: 0.735265
Average cost in epoch 172: 0.672583
training accuracy: 0.593750     test accuracy: 0.730270
Average cost in epoch 173: 0.676570
training accuracy: 0.718750     test accuracy: 0.731269
Average cost in epoch 174: 0.677779
training accuracy: 0.812500     test accuracy: 0.733267

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 175: 0.666702
training accuracy: 0.687500     test accuracy: 0.732268
Average cost in epoch 176: 0.679209
training accuracy: 0.562500     test accuracy: 0.724276
Average cost in epoch 177: 0.687283
training accuracy: 0.875000     test accuracy: 0.730270
Average cost in epoch 178: 0.662895
training accuracy: 0.781250     test accuracy: 0.736264
Average cost in epoch 179: 0.676212
training accuracy: 0.750000     test accuracy: 0.725275

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 180: 0.663001
training accuracy: 0.812500     test accuracy: 0.730270
Average cost in epoch 181: 0.672092
training accuracy: 0.750000     test accuracy: 0.732268
Average cost in epoch 182: 0.672262
training accuracy: 0.781250     test accuracy: 0.719281
Average cost in epoch 183: 0.684340
training accuracy: 0.718750     test accuracy: 0.723277
Average cost in epoch 184: 0.672636
training accuracy: 0.687500     test accuracy: 0.723277

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 185: 0.675214
training accuracy: 0.750000     test accuracy: 0.723277
Average cost in epoch 186: 0.670079
training accuracy: 0.875000     test accuracy: 0.744256
Average cost in epoch 187: 0.662221
training accuracy: 0.656250     test accuracy: 0.729271
Average cost in epoch 188: 0.667538
training accuracy: 0.750000     test accuracy: 0.733267
Average cost in epoch 189: 0.665286
training accuracy: 0.562500     test accuracy: 0.731269

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 190: 0.660771
training accuracy: 0.718750     test accuracy: 0.734266
Average cost in epoch 191: 0.673785
training accuracy: 0.750000     test accuracy: 0.721279
Average cost in epoch 192: 0.677145
training accuracy: 0.718750     test accuracy: 0.731269
Average cost in epoch 193: 0.680510
training accuracy: 0.875000     test accuracy: 0.728272
Average cost in epoch 194: 0.674099
training accuracy: 0.718750     test accuracy: 0.725275

dump to weights/att-lstm/att-lstm_12.pkl

Average cost in epoch 195: 0.679201
training accuracy: 0.781250     test accuracy: 0.725275
Average cost in epoch 196: 0.660311
training accuracy: 0.593750     test accuracy: 0.726274
Average cost in epoch 197: 0.669923
training accuracy: 0.843750     test accuracy: 0.726274
Average cost in epoch 198: 0.672313
training accuracy: 0.687500     test accuracy: 0.737263
Average cost in epoch 199: 0.676818
training accuracy: 0.843750     test accuracy: 0.734266

dump to weights/att-lstm/att-lstm_12.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 13, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_13.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 118.84
Starting training...
Average cost in epoch 0: 0.750738
training accuracy: 0.937500     test accuracy: 0.944056
Average cost in epoch 1: 0.504989
training accuracy: 1.000000     test accuracy: 0.944056
Average cost in epoch 2: 0.455841
training accuracy: 0.937500     test accuracy: 0.944056
Average cost in epoch 3: 0.435494
training accuracy: 0.968750     test accuracy: 0.944056
Average cost in epoch 4: 0.421170
training accuracy: 0.968750     test accuracy: 0.944056

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 5: 0.408822
training accuracy: 0.937500     test accuracy: 0.944056
lr decays to 0.009000
Average cost in epoch 6: 0.404996
training accuracy: 0.937500     test accuracy: 0.944056
Average cost in epoch 7: 0.395359
training accuracy: 0.875000     test accuracy: 0.944056
Average cost in epoch 8: 0.390889
training accuracy: 0.937500     test accuracy: 0.944056
Average cost in epoch 9: 0.397342
training accuracy: 0.937500     test accuracy: 0.944056

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 10: 0.392148
training accuracy: 0.937500     test accuracy: 0.944056
lr decays to 0.008100
Average cost in epoch 11: 0.381310
training accuracy: 0.937500     test accuracy: 0.944056
Average cost in epoch 12: 0.381420
training accuracy: 0.937500     test accuracy: 0.944056
Average cost in epoch 13: 0.374162
training accuracy: 1.000000     test accuracy: 0.944056
Average cost in epoch 14: 0.380068
training accuracy: 0.906250     test accuracy: 0.944056

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 15: 0.374022
training accuracy: 1.000000     test accuracy: 0.936064
lr decays to 0.007290
Average cost in epoch 16: 0.374871
training accuracy: 0.968750     test accuracy: 0.944056
Average cost in epoch 17: 0.370077
training accuracy: 0.968750     test accuracy: 0.944056
Average cost in epoch 18: 0.364701
training accuracy: 0.968750     test accuracy: 0.943057
Average cost in epoch 19: 0.364029
training accuracy: 0.937500     test accuracy: 0.944056

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 20: 0.363843
training accuracy: 1.000000     test accuracy: 0.944056
lr decays to 0.006561
Average cost in epoch 21: 0.361125
training accuracy: 0.937500     test accuracy: 0.944056
Average cost in epoch 22: 0.360668
training accuracy: 0.968750     test accuracy: 0.944056
Average cost in epoch 23: 0.349257
training accuracy: 1.000000     test accuracy: 0.942058
Average cost in epoch 24: 0.348489
training accuracy: 0.968750     test accuracy: 0.944056

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 25: 0.352195
training accuracy: 0.906250     test accuracy: 0.944056
lr decays to 0.005905
Average cost in epoch 26: 0.347825
training accuracy: 0.812500     test accuracy: 0.944056
Average cost in epoch 27: 0.337399
training accuracy: 0.875000     test accuracy: 0.943057
Average cost in epoch 28: 0.336026
training accuracy: 0.968750     test accuracy: 0.943057
Average cost in epoch 29: 0.342645
training accuracy: 1.000000     test accuracy: 0.943057

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 30: 0.338435
training accuracy: 0.968750     test accuracy: 0.944056
lr decays to 0.005314
Average cost in epoch 31: 0.344908
training accuracy: 0.937500     test accuracy: 0.944056
Average cost in epoch 32: 0.325810
training accuracy: 0.843750     test accuracy: 0.944056
Average cost in epoch 33: 0.335885
training accuracy: 0.937500     test accuracy: 0.943057
Average cost in epoch 34: 0.336587
training accuracy: 0.968750     test accuracy: 0.940060

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 35: 0.328474
training accuracy: 0.937500     test accuracy: 0.943057
lr decays to 0.004783
Average cost in epoch 36: 0.328141
training accuracy: 0.906250     test accuracy: 0.942058
Average cost in epoch 37: 0.324435
training accuracy: 0.843750     test accuracy: 0.943057
Average cost in epoch 38: 0.334443
training accuracy: 0.937500     test accuracy: 0.941059
Average cost in epoch 39: 0.323714
training accuracy: 0.937500     test accuracy: 0.942058

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 40: 0.327434
training accuracy: 1.000000     test accuracy: 0.944056
lr decays to 0.004305
Average cost in epoch 41: 0.319548
training accuracy: 0.968750     test accuracy: 0.944056
Average cost in epoch 42: 0.322545
training accuracy: 0.968750     test accuracy: 0.942058
Average cost in epoch 43: 0.323938
training accuracy: 0.875000     test accuracy: 0.941059
Average cost in epoch 44: 0.317316
training accuracy: 0.906250     test accuracy: 0.942058

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 45: 0.310574
training accuracy: 0.906250     test accuracy: 0.941059
lr decays to 0.003874
Average cost in epoch 46: 0.318732
training accuracy: 0.968750     test accuracy: 0.942058
Average cost in epoch 47: 0.309535
training accuracy: 0.906250     test accuracy: 0.941059
Average cost in epoch 48: 0.316488
training accuracy: 0.968750     test accuracy: 0.942058
Average cost in epoch 49: 0.304101
training accuracy: 0.937500     test accuracy: 0.942058

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 50: 0.306440
training accuracy: 0.875000     test accuracy: 0.941059
lr decays to 0.003487
Average cost in epoch 51: 0.301874
training accuracy: 0.968750     test accuracy: 0.943057
Average cost in epoch 52: 0.301758
training accuracy: 0.906250     test accuracy: 0.939061
Average cost in epoch 53: 0.298605
training accuracy: 0.968750     test accuracy: 0.941059
Average cost in epoch 54: 0.300322
training accuracy: 0.937500     test accuracy: 0.937063

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 55: 0.297713
training accuracy: 0.968750     test accuracy: 0.938062
lr decays to 0.003138
Average cost in epoch 56: 0.307418
training accuracy: 0.812500     test accuracy: 0.940060
Average cost in epoch 57: 0.287641
training accuracy: 0.937500     test accuracy: 0.940060
Average cost in epoch 58: 0.292066
training accuracy: 0.906250     test accuracy: 0.941059
Average cost in epoch 59: 0.300600
training accuracy: 0.937500     test accuracy: 0.939061

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 60: 0.289800
training accuracy: 0.875000     test accuracy: 0.942058
lr decays to 0.002824
Average cost in epoch 61: 0.290661
training accuracy: 0.937500     test accuracy: 0.943057
Average cost in epoch 62: 0.291950
training accuracy: 0.937500     test accuracy: 0.941059
Average cost in epoch 63: 0.299252
training accuracy: 0.937500     test accuracy: 0.941059
Average cost in epoch 64: 0.279405
training accuracy: 0.937500     test accuracy: 0.940060

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 65: 0.281471
training accuracy: 0.937500     test accuracy: 0.939061
lr decays to 0.002542
Average cost in epoch 66: 0.283182
training accuracy: 0.843750     test accuracy: 0.940060
Average cost in epoch 67: 0.291266
training accuracy: 0.906250     test accuracy: 0.937063
Average cost in epoch 68: 0.282176
training accuracy: 0.968750     test accuracy: 0.940060
Average cost in epoch 69: 0.280747
training accuracy: 0.968750     test accuracy: 0.942058

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 70: 0.280994
training accuracy: 0.968750     test accuracy: 0.941059
lr decays to 0.002288
Average cost in epoch 71: 0.288295
training accuracy: 0.968750     test accuracy: 0.940060
Average cost in epoch 72: 0.277532
training accuracy: 0.875000     test accuracy: 0.941059
Average cost in epoch 73: 0.271683
training accuracy: 0.937500     test accuracy: 0.937063
Average cost in epoch 74: 0.281955
training accuracy: 0.875000     test accuracy: 0.941059

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 75: 0.271990
training accuracy: 0.906250     test accuracy: 0.939061
lr decays to 0.002059
Average cost in epoch 76: 0.277436
training accuracy: 0.937500     test accuracy: 0.939061
Average cost in epoch 77: 0.270653
training accuracy: 1.000000     test accuracy: 0.939061
Average cost in epoch 78: 0.280874
training accuracy: 0.968750     test accuracy: 0.939061
Average cost in epoch 79: 0.258171
training accuracy: 1.000000     test accuracy: 0.938062

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 80: 0.271254
training accuracy: 0.906250     test accuracy: 0.940060
lr decays to 0.001853
Average cost in epoch 81: 0.259764
training accuracy: 0.968750     test accuracy: 0.939061
Average cost in epoch 82: 0.269653
training accuracy: 0.812500     test accuracy: 0.940060
Average cost in epoch 83: 0.265789
training accuracy: 0.937500     test accuracy: 0.939061
Average cost in epoch 84: 0.262835
training accuracy: 0.937500     test accuracy: 0.937063

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 85: 0.264735
training accuracy: 0.937500     test accuracy: 0.939061
lr decays to 0.001668
Average cost in epoch 86: 0.257554
training accuracy: 0.968750     test accuracy: 0.938062
Average cost in epoch 87: 0.261013
training accuracy: 0.968750     test accuracy: 0.938062
Average cost in epoch 88: 0.256891
training accuracy: 0.937500     test accuracy: 0.938062
Average cost in epoch 89: 0.258372
training accuracy: 0.968750     test accuracy: 0.940060

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 90: 0.245781
training accuracy: 0.906250     test accuracy: 0.939061
lr decays to 0.001501
Average cost in epoch 91: 0.257955
training accuracy: 1.000000     test accuracy: 0.938062
Average cost in epoch 92: 0.258788
training accuracy: 0.937500     test accuracy: 0.940060
Average cost in epoch 93: 0.244547
training accuracy: 0.968750     test accuracy: 0.939061
Average cost in epoch 94: 0.260919
training accuracy: 0.968750     test accuracy: 0.940060

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 95: 0.256069
training accuracy: 1.000000     test accuracy: 0.939061
lr decays to 0.001351
Average cost in epoch 96: 0.253617
training accuracy: 0.968750     test accuracy: 0.938062
Average cost in epoch 97: 0.249346
training accuracy: 0.968750     test accuracy: 0.939061
Average cost in epoch 98: 0.244108
training accuracy: 0.875000     test accuracy: 0.938062
Average cost in epoch 99: 0.256677
training accuracy: 0.968750     test accuracy: 0.937063

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 100: 0.246043
training accuracy: 1.000000     test accuracy: 0.939061
lr decays to 0.001216
Average cost in epoch 101: 0.249232
training accuracy: 0.875000     test accuracy: 0.937063
Average cost in epoch 102: 0.247007
training accuracy: 0.937500     test accuracy: 0.939061
Average cost in epoch 103: 0.240611
training accuracy: 0.968750     test accuracy: 0.938062
Average cost in epoch 104: 0.247086
training accuracy: 1.000000     test accuracy: 0.938062

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 105: 0.239235
training accuracy: 0.968750     test accuracy: 0.938062
Average cost in epoch 106: 0.246154
training accuracy: 0.937500     test accuracy: 0.938062
Average cost in epoch 107: 0.252346
training accuracy: 0.937500     test accuracy: 0.938062
Average cost in epoch 108: 0.244055
training accuracy: 0.937500     test accuracy: 0.939061
Average cost in epoch 109: 0.238351
training accuracy: 0.906250     test accuracy: 0.936064

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 110: 0.249411
training accuracy: 0.968750     test accuracy: 0.937063
Average cost in epoch 111: 0.236543
training accuracy: 0.937500     test accuracy: 0.938062
Average cost in epoch 112: 0.245237
training accuracy: 0.968750     test accuracy: 0.938062
Average cost in epoch 113: 0.233444
training accuracy: 0.906250     test accuracy: 0.937063
Average cost in epoch 114: 0.239880
training accuracy: 0.906250     test accuracy: 0.938062

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 115: 0.238518
training accuracy: 0.968750     test accuracy: 0.940060
Average cost in epoch 116: 0.239667
training accuracy: 0.968750     test accuracy: 0.937063
Average cost in epoch 117: 0.235424
training accuracy: 1.000000     test accuracy: 0.937063
Average cost in epoch 118: 0.235501
training accuracy: 0.937500     test accuracy: 0.938062
Average cost in epoch 119: 0.235444
training accuracy: 0.937500     test accuracy: 0.935065

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 120: 0.235021
training accuracy: 0.906250     test accuracy: 0.937063
Average cost in epoch 121: 0.236317
training accuracy: 0.937500     test accuracy: 0.938062
Average cost in epoch 122: 0.233702
training accuracy: 0.968750     test accuracy: 0.938062
Average cost in epoch 123: 0.233505
training accuracy: 0.906250     test accuracy: 0.937063
Average cost in epoch 124: 0.237969
training accuracy: 0.937500     test accuracy: 0.940060

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 125: 0.226547
training accuracy: 0.906250     test accuracy: 0.937063
Average cost in epoch 126: 0.238173
training accuracy: 0.937500     test accuracy: 0.939061
Average cost in epoch 127: 0.227946
training accuracy: 0.968750     test accuracy: 0.937063
Average cost in epoch 128: 0.235241
training accuracy: 0.968750     test accuracy: 0.936064
Average cost in epoch 129: 0.237458
training accuracy: 0.937500     test accuracy: 0.934066

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 130: 0.236495
training accuracy: 0.968750     test accuracy: 0.936064
Average cost in epoch 131: 0.232441
training accuracy: 0.906250     test accuracy: 0.935065
Average cost in epoch 132: 0.231901
training accuracy: 1.000000     test accuracy: 0.936064
Average cost in epoch 133: 0.236166
training accuracy: 0.937500     test accuracy: 0.937063
Average cost in epoch 134: 0.222973
training accuracy: 0.968750     test accuracy: 0.937063

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 135: 0.230546
training accuracy: 0.968750     test accuracy: 0.935065
Average cost in epoch 136: 0.232842
training accuracy: 0.937500     test accuracy: 0.938062
Average cost in epoch 137: 0.225403
training accuracy: 0.968750     test accuracy: 0.940060
Average cost in epoch 138: 0.230229
training accuracy: 0.906250     test accuracy: 0.937063
Average cost in epoch 139: 0.238580
training accuracy: 0.937500     test accuracy: 0.932068

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 140: 0.221824
training accuracy: 0.968750     test accuracy: 0.932068
Average cost in epoch 141: 0.228871
training accuracy: 0.937500     test accuracy: 0.937063
Average cost in epoch 142: 0.223926
training accuracy: 0.968750     test accuracy: 0.938062
Average cost in epoch 143: 0.236895
training accuracy: 0.875000     test accuracy: 0.938062
Average cost in epoch 144: 0.232390
training accuracy: 0.937500     test accuracy: 0.936064

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 145: 0.234609
training accuracy: 0.937500     test accuracy: 0.939061
Average cost in epoch 146: 0.228470
training accuracy: 0.937500     test accuracy: 0.935065
Average cost in epoch 147: 0.227417
training accuracy: 0.968750     test accuracy: 0.938062
Average cost in epoch 148: 0.223674
training accuracy: 0.968750     test accuracy: 0.937063
Average cost in epoch 149: 0.226771
training accuracy: 0.937500     test accuracy: 0.937063

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 150: 0.224138
training accuracy: 0.843750     test accuracy: 0.939061
Average cost in epoch 151: 0.224978
training accuracy: 0.937500     test accuracy: 0.938062
Average cost in epoch 152: 0.223764
training accuracy: 0.937500     test accuracy: 0.938062
Average cost in epoch 153: 0.223385
training accuracy: 0.937500     test accuracy: 0.937063
Average cost in epoch 154: 0.226122
training accuracy: 0.906250     test accuracy: 0.937063

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 155: 0.228784
training accuracy: 1.000000     test accuracy: 0.936064
Average cost in epoch 156: 0.222936
training accuracy: 0.906250     test accuracy: 0.936064
Average cost in epoch 157: 0.219892
training accuracy: 0.875000     test accuracy: 0.936064
Average cost in epoch 158: 0.221990
training accuracy: 0.968750     test accuracy: 0.937063
Average cost in epoch 159: 0.214365
training accuracy: 0.875000     test accuracy: 0.937063

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 160: 0.231161
training accuracy: 0.875000     test accuracy: 0.932068
Average cost in epoch 161: 0.215757
training accuracy: 0.937500     test accuracy: 0.935065
Average cost in epoch 162: 0.221674
training accuracy: 0.937500     test accuracy: 0.935065
Average cost in epoch 163: 0.225857
training accuracy: 1.000000     test accuracy: 0.935065
Average cost in epoch 164: 0.224815
training accuracy: 0.968750     test accuracy: 0.936064

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 165: 0.223047
training accuracy: 0.937500     test accuracy: 0.935065
Average cost in epoch 166: 0.216834
training accuracy: 0.937500     test accuracy: 0.935065
Average cost in epoch 167: 0.226940
training accuracy: 0.968750     test accuracy: 0.936064
Average cost in epoch 168: 0.213851
training accuracy: 0.937500     test accuracy: 0.936064
Average cost in epoch 169: 0.238227
training accuracy: 0.812500     test accuracy: 0.934066

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 170: 0.211164
training accuracy: 0.875000     test accuracy: 0.936064
Average cost in epoch 171: 0.222492
training accuracy: 0.906250     test accuracy: 0.936064
Average cost in epoch 172: 0.218529
training accuracy: 1.000000     test accuracy: 0.934066
Average cost in epoch 173: 0.212289
training accuracy: 0.968750     test accuracy: 0.935065
Average cost in epoch 174: 0.231799
training accuracy: 1.000000     test accuracy: 0.934066

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 175: 0.201052
training accuracy: 0.875000     test accuracy: 0.933067
Average cost in epoch 176: 0.228412
training accuracy: 0.906250     test accuracy: 0.934066
Average cost in epoch 177: 0.220454
training accuracy: 1.000000     test accuracy: 0.936064
Average cost in epoch 178: 0.215147
training accuracy: 1.000000     test accuracy: 0.934066
Average cost in epoch 179: 0.214439
training accuracy: 0.937500     test accuracy: 0.933067

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 180: 0.222186
training accuracy: 0.875000     test accuracy: 0.934066
Average cost in epoch 181: 0.214549
training accuracy: 0.906250     test accuracy: 0.936064
Average cost in epoch 182: 0.224762
training accuracy: 0.968750     test accuracy: 0.935065
Average cost in epoch 183: 0.207616
training accuracy: 1.000000     test accuracy: 0.936064
Average cost in epoch 184: 0.223207
training accuracy: 0.906250     test accuracy: 0.931069

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 185: 0.218276
training accuracy: 0.968750     test accuracy: 0.936064
Average cost in epoch 186: 0.219351
training accuracy: 1.000000     test accuracy: 0.935065
Average cost in epoch 187: 0.218530
training accuracy: 0.968750     test accuracy: 0.936064
Average cost in epoch 188: 0.217172
training accuracy: 0.937500     test accuracy: 0.934066
Average cost in epoch 189: 0.210665
training accuracy: 1.000000     test accuracy: 0.938062

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 190: 0.221645
training accuracy: 0.937500     test accuracy: 0.928072
Average cost in epoch 191: 0.213946
training accuracy: 0.968750     test accuracy: 0.932068
Average cost in epoch 192: 0.218013
training accuracy: 0.906250     test accuracy: 0.938062
Average cost in epoch 193: 0.198751
training accuracy: 0.937500     test accuracy: 0.934066
Average cost in epoch 194: 0.232499
training accuracy: 0.937500     test accuracy: 0.930070

dump to weights/att-lstm/att-lstm_13.pkl

Average cost in epoch 195: 0.213089
training accuracy: 0.937500     test accuracy: 0.936064
Average cost in epoch 196: 0.212743
training accuracy: 0.937500     test accuracy: 0.935065
Average cost in epoch 197: 0.215169
training accuracy: 1.000000     test accuracy: 0.933067
Average cost in epoch 198: 0.216826
training accuracy: 0.875000     test accuracy: 0.934066
Average cost in epoch 199: 0.211298
training accuracy: 0.968750     test accuracy: 0.935065

dump to weights/att-lstm/att-lstm_13.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 14, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_14.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 117.45
Starting training...
Average cost in epoch 0: 1.808648
training accuracy: 0.312500     test accuracy: 0.316683
Average cost in epoch 1: 1.664813
training accuracy: 0.343750     test accuracy: 0.359640
Average cost in epoch 2: 1.602931
training accuracy: 0.375000     test accuracy: 0.370629
Average cost in epoch 3: 1.561261
training accuracy: 0.250000     test accuracy: 0.370629
Average cost in epoch 4: 1.536409
training accuracy: 0.250000     test accuracy: 0.408591

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 5: 1.510410
training accuracy: 0.312500     test accuracy: 0.415584
lr decays to 0.009000
Average cost in epoch 6: 1.486106
training accuracy: 0.500000     test accuracy: 0.421578
Average cost in epoch 7: 1.465456
training accuracy: 0.312500     test accuracy: 0.454545
Average cost in epoch 8: 1.459139
training accuracy: 0.406250     test accuracy: 0.450549
Average cost in epoch 9: 1.440371
training accuracy: 0.531250     test accuracy: 0.421578

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 10: 1.439716
training accuracy: 0.406250     test accuracy: 0.428571
lr decays to 0.008100
Average cost in epoch 11: 1.407870
training accuracy: 0.562500     test accuracy: 0.450549
Average cost in epoch 12: 1.401471
training accuracy: 0.437500     test accuracy: 0.432567
Average cost in epoch 13: 1.400658
training accuracy: 0.343750     test accuracy: 0.455544
Average cost in epoch 14: 1.399491
training accuracy: 0.500000     test accuracy: 0.429570

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 15: 1.387723
training accuracy: 0.531250     test accuracy: 0.427572
lr decays to 0.007290
Average cost in epoch 16: 1.379894
training accuracy: 0.500000     test accuracy: 0.446553
Average cost in epoch 17: 1.368175
training accuracy: 0.500000     test accuracy: 0.454545
Average cost in epoch 18: 1.372910
training accuracy: 0.250000     test accuracy: 0.437562
Average cost in epoch 19: 1.368985
training accuracy: 0.468750     test accuracy: 0.445554

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 20: 1.367616
training accuracy: 0.375000     test accuracy: 0.424575
lr decays to 0.006561
Average cost in epoch 21: 1.357986
training accuracy: 0.406250     test accuracy: 0.454545
Average cost in epoch 22: 1.355747
training accuracy: 0.375000     test accuracy: 0.449550
Average cost in epoch 23: 1.345604
training accuracy: 0.281250     test accuracy: 0.446553
Average cost in epoch 24: 1.346439
training accuracy: 0.406250     test accuracy: 0.447552

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 25: 1.345616
training accuracy: 0.468750     test accuracy: 0.444555
lr decays to 0.005905
Average cost in epoch 26: 1.332837
training accuracy: 0.468750     test accuracy: 0.440559
Average cost in epoch 27: 1.324358
training accuracy: 0.468750     test accuracy: 0.418581
Average cost in epoch 28: 1.321125
training accuracy: 0.656250     test accuracy: 0.439560
Average cost in epoch 29: 1.323772
training accuracy: 0.500000     test accuracy: 0.448551

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 30: 1.323763
training accuracy: 0.406250     test accuracy: 0.453546
lr decays to 0.005314
Average cost in epoch 31: 1.320508
training accuracy: 0.312500     test accuracy: 0.457542
Average cost in epoch 32: 1.312636
training accuracy: 0.500000     test accuracy: 0.471528
Average cost in epoch 33: 1.309764
training accuracy: 0.406250     test accuracy: 0.432567
Average cost in epoch 34: 1.299793
training accuracy: 0.437500     test accuracy: 0.444555

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 35: 1.299984
training accuracy: 0.406250     test accuracy: 0.450549
lr decays to 0.004783
Average cost in epoch 36: 1.295580
training accuracy: 0.468750     test accuracy: 0.468531
Average cost in epoch 37: 1.296962
training accuracy: 0.343750     test accuracy: 0.443556
Average cost in epoch 38: 1.298448
training accuracy: 0.343750     test accuracy: 0.443556
Average cost in epoch 39: 1.296858
training accuracy: 0.406250     test accuracy: 0.456543

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 40: 1.286073
training accuracy: 0.406250     test accuracy: 0.440559
lr decays to 0.004305
Average cost in epoch 41: 1.288313
training accuracy: 0.500000     test accuracy: 0.432567
Average cost in epoch 42: 1.286135
training accuracy: 0.468750     test accuracy: 0.445554
Average cost in epoch 43: 1.282890
training accuracy: 0.375000     test accuracy: 0.441558
Average cost in epoch 44: 1.285652
training accuracy: 0.406250     test accuracy: 0.438561

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 45: 1.279942
training accuracy: 0.437500     test accuracy: 0.461538
lr decays to 0.003874
Average cost in epoch 46: 1.275236
training accuracy: 0.531250     test accuracy: 0.458541
Average cost in epoch 47: 1.262334
training accuracy: 0.625000     test accuracy: 0.444555
Average cost in epoch 48: 1.266604
training accuracy: 0.437500     test accuracy: 0.443556
Average cost in epoch 49: 1.270221
training accuracy: 0.468750     test accuracy: 0.458541

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 50: 1.264548
training accuracy: 0.312500     test accuracy: 0.457542
lr decays to 0.003487
Average cost in epoch 51: 1.259897
training accuracy: 0.500000     test accuracy: 0.450549
Average cost in epoch 52: 1.262845
training accuracy: 0.500000     test accuracy: 0.442557
Average cost in epoch 53: 1.259998
training accuracy: 0.406250     test accuracy: 0.438561
Average cost in epoch 54: 1.263468
training accuracy: 0.281250     test accuracy: 0.441558

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 55: 1.255146
training accuracy: 0.750000     test accuracy: 0.448551
lr decays to 0.003138
Average cost in epoch 56: 1.258470
training accuracy: 0.437500     test accuracy: 0.452547
Average cost in epoch 57: 1.246903
training accuracy: 0.531250     test accuracy: 0.439560
Average cost in epoch 58: 1.250938
training accuracy: 0.593750     test accuracy: 0.432567
Average cost in epoch 59: 1.244039
training accuracy: 0.468750     test accuracy: 0.447552

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 60: 1.247032
training accuracy: 0.250000     test accuracy: 0.444555
lr decays to 0.002824
Average cost in epoch 61: 1.241055
training accuracy: 0.437500     test accuracy: 0.427572
Average cost in epoch 62: 1.247842
training accuracy: 0.687500     test accuracy: 0.439560
Average cost in epoch 63: 1.233545
training accuracy: 0.531250     test accuracy: 0.439560
Average cost in epoch 64: 1.233359
training accuracy: 0.531250     test accuracy: 0.435564

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 65: 1.232736
training accuracy: 0.593750     test accuracy: 0.439560
lr decays to 0.002542
Average cost in epoch 66: 1.239074
training accuracy: 0.625000     test accuracy: 0.435564
Average cost in epoch 67: 1.232775
training accuracy: 0.312500     test accuracy: 0.447552
Average cost in epoch 68: 1.229931
training accuracy: 0.468750     test accuracy: 0.446553
Average cost in epoch 69: 1.231688
training accuracy: 0.375000     test accuracy: 0.453546

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 70: 1.232670
training accuracy: 0.531250     test accuracy: 0.433566
lr decays to 0.002288
Average cost in epoch 71: 1.230830
training accuracy: 0.468750     test accuracy: 0.441558
Average cost in epoch 72: 1.221653
training accuracy: 0.656250     test accuracy: 0.441558
Average cost in epoch 73: 1.229911
training accuracy: 0.562500     test accuracy: 0.447552
Average cost in epoch 74: 1.230105
training accuracy: 0.468750     test accuracy: 0.433566

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 75: 1.217279
training accuracy: 0.500000     test accuracy: 0.436563
lr decays to 0.002059
Average cost in epoch 76: 1.214892
training accuracy: 0.531250     test accuracy: 0.454545
Average cost in epoch 77: 1.207593
training accuracy: 0.437500     test accuracy: 0.438561
Average cost in epoch 78: 1.217855
training accuracy: 0.375000     test accuracy: 0.440559
Average cost in epoch 79: 1.213027
training accuracy: 0.500000     test accuracy: 0.429570

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 80: 1.218014
training accuracy: 0.406250     test accuracy: 0.447552
lr decays to 0.001853
Average cost in epoch 81: 1.207623
training accuracy: 0.562500     test accuracy: 0.444555
Average cost in epoch 82: 1.204996
training accuracy: 0.593750     test accuracy: 0.439560
Average cost in epoch 83: 1.202391
training accuracy: 0.437500     test accuracy: 0.441558
Average cost in epoch 84: 1.206806
training accuracy: 0.656250     test accuracy: 0.437562

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 85: 1.211319
training accuracy: 0.437500     test accuracy: 0.429570
lr decays to 0.001668
Average cost in epoch 86: 1.206132
training accuracy: 0.500000     test accuracy: 0.434565
Average cost in epoch 87: 1.196825
training accuracy: 0.562500     test accuracy: 0.440559
Average cost in epoch 88: 1.193525
training accuracy: 0.437500     test accuracy: 0.428571
Average cost in epoch 89: 1.193326
training accuracy: 0.437500     test accuracy: 0.442557

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 90: 1.192665
training accuracy: 0.500000     test accuracy: 0.434565
lr decays to 0.001501
Average cost in epoch 91: 1.194508
training accuracy: 0.468750     test accuracy: 0.423576
Average cost in epoch 92: 1.198572
training accuracy: 0.593750     test accuracy: 0.434565
Average cost in epoch 93: 1.196186
training accuracy: 0.500000     test accuracy: 0.447552
Average cost in epoch 94: 1.184756
training accuracy: 0.625000     test accuracy: 0.445554

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 95: 1.187527
training accuracy: 0.562500     test accuracy: 0.425574
lr decays to 0.001351
Average cost in epoch 96: 1.191872
training accuracy: 0.562500     test accuracy: 0.428571
Average cost in epoch 97: 1.182795
training accuracy: 0.468750     test accuracy: 0.424575
Average cost in epoch 98: 1.190543
training accuracy: 0.593750     test accuracy: 0.426573
Average cost in epoch 99: 1.185854
training accuracy: 0.500000     test accuracy: 0.423576

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 100: 1.188746
training accuracy: 0.562500     test accuracy: 0.436563
lr decays to 0.001216
Average cost in epoch 101: 1.194719
training accuracy: 0.468750     test accuracy: 0.430569
Average cost in epoch 102: 1.179858
training accuracy: 0.593750     test accuracy: 0.426573
Average cost in epoch 103: 1.186765
training accuracy: 0.656250     test accuracy: 0.431568
Average cost in epoch 104: 1.195682
training accuracy: 0.625000     test accuracy: 0.429570

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 105: 1.171853
training accuracy: 0.562500     test accuracy: 0.437562
Average cost in epoch 106: 1.177073
training accuracy: 0.562500     test accuracy: 0.421578
Average cost in epoch 107: 1.182981
training accuracy: 0.562500     test accuracy: 0.426573
Average cost in epoch 108: 1.189408
training accuracy: 0.500000     test accuracy: 0.434565
Average cost in epoch 109: 1.175068
training accuracy: 0.656250     test accuracy: 0.440559

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 110: 1.185318
training accuracy: 0.593750     test accuracy: 0.443556
Average cost in epoch 111: 1.172310
training accuracy: 0.375000     test accuracy: 0.427572
Average cost in epoch 112: 1.178696
training accuracy: 0.468750     test accuracy: 0.427572
Average cost in epoch 113: 1.179005
training accuracy: 0.656250     test accuracy: 0.418581
Average cost in epoch 114: 1.173418
training accuracy: 0.593750     test accuracy: 0.438561

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 115: 1.181721
training accuracy: 0.437500     test accuracy: 0.434565
Average cost in epoch 116: 1.164965
training accuracy: 0.375000     test accuracy: 0.430569
Average cost in epoch 117: 1.185003
training accuracy: 0.656250     test accuracy: 0.427572
Average cost in epoch 118: 1.172144
training accuracy: 0.531250     test accuracy: 0.434565
Average cost in epoch 119: 1.177347
training accuracy: 0.468750     test accuracy: 0.433566

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 120: 1.164777
training accuracy: 0.437500     test accuracy: 0.436563
Average cost in epoch 121: 1.171177
training accuracy: 0.687500     test accuracy: 0.433566
Average cost in epoch 122: 1.166688
training accuracy: 0.687500     test accuracy: 0.431568
Average cost in epoch 123: 1.168489
training accuracy: 0.437500     test accuracy: 0.431568
Average cost in epoch 124: 1.166598
training accuracy: 0.500000     test accuracy: 0.437562

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 125: 1.162541
training accuracy: 0.468750     test accuracy: 0.443556
Average cost in epoch 126: 1.168464
training accuracy: 0.531250     test accuracy: 0.426573
Average cost in epoch 127: 1.158228
training accuracy: 0.500000     test accuracy: 0.422577
Average cost in epoch 128: 1.157901
training accuracy: 0.500000     test accuracy: 0.431568
Average cost in epoch 129: 1.158471
training accuracy: 0.562500     test accuracy: 0.434565

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 130: 1.169483
training accuracy: 0.437500     test accuracy: 0.423576
Average cost in epoch 131: 1.159969
training accuracy: 0.375000     test accuracy: 0.432567
Average cost in epoch 132: 1.169018
training accuracy: 0.437500     test accuracy: 0.430569
Average cost in epoch 133: 1.162658
training accuracy: 0.562500     test accuracy: 0.434565
Average cost in epoch 134: 1.171687
training accuracy: 0.406250     test accuracy: 0.439560

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 135: 1.160859
training accuracy: 0.437500     test accuracy: 0.439560
Average cost in epoch 136: 1.178626
training accuracy: 0.500000     test accuracy: 0.442557
Average cost in epoch 137: 1.166472
training accuracy: 0.562500     test accuracy: 0.429570
Average cost in epoch 138: 1.161443
training accuracy: 0.468750     test accuracy: 0.425574
Average cost in epoch 139: 1.155799
training accuracy: 0.593750     test accuracy: 0.428571

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 140: 1.171191
training accuracy: 0.437500     test accuracy: 0.439560
Average cost in epoch 141: 1.161504
training accuracy: 0.562500     test accuracy: 0.437562
Average cost in epoch 142: 1.163055
training accuracy: 0.562500     test accuracy: 0.445554
Average cost in epoch 143: 1.154837
training accuracy: 0.437500     test accuracy: 0.436563
Average cost in epoch 144: 1.156215
training accuracy: 0.406250     test accuracy: 0.444555

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 145: 1.155797
training accuracy: 0.437500     test accuracy: 0.436563
Average cost in epoch 146: 1.162588
training accuracy: 0.500000     test accuracy: 0.443556
Average cost in epoch 147: 1.158751
training accuracy: 0.562500     test accuracy: 0.435564
Average cost in epoch 148: 1.165931
training accuracy: 0.468750     test accuracy: 0.431568
Average cost in epoch 149: 1.158264
training accuracy: 0.593750     test accuracy: 0.437562

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 150: 1.158666
training accuracy: 0.375000     test accuracy: 0.449550
Average cost in epoch 151: 1.147872
training accuracy: 0.500000     test accuracy: 0.425574
Average cost in epoch 152: 1.151440
training accuracy: 0.593750     test accuracy: 0.449550
Average cost in epoch 153: 1.160602
training accuracy: 0.531250     test accuracy: 0.446553
Average cost in epoch 154: 1.142596
training accuracy: 0.406250     test accuracy: 0.442557

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 155: 1.153734
training accuracy: 0.593750     test accuracy: 0.423576
Average cost in epoch 156: 1.145941
training accuracy: 0.531250     test accuracy: 0.424575
Average cost in epoch 157: 1.163502
training accuracy: 0.343750     test accuracy: 0.425574
Average cost in epoch 158: 1.151630
training accuracy: 0.593750     test accuracy: 0.437562
Average cost in epoch 159: 1.144855
training accuracy: 0.625000     test accuracy: 0.435564

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 160: 1.154729
training accuracy: 0.500000     test accuracy: 0.426573
Average cost in epoch 161: 1.144799
training accuracy: 0.687500     test accuracy: 0.427572
Average cost in epoch 162: 1.154187
training accuracy: 0.375000     test accuracy: 0.427572
Average cost in epoch 163: 1.147401
training accuracy: 0.375000     test accuracy: 0.438561
Average cost in epoch 164: 1.146795
training accuracy: 0.406250     test accuracy: 0.429570

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 165: 1.155468
training accuracy: 0.343750     test accuracy: 0.448551
Average cost in epoch 166: 1.156221
training accuracy: 0.500000     test accuracy: 0.439560
Average cost in epoch 167: 1.149730
training accuracy: 0.656250     test accuracy: 0.438561
Average cost in epoch 168: 1.147777
training accuracy: 0.531250     test accuracy: 0.434565
Average cost in epoch 169: 1.152079
training accuracy: 0.562500     test accuracy: 0.424575

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 170: 1.158681
training accuracy: 0.500000     test accuracy: 0.446553
Average cost in epoch 171: 1.151863
training accuracy: 0.531250     test accuracy: 0.447552
Average cost in epoch 172: 1.154956
training accuracy: 0.500000     test accuracy: 0.441558
Average cost in epoch 173: 1.165995
training accuracy: 0.500000     test accuracy: 0.436563
Average cost in epoch 174: 1.147542
training accuracy: 0.468750     test accuracy: 0.426573

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 175: 1.154546
training accuracy: 0.531250     test accuracy: 0.432567
Average cost in epoch 176: 1.150819
training accuracy: 0.500000     test accuracy: 0.424575
Average cost in epoch 177: 1.143652
training accuracy: 0.500000     test accuracy: 0.422577
Average cost in epoch 178: 1.147772
training accuracy: 0.531250     test accuracy: 0.421578
Average cost in epoch 179: 1.145409
training accuracy: 0.500000     test accuracy: 0.425574

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 180: 1.150739
training accuracy: 0.343750     test accuracy: 0.426573
Average cost in epoch 181: 1.135710
training accuracy: 0.312500     test accuracy: 0.428571
Average cost in epoch 182: 1.140970
training accuracy: 0.625000     test accuracy: 0.437562
Average cost in epoch 183: 1.141564
training accuracy: 0.468750     test accuracy: 0.435564
Average cost in epoch 184: 1.142978
training accuracy: 0.625000     test accuracy: 0.424575

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 185: 1.128273
training accuracy: 0.531250     test accuracy: 0.421578
Average cost in epoch 186: 1.156530
training accuracy: 0.500000     test accuracy: 0.431568
Average cost in epoch 187: 1.139671
training accuracy: 0.656250     test accuracy: 0.426573
Average cost in epoch 188: 1.141900
training accuracy: 0.687500     test accuracy: 0.427572
Average cost in epoch 189: 1.148885
training accuracy: 0.531250     test accuracy: 0.429570

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 190: 1.155518
training accuracy: 0.593750     test accuracy: 0.435564
Average cost in epoch 191: 1.135496
training accuracy: 0.656250     test accuracy: 0.416583
Average cost in epoch 192: 1.142079
training accuracy: 0.562500     test accuracy: 0.424575
Average cost in epoch 193: 1.141447
training accuracy: 0.593750     test accuracy: 0.431568
Average cost in epoch 194: 1.155799
training accuracy: 0.406250     test accuracy: 0.428571

dump to weights/att-lstm/att-lstm_14.pkl

Average cost in epoch 195: 1.139967
training accuracy: 0.562500     test accuracy: 0.428571
Average cost in epoch 196: 1.143345
training accuracy: 0.562500     test accuracy: 0.440559
Average cost in epoch 197: 1.137176
training accuracy: 0.593750     test accuracy: 0.429570
Average cost in epoch 198: 1.136099
training accuracy: 0.437500     test accuracy: 0.443556
Average cost in epoch 199: 1.139528
training accuracy: 0.406250     test accuracy: 0.436563

dump to weights/att-lstm/att-lstm_14.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 15, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_15.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 118.34
Starting training...
Average cost in epoch 0: 1.432823
training accuracy: 0.406250     test accuracy: 0.460539
Average cost in epoch 1: 1.233422
training accuracy: 0.281250     test accuracy: 0.450549
Average cost in epoch 2: 1.154806
training accuracy: 0.531250     test accuracy: 0.552448
Average cost in epoch 3: 1.101819
training accuracy: 0.437500     test accuracy: 0.579421
Average cost in epoch 4: 1.065325
training accuracy: 0.656250     test accuracy: 0.553447

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 5: 1.042642
training accuracy: 0.593750     test accuracy: 0.591409
lr decays to 0.009000
Average cost in epoch 6: 1.028357
training accuracy: 0.656250     test accuracy: 0.603397
Average cost in epoch 7: 1.009782
training accuracy: 0.437500     test accuracy: 0.586414
Average cost in epoch 8: 1.006250
training accuracy: 0.625000     test accuracy: 0.587413
Average cost in epoch 9: 0.992199
training accuracy: 0.437500     test accuracy: 0.595405

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 10: 0.990407
training accuracy: 0.718750     test accuracy: 0.611389
lr decays to 0.008100
Average cost in epoch 11: 0.979267
training accuracy: 0.531250     test accuracy: 0.610390
Average cost in epoch 12: 0.974379
training accuracy: 0.500000     test accuracy: 0.604396
Average cost in epoch 13: 0.963230
training accuracy: 0.593750     test accuracy: 0.605395
Average cost in epoch 14: 0.964391
training accuracy: 0.562500     test accuracy: 0.587413

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 15: 0.964663
training accuracy: 0.593750     test accuracy: 0.606394
lr decays to 0.007290
Average cost in epoch 16: 0.954725
training accuracy: 0.500000     test accuracy: 0.592408
Average cost in epoch 17: 0.945803
training accuracy: 0.437500     test accuracy: 0.609391
Average cost in epoch 18: 0.935047
training accuracy: 0.562500     test accuracy: 0.596404
Average cost in epoch 19: 0.937482
training accuracy: 0.593750     test accuracy: 0.604396

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 20: 0.929142
training accuracy: 0.500000     test accuracy: 0.615385
lr decays to 0.006561
Average cost in epoch 21: 0.927944
training accuracy: 0.718750     test accuracy: 0.615385
Average cost in epoch 22: 0.924012
training accuracy: 0.625000     test accuracy: 0.611389
Average cost in epoch 23: 0.921181
training accuracy: 0.562500     test accuracy: 0.588412
Average cost in epoch 24: 0.915625
training accuracy: 0.750000     test accuracy: 0.603397

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 25: 0.909620
training accuracy: 0.593750     test accuracy: 0.602398
lr decays to 0.005905
Average cost in epoch 26: 0.909221
training accuracy: 0.625000     test accuracy: 0.598402
Average cost in epoch 27: 0.908578
training accuracy: 0.593750     test accuracy: 0.617383
Average cost in epoch 28: 0.897322
training accuracy: 0.625000     test accuracy: 0.603397
Average cost in epoch 29: 0.899232
training accuracy: 0.656250     test accuracy: 0.597403

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 30: 0.890020
training accuracy: 0.531250     test accuracy: 0.596404
lr decays to 0.005314
Average cost in epoch 31: 0.892811
training accuracy: 0.656250     test accuracy: 0.615385
Average cost in epoch 32: 0.884250
training accuracy: 0.687500     test accuracy: 0.584416
Average cost in epoch 33: 0.886533
training accuracy: 0.687500     test accuracy: 0.596404
Average cost in epoch 34: 0.880420
training accuracy: 0.531250     test accuracy: 0.587413

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 35: 0.877204
training accuracy: 0.593750     test accuracy: 0.602398
lr decays to 0.004783
Average cost in epoch 36: 0.878380
training accuracy: 0.625000     test accuracy: 0.597403
Average cost in epoch 37: 0.872261
training accuracy: 0.687500     test accuracy: 0.602398
Average cost in epoch 38: 0.866374
training accuracy: 0.625000     test accuracy: 0.609391
Average cost in epoch 39: 0.860895
training accuracy: 0.500000     test accuracy: 0.603397

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 40: 0.863948
training accuracy: 0.656250     test accuracy: 0.572428
lr decays to 0.004305
Average cost in epoch 41: 0.866580
training accuracy: 0.468750     test accuracy: 0.609391
Average cost in epoch 42: 0.852246
training accuracy: 0.656250     test accuracy: 0.589411
Average cost in epoch 43: 0.864073
training accuracy: 0.843750     test accuracy: 0.605395
Average cost in epoch 44: 0.846649
training accuracy: 0.656250     test accuracy: 0.605395

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 45: 0.846581
training accuracy: 0.656250     test accuracy: 0.613387
lr decays to 0.003874
Average cost in epoch 46: 0.845402
training accuracy: 0.781250     test accuracy: 0.588412
Average cost in epoch 47: 0.850973
training accuracy: 0.625000     test accuracy: 0.613387
Average cost in epoch 48: 0.844709
training accuracy: 0.750000     test accuracy: 0.603397
Average cost in epoch 49: 0.845770
training accuracy: 0.687500     test accuracy: 0.585415

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 50: 0.836888
training accuracy: 0.625000     test accuracy: 0.595405
lr decays to 0.003487
Average cost in epoch 51: 0.840468
training accuracy: 0.531250     test accuracy: 0.582418
Average cost in epoch 52: 0.837053
training accuracy: 0.625000     test accuracy: 0.602398
Average cost in epoch 53: 0.829389
training accuracy: 0.562500     test accuracy: 0.580420
Average cost in epoch 54: 0.832315
training accuracy: 0.625000     test accuracy: 0.591409

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 55: 0.824384
training accuracy: 0.468750     test accuracy: 0.589411
lr decays to 0.003138
Average cost in epoch 56: 0.837323
training accuracy: 0.625000     test accuracy: 0.575425
Average cost in epoch 57: 0.818989
training accuracy: 0.593750     test accuracy: 0.575425
Average cost in epoch 58: 0.819954
training accuracy: 0.625000     test accuracy: 0.597403
Average cost in epoch 59: 0.816294
training accuracy: 0.781250     test accuracy: 0.571429

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 60: 0.826940
training accuracy: 0.625000     test accuracy: 0.611389
lr decays to 0.002824
Average cost in epoch 61: 0.816416
training accuracy: 0.750000     test accuracy: 0.590410
Average cost in epoch 62: 0.815730
training accuracy: 0.687500     test accuracy: 0.607393
Average cost in epoch 63: 0.812271
training accuracy: 0.687500     test accuracy: 0.591409
Average cost in epoch 64: 0.807629
training accuracy: 0.718750     test accuracy: 0.593407

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 65: 0.814330
training accuracy: 0.593750     test accuracy: 0.569431
lr decays to 0.002542
Average cost in epoch 66: 0.800377
training accuracy: 0.562500     test accuracy: 0.587413
Average cost in epoch 67: 0.809552
training accuracy: 0.750000     test accuracy: 0.574426
Average cost in epoch 68: 0.801707
training accuracy: 0.718750     test accuracy: 0.582418
Average cost in epoch 69: 0.808852
training accuracy: 0.687500     test accuracy: 0.596404

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 70: 0.796874
training accuracy: 0.750000     test accuracy: 0.584416
lr decays to 0.002288
Average cost in epoch 71: 0.794784
training accuracy: 0.593750     test accuracy: 0.577423
Average cost in epoch 72: 0.800210
training accuracy: 0.625000     test accuracy: 0.572428
Average cost in epoch 73: 0.804908
training accuracy: 0.500000     test accuracy: 0.587413
Average cost in epoch 74: 0.795037
training accuracy: 0.500000     test accuracy: 0.559441

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 75: 0.787497
training accuracy: 0.656250     test accuracy: 0.590410
lr decays to 0.002059
Average cost in epoch 76: 0.790303
training accuracy: 0.687500     test accuracy: 0.579421
Average cost in epoch 77: 0.794174
training accuracy: 0.718750     test accuracy: 0.581419
Average cost in epoch 78: 0.794843
training accuracy: 0.687500     test accuracy: 0.570430
Average cost in epoch 79: 0.798985
training accuracy: 0.718750     test accuracy: 0.582418

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 80: 0.789092
training accuracy: 0.656250     test accuracy: 0.592408
lr decays to 0.001853
Average cost in epoch 81: 0.779982
training accuracy: 0.656250     test accuracy: 0.571429
Average cost in epoch 82: 0.788303
training accuracy: 0.531250     test accuracy: 0.577423
Average cost in epoch 83: 0.785288
training accuracy: 0.593750     test accuracy: 0.583417
Average cost in epoch 84: 0.787706
training accuracy: 0.625000     test accuracy: 0.578422

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 85: 0.784660
training accuracy: 0.437500     test accuracy: 0.598402
lr decays to 0.001668
Average cost in epoch 86: 0.780475
training accuracy: 0.593750     test accuracy: 0.587413
Average cost in epoch 87: 0.785423
training accuracy: 0.468750     test accuracy: 0.585415
Average cost in epoch 88: 0.778571
training accuracy: 0.625000     test accuracy: 0.578422
Average cost in epoch 89: 0.771707
training accuracy: 0.750000     test accuracy: 0.587413

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 90: 0.783456
training accuracy: 0.750000     test accuracy: 0.570430
lr decays to 0.001501
Average cost in epoch 91: 0.771640
training accuracy: 0.593750     test accuracy: 0.589411
Average cost in epoch 92: 0.767969
training accuracy: 0.625000     test accuracy: 0.569431
Average cost in epoch 93: 0.772761
training accuracy: 0.625000     test accuracy: 0.587413
Average cost in epoch 94: 0.777214
training accuracy: 0.593750     test accuracy: 0.583417

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 95: 0.770031
training accuracy: 0.687500     test accuracy: 0.589411
lr decays to 0.001351
Average cost in epoch 96: 0.770649
training accuracy: 0.562500     test accuracy: 0.584416
Average cost in epoch 97: 0.766705
training accuracy: 0.656250     test accuracy: 0.577423
Average cost in epoch 98: 0.773416
training accuracy: 0.656250     test accuracy: 0.574426
Average cost in epoch 99: 0.756415
training accuracy: 0.562500     test accuracy: 0.586414

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 100: 0.768163
training accuracy: 0.656250     test accuracy: 0.576424
lr decays to 0.001216
Average cost in epoch 101: 0.765102
training accuracy: 0.656250     test accuracy: 0.571429
Average cost in epoch 102: 0.753923
training accuracy: 0.687500     test accuracy: 0.582418
Average cost in epoch 103: 0.766905
training accuracy: 0.718750     test accuracy: 0.585415
Average cost in epoch 104: 0.761362
training accuracy: 0.656250     test accuracy: 0.596404

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 105: 0.766085
training accuracy: 0.718750     test accuracy: 0.583417
Average cost in epoch 106: 0.762482
training accuracy: 0.593750     test accuracy: 0.578422
Average cost in epoch 107: 0.757653
training accuracy: 0.593750     test accuracy: 0.571429
Average cost in epoch 108: 0.753580
training accuracy: 0.781250     test accuracy: 0.576424
Average cost in epoch 109: 0.759240
training accuracy: 0.750000     test accuracy: 0.580420

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 110: 0.759431
training accuracy: 0.625000     test accuracy: 0.569431
Average cost in epoch 111: 0.758204
training accuracy: 0.593750     test accuracy: 0.579421
Average cost in epoch 112: 0.753265
training accuracy: 0.593750     test accuracy: 0.576424
Average cost in epoch 113: 0.752959
training accuracy: 0.656250     test accuracy: 0.573427
Average cost in epoch 114: 0.759805
training accuracy: 0.687500     test accuracy: 0.586414

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 115: 0.759340
training accuracy: 0.687500     test accuracy: 0.577423
Average cost in epoch 116: 0.752080
training accuracy: 0.656250     test accuracy: 0.578422
Average cost in epoch 117: 0.750396
training accuracy: 0.750000     test accuracy: 0.579421
Average cost in epoch 118: 0.752413
training accuracy: 0.718750     test accuracy: 0.580420
Average cost in epoch 119: 0.753098
training accuracy: 0.593750     test accuracy: 0.582418

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 120: 0.765045
training accuracy: 0.593750     test accuracy: 0.580420
Average cost in epoch 121: 0.753307
training accuracy: 0.687500     test accuracy: 0.585415
Average cost in epoch 122: 0.752779
training accuracy: 0.687500     test accuracy: 0.571429
Average cost in epoch 123: 0.758110
training accuracy: 0.625000     test accuracy: 0.576424
Average cost in epoch 124: 0.758716
training accuracy: 0.531250     test accuracy: 0.581419

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 125: 0.756942
training accuracy: 0.562500     test accuracy: 0.564436
Average cost in epoch 126: 0.749327
training accuracy: 0.562500     test accuracy: 0.583417
Average cost in epoch 127: 0.754509
training accuracy: 0.687500     test accuracy: 0.578422
Average cost in epoch 128: 0.758188
training accuracy: 0.437500     test accuracy: 0.586414
Average cost in epoch 129: 0.750699
training accuracy: 0.750000     test accuracy: 0.584416

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 130: 0.757176
training accuracy: 0.656250     test accuracy: 0.571429
Average cost in epoch 131: 0.757119
training accuracy: 0.656250     test accuracy: 0.575425
Average cost in epoch 132: 0.752370
training accuracy: 0.687500     test accuracy: 0.588412
Average cost in epoch 133: 0.751517
training accuracy: 0.531250     test accuracy: 0.595405
Average cost in epoch 134: 0.758961
training accuracy: 0.718750     test accuracy: 0.576424

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 135: 0.741302
training accuracy: 0.718750     test accuracy: 0.581419
Average cost in epoch 136: 0.757082
training accuracy: 0.531250     test accuracy: 0.591409
Average cost in epoch 137: 0.752460
training accuracy: 0.562500     test accuracy: 0.578422
Average cost in epoch 138: 0.742351
training accuracy: 0.656250     test accuracy: 0.572428
Average cost in epoch 139: 0.749949
training accuracy: 0.687500     test accuracy: 0.585415

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 140: 0.747837
training accuracy: 0.625000     test accuracy: 0.575425
Average cost in epoch 141: 0.752870
training accuracy: 0.656250     test accuracy: 0.573427
Average cost in epoch 142: 0.747011
training accuracy: 0.750000     test accuracy: 0.577423
Average cost in epoch 143: 0.746860
training accuracy: 0.718750     test accuracy: 0.572428
Average cost in epoch 144: 0.756406
training accuracy: 0.687500     test accuracy: 0.581419

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 145: 0.742198
training accuracy: 0.625000     test accuracy: 0.583417
Average cost in epoch 146: 0.745904
training accuracy: 0.531250     test accuracy: 0.562438
Average cost in epoch 147: 0.751805
training accuracy: 0.593750     test accuracy: 0.585415
Average cost in epoch 148: 0.742860
training accuracy: 0.781250     test accuracy: 0.571429
Average cost in epoch 149: 0.747746
training accuracy: 0.687500     test accuracy: 0.575425

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 150: 0.743023
training accuracy: 0.687500     test accuracy: 0.572428
Average cost in epoch 151: 0.746464
training accuracy: 0.687500     test accuracy: 0.575425
Average cost in epoch 152: 0.738799
training accuracy: 0.656250     test accuracy: 0.559441
Average cost in epoch 153: 0.751018
training accuracy: 0.781250     test accuracy: 0.583417
Average cost in epoch 154: 0.748397
training accuracy: 0.750000     test accuracy: 0.577423

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 155: 0.751213
training accuracy: 0.625000     test accuracy: 0.583417
Average cost in epoch 156: 0.742253
training accuracy: 0.718750     test accuracy: 0.585415
Average cost in epoch 157: 0.746048
training accuracy: 0.687500     test accuracy: 0.581419
Average cost in epoch 158: 0.748892
training accuracy: 0.593750     test accuracy: 0.578422
Average cost in epoch 159: 0.746991
training accuracy: 0.718750     test accuracy: 0.588412

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 160: 0.744939
training accuracy: 0.718750     test accuracy: 0.575425
Average cost in epoch 161: 0.740147
training accuracy: 0.625000     test accuracy: 0.593407
Average cost in epoch 162: 0.744584
training accuracy: 0.750000     test accuracy: 0.581419
Average cost in epoch 163: 0.736366
training accuracy: 0.750000     test accuracy: 0.576424
Average cost in epoch 164: 0.752361
training accuracy: 0.656250     test accuracy: 0.580420

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 165: 0.737983
training accuracy: 0.656250     test accuracy: 0.572428
Average cost in epoch 166: 0.742968
training accuracy: 0.593750     test accuracy: 0.575425
Average cost in epoch 167: 0.745951
training accuracy: 0.718750     test accuracy: 0.570430
Average cost in epoch 168: 0.740633
training accuracy: 0.656250     test accuracy: 0.584416
Average cost in epoch 169: 0.748638
training accuracy: 0.625000     test accuracy: 0.580420

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 170: 0.733962
training accuracy: 0.656250     test accuracy: 0.581419
Average cost in epoch 171: 0.737292
training accuracy: 0.625000     test accuracy: 0.589411
Average cost in epoch 172: 0.745272
training accuracy: 0.656250     test accuracy: 0.580420
Average cost in epoch 173: 0.741313
training accuracy: 0.656250     test accuracy: 0.576424
Average cost in epoch 174: 0.740303
training accuracy: 0.656250     test accuracy: 0.587413

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 175: 0.743180
training accuracy: 0.593750     test accuracy: 0.587413
Average cost in epoch 176: 0.746299
training accuracy: 0.625000     test accuracy: 0.571429
Average cost in epoch 177: 0.744617
training accuracy: 0.593750     test accuracy: 0.579421
Average cost in epoch 178: 0.742576
training accuracy: 0.625000     test accuracy: 0.577423
Average cost in epoch 179: 0.741872
training accuracy: 0.593750     test accuracy: 0.576424

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 180: 0.729725
training accuracy: 0.531250     test accuracy: 0.574426
Average cost in epoch 181: 0.735835
training accuracy: 0.750000     test accuracy: 0.570430
Average cost in epoch 182: 0.737511
training accuracy: 0.531250     test accuracy: 0.575425
Average cost in epoch 183: 0.738987
training accuracy: 0.687500     test accuracy: 0.592408
Average cost in epoch 184: 0.730307
training accuracy: 0.718750     test accuracy: 0.587413

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 185: 0.741755
training accuracy: 0.500000     test accuracy: 0.580420
Average cost in epoch 186: 0.734785
training accuracy: 0.687500     test accuracy: 0.562438
Average cost in epoch 187: 0.736861
training accuracy: 0.531250     test accuracy: 0.592408
Average cost in epoch 188: 0.746908
training accuracy: 0.656250     test accuracy: 0.582418
Average cost in epoch 189: 0.738318
training accuracy: 0.625000     test accuracy: 0.573427

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 190: 0.741300
training accuracy: 0.468750     test accuracy: 0.570430
Average cost in epoch 191: 0.732155
training accuracy: 0.500000     test accuracy: 0.582418
Average cost in epoch 192: 0.730775
training accuracy: 0.687500     test accuracy: 0.571429
Average cost in epoch 193: 0.728594
training accuracy: 0.718750     test accuracy: 0.579421
Average cost in epoch 194: 0.733226
training accuracy: 0.625000     test accuracy: 0.572428

dump to weights/att-lstm/att-lstm_15.pkl

Average cost in epoch 195: 0.740690
training accuracy: 0.593750     test accuracy: 0.570430
Average cost in epoch 196: 0.738664
training accuracy: 0.625000     test accuracy: 0.578422
Average cost in epoch 197: 0.734897
training accuracy: 0.781250     test accuracy: 0.581419
Average cost in epoch 198: 0.744686
training accuracy: 0.687500     test accuracy: 0.580420
Average cost in epoch 199: 0.732288
training accuracy: 0.687500     test accuracy: 0.585415

dump to weights/att-lstm/att-lstm_15.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 16, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_16.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 118.52
Starting training...
Average cost in epoch 0: 1.327531
training accuracy: 0.375000     test accuracy: 0.462537
Average cost in epoch 1: 1.160451
training accuracy: 0.687500     test accuracy: 0.471528
Average cost in epoch 2: 1.090833
training accuracy: 0.500000     test accuracy: 0.518482
Average cost in epoch 3: 1.053633
training accuracy: 0.468750     test accuracy: 0.486513
Average cost in epoch 4: 1.041931
training accuracy: 0.437500     test accuracy: 0.456543

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 5: 1.034571
training accuracy: 0.437500     test accuracy: 0.481518
lr decays to 0.009000
Average cost in epoch 6: 1.013398
training accuracy: 0.531250     test accuracy: 0.472527
Average cost in epoch 7: 1.010128
training accuracy: 0.593750     test accuracy: 0.471528
Average cost in epoch 8: 1.004287
training accuracy: 0.437500     test accuracy: 0.491508
Average cost in epoch 9: 0.998310
training accuracy: 0.406250     test accuracy: 0.510490

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 10: 0.991783
training accuracy: 0.312500     test accuracy: 0.471528
lr decays to 0.008100
Average cost in epoch 11: 0.986362
training accuracy: 0.531250     test accuracy: 0.488511
Average cost in epoch 12: 0.992796
training accuracy: 0.468750     test accuracy: 0.488511
Average cost in epoch 13: 0.979453
training accuracy: 0.500000     test accuracy: 0.483516
Average cost in epoch 14: 0.970989
training accuracy: 0.437500     test accuracy: 0.477522

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 15: 0.972614
training accuracy: 0.468750     test accuracy: 0.495504
lr decays to 0.007290
Average cost in epoch 16: 0.968694
training accuracy: 0.531250     test accuracy: 0.497502
Average cost in epoch 17: 0.971380
training accuracy: 0.593750     test accuracy: 0.502498
Average cost in epoch 18: 0.963094
training accuracy: 0.468750     test accuracy: 0.489510
Average cost in epoch 19: 0.959844
training accuracy: 0.656250     test accuracy: 0.503497

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 20: 0.959941
training accuracy: 0.562500     test accuracy: 0.478521
lr decays to 0.006561
Average cost in epoch 21: 0.943838
training accuracy: 0.406250     test accuracy: 0.508492
Average cost in epoch 22: 0.954026
training accuracy: 0.437500     test accuracy: 0.485514
Average cost in epoch 23: 0.950476
training accuracy: 0.531250     test accuracy: 0.494505
Average cost in epoch 24: 0.948920
training accuracy: 0.500000     test accuracy: 0.479520

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 25: 0.953010
training accuracy: 0.468750     test accuracy: 0.486513
lr decays to 0.005905
Average cost in epoch 26: 0.941639
training accuracy: 0.437500     test accuracy: 0.476523
Average cost in epoch 27: 0.936249
training accuracy: 0.468750     test accuracy: 0.505495
Average cost in epoch 28: 0.939103
training accuracy: 0.437500     test accuracy: 0.494505
Average cost in epoch 29: 0.932296
training accuracy: 0.531250     test accuracy: 0.461538

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 30: 0.933575
training accuracy: 0.562500     test accuracy: 0.475524
lr decays to 0.005314
Average cost in epoch 31: 0.929225
training accuracy: 0.531250     test accuracy: 0.450549
Average cost in epoch 32: 0.924646
training accuracy: 0.656250     test accuracy: 0.465534
Average cost in epoch 33: 0.922794
training accuracy: 0.531250     test accuracy: 0.486513
Average cost in epoch 34: 0.922390
training accuracy: 0.531250     test accuracy: 0.483516

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 35: 0.925607
training accuracy: 0.531250     test accuracy: 0.469530
lr decays to 0.004783
Average cost in epoch 36: 0.922380
training accuracy: 0.500000     test accuracy: 0.479520
Average cost in epoch 37: 0.914946
training accuracy: 0.531250     test accuracy: 0.470529
Average cost in epoch 38: 0.911695
training accuracy: 0.531250     test accuracy: 0.471528
Average cost in epoch 39: 0.915686
training accuracy: 0.593750     test accuracy: 0.490509

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 40: 0.921309
training accuracy: 0.406250     test accuracy: 0.496503
lr decays to 0.004305
Average cost in epoch 41: 0.913995
training accuracy: 0.531250     test accuracy: 0.500500
Average cost in epoch 42: 0.913356
training accuracy: 0.437500     test accuracy: 0.454545
Average cost in epoch 43: 0.903878
training accuracy: 0.500000     test accuracy: 0.489510
Average cost in epoch 44: 0.907525
training accuracy: 0.687500     test accuracy: 0.475524

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 45: 0.907864
training accuracy: 0.406250     test accuracy: 0.474525
lr decays to 0.003874
Average cost in epoch 46: 0.903998
training accuracy: 0.687500     test accuracy: 0.484515
Average cost in epoch 47: 0.900096
training accuracy: 0.625000     test accuracy: 0.478521
Average cost in epoch 48: 0.898034
training accuracy: 0.468750     test accuracy: 0.487512
Average cost in epoch 49: 0.895773
training accuracy: 0.562500     test accuracy: 0.471528

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 50: 0.902155
training accuracy: 0.312500     test accuracy: 0.469530
lr decays to 0.003487
Average cost in epoch 51: 0.898683
training accuracy: 0.687500     test accuracy: 0.475524
Average cost in epoch 52: 0.888537
training accuracy: 0.656250     test accuracy: 0.488511
Average cost in epoch 53: 0.891340
training accuracy: 0.500000     test accuracy: 0.501499
Average cost in epoch 54: 0.891187
training accuracy: 0.531250     test accuracy: 0.472527

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 55: 0.895097
training accuracy: 0.531250     test accuracy: 0.492507
lr decays to 0.003138
Average cost in epoch 56: 0.884273
training accuracy: 0.562500     test accuracy: 0.482517
Average cost in epoch 57: 0.883530
training accuracy: 0.656250     test accuracy: 0.484515
Average cost in epoch 58: 0.882150
training accuracy: 0.593750     test accuracy: 0.485514
Average cost in epoch 59: 0.888666
training accuracy: 0.500000     test accuracy: 0.491508

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 60: 0.882656
training accuracy: 0.500000     test accuracy: 0.476523
lr decays to 0.002824
Average cost in epoch 61: 0.876067
training accuracy: 0.531250     test accuracy: 0.491508
Average cost in epoch 62: 0.873110
training accuracy: 0.531250     test accuracy: 0.482517
Average cost in epoch 63: 0.869954
training accuracy: 0.375000     test accuracy: 0.483516
Average cost in epoch 64: 0.874621
training accuracy: 0.531250     test accuracy: 0.478521

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 65: 0.865776
training accuracy: 0.656250     test accuracy: 0.484515
lr decays to 0.002542
Average cost in epoch 66: 0.874312
training accuracy: 0.593750     test accuracy: 0.476523
Average cost in epoch 67: 0.876113
training accuracy: 0.625000     test accuracy: 0.495504
Average cost in epoch 68: 0.868545
training accuracy: 0.468750     test accuracy: 0.484515
Average cost in epoch 69: 0.865332
training accuracy: 0.406250     test accuracy: 0.465534

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 70: 0.864467
training accuracy: 0.562500     test accuracy: 0.482517
lr decays to 0.002288
Average cost in epoch 71: 0.869099
training accuracy: 0.468750     test accuracy: 0.470529
Average cost in epoch 72: 0.869572
training accuracy: 0.437500     test accuracy: 0.470529
Average cost in epoch 73: 0.864964
training accuracy: 0.718750     test accuracy: 0.465534
Average cost in epoch 74: 0.862046
training accuracy: 0.687500     test accuracy: 0.470529

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 75: 0.858710
training accuracy: 0.593750     test accuracy: 0.465534
lr decays to 0.002059
Average cost in epoch 76: 0.860352
training accuracy: 0.562500     test accuracy: 0.481518
Average cost in epoch 77: 0.856183
training accuracy: 0.531250     test accuracy: 0.462537
Average cost in epoch 78: 0.856199
training accuracy: 0.531250     test accuracy: 0.493506
Average cost in epoch 79: 0.858138
training accuracy: 0.531250     test accuracy: 0.487512

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 80: 0.851774
training accuracy: 0.562500     test accuracy: 0.473526
lr decays to 0.001853
Average cost in epoch 81: 0.853562
training accuracy: 0.687500     test accuracy: 0.475524
Average cost in epoch 82: 0.840436
training accuracy: 0.562500     test accuracy: 0.479520
Average cost in epoch 83: 0.856018
training accuracy: 0.562500     test accuracy: 0.487512
Average cost in epoch 84: 0.848330
training accuracy: 0.593750     test accuracy: 0.469530

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 85: 0.847340
training accuracy: 0.437500     test accuracy: 0.487512
lr decays to 0.001668
Average cost in epoch 86: 0.853179
training accuracy: 0.531250     test accuracy: 0.484515
Average cost in epoch 87: 0.840688
training accuracy: 0.625000     test accuracy: 0.486513
Average cost in epoch 88: 0.844560
training accuracy: 0.656250     test accuracy: 0.488511
Average cost in epoch 89: 0.847947
training accuracy: 0.531250     test accuracy: 0.473526

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 90: 0.840358
training accuracy: 0.593750     test accuracy: 0.486513
lr decays to 0.001501
Average cost in epoch 91: 0.845515
training accuracy: 0.500000     test accuracy: 0.484515
Average cost in epoch 92: 0.840042
training accuracy: 0.531250     test accuracy: 0.474525
Average cost in epoch 93: 0.832455
training accuracy: 0.562500     test accuracy: 0.488511
Average cost in epoch 94: 0.832975
training accuracy: 0.531250     test accuracy: 0.473526

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 95: 0.833884
training accuracy: 0.625000     test accuracy: 0.488511
lr decays to 0.001351
Average cost in epoch 96: 0.829289
training accuracy: 0.468750     test accuracy: 0.466533
Average cost in epoch 97: 0.831008
training accuracy: 0.562500     test accuracy: 0.476523
Average cost in epoch 98: 0.838709
training accuracy: 0.468750     test accuracy: 0.474525
Average cost in epoch 99: 0.832097
training accuracy: 0.468750     test accuracy: 0.482517

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 100: 0.831097
training accuracy: 0.562500     test accuracy: 0.477522
lr decays to 0.001216
Average cost in epoch 101: 0.820026
training accuracy: 0.406250     test accuracy: 0.470529
Average cost in epoch 102: 0.822262
training accuracy: 0.531250     test accuracy: 0.475524
Average cost in epoch 103: 0.825492
training accuracy: 0.531250     test accuracy: 0.467532
Average cost in epoch 104: 0.826167
training accuracy: 0.625000     test accuracy: 0.471528

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 105: 0.823486
training accuracy: 0.562500     test accuracy: 0.473526
Average cost in epoch 106: 0.830991
training accuracy: 0.468750     test accuracy: 0.464535
Average cost in epoch 107: 0.819330
training accuracy: 0.531250     test accuracy: 0.474525
Average cost in epoch 108: 0.824168
training accuracy: 0.656250     test accuracy: 0.473526
Average cost in epoch 109: 0.816046
training accuracy: 0.531250     test accuracy: 0.479520

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 110: 0.830723
training accuracy: 0.406250     test accuracy: 0.472527
Average cost in epoch 111: 0.818583
training accuracy: 0.593750     test accuracy: 0.471528
Average cost in epoch 112: 0.821346
training accuracy: 0.468750     test accuracy: 0.464535
Average cost in epoch 113: 0.814634
training accuracy: 0.531250     test accuracy: 0.472527
Average cost in epoch 114: 0.822527
training accuracy: 0.625000     test accuracy: 0.477522

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 115: 0.814175
training accuracy: 0.531250     test accuracy: 0.472527
Average cost in epoch 116: 0.820145
training accuracy: 0.625000     test accuracy: 0.473526
Average cost in epoch 117: 0.818001
training accuracy: 0.562500     test accuracy: 0.483516
Average cost in epoch 118: 0.811821
training accuracy: 0.531250     test accuracy: 0.471528
Average cost in epoch 119: 0.817727
training accuracy: 0.687500     test accuracy: 0.487512

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 120: 0.815545
training accuracy: 0.437500     test accuracy: 0.476523
Average cost in epoch 121: 0.816901
training accuracy: 0.468750     test accuracy: 0.478521
Average cost in epoch 122: 0.813212
training accuracy: 0.593750     test accuracy: 0.485514
Average cost in epoch 123: 0.807960
training accuracy: 0.437500     test accuracy: 0.468531
Average cost in epoch 124: 0.817937
training accuracy: 0.500000     test accuracy: 0.469530

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 125: 0.819160
training accuracy: 0.531250     test accuracy: 0.466533
Average cost in epoch 126: 0.818941
training accuracy: 0.593750     test accuracy: 0.481518
Average cost in epoch 127: 0.815797
training accuracy: 0.531250     test accuracy: 0.475524
Average cost in epoch 128: 0.810995
training accuracy: 0.562500     test accuracy: 0.482517
Average cost in epoch 129: 0.810235
training accuracy: 0.500000     test accuracy: 0.462537

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 130: 0.809473
training accuracy: 0.625000     test accuracy: 0.480519
Average cost in epoch 131: 0.809460
training accuracy: 0.593750     test accuracy: 0.464535
Average cost in epoch 132: 0.805868
training accuracy: 0.593750     test accuracy: 0.471528
Average cost in epoch 133: 0.816413
training accuracy: 0.468750     test accuracy: 0.481518
Average cost in epoch 134: 0.809571
training accuracy: 0.531250     test accuracy: 0.470529

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 135: 0.805595
training accuracy: 0.718750     test accuracy: 0.475524
Average cost in epoch 136: 0.815491
training accuracy: 0.531250     test accuracy: 0.471528
Average cost in epoch 137: 0.807720
training accuracy: 0.593750     test accuracy: 0.481518
Average cost in epoch 138: 0.813461
training accuracy: 0.562500     test accuracy: 0.469530
Average cost in epoch 139: 0.809350
training accuracy: 0.625000     test accuracy: 0.465534

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 140: 0.806486
training accuracy: 0.531250     test accuracy: 0.461538
Average cost in epoch 141: 0.818303
training accuracy: 0.656250     test accuracy: 0.483516
Average cost in epoch 142: 0.812959
training accuracy: 0.468750     test accuracy: 0.478521
Average cost in epoch 143: 0.807164
training accuracy: 0.562500     test accuracy: 0.481518
Average cost in epoch 144: 0.801822
training accuracy: 0.593750     test accuracy: 0.465534

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 145: 0.808147
training accuracy: 0.625000     test accuracy: 0.474525
Average cost in epoch 146: 0.798639
training accuracy: 0.562500     test accuracy: 0.474525
Average cost in epoch 147: 0.815652
training accuracy: 0.781250     test accuracy: 0.480519
Average cost in epoch 148: 0.806338
training accuracy: 0.562500     test accuracy: 0.470529
Average cost in epoch 149: 0.797448
training accuracy: 0.468750     test accuracy: 0.464535

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 150: 0.812445
training accuracy: 0.500000     test accuracy: 0.467532
Average cost in epoch 151: 0.807432
training accuracy: 0.500000     test accuracy: 0.468531
Average cost in epoch 152: 0.799078
training accuracy: 0.531250     test accuracy: 0.479520
Average cost in epoch 153: 0.806520
training accuracy: 0.562500     test accuracy: 0.457542
Average cost in epoch 154: 0.812126
training accuracy: 0.562500     test accuracy: 0.471528

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 155: 0.805891
training accuracy: 0.500000     test accuracy: 0.484515
Average cost in epoch 156: 0.808623
training accuracy: 0.562500     test accuracy: 0.462537
Average cost in epoch 157: 0.806963
training accuracy: 0.468750     test accuracy: 0.472527
Average cost in epoch 158: 0.808430
training accuracy: 0.562500     test accuracy: 0.471528
Average cost in epoch 159: 0.797460
training accuracy: 0.562500     test accuracy: 0.466533

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 160: 0.798980
training accuracy: 0.656250     test accuracy: 0.478521
Average cost in epoch 161: 0.796333
training accuracy: 0.656250     test accuracy: 0.474525
Average cost in epoch 162: 0.802795
training accuracy: 0.531250     test accuracy: 0.475524
Average cost in epoch 163: 0.799500
training accuracy: 0.562500     test accuracy: 0.478521
Average cost in epoch 164: 0.798782
training accuracy: 0.593750     test accuracy: 0.462537

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 165: 0.803000
training accuracy: 0.406250     test accuracy: 0.480519
Average cost in epoch 166: 0.798868
training accuracy: 0.500000     test accuracy: 0.470529
Average cost in epoch 167: 0.796474
training accuracy: 0.656250     test accuracy: 0.484515
Average cost in epoch 168: 0.806802
training accuracy: 0.625000     test accuracy: 0.477522
Average cost in epoch 169: 0.803326
training accuracy: 0.750000     test accuracy: 0.477522

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 170: 0.803424
training accuracy: 0.593750     test accuracy: 0.460539
Average cost in epoch 171: 0.790782
training accuracy: 0.531250     test accuracy: 0.470529
Average cost in epoch 172: 0.801251
training accuracy: 0.468750     test accuracy: 0.488511
Average cost in epoch 173: 0.791355
training accuracy: 0.531250     test accuracy: 0.482517
Average cost in epoch 174: 0.797055
training accuracy: 0.656250     test accuracy: 0.476523

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 175: 0.797726
training accuracy: 0.687500     test accuracy: 0.485514
Average cost in epoch 176: 0.801969
training accuracy: 0.656250     test accuracy: 0.474525
Average cost in epoch 177: 0.793943
training accuracy: 0.437500     test accuracy: 0.481518
Average cost in epoch 178: 0.791232
training accuracy: 0.656250     test accuracy: 0.483516
Average cost in epoch 179: 0.798268
training accuracy: 0.406250     test accuracy: 0.468531

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 180: 0.786978
training accuracy: 0.593750     test accuracy: 0.475524
Average cost in epoch 181: 0.797803
training accuracy: 0.687500     test accuracy: 0.476523
Average cost in epoch 182: 0.796823
training accuracy: 0.593750     test accuracy: 0.479520
Average cost in epoch 183: 0.795654
training accuracy: 0.625000     test accuracy: 0.473526
Average cost in epoch 184: 0.790317
training accuracy: 0.531250     test accuracy: 0.477522

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 185: 0.806313
training accuracy: 0.750000     test accuracy: 0.487512
Average cost in epoch 186: 0.789060
training accuracy: 0.500000     test accuracy: 0.468531
Average cost in epoch 187: 0.798511
training accuracy: 0.500000     test accuracy: 0.463536
Average cost in epoch 188: 0.795224
training accuracy: 0.625000     test accuracy: 0.462537
Average cost in epoch 189: 0.793045
training accuracy: 0.593750     test accuracy: 0.478521

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 190: 0.790973
training accuracy: 0.718750     test accuracy: 0.481518
Average cost in epoch 191: 0.788115
training accuracy: 0.687500     test accuracy: 0.478521
Average cost in epoch 192: 0.790648
training accuracy: 0.531250     test accuracy: 0.470529
Average cost in epoch 193: 0.794314
training accuracy: 0.687500     test accuracy: 0.475524
Average cost in epoch 194: 0.788831
training accuracy: 0.625000     test accuracy: 0.473526

dump to weights/att-lstm/att-lstm_16.pkl

Average cost in epoch 195: 0.798511
training accuracy: 0.593750     test accuracy: 0.477522
Average cost in epoch 196: 0.787884
training accuracy: 0.562500     test accuracy: 0.494505
Average cost in epoch 197: 0.790244
training accuracy: 0.625000     test accuracy: 0.485514
Average cost in epoch 198: 0.791254
training accuracy: 0.656250     test accuracy: 0.474525
Average cost in epoch 199: 0.795325
training accuracy: 0.375000     test accuracy: 0.490509

dump to weights/att-lstm/att-lstm_16.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 17, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_17.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 119.38
Starting training...
Average cost in epoch 0: 0.736619
training accuracy: 0.312500     test accuracy: 0.479520
Average cost in epoch 1: 0.698735
training accuracy: 0.375000     test accuracy: 0.486513
Average cost in epoch 2: 0.697039
training accuracy: 0.437500     test accuracy: 0.479520
Average cost in epoch 3: 0.697640
training accuracy: 0.468750     test accuracy: 0.508492
Average cost in epoch 4: 0.694619
training accuracy: 0.625000     test accuracy: 0.479520

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 5: 0.694534
training accuracy: 0.312500     test accuracy: 0.509491
lr decays to 0.009000
Average cost in epoch 6: 0.698297
training accuracy: 0.375000     test accuracy: 0.520480
Average cost in epoch 7: 0.694622
training accuracy: 0.531250     test accuracy: 0.479520
Average cost in epoch 8: 0.694455
training accuracy: 0.375000     test accuracy: 0.479520
Average cost in epoch 9: 0.694207
training accuracy: 0.312500     test accuracy: 0.520480

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 10: 0.695150
training accuracy: 0.406250     test accuracy: 0.520480
lr decays to 0.008100
Average cost in epoch 11: 0.694203
training accuracy: 0.500000     test accuracy: 0.518482
Average cost in epoch 12: 0.693709
training accuracy: 0.593750     test accuracy: 0.479520
Average cost in epoch 13: 0.694109
training accuracy: 0.562500     test accuracy: 0.475524
Average cost in epoch 14: 0.693819
training accuracy: 0.500000     test accuracy: 0.479520

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 15: 0.694449
training accuracy: 0.625000     test accuracy: 0.466533
lr decays to 0.007290
Average cost in epoch 16: 0.693761
training accuracy: 0.562500     test accuracy: 0.479520
Average cost in epoch 17: 0.693828
training accuracy: 0.406250     test accuracy: 0.527473
Average cost in epoch 18: 0.693638
training accuracy: 0.500000     test accuracy: 0.479520
Average cost in epoch 19: 0.693677
training accuracy: 0.687500     test accuracy: 0.479520

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 20: 0.694746
training accuracy: 0.531250     test accuracy: 0.490509
lr decays to 0.006561
Average cost in epoch 21: 0.693588
training accuracy: 0.687500     test accuracy: 0.479520
Average cost in epoch 22: 0.693466
training accuracy: 0.468750     test accuracy: 0.479520
Average cost in epoch 23: 0.694659
training accuracy: 0.437500     test accuracy: 0.479520
Average cost in epoch 24: 0.693874
training accuracy: 0.500000     test accuracy: 0.516484

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 25: 0.694020
training accuracy: 0.562500     test accuracy: 0.503497
lr decays to 0.005905
Average cost in epoch 26: 0.693678
training accuracy: 0.437500     test accuracy: 0.513487
Average cost in epoch 27: 0.693523
training accuracy: 0.531250     test accuracy: 0.507493
Average cost in epoch 28: 0.693449
training accuracy: 0.562500     test accuracy: 0.489510
Average cost in epoch 29: 0.693322
training accuracy: 0.375000     test accuracy: 0.491508

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 30: 0.694130
training accuracy: 0.562500     test accuracy: 0.479520
lr decays to 0.005314
Average cost in epoch 31: 0.693620
training accuracy: 0.562500     test accuracy: 0.512488
Average cost in epoch 32: 0.693831
training accuracy: 0.406250     test accuracy: 0.482517
Average cost in epoch 33: 0.694001
training accuracy: 0.468750     test accuracy: 0.469530
Average cost in epoch 34: 0.693365
training accuracy: 0.593750     test accuracy: 0.494505

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 35: 0.693859
training accuracy: 0.406250     test accuracy: 0.484515
lr decays to 0.004783
Average cost in epoch 36: 0.693287
training accuracy: 0.468750     test accuracy: 0.488511
Average cost in epoch 37: 0.693481
training accuracy: 0.437500     test accuracy: 0.479520
Average cost in epoch 38: 0.693481
training accuracy: 0.500000     test accuracy: 0.479520
Average cost in epoch 39: 0.693816
training accuracy: 0.500000     test accuracy: 0.502498

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 40: 0.693689
training accuracy: 0.468750     test accuracy: 0.482517
lr decays to 0.004305
Average cost in epoch 41: 0.693437
training accuracy: 0.531250     test accuracy: 0.505495
Average cost in epoch 42: 0.693913
training accuracy: 0.500000     test accuracy: 0.479520
Average cost in epoch 43: 0.693578
training accuracy: 0.562500     test accuracy: 0.525475
Average cost in epoch 44: 0.693516
training accuracy: 0.500000     test accuracy: 0.483516

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 45: 0.693699
training accuracy: 0.468750     test accuracy: 0.497502
lr decays to 0.003874
Average cost in epoch 46: 0.693740
training accuracy: 0.593750     test accuracy: 0.478521
Average cost in epoch 47: 0.693377
training accuracy: 0.500000     test accuracy: 0.511489
Average cost in epoch 48: 0.693391
training accuracy: 0.437500     test accuracy: 0.489510
Average cost in epoch 49: 0.693281
training accuracy: 0.562500     test accuracy: 0.529471

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 50: 0.693349
training accuracy: 0.531250     test accuracy: 0.505495
lr decays to 0.003487
Average cost in epoch 51: 0.693618
training accuracy: 0.593750     test accuracy: 0.526474
Average cost in epoch 52: 0.693194
training accuracy: 0.468750     test accuracy: 0.497502
Average cost in epoch 53: 0.693297
training accuracy: 0.625000     test accuracy: 0.478521
Average cost in epoch 54: 0.693342
training accuracy: 0.312500     test accuracy: 0.490509

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 55: 0.692187
training accuracy: 0.687500     test accuracy: 0.480519
lr decays to 0.003138
Average cost in epoch 56: 0.692864
training accuracy: 0.375000     test accuracy: 0.492507
Average cost in epoch 57: 0.693201
training accuracy: 0.562500     test accuracy: 0.477522
Average cost in epoch 58: 0.692075
training accuracy: 0.500000     test accuracy: 0.478521
Average cost in epoch 59: 0.693758
training accuracy: 0.718750     test accuracy: 0.492507

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 60: 0.693050
training accuracy: 0.593750     test accuracy: 0.480519
lr decays to 0.002824
Average cost in epoch 61: 0.693351
training accuracy: 0.437500     test accuracy: 0.481518
Average cost in epoch 62: 0.693296
training accuracy: 0.500000     test accuracy: 0.483516
Average cost in epoch 63: 0.693057
training accuracy: 0.468750     test accuracy: 0.498501
Average cost in epoch 64: 0.693055
training accuracy: 0.468750     test accuracy: 0.473526

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 65: 0.692504
training accuracy: 0.562500     test accuracy: 0.491508
lr decays to 0.002542
Average cost in epoch 66: 0.692400
training accuracy: 0.437500     test accuracy: 0.479520
Average cost in epoch 67: 0.692112
training accuracy: 0.593750     test accuracy: 0.492507
Average cost in epoch 68: 0.692146
training accuracy: 0.468750     test accuracy: 0.480519
Average cost in epoch 69: 0.692287
training accuracy: 0.562500     test accuracy: 0.479520

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 70: 0.692445
training accuracy: 0.531250     test accuracy: 0.468531
lr decays to 0.002288
Average cost in epoch 71: 0.692541
training accuracy: 0.625000     test accuracy: 0.497502
Average cost in epoch 72: 0.692305
training accuracy: 0.531250     test accuracy: 0.490509
Average cost in epoch 73: 0.692072
training accuracy: 0.562500     test accuracy: 0.481518
Average cost in epoch 74: 0.692719
training accuracy: 0.562500     test accuracy: 0.485514

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 75: 0.692425
training accuracy: 0.468750     test accuracy: 0.494505
lr decays to 0.002059
Average cost in epoch 76: 0.691716
training accuracy: 0.562500     test accuracy: 0.473526
Average cost in epoch 77: 0.692152
training accuracy: 0.343750     test accuracy: 0.477522
Average cost in epoch 78: 0.692603
training accuracy: 0.375000     test accuracy: 0.507493
Average cost in epoch 79: 0.692587
training accuracy: 0.625000     test accuracy: 0.481518

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 80: 0.692567
training accuracy: 0.656250     test accuracy: 0.496503
lr decays to 0.001853
Average cost in epoch 81: 0.691977
training accuracy: 0.500000     test accuracy: 0.491508
Average cost in epoch 82: 0.691632
training accuracy: 0.531250     test accuracy: 0.495504
Average cost in epoch 83: 0.691327
training accuracy: 0.500000     test accuracy: 0.493506
Average cost in epoch 84: 0.690958
training accuracy: 0.593750     test accuracy: 0.467532

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 85: 0.691929
training accuracy: 0.625000     test accuracy: 0.500500
lr decays to 0.001668
Average cost in epoch 86: 0.692029
training accuracy: 0.406250     test accuracy: 0.497502
Average cost in epoch 87: 0.690908
training accuracy: 0.500000     test accuracy: 0.492507
Average cost in epoch 88: 0.691422
training accuracy: 0.593750     test accuracy: 0.484515
Average cost in epoch 89: 0.691468
training accuracy: 0.593750     test accuracy: 0.492507

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 90: 0.692269
training accuracy: 0.625000     test accuracy: 0.467532
lr decays to 0.001501
Average cost in epoch 91: 0.689528
training accuracy: 0.500000     test accuracy: 0.478521
Average cost in epoch 92: 0.692130
training accuracy: 0.593750     test accuracy: 0.483516
Average cost in epoch 93: 0.689540
training accuracy: 0.531250     test accuracy: 0.476523
Average cost in epoch 94: 0.690499
training accuracy: 0.468750     test accuracy: 0.465534

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 95: 0.691901
training accuracy: 0.343750     test accuracy: 0.489510
lr decays to 0.001351
Average cost in epoch 96: 0.690057
training accuracy: 0.406250     test accuracy: 0.492507
Average cost in epoch 97: 0.690688
training accuracy: 0.375000     test accuracy: 0.468531
Average cost in epoch 98: 0.689524
training accuracy: 0.593750     test accuracy: 0.479520
Average cost in epoch 99: 0.689342
training accuracy: 0.437500     test accuracy: 0.459540

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 100: 0.690352
training accuracy: 0.437500     test accuracy: 0.487512
lr decays to 0.001216
Average cost in epoch 101: 0.689371
training accuracy: 0.437500     test accuracy: 0.462537
Average cost in epoch 102: 0.689963
training accuracy: 0.468750     test accuracy: 0.499500
Average cost in epoch 103: 0.689000
training accuracy: 0.437500     test accuracy: 0.478521
Average cost in epoch 104: 0.689676
training accuracy: 0.468750     test accuracy: 0.482517

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 105: 0.690676
training accuracy: 0.437500     test accuracy: 0.481518
Average cost in epoch 106: 0.690081
training accuracy: 0.437500     test accuracy: 0.471528
Average cost in epoch 107: 0.689855
training accuracy: 0.500000     test accuracy: 0.471528
Average cost in epoch 108: 0.689218
training accuracy: 0.562500     test accuracy: 0.483516
Average cost in epoch 109: 0.689347
training accuracy: 0.656250     test accuracy: 0.478521

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 110: 0.690788
training accuracy: 0.468750     test accuracy: 0.459540
Average cost in epoch 111: 0.690874
training accuracy: 0.500000     test accuracy: 0.482517
Average cost in epoch 112: 0.689060
training accuracy: 0.687500     test accuracy: 0.464535
Average cost in epoch 113: 0.690208
training accuracy: 0.531250     test accuracy: 0.468531
Average cost in epoch 114: 0.688719
training accuracy: 0.437500     test accuracy: 0.468531

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 115: 0.690223
training accuracy: 0.562500     test accuracy: 0.462537
Average cost in epoch 116: 0.689068
training accuracy: 0.687500     test accuracy: 0.464535
Average cost in epoch 117: 0.688713
training accuracy: 0.531250     test accuracy: 0.470529
Average cost in epoch 118: 0.688091
training accuracy: 0.781250     test accuracy: 0.465534
Average cost in epoch 119: 0.689115
training accuracy: 0.562500     test accuracy: 0.476523

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 120: 0.689569
training accuracy: 0.437500     test accuracy: 0.491508
Average cost in epoch 121: 0.687601
training accuracy: 0.500000     test accuracy: 0.488511
Average cost in epoch 122: 0.687355
training accuracy: 0.531250     test accuracy: 0.491508
Average cost in epoch 123: 0.687689
training accuracy: 0.500000     test accuracy: 0.463536
Average cost in epoch 124: 0.686736
training accuracy: 0.468750     test accuracy: 0.508492

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 125: 0.685742
training accuracy: 0.468750     test accuracy: 0.481518
Average cost in epoch 126: 0.687481
training accuracy: 0.531250     test accuracy: 0.487512
Average cost in epoch 127: 0.684494
training accuracy: 0.468750     test accuracy: 0.481518
Average cost in epoch 128: 0.684993
training accuracy: 0.625000     test accuracy: 0.479520
Average cost in epoch 129: 0.685383
training accuracy: 0.500000     test accuracy: 0.483516

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 130: 0.684600
training accuracy: 0.500000     test accuracy: 0.476523
Average cost in epoch 131: 0.682882
training accuracy: 0.375000     test accuracy: 0.489510
Average cost in epoch 132: 0.683652
training accuracy: 0.593750     test accuracy: 0.482517
Average cost in epoch 133: 0.682838
training accuracy: 0.562500     test accuracy: 0.473526
Average cost in epoch 134: 0.681352
training accuracy: 0.500000     test accuracy: 0.492507

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 135: 0.681766
training accuracy: 0.562500     test accuracy: 0.487512
Average cost in epoch 136: 0.682527
training accuracy: 0.562500     test accuracy: 0.505495
Average cost in epoch 137: 0.683410
training accuracy: 0.656250     test accuracy: 0.498501
Average cost in epoch 138: 0.683205
training accuracy: 0.562500     test accuracy: 0.492507
Average cost in epoch 139: 0.681534
training accuracy: 0.500000     test accuracy: 0.513487

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 140: 0.682582
training accuracy: 0.531250     test accuracy: 0.485514
Average cost in epoch 141: 0.681202
training accuracy: 0.437500     test accuracy: 0.501499
Average cost in epoch 142: 0.678653
training accuracy: 0.500000     test accuracy: 0.505495
Average cost in epoch 143: 0.680513
training accuracy: 0.593750     test accuracy: 0.496503
Average cost in epoch 144: 0.676859
training accuracy: 0.625000     test accuracy: 0.488511

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 145: 0.680245
training accuracy: 0.687500     test accuracy: 0.528472
Average cost in epoch 146: 0.683261
training accuracy: 0.656250     test accuracy: 0.484515
Average cost in epoch 147: 0.678493
training accuracy: 0.468750     test accuracy: 0.498501
Average cost in epoch 148: 0.680545
training accuracy: 0.625000     test accuracy: 0.497502
Average cost in epoch 149: 0.676691
training accuracy: 0.437500     test accuracy: 0.498501

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 150: 0.677630
training accuracy: 0.875000     test accuracy: 0.526474
Average cost in epoch 151: 0.677149
training accuracy: 0.468750     test accuracy: 0.502498
Average cost in epoch 152: 0.673355
training accuracy: 0.625000     test accuracy: 0.509491
Average cost in epoch 153: 0.674967
training accuracy: 0.593750     test accuracy: 0.509491
Average cost in epoch 154: 0.675283
training accuracy: 0.656250     test accuracy: 0.503497

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 155: 0.674328
training accuracy: 0.375000     test accuracy: 0.506494
Average cost in epoch 156: 0.673146
training accuracy: 0.625000     test accuracy: 0.507493
Average cost in epoch 157: 0.675836
training accuracy: 0.468750     test accuracy: 0.496503
Average cost in epoch 158: 0.673410
training accuracy: 0.687500     test accuracy: 0.502498
Average cost in epoch 159: 0.675439
training accuracy: 0.375000     test accuracy: 0.504496

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 160: 0.672328
training accuracy: 0.687500     test accuracy: 0.515485
Average cost in epoch 161: 0.672571
training accuracy: 0.593750     test accuracy: 0.499500
Average cost in epoch 162: 0.673144
training accuracy: 0.656250     test accuracy: 0.508492
Average cost in epoch 163: 0.673980
training accuracy: 0.500000     test accuracy: 0.504496
Average cost in epoch 164: 0.672926
training accuracy: 0.593750     test accuracy: 0.499500

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 165: 0.671972
training accuracy: 0.593750     test accuracy: 0.505495
Average cost in epoch 166: 0.670779
training accuracy: 0.437500     test accuracy: 0.492507
Average cost in epoch 167: 0.668566
training accuracy: 0.593750     test accuracy: 0.512488
Average cost in epoch 168: 0.672365
training accuracy: 0.718750     test accuracy: 0.502498
Average cost in epoch 169: 0.673384
training accuracy: 0.406250     test accuracy: 0.503497

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 170: 0.672462
training accuracy: 0.656250     test accuracy: 0.509491
Average cost in epoch 171: 0.669777
training accuracy: 0.593750     test accuracy: 0.509491
Average cost in epoch 172: 0.666224
training accuracy: 0.593750     test accuracy: 0.507493
Average cost in epoch 173: 0.668915
training accuracy: 0.468750     test accuracy: 0.510490
Average cost in epoch 174: 0.664289
training accuracy: 0.656250     test accuracy: 0.505495

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 175: 0.669832
training accuracy: 0.531250     test accuracy: 0.510490
Average cost in epoch 176: 0.667388
training accuracy: 0.750000     test accuracy: 0.492507
Average cost in epoch 177: 0.663874
training accuracy: 0.718750     test accuracy: 0.504496
Average cost in epoch 178: 0.660171
training accuracy: 0.531250     test accuracy: 0.522478
Average cost in epoch 179: 0.665496
training accuracy: 0.593750     test accuracy: 0.505495

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 180: 0.666511
training accuracy: 0.562500     test accuracy: 0.518482
Average cost in epoch 181: 0.666167
training accuracy: 0.312500     test accuracy: 0.507493
Average cost in epoch 182: 0.665188
training accuracy: 0.593750     test accuracy: 0.511489
Average cost in epoch 183: 0.662069
training accuracy: 0.718750     test accuracy: 0.510490
Average cost in epoch 184: 0.659898
training accuracy: 0.562500     test accuracy: 0.499500

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 185: 0.666036
training accuracy: 0.718750     test accuracy: 0.544456
Average cost in epoch 186: 0.661791
training accuracy: 0.531250     test accuracy: 0.490509
Average cost in epoch 187: 0.664067
training accuracy: 0.500000     test accuracy: 0.526474
Average cost in epoch 188: 0.658845
training accuracy: 0.562500     test accuracy: 0.501499
Average cost in epoch 189: 0.660851
training accuracy: 0.437500     test accuracy: 0.546454

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 190: 0.663034
training accuracy: 0.437500     test accuracy: 0.511489
Average cost in epoch 191: 0.663494
training accuracy: 0.500000     test accuracy: 0.517483
Average cost in epoch 192: 0.660470
training accuracy: 0.656250     test accuracy: 0.516484
Average cost in epoch 193: 0.663848
training accuracy: 0.562500     test accuracy: 0.518482
Average cost in epoch 194: 0.662049
training accuracy: 0.625000     test accuracy: 0.493506

dump to weights/att-lstm/att-lstm_17.pkl

Average cost in epoch 195: 0.657179
training accuracy: 0.531250     test accuracy: 0.512488
Average cost in epoch 196: 0.658387
training accuracy: 0.593750     test accuracy: 0.498501
Average cost in epoch 197: 0.662328
training accuracy: 0.531250     test accuracy: 0.517483
Average cost in epoch 198: 0.658657
training accuracy: 0.406250     test accuracy: 0.507493
Average cost in epoch 199: 0.654658
training accuracy: 0.593750     test accuracy: 0.531469

dump to weights/att-lstm/att-lstm_17.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 18, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_18.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 120.44
Starting training...
Average cost in epoch 0: 0.440853
training accuracy: 0.843750     test accuracy: 0.893107
Average cost in epoch 1: 0.145947
training accuracy: 0.906250     test accuracy: 0.893107
Average cost in epoch 2: 0.128196
training accuracy: 0.906250     test accuracy: 0.919081
Average cost in epoch 3: 0.126720
training accuracy: 0.812500     test accuracy: 0.893107
Average cost in epoch 4: 0.135061
training accuracy: 0.968750     test accuracy: 0.893107

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 5: 0.124290
training accuracy: 0.906250     test accuracy: 0.915085
lr decays to 0.009000
Average cost in epoch 6: 0.125354
training accuracy: 0.812500     test accuracy: 0.892108
Average cost in epoch 7: 0.127770
training accuracy: 0.906250     test accuracy: 0.893107
Average cost in epoch 8: 0.122749
training accuracy: 1.000000     test accuracy: 0.914086
Average cost in epoch 9: 0.125457
training accuracy: 0.968750     test accuracy: 0.918082

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 10: 0.123631
training accuracy: 0.875000     test accuracy: 0.913087
lr decays to 0.008100
Average cost in epoch 11: 0.125514
training accuracy: 0.937500     test accuracy: 0.911089
Average cost in epoch 12: 0.124713
training accuracy: 0.968750     test accuracy: 0.915085
Average cost in epoch 13: 0.124591
training accuracy: 0.968750     test accuracy: 0.918082
Average cost in epoch 14: 0.126326
training accuracy: 0.875000     test accuracy: 0.913087

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 15: 0.122696
training accuracy: 0.937500     test accuracy: 0.909091
lr decays to 0.007290
Average cost in epoch 16: 0.123248
training accuracy: 0.968750     test accuracy: 0.912088
Average cost in epoch 17: 0.123650
training accuracy: 0.781250     test accuracy: 0.915085
Average cost in epoch 18: 0.121322
training accuracy: 0.843750     test accuracy: 0.900100
Average cost in epoch 19: 0.125510
training accuracy: 0.937500     test accuracy: 0.914086

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 20: 0.122342
training accuracy: 0.968750     test accuracy: 0.903097
lr decays to 0.006561
Average cost in epoch 21: 0.122794
training accuracy: 0.843750     test accuracy: 0.908092
Average cost in epoch 22: 0.124367
training accuracy: 0.843750     test accuracy: 0.915085
Average cost in epoch 23: 0.127742
training accuracy: 0.906250     test accuracy: 0.907093
Average cost in epoch 24: 0.122459
training accuracy: 0.937500     test accuracy: 0.900100

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 25: 0.125209
training accuracy: 0.937500     test accuracy: 0.908092
lr decays to 0.005905
Average cost in epoch 26: 0.121975
training accuracy: 0.968750     test accuracy: 0.909091
Average cost in epoch 27: 0.122303
training accuracy: 0.968750     test accuracy: 0.917083
Average cost in epoch 28: 0.125508
training accuracy: 0.937500     test accuracy: 0.911089
Average cost in epoch 29: 0.124164
training accuracy: 0.843750     test accuracy: 0.917083

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 30: 0.122666
training accuracy: 0.906250     test accuracy: 0.909091
lr decays to 0.005314
Average cost in epoch 31: 0.122550
training accuracy: 0.937500     test accuracy: 0.918082
Average cost in epoch 32: 0.123506
training accuracy: 0.906250     test accuracy: 0.917083
Average cost in epoch 33: 0.124212
training accuracy: 0.843750     test accuracy: 0.919081
Average cost in epoch 34: 0.122638
training accuracy: 0.968750     test accuracy: 0.903097

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 35: 0.122342
training accuracy: 0.968750     test accuracy: 0.910090
lr decays to 0.004783
Average cost in epoch 36: 0.121232
training accuracy: 0.875000     test accuracy: 0.904096
Average cost in epoch 37: 0.124256
training accuracy: 0.843750     test accuracy: 0.916084
Average cost in epoch 38: 0.123259
training accuracy: 0.906250     test accuracy: 0.903097
Average cost in epoch 39: 0.121652
training accuracy: 0.937500     test accuracy: 0.901099

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 40: 0.122987
training accuracy: 0.937500     test accuracy: 0.902098
lr decays to 0.004305
Average cost in epoch 41: 0.124623
training accuracy: 0.937500     test accuracy: 0.916084
Average cost in epoch 42: 0.121800
training accuracy: 0.937500     test accuracy: 0.891109
Average cost in epoch 43: 0.123074
training accuracy: 0.906250     test accuracy: 0.916084
Average cost in epoch 44: 0.122072
training accuracy: 0.937500     test accuracy: 0.898102

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 45: 0.122518
training accuracy: 0.906250     test accuracy: 0.905095
lr decays to 0.003874
Average cost in epoch 46: 0.122395
training accuracy: 0.968750     test accuracy: 0.901099
Average cost in epoch 47: 0.122217
training accuracy: 0.937500     test accuracy: 0.920080
Average cost in epoch 48: 0.122549
training accuracy: 0.968750     test accuracy: 0.926074
Average cost in epoch 49: 0.120860
training accuracy: 0.937500     test accuracy: 0.915085

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 50: 0.120757
training accuracy: 1.000000     test accuracy: 0.913087
lr decays to 0.003487
Average cost in epoch 51: 0.122268
training accuracy: 0.968750     test accuracy: 0.913087
Average cost in epoch 52: 0.120163
training accuracy: 0.843750     test accuracy: 0.904096
Average cost in epoch 53: 0.119941
training accuracy: 0.906250     test accuracy: 0.928072
Average cost in epoch 54: 0.120922
training accuracy: 0.968750     test accuracy: 0.912088

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 55: 0.122362
training accuracy: 0.937500     test accuracy: 0.922078
lr decays to 0.003138
Average cost in epoch 56: 0.121584
training accuracy: 0.906250     test accuracy: 0.922078
Average cost in epoch 57: 0.121096
training accuracy: 0.968750     test accuracy: 0.908092
Average cost in epoch 58: 0.122451
training accuracy: 0.937500     test accuracy: 0.917083
Average cost in epoch 59: 0.121734
training accuracy: 0.937500     test accuracy: 0.917083

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 60: 0.122385
training accuracy: 0.968750     test accuracy: 0.909091
lr decays to 0.002824
Average cost in epoch 61: 0.120782
training accuracy: 0.937500     test accuracy: 0.907093
Average cost in epoch 62: 0.119763
training accuracy: 0.937500     test accuracy: 0.915085
Average cost in epoch 63: 0.120542
training accuracy: 0.937500     test accuracy: 0.904096
Average cost in epoch 64: 0.116910
training accuracy: 0.937500     test accuracy: 0.911089

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 65: 0.121547
training accuracy: 0.937500     test accuracy: 0.906094
lr decays to 0.002542
Average cost in epoch 66: 0.117588
training accuracy: 0.875000     test accuracy: 0.910090
Average cost in epoch 67: 0.121031
training accuracy: 0.937500     test accuracy: 0.913087
Average cost in epoch 68: 0.116898
training accuracy: 0.937500     test accuracy: 0.901099
Average cost in epoch 69: 0.119228
training accuracy: 1.000000     test accuracy: 0.909091

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 70: 0.122513
training accuracy: 0.906250     test accuracy: 0.901099
lr decays to 0.002288
Average cost in epoch 71: 0.115324
training accuracy: 0.781250     test accuracy: 0.903097
Average cost in epoch 72: 0.120035
training accuracy: 0.968750     test accuracy: 0.914086
Average cost in epoch 73: 0.118477
training accuracy: 0.937500     test accuracy: 0.904096
Average cost in epoch 74: 0.118788
training accuracy: 0.968750     test accuracy: 0.901099

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 75: 0.119217
training accuracy: 0.968750     test accuracy: 0.918082
lr decays to 0.002059
Average cost in epoch 76: 0.121010
training accuracy: 0.906250     test accuracy: 0.918082
Average cost in epoch 77: 0.116485
training accuracy: 0.937500     test accuracy: 0.911089
Average cost in epoch 78: 0.115481
training accuracy: 0.906250     test accuracy: 0.906094
Average cost in epoch 79: 0.122269
training accuracy: 0.875000     test accuracy: 0.918082

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 80: 0.115818
training accuracy: 0.937500     test accuracy: 0.906094
lr decays to 0.001853
Average cost in epoch 81: 0.116685
training accuracy: 0.937500     test accuracy: 0.913087
Average cost in epoch 82: 0.118348
training accuracy: 0.906250     test accuracy: 0.910090
Average cost in epoch 83: 0.117002
training accuracy: 0.906250     test accuracy: 0.903097
Average cost in epoch 84: 0.116859
training accuracy: 0.906250     test accuracy: 0.903097

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 85: 0.115218
training accuracy: 0.968750     test accuracy: 0.912088
lr decays to 0.001668
Average cost in epoch 86: 0.117053
training accuracy: 0.875000     test accuracy: 0.904096
Average cost in epoch 87: 0.114193
training accuracy: 0.937500     test accuracy: 0.908092
Average cost in epoch 88: 0.113445
training accuracy: 0.968750     test accuracy: 0.901099
Average cost in epoch 89: 0.118016
training accuracy: 0.906250     test accuracy: 0.906094

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 90: 0.113386
training accuracy: 0.906250     test accuracy: 0.908092
lr decays to 0.001501
Average cost in epoch 91: 0.115762
training accuracy: 0.937500     test accuracy: 0.904096
Average cost in epoch 92: 0.114348
training accuracy: 0.906250     test accuracy: 0.915085
Average cost in epoch 93: 0.114198
training accuracy: 0.968750     test accuracy: 0.905095
Average cost in epoch 94: 0.116613
training accuracy: 0.875000     test accuracy: 0.915085

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 95: 0.113232
training accuracy: 0.937500     test accuracy: 0.914086
lr decays to 0.001351
Average cost in epoch 96: 0.117067
training accuracy: 0.937500     test accuracy: 0.918082
Average cost in epoch 97: 0.112809
training accuracy: 0.937500     test accuracy: 0.906094
Average cost in epoch 98: 0.115639
training accuracy: 0.937500     test accuracy: 0.908092
Average cost in epoch 99: 0.111077
training accuracy: 0.968750     test accuracy: 0.897103

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 100: 0.116906
training accuracy: 0.937500     test accuracy: 0.909091
lr decays to 0.001216
Average cost in epoch 101: 0.118131
training accuracy: 0.968750     test accuracy: 0.916084
Average cost in epoch 102: 0.112682
training accuracy: 0.937500     test accuracy: 0.915085
Average cost in epoch 103: 0.115197
training accuracy: 0.968750     test accuracy: 0.913087
Average cost in epoch 104: 0.115509
training accuracy: 0.906250     test accuracy: 0.909091

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 105: 0.114797
training accuracy: 0.937500     test accuracy: 0.907093
Average cost in epoch 106: 0.112100
training accuracy: 0.937500     test accuracy: 0.896104
Average cost in epoch 107: 0.116524
training accuracy: 0.968750     test accuracy: 0.908092
Average cost in epoch 108: 0.109524
training accuracy: 0.937500     test accuracy: 0.911089
Average cost in epoch 109: 0.113110
training accuracy: 0.906250     test accuracy: 0.905095

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 110: 0.114083
training accuracy: 0.937500     test accuracy: 0.911089
Average cost in epoch 111: 0.113866
training accuracy: 0.937500     test accuracy: 0.912088
Average cost in epoch 112: 0.115510
training accuracy: 0.968750     test accuracy: 0.901099
Average cost in epoch 113: 0.112066
training accuracy: 0.906250     test accuracy: 0.908092
Average cost in epoch 114: 0.113799
training accuracy: 0.968750     test accuracy: 0.914086

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 115: 0.114322
training accuracy: 0.968750     test accuracy: 0.914086
Average cost in epoch 116: 0.110903
training accuracy: 0.968750     test accuracy: 0.903097
Average cost in epoch 117: 0.112864
training accuracy: 0.968750     test accuracy: 0.896104
Average cost in epoch 118: 0.115712
training accuracy: 0.937500     test accuracy: 0.911089
Average cost in epoch 119: 0.114519
training accuracy: 0.968750     test accuracy: 0.907093

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 120: 0.113961
training accuracy: 0.937500     test accuracy: 0.911089
Average cost in epoch 121: 0.111781
training accuracy: 0.937500     test accuracy: 0.916084
Average cost in epoch 122: 0.115899
training accuracy: 1.000000     test accuracy: 0.895105
Average cost in epoch 123: 0.112203
training accuracy: 0.937500     test accuracy: 0.915085
Average cost in epoch 124: 0.114692
training accuracy: 0.937500     test accuracy: 0.912088

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 125: 0.111014
training accuracy: 0.875000     test accuracy: 0.904096
Average cost in epoch 126: 0.112569
training accuracy: 0.968750     test accuracy: 0.907093
Average cost in epoch 127: 0.111670
training accuracy: 0.906250     test accuracy: 0.908092
Average cost in epoch 128: 0.110073
training accuracy: 1.000000     test accuracy: 0.905095
Average cost in epoch 129: 0.113124
training accuracy: 0.968750     test accuracy: 0.902098

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 130: 0.113486
training accuracy: 0.937500     test accuracy: 0.908092
Average cost in epoch 131: 0.111214
training accuracy: 1.000000     test accuracy: 0.915085
Average cost in epoch 132: 0.110583
training accuracy: 1.000000     test accuracy: 0.907093
Average cost in epoch 133: 0.115241
training accuracy: 0.937500     test accuracy: 0.904096
Average cost in epoch 134: 0.109994
training accuracy: 0.968750     test accuracy: 0.904096

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 135: 0.110305
training accuracy: 0.968750     test accuracy: 0.913087
Average cost in epoch 136: 0.111138
training accuracy: 0.875000     test accuracy: 0.907093
Average cost in epoch 137: 0.111525
training accuracy: 0.937500     test accuracy: 0.913087
Average cost in epoch 138: 0.111667
training accuracy: 0.906250     test accuracy: 0.899101
Average cost in epoch 139: 0.109401
training accuracy: 0.937500     test accuracy: 0.912088

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 140: 0.113345
training accuracy: 0.968750     test accuracy: 0.913087
Average cost in epoch 141: 0.108740
training accuracy: 0.875000     test accuracy: 0.911089
Average cost in epoch 142: 0.109087
training accuracy: 1.000000     test accuracy: 0.905095
Average cost in epoch 143: 0.111286
training accuracy: 0.937500     test accuracy: 0.905095
Average cost in epoch 144: 0.114895
training accuracy: 0.875000     test accuracy: 0.902098

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 145: 0.111305
training accuracy: 0.937500     test accuracy: 0.910090
Average cost in epoch 146: 0.110293
training accuracy: 0.937500     test accuracy: 0.903097
Average cost in epoch 147: 0.111449
training accuracy: 0.968750     test accuracy: 0.907093
Average cost in epoch 148: 0.114457
training accuracy: 0.937500     test accuracy: 0.904096
Average cost in epoch 149: 0.111254
training accuracy: 0.875000     test accuracy: 0.903097

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 150: 0.111973
training accuracy: 0.843750     test accuracy: 0.906094
Average cost in epoch 151: 0.110235
training accuracy: 0.968750     test accuracy: 0.910090
Average cost in epoch 152: 0.112216
training accuracy: 0.937500     test accuracy: 0.907093
Average cost in epoch 153: 0.111783
training accuracy: 0.937500     test accuracy: 0.907093
Average cost in epoch 154: 0.110525
training accuracy: 0.937500     test accuracy: 0.903097

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 155: 0.112433
training accuracy: 1.000000     test accuracy: 0.903097
Average cost in epoch 156: 0.105818
training accuracy: 0.843750     test accuracy: 0.902098
Average cost in epoch 157: 0.112112
training accuracy: 0.968750     test accuracy: 0.904096
Average cost in epoch 158: 0.110321
training accuracy: 0.906250     test accuracy: 0.909091
Average cost in epoch 159: 0.110239
training accuracy: 1.000000     test accuracy: 0.912088

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 160: 0.114079
training accuracy: 0.937500     test accuracy: 0.902098
Average cost in epoch 161: 0.109121
training accuracy: 0.968750     test accuracy: 0.909091
Average cost in epoch 162: 0.110572
training accuracy: 1.000000     test accuracy: 0.901099
Average cost in epoch 163: 0.112442
training accuracy: 0.937500     test accuracy: 0.909091
Average cost in epoch 164: 0.110480
training accuracy: 0.968750     test accuracy: 0.906094

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 165: 0.106427
training accuracy: 0.937500     test accuracy: 0.910090
Average cost in epoch 166: 0.110447
training accuracy: 0.906250     test accuracy: 0.900100
Average cost in epoch 167: 0.107402
training accuracy: 1.000000     test accuracy: 0.902098
Average cost in epoch 168: 0.111465
training accuracy: 0.906250     test accuracy: 0.907093
Average cost in epoch 169: 0.105734
training accuracy: 0.937500     test accuracy: 0.907093

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 170: 0.112672
training accuracy: 0.875000     test accuracy: 0.902098
Average cost in epoch 171: 0.113816
training accuracy: 0.875000     test accuracy: 0.902098
Average cost in epoch 172: 0.108024
training accuracy: 0.937500     test accuracy: 0.899101
Average cost in epoch 173: 0.108660
training accuracy: 0.843750     test accuracy: 0.910090
Average cost in epoch 174: 0.113236
training accuracy: 0.906250     test accuracy: 0.908092

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 175: 0.108584
training accuracy: 0.968750     test accuracy: 0.907093
Average cost in epoch 176: 0.110283
training accuracy: 0.875000     test accuracy: 0.905095
Average cost in epoch 177: 0.109523
training accuracy: 0.968750     test accuracy: 0.904096
Average cost in epoch 178: 0.106766
training accuracy: 0.937500     test accuracy: 0.914086
Average cost in epoch 179: 0.107493
training accuracy: 0.968750     test accuracy: 0.899101

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 180: 0.108358
training accuracy: 0.906250     test accuracy: 0.903097
Average cost in epoch 181: 0.109538
training accuracy: 1.000000     test accuracy: 0.910090
Average cost in epoch 182: 0.106240
training accuracy: 0.937500     test accuracy: 0.909091
Average cost in epoch 183: 0.108393
training accuracy: 0.875000     test accuracy: 0.905095
Average cost in epoch 184: 0.109860
training accuracy: 0.875000     test accuracy: 0.911089

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 185: 0.107154
training accuracy: 0.906250     test accuracy: 0.904096
Average cost in epoch 186: 0.107817
training accuracy: 0.937500     test accuracy: 0.908092
Average cost in epoch 187: 0.108403
training accuracy: 0.968750     test accuracy: 0.898102
Average cost in epoch 188: 0.111096
training accuracy: 0.937500     test accuracy: 0.902098
Average cost in epoch 189: 0.106962
training accuracy: 0.968750     test accuracy: 0.904096

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 190: 0.108912
training accuracy: 0.968750     test accuracy: 0.898102
Average cost in epoch 191: 0.108902
training accuracy: 0.906250     test accuracy: 0.894106
Average cost in epoch 192: 0.108671
training accuracy: 1.000000     test accuracy: 0.909091
Average cost in epoch 193: 0.105620
training accuracy: 0.968750     test accuracy: 0.897103
Average cost in epoch 194: 0.104324
training accuracy: 0.906250     test accuracy: 0.898102

dump to weights/att-lstm/att-lstm_18.pkl

Average cost in epoch 195: 0.108043
training accuracy: 0.937500     test accuracy: 0.904096
Average cost in epoch 196: 0.104887
training accuracy: 0.937500     test accuracy: 0.906094
Average cost in epoch 197: 0.107064
training accuracy: 0.937500     test accuracy: 0.896104
Average cost in epoch 198: 0.106932
training accuracy: 0.968750     test accuracy: 0.901099
Average cost in epoch 199: 0.104019
training accuracy: 0.937500     test accuracy: 0.899101

dump to weights/att-lstm/att-lstm_18.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 19, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_19.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 116.47
Starting training...
Average cost in epoch 0: 2.535177
training accuracy: 0.062500     test accuracy: 0.103896
Average cost in epoch 1: 2.473846
training accuracy: 0.093750     test accuracy: 0.108891
Average cost in epoch 2: 2.468306
training accuracy: 0.062500     test accuracy: 0.098901
Average cost in epoch 3: 2.462637
training accuracy: 0.062500     test accuracy: 0.108891
Average cost in epoch 4: 2.461104
training accuracy: 0.093750     test accuracy: 0.091908

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 5: 2.462469
training accuracy: 0.156250     test accuracy: 0.097902
lr decays to 0.009000
Average cost in epoch 6: 2.459254
training accuracy: 0.156250     test accuracy: 0.086913
Average cost in epoch 7: 2.459729
training accuracy: 0.156250     test accuracy: 0.088911
Average cost in epoch 8: 2.457851
training accuracy: 0.093750     test accuracy: 0.105894
Average cost in epoch 9: 2.458089
training accuracy: 0.312500     test accuracy: 0.093906

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 10: 2.457563
training accuracy: 0.093750     test accuracy: 0.098901
lr decays to 0.008100
Average cost in epoch 11: 2.457175
training accuracy: 0.187500     test accuracy: 0.103896
Average cost in epoch 12: 2.456318
training accuracy: 0.187500     test accuracy: 0.104895
Average cost in epoch 13: 2.455247
training accuracy: 0.156250     test accuracy: 0.102897
Average cost in epoch 14: 2.456086
training accuracy: 0.062500     test accuracy: 0.090909

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 15: 2.455595
training accuracy: 0.156250     test accuracy: 0.099900
lr decays to 0.007290
Average cost in epoch 16: 2.455770
training accuracy: 0.156250     test accuracy: 0.099900
Average cost in epoch 17: 2.452272
training accuracy: 0.093750     test accuracy: 0.101898
Average cost in epoch 18: 2.452817
training accuracy: 0.156250     test accuracy: 0.092907
Average cost in epoch 19: 2.453713
training accuracy: 0.187500     test accuracy: 0.107892

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 20: 2.450166
training accuracy: 0.031250     test accuracy: 0.091908
lr decays to 0.006561
Average cost in epoch 21: 2.452606
training accuracy: 0.281250     test accuracy: 0.101898
Average cost in epoch 22: 2.453778
training accuracy: 0.156250     test accuracy: 0.097902
Average cost in epoch 23: 2.451610
training accuracy: 0.062500     test accuracy: 0.088911
Average cost in epoch 24: 2.453986
training accuracy: 0.187500     test accuracy: 0.091908

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 25: 2.451514
training accuracy: 0.093750     test accuracy: 0.099900
lr decays to 0.005905
Average cost in epoch 26: 2.448350
training accuracy: 0.093750     test accuracy: 0.100899
Average cost in epoch 27: 2.448928
training accuracy: 0.125000     test accuracy: 0.097902
Average cost in epoch 28: 2.451097
training accuracy: 0.218750     test accuracy: 0.103896
Average cost in epoch 29: 2.448638
training accuracy: 0.218750     test accuracy: 0.092907

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 30: 2.450161
training accuracy: 0.187500     test accuracy: 0.096903
lr decays to 0.005314
Average cost in epoch 31: 2.445426
training accuracy: 0.062500     test accuracy: 0.107892
Average cost in epoch 32: 2.449472
training accuracy: 0.062500     test accuracy: 0.087912
Average cost in epoch 33: 2.445304
training accuracy: 0.156250     test accuracy: 0.091908
Average cost in epoch 34: 2.449292
training accuracy: 0.062500     test accuracy: 0.095904

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 35: 2.446614
training accuracy: 0.125000     test accuracy: 0.104895
lr decays to 0.004783
Average cost in epoch 36: 2.445924
training accuracy: 0.125000     test accuracy: 0.093906
Average cost in epoch 37: 2.447114
training accuracy: 0.062500     test accuracy: 0.093906
Average cost in epoch 38: 2.446141
training accuracy: 0.125000     test accuracy: 0.097902
Average cost in epoch 39: 2.450178
training accuracy: 0.125000     test accuracy: 0.099900

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 40: 2.444935
training accuracy: 0.250000     test accuracy: 0.101898
lr decays to 0.004305
Average cost in epoch 41: 2.444431
training accuracy: 0.031250     test accuracy: 0.093906
Average cost in epoch 42: 2.444000
training accuracy: 0.187500     test accuracy: 0.102897
Average cost in epoch 43: 2.445239
training accuracy: 0.250000     test accuracy: 0.090909
Average cost in epoch 44: 2.443964
training accuracy: 0.156250     test accuracy: 0.100899

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 45: 2.443187
training accuracy: 0.000000     test accuracy: 0.098901
lr decays to 0.003874
Average cost in epoch 46: 2.441893
training accuracy: 0.156250     test accuracy: 0.095904
Average cost in epoch 47: 2.441471
training accuracy: 0.093750     test accuracy: 0.083916
Average cost in epoch 48: 2.440431
training accuracy: 0.125000     test accuracy: 0.097902
Average cost in epoch 49: 2.443474
training accuracy: 0.156250     test accuracy: 0.082917

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 50: 2.441764
training accuracy: 0.093750     test accuracy: 0.101898
lr decays to 0.003487
Average cost in epoch 51: 2.439717
training accuracy: 0.343750     test accuracy: 0.093906
Average cost in epoch 52: 2.439609
training accuracy: 0.125000     test accuracy: 0.089910
Average cost in epoch 53: 2.438213
training accuracy: 0.062500     test accuracy: 0.098901
Average cost in epoch 54: 2.436362
training accuracy: 0.093750     test accuracy: 0.094905

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 55: 2.436899
training accuracy: 0.156250     test accuracy: 0.098901
lr decays to 0.003138
Average cost in epoch 56: 2.434964
training accuracy: 0.093750     test accuracy: 0.108891
Average cost in epoch 57: 2.436420
training accuracy: 0.062500     test accuracy: 0.095904
Average cost in epoch 58: 2.438798
training accuracy: 0.281250     test accuracy: 0.102897
Average cost in epoch 59: 2.435256
training accuracy: 0.093750     test accuracy: 0.106893

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 60: 2.436213
training accuracy: 0.125000     test accuracy: 0.103896
lr decays to 0.002824
Average cost in epoch 61: 2.433265
training accuracy: 0.250000     test accuracy: 0.099900
Average cost in epoch 62: 2.433625
training accuracy: 0.125000     test accuracy: 0.102897
Average cost in epoch 63: 2.433004
training accuracy: 0.156250     test accuracy: 0.112887
Average cost in epoch 64: 2.434321
training accuracy: 0.187500     test accuracy: 0.115884

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 65: 2.427808
training accuracy: 0.093750     test accuracy: 0.107892
lr decays to 0.002542
Average cost in epoch 66: 2.434181
training accuracy: 0.093750     test accuracy: 0.091908
Average cost in epoch 67: 2.432972
training accuracy: 0.187500     test accuracy: 0.097902
Average cost in epoch 68: 2.433501
training accuracy: 0.000000     test accuracy: 0.106893
Average cost in epoch 69: 2.426256
training accuracy: 0.187500     test accuracy: 0.099900

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 70: 2.428175
training accuracy: 0.187500     test accuracy: 0.105894
lr decays to 0.002288
Average cost in epoch 71: 2.429947
training accuracy: 0.093750     test accuracy: 0.104895
Average cost in epoch 72: 2.428164
training accuracy: 0.156250     test accuracy: 0.119880
Average cost in epoch 73: 2.425187
training accuracy: 0.156250     test accuracy: 0.102897
Average cost in epoch 74: 2.425624
training accuracy: 0.062500     test accuracy: 0.108891

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 75: 2.427406
training accuracy: 0.031250     test accuracy: 0.096903
lr decays to 0.002059
Average cost in epoch 76: 2.426344
training accuracy: 0.156250     test accuracy: 0.098901
Average cost in epoch 77: 2.426119
training accuracy: 0.250000     test accuracy: 0.114885
Average cost in epoch 78: 2.424275
training accuracy: 0.093750     test accuracy: 0.094905
Average cost in epoch 79: 2.421446
training accuracy: 0.156250     test accuracy: 0.103896

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 80: 2.426586
training accuracy: 0.125000     test accuracy: 0.100899
lr decays to 0.001853
Average cost in epoch 81: 2.422509
training accuracy: 0.156250     test accuracy: 0.090909
Average cost in epoch 82: 2.421121
training accuracy: 0.125000     test accuracy: 0.110889
Average cost in epoch 83: 2.424351
training accuracy: 0.125000     test accuracy: 0.095904
Average cost in epoch 84: 2.418169
training accuracy: 0.187500     test accuracy: 0.103896

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 85: 2.420836
training accuracy: 0.093750     test accuracy: 0.104895
lr decays to 0.001668
Average cost in epoch 86: 2.418270
training accuracy: 0.156250     test accuracy: 0.091908
Average cost in epoch 87: 2.418327
training accuracy: 0.156250     test accuracy: 0.102897
Average cost in epoch 88: 2.417443
training accuracy: 0.062500     test accuracy: 0.096903
Average cost in epoch 89: 2.420853
training accuracy: 0.156250     test accuracy: 0.105894

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 90: 2.410640
training accuracy: 0.125000     test accuracy: 0.111888
lr decays to 0.001501
Average cost in epoch 91: 2.416701
training accuracy: 0.156250     test accuracy: 0.104895
Average cost in epoch 92: 2.416494
training accuracy: 0.125000     test accuracy: 0.102897
Average cost in epoch 93: 2.413759
training accuracy: 0.093750     test accuracy: 0.106893
Average cost in epoch 94: 2.412185
training accuracy: 0.093750     test accuracy: 0.106893

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 95: 2.416952
training accuracy: 0.125000     test accuracy: 0.099900
lr decays to 0.001351
Average cost in epoch 96: 2.411807
training accuracy: 0.125000     test accuracy: 0.102897
Average cost in epoch 97: 2.412285
training accuracy: 0.187500     test accuracy: 0.100899
Average cost in epoch 98: 2.410336
training accuracy: 0.093750     test accuracy: 0.094905
Average cost in epoch 99: 2.406486
training accuracy: 0.062500     test accuracy: 0.092907

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 100: 2.412016
training accuracy: 0.250000     test accuracy: 0.105894
lr decays to 0.001216
Average cost in epoch 101: 2.404121
training accuracy: 0.093750     test accuracy: 0.105894
Average cost in epoch 102: 2.408100
training accuracy: 0.125000     test accuracy: 0.106893
Average cost in epoch 103: 2.407099
training accuracy: 0.093750     test accuracy: 0.104895
Average cost in epoch 104: 2.406875
training accuracy: 0.125000     test accuracy: 0.103896

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 105: 2.404480
training accuracy: 0.312500     test accuracy: 0.104895
Average cost in epoch 106: 2.403057
training accuracy: 0.218750     test accuracy: 0.111888
Average cost in epoch 107: 2.405263
training accuracy: 0.156250     test accuracy: 0.097902
Average cost in epoch 108: 2.402673
training accuracy: 0.156250     test accuracy: 0.092907
Average cost in epoch 109: 2.397485
training accuracy: 0.218750     test accuracy: 0.094905

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 110: 2.401930
training accuracy: 0.187500     test accuracy: 0.095904
Average cost in epoch 111: 2.398995
training accuracy: 0.187500     test accuracy: 0.097902
Average cost in epoch 112: 2.402750
training accuracy: 0.125000     test accuracy: 0.103896
Average cost in epoch 113: 2.403430
training accuracy: 0.156250     test accuracy: 0.099900
Average cost in epoch 114: 2.400168
training accuracy: 0.125000     test accuracy: 0.098901

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 115: 2.397413
training accuracy: 0.031250     test accuracy: 0.097902
Average cost in epoch 116: 2.397447
training accuracy: 0.156250     test accuracy: 0.105894
Average cost in epoch 117: 2.404424
training accuracy: 0.125000     test accuracy: 0.097902
Average cost in epoch 118: 2.396518
training accuracy: 0.125000     test accuracy: 0.103896
Average cost in epoch 119: 2.399634
training accuracy: 0.218750     test accuracy: 0.104895

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 120: 2.400205
training accuracy: 0.125000     test accuracy: 0.112887
Average cost in epoch 121: 2.399699
training accuracy: 0.250000     test accuracy: 0.099900
Average cost in epoch 122: 2.401767
training accuracy: 0.125000     test accuracy: 0.105894
Average cost in epoch 123: 2.400162
training accuracy: 0.218750     test accuracy: 0.083916
Average cost in epoch 124: 2.399634
training accuracy: 0.156250     test accuracy: 0.098901

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 125: 2.396845
training accuracy: 0.125000     test accuracy: 0.098901
Average cost in epoch 126: 2.399461
training accuracy: 0.281250     test accuracy: 0.107892
Average cost in epoch 127: 2.399130
training accuracy: 0.125000     test accuracy: 0.096903
Average cost in epoch 128: 2.393058
training accuracy: 0.187500     test accuracy: 0.102897
Average cost in epoch 129: 2.395000
training accuracy: 0.125000     test accuracy: 0.091908

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 130: 2.400564
training accuracy: 0.187500     test accuracy: 0.082917
Average cost in epoch 131: 2.393114
training accuracy: 0.125000     test accuracy: 0.095904
Average cost in epoch 132: 2.394902
training accuracy: 0.125000     test accuracy: 0.100899
Average cost in epoch 133: 2.392715
training accuracy: 0.062500     test accuracy: 0.108891
Average cost in epoch 134: 2.396699
training accuracy: 0.156250     test accuracy: 0.085914

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 135: 2.398196
training accuracy: 0.031250     test accuracy: 0.102897
Average cost in epoch 136: 2.391851
training accuracy: 0.031250     test accuracy: 0.098901
Average cost in epoch 137: 2.391604
training accuracy: 0.156250     test accuracy: 0.105894
Average cost in epoch 138: 2.393289
training accuracy: 0.156250     test accuracy: 0.101898
Average cost in epoch 139: 2.391970
training accuracy: 0.062500     test accuracy: 0.096903

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 140: 2.395420
training accuracy: 0.218750     test accuracy: 0.105894
Average cost in epoch 141: 2.388027
training accuracy: 0.062500     test accuracy: 0.097902
Average cost in epoch 142: 2.387681
training accuracy: 0.281250     test accuracy: 0.110889
Average cost in epoch 143: 2.386501
training accuracy: 0.250000     test accuracy: 0.101898
Average cost in epoch 144: 2.395284
training accuracy: 0.156250     test accuracy: 0.102897

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 145: 2.388273
training accuracy: 0.156250     test accuracy: 0.105894
Average cost in epoch 146: 2.387063
training accuracy: 0.156250     test accuracy: 0.095904
Average cost in epoch 147: 2.388125
training accuracy: 0.062500     test accuracy: 0.099900
Average cost in epoch 148: 2.386134
training accuracy: 0.156250     test accuracy: 0.109890
Average cost in epoch 149: 2.388500
training accuracy: 0.125000     test accuracy: 0.098901

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 150: 2.388973
training accuracy: 0.125000     test accuracy: 0.096903
Average cost in epoch 151: 2.389213
training accuracy: 0.093750     test accuracy: 0.103896
Average cost in epoch 152: 2.386741
training accuracy: 0.187500     test accuracy: 0.092907
Average cost in epoch 153: 2.386548
training accuracy: 0.062500     test accuracy: 0.091908
Average cost in epoch 154: 2.387080
training accuracy: 0.250000     test accuracy: 0.094905

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 155: 2.388029
training accuracy: 0.093750     test accuracy: 0.105894
Average cost in epoch 156: 2.384618
training accuracy: 0.218750     test accuracy: 0.091908
Average cost in epoch 157: 2.381262
training accuracy: 0.156250     test accuracy: 0.099900
Average cost in epoch 158: 2.382100
training accuracy: 0.093750     test accuracy: 0.098901
Average cost in epoch 159: 2.382405
training accuracy: 0.062500     test accuracy: 0.094905

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 160: 2.384285
training accuracy: 0.093750     test accuracy: 0.097902
Average cost in epoch 161: 2.385368
training accuracy: 0.062500     test accuracy: 0.094905
Average cost in epoch 162: 2.382674
training accuracy: 0.156250     test accuracy: 0.096903
Average cost in epoch 163: 2.383172
training accuracy: 0.062500     test accuracy: 0.089910
Average cost in epoch 164: 2.382684
training accuracy: 0.062500     test accuracy: 0.091908

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 165: 2.380357
training accuracy: 0.250000     test accuracy: 0.101898
Average cost in epoch 166: 2.383522
training accuracy: 0.031250     test accuracy: 0.092907
Average cost in epoch 167: 2.381143
training accuracy: 0.125000     test accuracy: 0.092907
Average cost in epoch 168: 2.377789
training accuracy: 0.156250     test accuracy: 0.092907
Average cost in epoch 169: 2.380143
training accuracy: 0.187500     test accuracy: 0.099900

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 170: 2.384691
training accuracy: 0.312500     test accuracy: 0.099900
Average cost in epoch 171: 2.385125
training accuracy: 0.187500     test accuracy: 0.093906
Average cost in epoch 172: 2.378024
training accuracy: 0.000000     test accuracy: 0.098901
Average cost in epoch 173: 2.377468
training accuracy: 0.281250     test accuracy: 0.104895
Average cost in epoch 174: 2.382382
training accuracy: 0.093750     test accuracy: 0.095904

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 175: 2.380317
training accuracy: 0.218750     test accuracy: 0.103896
Average cost in epoch 176: 2.380641
training accuracy: 0.093750     test accuracy: 0.099900
Average cost in epoch 177: 2.378872
training accuracy: 0.093750     test accuracy: 0.090909
Average cost in epoch 178: 2.379433
training accuracy: 0.125000     test accuracy: 0.088911
Average cost in epoch 179: 2.378566
training accuracy: 0.093750     test accuracy: 0.099900

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 180: 2.374238
training accuracy: 0.250000     test accuracy: 0.093906
Average cost in epoch 181: 2.376455
training accuracy: 0.125000     test accuracy: 0.094905
Average cost in epoch 182: 2.376489
training accuracy: 0.031250     test accuracy: 0.103896
Average cost in epoch 183: 2.383139
training accuracy: 0.156250     test accuracy: 0.097902
Average cost in epoch 184: 2.372827
training accuracy: 0.187500     test accuracy: 0.105894

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 185: 2.379720
training accuracy: 0.281250     test accuracy: 0.089910
Average cost in epoch 186: 2.379411
training accuracy: 0.281250     test accuracy: 0.099900
Average cost in epoch 187: 2.375622
training accuracy: 0.093750     test accuracy: 0.101898
Average cost in epoch 188: 2.377372
training accuracy: 0.218750     test accuracy: 0.097902
Average cost in epoch 189: 2.370716
training accuracy: 0.062500     test accuracy: 0.102897

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 190: 2.374711
training accuracy: 0.218750     test accuracy: 0.094905
Average cost in epoch 191: 2.376496
training accuracy: 0.062500     test accuracy: 0.099900
Average cost in epoch 192: 2.369213
training accuracy: 0.125000     test accuracy: 0.093906
Average cost in epoch 193: 2.372189
training accuracy: 0.125000     test accuracy: 0.091908
Average cost in epoch 194: 2.368906
training accuracy: 0.156250     test accuracy: 0.098901

dump to weights/att-lstm/att-lstm_19.pkl

Average cost in epoch 195: 2.377011
training accuracy: 0.250000     test accuracy: 0.091908
Average cost in epoch 196: 2.369090
training accuracy: 0.125000     test accuracy: 0.100899
Average cost in epoch 197: 2.375408
training accuracy: 0.093750     test accuracy: 0.103896
Average cost in epoch 198: 2.366017
training accuracy: 0.156250     test accuracy: 0.102897
Average cost in epoch 199: 2.370241
training accuracy: 0.156250     test accuracy: 0.096903

dump to weights/att-lstm/att-lstm_19.pkl

/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 20, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "att-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/att-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "att-lstm_20.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid": 16, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "att-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 116.15
Starting training...
Average cost in epoch 0: 0.441670
training accuracy: 0.937500     test accuracy: 0.910090
Average cost in epoch 1: 0.183321
training accuracy: 0.937500     test accuracy: 0.912088
Average cost in epoch 2: 0.148389
training accuracy: 0.843750     test accuracy: 0.961039
Average cost in epoch 3: 0.125592
training accuracy: 0.968750     test accuracy: 0.968032
Average cost in epoch 4: 0.108041
training accuracy: 0.937500     test accuracy: 0.976024

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 5: 0.099875
training accuracy: 1.000000     test accuracy: 0.978022
lr decays to 0.009000
Average cost in epoch 6: 0.082712
training accuracy: 0.937500     test accuracy: 0.977023
Average cost in epoch 7: 0.085781
training accuracy: 1.000000     test accuracy: 0.978022
Average cost in epoch 8: 0.081283
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 9: 0.074401
training accuracy: 0.937500     test accuracy: 0.979021

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 10: 0.074888
training accuracy: 0.968750     test accuracy: 0.985015
lr decays to 0.008100
Average cost in epoch 11: 0.069757
training accuracy: 1.000000     test accuracy: 0.981019
Average cost in epoch 12: 0.069250
training accuracy: 0.968750     test accuracy: 0.983017
Average cost in epoch 13: 0.066988
training accuracy: 1.000000     test accuracy: 0.978022
Average cost in epoch 14: 0.069386
training accuracy: 0.968750     test accuracy: 0.981019

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 15: 0.066986
training accuracy: 1.000000     test accuracy: 0.983017
lr decays to 0.007290
Average cost in epoch 16: 0.061953
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 17: 0.064560
training accuracy: 1.000000     test accuracy: 0.983017
Average cost in epoch 18: 0.060221
training accuracy: 1.000000     test accuracy: 0.982018
Average cost in epoch 19: 0.062232
training accuracy: 0.937500     test accuracy: 0.983017

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 20: 0.059771
training accuracy: 1.000000     test accuracy: 0.980020
lr decays to 0.006561
Average cost in epoch 21: 0.058177
training accuracy: 1.000000     test accuracy: 0.982018
Average cost in epoch 22: 0.057155
training accuracy: 1.000000     test accuracy: 0.982018
Average cost in epoch 23: 0.054616
training accuracy: 1.000000     test accuracy: 0.981019
Average cost in epoch 24: 0.058099
training accuracy: 1.000000     test accuracy: 0.979021

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 25: 0.052859
training accuracy: 0.937500     test accuracy: 0.985015
lr decays to 0.005905
Average cost in epoch 26: 0.052918
training accuracy: 0.937500     test accuracy: 0.981019
Average cost in epoch 27: 0.051426
training accuracy: 0.968750     test accuracy: 0.981019
Average cost in epoch 28: 0.051487
training accuracy: 1.000000     test accuracy: 0.980020
Average cost in epoch 29: 0.052179
training accuracy: 1.000000     test accuracy: 0.980020

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 30: 0.049642
training accuracy: 1.000000     test accuracy: 0.983017
lr decays to 0.005314
Average cost in epoch 31: 0.046517
training accuracy: 1.000000     test accuracy: 0.983017
Average cost in epoch 32: 0.041405
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 33: 0.044744
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 34: 0.042550
training accuracy: 1.000000     test accuracy: 0.986014

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 35: 0.040718
training accuracy: 0.968750     test accuracy: 0.985015
lr decays to 0.004783
Average cost in epoch 36: 0.044585
training accuracy: 0.968750     test accuracy: 0.988012
Average cost in epoch 37: 0.039537
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 38: 0.038710
training accuracy: 0.968750     test accuracy: 0.990010
Average cost in epoch 39: 0.040458
training accuracy: 0.968750     test accuracy: 0.990010

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 40: 0.040188
training accuracy: 1.000000     test accuracy: 0.987013
lr decays to 0.004305
Average cost in epoch 41: 0.038704
training accuracy: 0.906250     test accuracy: 0.989011
Average cost in epoch 42: 0.034168
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 43: 0.033602
training accuracy: 0.968750     test accuracy: 0.987013
Average cost in epoch 44: 0.034834
training accuracy: 1.000000     test accuracy: 0.991009

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 45: 0.031075
training accuracy: 0.968750     test accuracy: 0.990010
lr decays to 0.003874
Average cost in epoch 46: 0.031827
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 47: 0.029092
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 48: 0.027978
training accuracy: 0.968750     test accuracy: 0.984016
Average cost in epoch 49: 0.027850
training accuracy: 1.000000     test accuracy: 0.991009

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 50: 0.026855
training accuracy: 0.968750     test accuracy: 0.988012
lr decays to 0.003487
Average cost in epoch 51: 0.023380
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 52: 0.026128
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 53: 0.026166
training accuracy: 0.937500     test accuracy: 0.990010
Average cost in epoch 54: 0.022503
training accuracy: 1.000000     test accuracy: 0.992008

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 55: 0.021913
training accuracy: 0.937500     test accuracy: 0.990010
lr decays to 0.003138
Average cost in epoch 56: 0.022405
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 57: 0.020782
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 58: 0.023419
training accuracy: 1.000000     test accuracy: 0.990010
Average cost in epoch 59: 0.020203
training accuracy: 1.000000     test accuracy: 0.991009

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 60: 0.021197
training accuracy: 1.000000     test accuracy: 0.991009
lr decays to 0.002824
Average cost in epoch 61: 0.019179
training accuracy: 1.000000     test accuracy: 0.991009
Average cost in epoch 62: 0.017471
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 63: 0.014757
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 64: 0.014507
training accuracy: 1.000000     test accuracy: 0.989011

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 65: 0.017350
training accuracy: 1.000000     test accuracy: 0.991009
lr decays to 0.002542
Average cost in epoch 66: 0.014390
training accuracy: 0.968750     test accuracy: 0.989011
Average cost in epoch 67: 0.013132
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 68: 0.013344
training accuracy: 1.000000     test accuracy: 0.991009
Average cost in epoch 69: 0.016659
training accuracy: 0.968750     test accuracy: 0.990010

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 70: 0.015222
training accuracy: 1.000000     test accuracy: 0.986014
lr decays to 0.002288
Average cost in epoch 71: 0.009654
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 72: 0.011345
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 73: 0.012478
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 74: 0.011206
training accuracy: 1.000000     test accuracy: 0.990010

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 75: 0.011855
training accuracy: 1.000000     test accuracy: 0.988012
lr decays to 0.002059
Average cost in epoch 76: 0.012230
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 77: 0.010463
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 78: 0.008992
training accuracy: 1.000000     test accuracy: 0.992008
Average cost in epoch 79: 0.009555
training accuracy: 1.000000     test accuracy: 0.986014

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 80: 0.009792
training accuracy: 1.000000     test accuracy: 0.988012
lr decays to 0.001853
Average cost in epoch 81: 0.009211
training accuracy: 1.000000     test accuracy: 0.990010
Average cost in epoch 82: 0.010339
training accuracy: 1.000000     test accuracy: 0.990010
Average cost in epoch 83: 0.009582
training accuracy: 1.000000     test accuracy: 0.990010
Average cost in epoch 84: 0.013449
training accuracy: 1.000000     test accuracy: 0.990010

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 85: 0.008593
training accuracy: 1.000000     test accuracy: 0.989011
lr decays to 0.001668
Average cost in epoch 86: 0.010814
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 87: 0.006406
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 88: 0.007025
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 89: 0.007810
training accuracy: 1.000000     test accuracy: 0.987013

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 90: 0.005946
training accuracy: 1.000000     test accuracy: 0.988012
lr decays to 0.001501
Average cost in epoch 91: 0.009222
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 92: 0.006284
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 93: 0.007170
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 94: 0.006876
training accuracy: 1.000000     test accuracy: 0.988012

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 95: 0.007836
training accuracy: 1.000000     test accuracy: 0.986014
lr decays to 0.001351
Average cost in epoch 96: 0.009994
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 97: 0.006785
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 98: 0.006821
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 99: 0.009600
training accuracy: 1.000000     test accuracy: 0.988012

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 100: 0.005701
training accuracy: 1.000000     test accuracy: 0.990010
lr decays to 0.001216
Average cost in epoch 101: 0.005833
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 102: 0.005271
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 103: 0.005989
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 104: 0.006535
training accuracy: 1.000000     test accuracy: 0.990010

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 105: 0.003265
training accuracy: 1.000000     test accuracy: 0.990010
Average cost in epoch 106: 0.005522
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 107: 0.005996
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 108: 0.005434
training accuracy: 1.000000     test accuracy: 0.990010
Average cost in epoch 109: 0.004672
training accuracy: 1.000000     test accuracy: 0.991009

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 110: 0.003634
training accuracy: 1.000000     test accuracy: 0.990010
Average cost in epoch 111: 0.009124
training accuracy: 1.000000     test accuracy: 0.990010
Average cost in epoch 112: 0.004867
training accuracy: 1.000000     test accuracy: 0.990010
Average cost in epoch 113: 0.005588
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 114: 0.004154
training accuracy: 1.000000     test accuracy: 0.987013

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 115: 0.005918
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 116: 0.002875
training accuracy: 0.968750     test accuracy: 0.986014
Average cost in epoch 117: 0.003640
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 118: 0.007938
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 119: 0.002705
training accuracy: 1.000000     test accuracy: 0.986014

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 120: 0.004362
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 121: 0.002702
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 122: 0.005750
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 123: 0.005039
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 124: 0.006195
training accuracy: 1.000000     test accuracy: 0.987013

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 125: 0.007540
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 126: 0.006098
training accuracy: 1.000000     test accuracy: 0.983017
Average cost in epoch 127: 0.006174
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 128: 0.008274
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 129: 0.007532
training accuracy: 1.000000     test accuracy: 0.987013

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 130: 0.005175
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 131: 0.003951
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 132: 0.005263
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 133: 0.002520
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 134: 0.003167
training accuracy: 1.000000     test accuracy: 0.989011

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 135: 0.005496
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 136: 0.005214
training accuracy: 0.968750     test accuracy: 0.987013
Average cost in epoch 137: 0.004773
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 138: 0.004752
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 139: 0.003135
training accuracy: 1.000000     test accuracy: 0.987013

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 140: 0.002777
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 141: 0.005137
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 142: 0.008367
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 143: 0.008344
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 144: 0.003541
training accuracy: 1.000000     test accuracy: 0.987013

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 145: 0.004007
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 146: 0.004221
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 147: 0.004467
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 148: 0.002290
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 149: 0.003807
training accuracy: 1.000000     test accuracy: 0.983017

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 150: 0.003179
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 151: 0.007902
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 152: 0.004168
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 153: 0.003475
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 154: 0.004813
training accuracy: 1.000000     test accuracy: 0.986014

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 155: 0.004712
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 156: 0.001846
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 157: 0.004680
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 158: 0.001677
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 159: 0.003873
training accuracy: 1.000000     test accuracy: 0.986014

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 160: 0.005530
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 161: 0.004658
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 162: 0.005576
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 163: 0.006434
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 164: 0.004885
training accuracy: 1.000000     test accuracy: 0.988012

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 165: 0.004683
training accuracy: 0.968750     test accuracy: 0.984016
Average cost in epoch 166: 0.002238
training accuracy: 1.000000     test accuracy: 0.983017
Average cost in epoch 167: 0.003274
training accuracy: 1.000000     test accuracy: 0.983017
Average cost in epoch 168: 0.006521
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 169: 0.003150
training accuracy: 1.000000     test accuracy: 0.985015

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 170: 0.002409
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 171: 0.002515
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 172: 0.006814
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 173: 0.005838
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 174: 0.004603
training accuracy: 1.000000     test accuracy: 0.985015

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 175: 0.005038
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 176: 0.003978
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 177: 0.011070
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 178: 0.008502
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 179: 0.001675
training accuracy: 1.000000     test accuracy: 0.985015

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 180: 0.003475
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 181: 0.001542
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 182: 0.006386
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 183: 0.004367
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 184: 0.003606
training accuracy: 0.968750     test accuracy: 0.984016

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 185: 0.009937
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 186: 0.001872
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 187: 0.006356
training accuracy: 0.968750     test accuracy: 0.984016
Average cost in epoch 188: 0.002586
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 189: 0.006198
training accuracy: 1.000000     test accuracy: 0.983017

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 190: 0.000803
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 191: 0.004231
training accuracy: 1.000000     test accuracy: 0.982018
Average cost in epoch 192: 0.002156
training accuracy: 1.000000     test accuracy: 0.983017
Average cost in epoch 193: 0.008916
training accuracy: 1.000000     test accuracy: 0.981019
Average cost in epoch 194: 0.003990
training accuracy: 1.000000     test accuracy: 0.984016

dump to weights/att-lstm/att-lstm_20.pkl

Average cost in epoch 195: 0.014107
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 196: 0.001896
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 197: 0.003477
training accuracy: 1.000000     test accuracy: 0.983017
Average cost in epoch 198: 0.002657
training accuracy: 1.000000     test accuracy: 0.983017
Average cost in epoch 199: 0.003856
training accuracy: 1.000000     test accuracy: 0.982018

dump to weights/att-lstm/att-lstm_20.pkl

