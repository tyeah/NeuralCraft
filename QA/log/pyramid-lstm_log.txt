/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 1, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_1.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 230.92
Starting training...
Average cost in epoch 0: 1.405352
training accuracy: 0.531250     test accuracy: 0.513487
Average cost in epoch 1: 1.205206
training accuracy: 0.593750     test accuracy: 0.526474
Average cost in epoch 2: 1.172723
training accuracy: 0.468750     test accuracy: 0.512488
Average cost in epoch 3: 1.151250
training accuracy: 0.656250     test accuracy: 0.509491
Average cost in epoch 4: 1.138658
training accuracy: 0.468750     test accuracy: 0.518482

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 5: 1.136426
training accuracy: 0.468750     test accuracy: 0.511489
lr decays to 0.009000
Average cost in epoch 6: 1.114021
training accuracy: 0.375000     test accuracy: 0.512488
Average cost in epoch 7: 1.109727
training accuracy: 0.562500     test accuracy: 0.529471
Average cost in epoch 8: 1.092896
training accuracy: 0.531250     test accuracy: 0.499500
Average cost in epoch 9: 1.087429
training accuracy: 0.437500     test accuracy: 0.505495

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 10: 1.093043
training accuracy: 0.531250     test accuracy: 0.516484
lr decays to 0.008100
Average cost in epoch 11: 1.083417
training accuracy: 0.531250     test accuracy: 0.528472
Average cost in epoch 12: 1.070445
training accuracy: 0.562500     test accuracy: 0.508492
Average cost in epoch 13: 1.064956
training accuracy: 0.468750     test accuracy: 0.527473
Average cost in epoch 14: 1.071634
training accuracy: 0.500000     test accuracy: 0.513487

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 15: 1.060889
training accuracy: 0.500000     test accuracy: 0.526474
lr decays to 0.007290
Average cost in epoch 16: 1.047639
training accuracy: 0.531250     test accuracy: 0.528472
Average cost in epoch 17: 1.048712
training accuracy: 0.750000     test accuracy: 0.524476
Average cost in epoch 18: 1.041052
training accuracy: 0.531250     test accuracy: 0.538462
Average cost in epoch 19: 1.041379
training accuracy: 0.562500     test accuracy: 0.525475

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 20: 1.031836
training accuracy: 0.468750     test accuracy: 0.516484
lr decays to 0.006561
Average cost in epoch 21: 1.032995
training accuracy: 0.593750     test accuracy: 0.519481
Average cost in epoch 22: 1.019735
training accuracy: 0.531250     test accuracy: 0.515485
Average cost in epoch 23: 1.014830
training accuracy: 0.593750     test accuracy: 0.516484
Average cost in epoch 24: 1.011401
training accuracy: 0.531250     test accuracy: 0.530470

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 25: 1.012594
training accuracy: 0.468750     test accuracy: 0.523477
lr decays to 0.005905
Average cost in epoch 26: 0.998761
training accuracy: 0.562500     test accuracy: 0.522478
Average cost in epoch 27: 0.995226
training accuracy: 0.500000     test accuracy: 0.521479
Average cost in epoch 28: 0.989317
training accuracy: 0.437500     test accuracy: 0.516484
Average cost in epoch 29: 0.991981
training accuracy: 0.656250     test accuracy: 0.524476

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 30: 0.992040
training accuracy: 0.531250     test accuracy: 0.514486
lr decays to 0.005314
Average cost in epoch 31: 0.980033
training accuracy: 0.687500     test accuracy: 0.510490
Average cost in epoch 32: 0.973085
training accuracy: 0.468750     test accuracy: 0.534466
Average cost in epoch 33: 0.971342
training accuracy: 0.593750     test accuracy: 0.533467
Average cost in epoch 34: 0.966409
training accuracy: 0.562500     test accuracy: 0.520480

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 35: 0.962330
training accuracy: 0.625000     test accuracy: 0.514486
lr decays to 0.004783
Average cost in epoch 36: 0.955446
training accuracy: 0.625000     test accuracy: 0.517483
Average cost in epoch 37: 0.941260
training accuracy: 0.562500     test accuracy: 0.525475
Average cost in epoch 38: 0.951477
training accuracy: 0.562500     test accuracy: 0.516484
Average cost in epoch 39: 0.942957
training accuracy: 0.656250     test accuracy: 0.531469

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 40: 0.943579
training accuracy: 0.531250     test accuracy: 0.525475
lr decays to 0.004305
Average cost in epoch 41: 0.926693
training accuracy: 0.593750     test accuracy: 0.517483
Average cost in epoch 42: 0.936934
training accuracy: 0.656250     test accuracy: 0.495504
Average cost in epoch 43: 0.920228
training accuracy: 0.656250     test accuracy: 0.526474
Average cost in epoch 44: 0.921716
training accuracy: 0.687500     test accuracy: 0.535465

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 45: 0.920163
training accuracy: 0.593750     test accuracy: 0.510490
lr decays to 0.003874
Average cost in epoch 46: 0.923384
training accuracy: 0.593750     test accuracy: 0.527473
Average cost in epoch 47: 0.907508
training accuracy: 0.656250     test accuracy: 0.511489
Average cost in epoch 48: 0.909889
training accuracy: 0.531250     test accuracy: 0.504496
Average cost in epoch 49: 0.904744
training accuracy: 0.687500     test accuracy: 0.523477

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 50: 0.904656
training accuracy: 0.531250     test accuracy: 0.522478
lr decays to 0.003487
Average cost in epoch 51: 0.904346
training accuracy: 0.625000     test accuracy: 0.517483
Average cost in epoch 52: 0.888054
training accuracy: 0.593750     test accuracy: 0.512488
Average cost in epoch 53: 0.889441
training accuracy: 0.593750     test accuracy: 0.516484
Average cost in epoch 54: 0.889788
training accuracy: 0.656250     test accuracy: 0.517483

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 55: 0.883787
training accuracy: 0.687500     test accuracy: 0.527473
lr decays to 0.003138
Average cost in epoch 56: 0.880139
training accuracy: 0.531250     test accuracy: 0.503497
Average cost in epoch 57: 0.868345
training accuracy: 0.593750     test accuracy: 0.524476
Average cost in epoch 58: 0.871087
training accuracy: 0.656250     test accuracy: 0.531469
Average cost in epoch 59: 0.859430
training accuracy: 0.593750     test accuracy: 0.511489

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 60: 0.855819
training accuracy: 0.468750     test accuracy: 0.505495
lr decays to 0.002824
Average cost in epoch 61: 0.855827
training accuracy: 0.687500     test accuracy: 0.528472
Average cost in epoch 62: 0.851243
training accuracy: 0.500000     test accuracy: 0.516484
Average cost in epoch 63: 0.850184
training accuracy: 0.687500     test accuracy: 0.520480
Average cost in epoch 64: 0.841661
training accuracy: 0.531250     test accuracy: 0.518482

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 65: 0.854732
training accuracy: 0.625000     test accuracy: 0.518482
lr decays to 0.002542
Average cost in epoch 66: 0.840195
training accuracy: 0.656250     test accuracy: 0.520480
Average cost in epoch 67: 0.834085
training accuracy: 0.593750     test accuracy: 0.508492
Average cost in epoch 68: 0.837993
training accuracy: 0.656250     test accuracy: 0.526474
Average cost in epoch 69: 0.835308
training accuracy: 0.687500     test accuracy: 0.522478

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 70: 0.832942
training accuracy: 0.593750     test accuracy: 0.522478
lr decays to 0.002288
Average cost in epoch 71: 0.824017
training accuracy: 0.562500     test accuracy: 0.512488
Average cost in epoch 72: 0.825972
training accuracy: 0.718750     test accuracy: 0.516484
Average cost in epoch 73: 0.833386
training accuracy: 0.718750     test accuracy: 0.507493
Average cost in epoch 74: 0.813940
training accuracy: 0.750000     test accuracy: 0.514486

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 75: 0.822312
training accuracy: 0.656250     test accuracy: 0.517483
lr decays to 0.002059
Average cost in epoch 76: 0.816522
training accuracy: 0.500000     test accuracy: 0.525475
Average cost in epoch 77: 0.810183
training accuracy: 0.500000     test accuracy: 0.520480
Average cost in epoch 78: 0.803383
training accuracy: 0.468750     test accuracy: 0.515485
Average cost in epoch 79: 0.808743
training accuracy: 0.593750     test accuracy: 0.505495

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 80: 0.815309
training accuracy: 0.656250     test accuracy: 0.523477
lr decays to 0.001853
Average cost in epoch 81: 0.812054
training accuracy: 0.718750     test accuracy: 0.516484
Average cost in epoch 82: 0.795760
training accuracy: 0.593750     test accuracy: 0.518482
Average cost in epoch 83: 0.792535
training accuracy: 0.593750     test accuracy: 0.516484
Average cost in epoch 84: 0.792253
training accuracy: 0.718750     test accuracy: 0.510490

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 85: 0.791720
training accuracy: 0.718750     test accuracy: 0.511489
lr decays to 0.001668
Average cost in epoch 86: 0.780144
training accuracy: 0.875000     test accuracy: 0.518482
Average cost in epoch 87: 0.792873
training accuracy: 0.625000     test accuracy: 0.514486
Average cost in epoch 88: 0.786346
training accuracy: 0.562500     test accuracy: 0.513487
Average cost in epoch 89: 0.781676
training accuracy: 0.562500     test accuracy: 0.514486

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 90: 0.769126
training accuracy: 0.718750     test accuracy: 0.503497
lr decays to 0.001501
Average cost in epoch 91: 0.785619
training accuracy: 0.625000     test accuracy: 0.507493
Average cost in epoch 92: 0.767324
training accuracy: 0.687500     test accuracy: 0.512488
Average cost in epoch 93: 0.777110
training accuracy: 0.656250     test accuracy: 0.505495
Average cost in epoch 94: 0.769297
training accuracy: 0.593750     test accuracy: 0.516484

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 95: 0.781633
training accuracy: 0.812500     test accuracy: 0.509491
lr decays to 0.001351
Average cost in epoch 96: 0.756708
training accuracy: 0.750000     test accuracy: 0.499500
Average cost in epoch 97: 0.764803
training accuracy: 0.750000     test accuracy: 0.517483
Average cost in epoch 98: 0.759120
training accuracy: 0.687500     test accuracy: 0.503497
Average cost in epoch 99: 0.768557
training accuracy: 0.718750     test accuracy: 0.497502

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 100: 0.751550
training accuracy: 0.500000     test accuracy: 0.508492
lr decays to 0.001216
Average cost in epoch 101: 0.761330
training accuracy: 0.781250     test accuracy: 0.516484
Average cost in epoch 102: 0.758238
training accuracy: 0.687500     test accuracy: 0.509491
Average cost in epoch 103: 0.756340
training accuracy: 0.781250     test accuracy: 0.506494
Average cost in epoch 104: 0.750855
training accuracy: 0.625000     test accuracy: 0.514486

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 105: 0.751028
training accuracy: 0.718750     test accuracy: 0.504496
Average cost in epoch 106: 0.747270
training accuracy: 0.718750     test accuracy: 0.520480
Average cost in epoch 107: 0.741773
training accuracy: 0.687500     test accuracy: 0.507493
Average cost in epoch 108: 0.751335
training accuracy: 0.656250     test accuracy: 0.514486
Average cost in epoch 109: 0.734252
training accuracy: 0.625000     test accuracy: 0.507493

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 110: 0.752694
training accuracy: 0.562500     test accuracy: 0.511489
Average cost in epoch 111: 0.740729
training accuracy: 0.625000     test accuracy: 0.518482
Average cost in epoch 112: 0.736079
training accuracy: 0.593750     test accuracy: 0.504496
Average cost in epoch 113: 0.744348
training accuracy: 0.718750     test accuracy: 0.509491
Average cost in epoch 114: 0.729422
training accuracy: 0.687500     test accuracy: 0.513487

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 115: 0.742099
training accuracy: 0.718750     test accuracy: 0.509491
Average cost in epoch 116: 0.741141
training accuracy: 0.718750     test accuracy: 0.514486
Average cost in epoch 117: 0.739602
training accuracy: 0.750000     test accuracy: 0.513487
Average cost in epoch 118: 0.747345
training accuracy: 0.687500     test accuracy: 0.517483
Average cost in epoch 119: 0.736120
training accuracy: 0.875000     test accuracy: 0.517483

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 120: 0.728267
training accuracy: 0.781250     test accuracy: 0.513487
Average cost in epoch 121: 0.738716
training accuracy: 0.656250     test accuracy: 0.512488
Average cost in epoch 122: 0.733229
training accuracy: 0.718750     test accuracy: 0.511489
Average cost in epoch 123: 0.733585
training accuracy: 0.843750     test accuracy: 0.516484
Average cost in epoch 124: 0.729287
training accuracy: 0.562500     test accuracy: 0.515485

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 125: 0.729320
training accuracy: 0.687500     test accuracy: 0.510490
Average cost in epoch 126: 0.743860
training accuracy: 0.593750     test accuracy: 0.506494
Average cost in epoch 127: 0.718490
training accuracy: 0.687500     test accuracy: 0.516484
Average cost in epoch 128: 0.725111
training accuracy: 0.593750     test accuracy: 0.506494
Average cost in epoch 129: 0.729647
training accuracy: 0.687500     test accuracy: 0.513487

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 130: 0.725155
training accuracy: 0.750000     test accuracy: 0.506494
Average cost in epoch 131: 0.732491
training accuracy: 0.718750     test accuracy: 0.510490
Average cost in epoch 132: 0.726588
training accuracy: 0.687500     test accuracy: 0.511489
Average cost in epoch 133: 0.724097
training accuracy: 0.718750     test accuracy: 0.506494
Average cost in epoch 134: 0.728244
training accuracy: 0.812500     test accuracy: 0.502498

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 135: 0.718223
training accuracy: 0.625000     test accuracy: 0.510490
Average cost in epoch 136: 0.724246
training accuracy: 0.656250     test accuracy: 0.508492
Average cost in epoch 137: 0.719885
training accuracy: 0.750000     test accuracy: 0.502498
Average cost in epoch 138: 0.727220
training accuracy: 0.593750     test accuracy: 0.501499
Average cost in epoch 139: 0.717373
training accuracy: 0.718750     test accuracy: 0.501499

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 140: 0.724379
training accuracy: 0.625000     test accuracy: 0.512488
Average cost in epoch 141: 0.730908
training accuracy: 0.718750     test accuracy: 0.518482
Average cost in epoch 142: 0.715140
training accuracy: 0.687500     test accuracy: 0.503497
Average cost in epoch 143: 0.717675
training accuracy: 0.781250     test accuracy: 0.511489
Average cost in epoch 144: 0.720099
training accuracy: 0.656250     test accuracy: 0.508492

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 145: 0.726468
training accuracy: 0.656250     test accuracy: 0.515485
Average cost in epoch 146: 0.715629
training accuracy: 0.625000     test accuracy: 0.518482
Average cost in epoch 147: 0.727520
training accuracy: 0.656250     test accuracy: 0.509491
Average cost in epoch 148: 0.715362
training accuracy: 0.812500     test accuracy: 0.506494
Average cost in epoch 149: 0.722129
training accuracy: 0.812500     test accuracy: 0.502498

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 150: 0.714634
training accuracy: 0.750000     test accuracy: 0.512488
Average cost in epoch 151: 0.713568
training accuracy: 0.593750     test accuracy: 0.494505
Average cost in epoch 152: 0.711588
training accuracy: 0.625000     test accuracy: 0.509491
Average cost in epoch 153: 0.726054
training accuracy: 0.750000     test accuracy: 0.515485
Average cost in epoch 154: 0.714483
training accuracy: 0.656250     test accuracy: 0.505495

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 155: 0.709133
training accuracy: 0.750000     test accuracy: 0.505495
Average cost in epoch 156: 0.721673
training accuracy: 0.843750     test accuracy: 0.495504
Average cost in epoch 157: 0.716491
training accuracy: 0.656250     test accuracy: 0.511489
Average cost in epoch 158: 0.712404
training accuracy: 0.687500     test accuracy: 0.507493
Average cost in epoch 159: 0.721647
training accuracy: 0.687500     test accuracy: 0.518482

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 160: 0.712450
training accuracy: 0.500000     test accuracy: 0.502498
Average cost in epoch 161: 0.717878
training accuracy: 0.718750     test accuracy: 0.506494
Average cost in epoch 162: 0.724705
training accuracy: 0.687500     test accuracy: 0.500500
Average cost in epoch 163: 0.706340
training accuracy: 0.656250     test accuracy: 0.501499
Average cost in epoch 164: 0.711067
training accuracy: 0.750000     test accuracy: 0.502498

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 165: 0.719836
training accuracy: 0.625000     test accuracy: 0.507493
Average cost in epoch 166: 0.700504
training accuracy: 0.656250     test accuracy: 0.498501
Average cost in epoch 167: 0.711674
training accuracy: 0.687500     test accuracy: 0.507493
Average cost in epoch 168: 0.700883
training accuracy: 0.625000     test accuracy: 0.505495
Average cost in epoch 169: 0.703884
training accuracy: 0.750000     test accuracy: 0.499500

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 170: 0.706542
training accuracy: 0.625000     test accuracy: 0.505495
Average cost in epoch 171: 0.700277
training accuracy: 0.781250     test accuracy: 0.499500
Average cost in epoch 172: 0.698140
training accuracy: 0.718750     test accuracy: 0.507493
Average cost in epoch 173: 0.713403
training accuracy: 0.718750     test accuracy: 0.498501
Average cost in epoch 174: 0.708862
training accuracy: 0.531250     test accuracy: 0.519481

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 175: 0.700472
training accuracy: 0.593750     test accuracy: 0.508492
Average cost in epoch 176: 0.709628
training accuracy: 0.718750     test accuracy: 0.508492
Average cost in epoch 177: 0.705830
training accuracy: 0.687500     test accuracy: 0.504496
Average cost in epoch 178: 0.710075
training accuracy: 0.687500     test accuracy: 0.504496
Average cost in epoch 179: 0.706698
training accuracy: 0.625000     test accuracy: 0.497502

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 180: 0.702761
training accuracy: 0.781250     test accuracy: 0.512488
Average cost in epoch 181: 0.712663
training accuracy: 0.625000     test accuracy: 0.493506
Average cost in epoch 182: 0.714613
training accuracy: 0.625000     test accuracy: 0.497502
Average cost in epoch 183: 0.705283
training accuracy: 0.687500     test accuracy: 0.493506
Average cost in epoch 184: 0.706084
training accuracy: 0.625000     test accuracy: 0.497502

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 185: 0.693558
training accuracy: 0.750000     test accuracy: 0.499500
Average cost in epoch 186: 0.710850
training accuracy: 0.593750     test accuracy: 0.505495
Average cost in epoch 187: 0.703283
training accuracy: 0.531250     test accuracy: 0.498501
Average cost in epoch 188: 0.717676
training accuracy: 0.718750     test accuracy: 0.500500
Average cost in epoch 189: 0.694908
training accuracy: 0.750000     test accuracy: 0.500500

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 190: 0.706650
training accuracy: 0.812500     test accuracy: 0.500500
Average cost in epoch 191: 0.700477
training accuracy: 0.781250     test accuracy: 0.507493
Average cost in epoch 192: 0.706721
training accuracy: 0.718750     test accuracy: 0.520480
Average cost in epoch 193: 0.701506
training accuracy: 0.718750     test accuracy: 0.504496
Average cost in epoch 194: 0.701498
training accuracy: 0.750000     test accuracy: 0.506494

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Average cost in epoch 195: 0.705413
training accuracy: 0.750000     test accuracy: 0.512488
Average cost in epoch 196: 0.701724
training accuracy: 0.562500     test accuracy: 0.497502
Average cost in epoch 197: 0.695908
training accuracy: 0.750000     test accuracy: 0.508492
Average cost in epoch 198: 0.696523
training accuracy: 0.531250     test accuracy: 0.493506
Average cost in epoch 199: 0.693213
training accuracy: 0.625000     test accuracy: 0.498501

dump to weights/pyramid-lstm/pyramid-lstm_1.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 2, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_2.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 219.79
Starting training...
Average cost in epoch 0: 1.817727
training accuracy: 0.312500     test accuracy: 0.298701
Average cost in epoch 1: 1.694951
training accuracy: 0.375000     test accuracy: 0.361638
Average cost in epoch 2: 1.628512
training accuracy: 0.437500     test accuracy: 0.372627
Average cost in epoch 3: 1.601856
training accuracy: 0.312500     test accuracy: 0.351648
Average cost in epoch 4: 1.572355
training accuracy: 0.500000     test accuracy: 0.372627

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 5: 1.553547
training accuracy: 0.375000     test accuracy: 0.374625
lr decays to 0.009000
Average cost in epoch 6: 1.535051
training accuracy: 0.406250     test accuracy: 0.368631
Average cost in epoch 7: 1.514276
training accuracy: 0.312500     test accuracy: 0.376623
Average cost in epoch 8: 1.501594
training accuracy: 0.468750     test accuracy: 0.359640
Average cost in epoch 9: 1.486778
training accuracy: 0.375000     test accuracy: 0.392607

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 10: 1.477319
training accuracy: 0.375000     test accuracy: 0.368631
lr decays to 0.008100
Average cost in epoch 11: 1.450709
training accuracy: 0.406250     test accuracy: 0.388611
Average cost in epoch 12: 1.445625
training accuracy: 0.468750     test accuracy: 0.396603
Average cost in epoch 13: 1.433694
training accuracy: 0.312500     test accuracy: 0.386613
Average cost in epoch 14: 1.419560
training accuracy: 0.406250     test accuracy: 0.391608

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 15: 1.409176
training accuracy: 0.500000     test accuracy: 0.403596
lr decays to 0.007290
Average cost in epoch 16: 1.402778
training accuracy: 0.437500     test accuracy: 0.401598
Average cost in epoch 17: 1.391692
training accuracy: 0.531250     test accuracy: 0.398601
Average cost in epoch 18: 1.385972
training accuracy: 0.343750     test accuracy: 0.400599
Average cost in epoch 19: 1.376549
training accuracy: 0.500000     test accuracy: 0.366633

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 20: 1.381981
training accuracy: 0.562500     test accuracy: 0.372627
lr decays to 0.006561
Average cost in epoch 21: 1.347895
training accuracy: 0.500000     test accuracy: 0.373626
Average cost in epoch 22: 1.344714
training accuracy: 0.437500     test accuracy: 0.369630
Average cost in epoch 23: 1.342711
training accuracy: 0.593750     test accuracy: 0.373626
Average cost in epoch 24: 1.332211
training accuracy: 0.468750     test accuracy: 0.373626

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 25: 1.328990
training accuracy: 0.343750     test accuracy: 0.357642
lr decays to 0.005905
Average cost in epoch 26: 1.312703
training accuracy: 0.406250     test accuracy: 0.369630
Average cost in epoch 27: 1.312486
training accuracy: 0.375000     test accuracy: 0.383616
Average cost in epoch 28: 1.306654
training accuracy: 0.562500     test accuracy: 0.394605
Average cost in epoch 29: 1.299780
training accuracy: 0.375000     test accuracy: 0.394605

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 30: 1.294634
training accuracy: 0.625000     test accuracy: 0.370629
lr decays to 0.005314
Average cost in epoch 31: 1.281250
training accuracy: 0.625000     test accuracy: 0.376623
Average cost in epoch 32: 1.276681
training accuracy: 0.562500     test accuracy: 0.370629
Average cost in epoch 33: 1.270470
training accuracy: 0.625000     test accuracy: 0.384615
Average cost in epoch 34: 1.275512
training accuracy: 0.468750     test accuracy: 0.374625

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 35: 1.258851
training accuracy: 0.625000     test accuracy: 0.395604
lr decays to 0.004783
Average cost in epoch 36: 1.256337
training accuracy: 0.343750     test accuracy: 0.377622
Average cost in epoch 37: 1.246022
training accuracy: 0.656250     test accuracy: 0.377622
Average cost in epoch 38: 1.246318
training accuracy: 0.562500     test accuracy: 0.374625
Average cost in epoch 39: 1.247661
training accuracy: 0.500000     test accuracy: 0.378621

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 40: 1.236489
training accuracy: 0.656250     test accuracy: 0.394605
lr decays to 0.004305
Average cost in epoch 41: 1.224454
training accuracy: 0.593750     test accuracy: 0.390609
Average cost in epoch 42: 1.228048
training accuracy: 0.687500     test accuracy: 0.378621
Average cost in epoch 43: 1.216857
training accuracy: 0.468750     test accuracy: 0.391608
Average cost in epoch 44: 1.210357
training accuracy: 0.593750     test accuracy: 0.404595

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 45: 1.207028
training accuracy: 0.593750     test accuracy: 0.373626
lr decays to 0.003874
Average cost in epoch 46: 1.198558
training accuracy: 0.531250     test accuracy: 0.390609
Average cost in epoch 47: 1.194291
training accuracy: 0.593750     test accuracy: 0.373626
Average cost in epoch 48: 1.182073
training accuracy: 0.562500     test accuracy: 0.363636
Average cost in epoch 49: 1.180818
training accuracy: 0.531250     test accuracy: 0.376623

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 50: 1.189966
training accuracy: 0.531250     test accuracy: 0.393606
lr decays to 0.003487
Average cost in epoch 51: 1.170608
training accuracy: 0.625000     test accuracy: 0.386613
Average cost in epoch 52: 1.162003
training accuracy: 0.406250     test accuracy: 0.379620
Average cost in epoch 53: 1.157801
training accuracy: 0.593750     test accuracy: 0.375624
Average cost in epoch 54: 1.165288
training accuracy: 0.562500     test accuracy: 0.370629

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 55: 1.163881
training accuracy: 0.562500     test accuracy: 0.350649
lr decays to 0.003138
Average cost in epoch 56: 1.135697
training accuracy: 0.531250     test accuracy: 0.349650
Average cost in epoch 57: 1.148371
training accuracy: 0.437500     test accuracy: 0.368631
Average cost in epoch 58: 1.161822
training accuracy: 0.625000     test accuracy: 0.370629
Average cost in epoch 59: 1.136153
training accuracy: 0.500000     test accuracy: 0.369630

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 60: 1.139744
training accuracy: 0.562500     test accuracy: 0.363636
lr decays to 0.002824
Average cost in epoch 61: 1.134077
training accuracy: 0.656250     test accuracy: 0.375624
Average cost in epoch 62: 1.142912
training accuracy: 0.656250     test accuracy: 0.362637
Average cost in epoch 63: 1.126796
training accuracy: 0.687500     test accuracy: 0.372627
Average cost in epoch 64: 1.116717
training accuracy: 0.750000     test accuracy: 0.375624

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 65: 1.134163
training accuracy: 0.656250     test accuracy: 0.378621
lr decays to 0.002542
Average cost in epoch 66: 1.119139
training accuracy: 0.468750     test accuracy: 0.360639
Average cost in epoch 67: 1.117401
training accuracy: 0.656250     test accuracy: 0.364635
Average cost in epoch 68: 1.107624
training accuracy: 0.500000     test accuracy: 0.346653
Average cost in epoch 69: 1.114245
training accuracy: 0.625000     test accuracy: 0.366633

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 70: 1.103233
training accuracy: 0.625000     test accuracy: 0.372627
lr decays to 0.002288
Average cost in epoch 71: 1.092461
training accuracy: 0.531250     test accuracy: 0.371628
Average cost in epoch 72: 1.099988
training accuracy: 0.687500     test accuracy: 0.390609
Average cost in epoch 73: 1.095708
training accuracy: 0.593750     test accuracy: 0.383616
Average cost in epoch 74: 1.093140
training accuracy: 0.656250     test accuracy: 0.371628

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 75: 1.087237
training accuracy: 0.781250     test accuracy: 0.367632
lr decays to 0.002059
Average cost in epoch 76: 1.077753
training accuracy: 0.656250     test accuracy: 0.369630
Average cost in epoch 77: 1.069919
training accuracy: 0.562500     test accuracy: 0.367632
Average cost in epoch 78: 1.071803
training accuracy: 0.593750     test accuracy: 0.363636
Average cost in epoch 79: 1.083285
training accuracy: 0.656250     test accuracy: 0.366633

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 80: 1.074467
training accuracy: 0.500000     test accuracy: 0.364635
lr decays to 0.001853
Average cost in epoch 81: 1.068007
training accuracy: 0.625000     test accuracy: 0.360639
Average cost in epoch 82: 1.067093
training accuracy: 0.625000     test accuracy: 0.380619
Average cost in epoch 83: 1.069503
training accuracy: 0.375000     test accuracy: 0.362637
Average cost in epoch 84: 1.060208
training accuracy: 0.562500     test accuracy: 0.378621

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 85: 1.048788
training accuracy: 0.562500     test accuracy: 0.369630
lr decays to 0.001668
Average cost in epoch 86: 1.058870
training accuracy: 0.656250     test accuracy: 0.355644
Average cost in epoch 87: 1.054395
training accuracy: 0.625000     test accuracy: 0.375624
Average cost in epoch 88: 1.045090
training accuracy: 0.531250     test accuracy: 0.364635
Average cost in epoch 89: 1.041510
training accuracy: 0.468750     test accuracy: 0.374625

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 90: 1.045007
training accuracy: 0.593750     test accuracy: 0.386613
lr decays to 0.001501
Average cost in epoch 91: 1.046037
training accuracy: 0.531250     test accuracy: 0.368631
Average cost in epoch 92: 1.041090
training accuracy: 0.718750     test accuracy: 0.368631
Average cost in epoch 93: 1.025500
training accuracy: 0.593750     test accuracy: 0.372627
Average cost in epoch 94: 1.030753
training accuracy: 0.500000     test accuracy: 0.366633

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 95: 1.021386
training accuracy: 0.812500     test accuracy: 0.370629
lr decays to 0.001351
Average cost in epoch 96: 1.022620
training accuracy: 0.687500     test accuracy: 0.366633
Average cost in epoch 97: 1.032523
training accuracy: 0.593750     test accuracy: 0.362637
Average cost in epoch 98: 1.013250
training accuracy: 0.593750     test accuracy: 0.357642
Average cost in epoch 99: 1.030942
training accuracy: 0.687500     test accuracy: 0.359640

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 100: 1.022961
training accuracy: 0.531250     test accuracy: 0.377622
lr decays to 0.001216
Average cost in epoch 101: 1.012725
training accuracy: 0.625000     test accuracy: 0.362637
Average cost in epoch 102: 1.021061
training accuracy: 0.781250     test accuracy: 0.359640
Average cost in epoch 103: 1.010043
training accuracy: 0.656250     test accuracy: 0.369630
Average cost in epoch 104: 1.021659
training accuracy: 0.625000     test accuracy: 0.382617

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 105: 1.017964
training accuracy: 0.687500     test accuracy: 0.381618
Average cost in epoch 106: 1.015118
training accuracy: 0.593750     test accuracy: 0.374625
Average cost in epoch 107: 1.001655
training accuracy: 0.625000     test accuracy: 0.368631
Average cost in epoch 108: 1.017068
training accuracy: 0.687500     test accuracy: 0.373626
Average cost in epoch 109: 1.016189
training accuracy: 0.625000     test accuracy: 0.375624

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 110: 1.005308
training accuracy: 0.718750     test accuracy: 0.358641
Average cost in epoch 111: 1.003870
training accuracy: 0.625000     test accuracy: 0.374625
Average cost in epoch 112: 0.998582
training accuracy: 0.562500     test accuracy: 0.373626
Average cost in epoch 113: 0.987422
training accuracy: 0.437500     test accuracy: 0.370629
Average cost in epoch 114: 1.000825
training accuracy: 0.781250     test accuracy: 0.365634

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 115: 1.002762
training accuracy: 0.562500     test accuracy: 0.366633
Average cost in epoch 116: 0.987381
training accuracy: 0.687500     test accuracy: 0.365634
Average cost in epoch 117: 0.986636
training accuracy: 0.593750     test accuracy: 0.384615
Average cost in epoch 118: 0.989538
training accuracy: 0.687500     test accuracy: 0.369630
Average cost in epoch 119: 1.012632
training accuracy: 0.593750     test accuracy: 0.370629

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 120: 0.989124
training accuracy: 0.562500     test accuracy: 0.369630
Average cost in epoch 121: 0.987384
training accuracy: 0.593750     test accuracy: 0.367632
Average cost in epoch 122: 1.003574
training accuracy: 0.500000     test accuracy: 0.363636
Average cost in epoch 123: 0.983822
training accuracy: 0.718750     test accuracy: 0.372627
Average cost in epoch 124: 1.001964
training accuracy: 0.562500     test accuracy: 0.355644

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 125: 0.982974
training accuracy: 0.500000     test accuracy: 0.364635
Average cost in epoch 126: 0.982783
training accuracy: 0.593750     test accuracy: 0.366633
Average cost in epoch 127: 0.999209
training accuracy: 0.562500     test accuracy: 0.360639
Average cost in epoch 128: 0.981168
training accuracy: 0.750000     test accuracy: 0.370629
Average cost in epoch 129: 0.990881
training accuracy: 0.687500     test accuracy: 0.358641

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 130: 0.994395
training accuracy: 0.843750     test accuracy: 0.359640
Average cost in epoch 131: 0.993332
training accuracy: 0.562500     test accuracy: 0.353646
Average cost in epoch 132: 0.965674
training accuracy: 0.687500     test accuracy: 0.366633
Average cost in epoch 133: 0.977747
training accuracy: 0.593750     test accuracy: 0.368631
Average cost in epoch 134: 0.980838
training accuracy: 0.656250     test accuracy: 0.368631

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 135: 0.992393
training accuracy: 0.718750     test accuracy: 0.368631
Average cost in epoch 136: 0.977433
training accuracy: 0.718750     test accuracy: 0.356643
Average cost in epoch 137: 0.978800
training accuracy: 0.750000     test accuracy: 0.358641
Average cost in epoch 138: 0.985355
training accuracy: 0.656250     test accuracy: 0.351648
Average cost in epoch 139: 0.976220
training accuracy: 0.656250     test accuracy: 0.364635

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 140: 0.989730
training accuracy: 0.531250     test accuracy: 0.354645
Average cost in epoch 141: 0.990169
training accuracy: 0.625000     test accuracy: 0.358641
Average cost in epoch 142: 0.975392
training accuracy: 0.687500     test accuracy: 0.352647
Average cost in epoch 143: 0.977231
training accuracy: 0.718750     test accuracy: 0.365634
Average cost in epoch 144: 0.969792
training accuracy: 0.625000     test accuracy: 0.349650

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 145: 0.978351
training accuracy: 0.750000     test accuracy: 0.368631
Average cost in epoch 146: 0.982802
training accuracy: 0.531250     test accuracy: 0.376623
Average cost in epoch 147: 0.964855
training accuracy: 0.656250     test accuracy: 0.361638
Average cost in epoch 148: 0.983119
training accuracy: 0.843750     test accuracy: 0.357642
Average cost in epoch 149: 0.977106
training accuracy: 0.593750     test accuracy: 0.359640

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 150: 0.985708
training accuracy: 0.687500     test accuracy: 0.358641
Average cost in epoch 151: 0.982276
training accuracy: 0.562500     test accuracy: 0.349650
Average cost in epoch 152: 0.980386
training accuracy: 0.593750     test accuracy: 0.338661
Average cost in epoch 153: 0.972523
training accuracy: 0.531250     test accuracy: 0.373626
Average cost in epoch 154: 0.977801
training accuracy: 0.531250     test accuracy: 0.359640

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 155: 0.977069
training accuracy: 0.656250     test accuracy: 0.358641
Average cost in epoch 156: 0.981657
training accuracy: 0.718750     test accuracy: 0.356643
Average cost in epoch 157: 0.966235
training accuracy: 0.531250     test accuracy: 0.349650
Average cost in epoch 158: 0.969651
training accuracy: 0.531250     test accuracy: 0.363636
Average cost in epoch 159: 0.974291
training accuracy: 0.687500     test accuracy: 0.360639

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 160: 0.965648
training accuracy: 0.812500     test accuracy: 0.358641
Average cost in epoch 161: 0.968502
training accuracy: 0.843750     test accuracy: 0.352647
Average cost in epoch 162: 0.965851
training accuracy: 0.750000     test accuracy: 0.364635
Average cost in epoch 163: 0.976353
training accuracy: 0.625000     test accuracy: 0.353646
Average cost in epoch 164: 0.965343
training accuracy: 0.625000     test accuracy: 0.349650

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 165: 0.965591
training accuracy: 0.750000     test accuracy: 0.349650
Average cost in epoch 166: 0.962225
training accuracy: 0.718750     test accuracy: 0.360639
Average cost in epoch 167: 0.964947
training accuracy: 0.718750     test accuracy: 0.357642
Average cost in epoch 168: 0.955553
training accuracy: 0.531250     test accuracy: 0.355644
Average cost in epoch 169: 0.971295
training accuracy: 0.468750     test accuracy: 0.373626

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 170: 0.966269
training accuracy: 0.750000     test accuracy: 0.365634
Average cost in epoch 171: 0.958544
training accuracy: 0.656250     test accuracy: 0.355644
Average cost in epoch 172: 0.951521
training accuracy: 0.781250     test accuracy: 0.356643
Average cost in epoch 173: 0.982297
training accuracy: 0.468750     test accuracy: 0.356643
Average cost in epoch 174: 0.944518
training accuracy: 0.625000     test accuracy: 0.348651

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 175: 0.978199
training accuracy: 0.687500     test accuracy: 0.336663
Average cost in epoch 176: 0.962951
training accuracy: 0.687500     test accuracy: 0.349650
Average cost in epoch 177: 0.962980
training accuracy: 0.468750     test accuracy: 0.351648
Average cost in epoch 178: 0.954428
training accuracy: 0.687500     test accuracy: 0.356643
Average cost in epoch 179: 0.964539
training accuracy: 0.687500     test accuracy: 0.349650

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 180: 0.944938
training accuracy: 0.687500     test accuracy: 0.347652
Average cost in epoch 181: 0.952527
training accuracy: 0.500000     test accuracy: 0.356643
Average cost in epoch 182: 0.970328
training accuracy: 0.687500     test accuracy: 0.338661
Average cost in epoch 183: 0.945885
training accuracy: 0.687500     test accuracy: 0.348651
Average cost in epoch 184: 0.966943
training accuracy: 0.656250     test accuracy: 0.355644

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 185: 0.958793
training accuracy: 0.593750     test accuracy: 0.360639
Average cost in epoch 186: 0.950564
training accuracy: 0.687500     test accuracy: 0.348651
Average cost in epoch 187: 0.954882
training accuracy: 0.562500     test accuracy: 0.359640
Average cost in epoch 188: 0.951859
training accuracy: 0.500000     test accuracy: 0.355644
Average cost in epoch 189: 0.947806
training accuracy: 0.750000     test accuracy: 0.339660

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 190: 0.967043
training accuracy: 0.687500     test accuracy: 0.336663
Average cost in epoch 191: 0.956725
training accuracy: 0.593750     test accuracy: 0.347652
Average cost in epoch 192: 0.958623
training accuracy: 0.593750     test accuracy: 0.351648
Average cost in epoch 193: 0.956282
training accuracy: 0.500000     test accuracy: 0.358641
Average cost in epoch 194: 0.948639
training accuracy: 0.718750     test accuracy: 0.364635

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Average cost in epoch 195: 0.959687
training accuracy: 0.562500     test accuracy: 0.356643
Average cost in epoch 196: 0.952790
training accuracy: 0.718750     test accuracy: 0.367632
Average cost in epoch 197: 0.951087
training accuracy: 0.687500     test accuracy: 0.353646
Average cost in epoch 198: 0.968557
training accuracy: 0.687500     test accuracy: 0.335664
Average cost in epoch 199: 0.940011
training accuracy: 0.406250     test accuracy: 0.330669

dump to weights/pyramid-lstm/pyramid-lstm_2.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 3, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_3.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 195.59
Starting training...
Average cost in epoch 0: 1.813844
training accuracy: 0.125000     test accuracy: 0.191808
Average cost in epoch 1: 1.719541
training accuracy: 0.218750     test accuracy: 0.208791
Average cost in epoch 2: 1.703364
training accuracy: 0.375000     test accuracy: 0.166833
Average cost in epoch 3: 1.692421
training accuracy: 0.156250     test accuracy: 0.201798
Average cost in epoch 4: 1.675437
training accuracy: 0.312500     test accuracy: 0.222777

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 5: 1.662921
training accuracy: 0.218750     test accuracy: 0.196803
lr decays to 0.009000
Average cost in epoch 6: 1.652012
training accuracy: 0.343750     test accuracy: 0.198801
Average cost in epoch 7: 1.647238
training accuracy: 0.343750     test accuracy: 0.200799
Average cost in epoch 8: 1.642039
training accuracy: 0.218750     test accuracy: 0.207792
Average cost in epoch 9: 1.631499
training accuracy: 0.437500     test accuracy: 0.200799

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 10: 1.629320
training accuracy: 0.281250     test accuracy: 0.178821
lr decays to 0.008100
Average cost in epoch 11: 1.623456
training accuracy: 0.218750     test accuracy: 0.181818
Average cost in epoch 12: 1.608587
training accuracy: 0.312500     test accuracy: 0.208791
Average cost in epoch 13: 1.606213
training accuracy: 0.250000     test accuracy: 0.168831
Average cost in epoch 14: 1.594930
training accuracy: 0.406250     test accuracy: 0.223776

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 15: 1.588917
training accuracy: 0.281250     test accuracy: 0.208791
lr decays to 0.007290
Average cost in epoch 16: 1.583717
training accuracy: 0.281250     test accuracy: 0.211788
Average cost in epoch 17: 1.574201
training accuracy: 0.156250     test accuracy: 0.221778
Average cost in epoch 18: 1.564930
training accuracy: 0.093750     test accuracy: 0.190809
Average cost in epoch 19: 1.565306
training accuracy: 0.343750     test accuracy: 0.235764

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 20: 1.564050
training accuracy: 0.281250     test accuracy: 0.232767
lr decays to 0.006561
Average cost in epoch 21: 1.544642
training accuracy: 0.343750     test accuracy: 0.223776
Average cost in epoch 22: 1.542671
training accuracy: 0.406250     test accuracy: 0.214785
Average cost in epoch 23: 1.534203
training accuracy: 0.437500     test accuracy: 0.189810
Average cost in epoch 24: 1.540017
training accuracy: 0.375000     test accuracy: 0.207792

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 25: 1.535950
training accuracy: 0.406250     test accuracy: 0.203796
lr decays to 0.005905
Average cost in epoch 26: 1.531043
training accuracy: 0.406250     test accuracy: 0.235764
Average cost in epoch 27: 1.518590
training accuracy: 0.343750     test accuracy: 0.227772
Average cost in epoch 28: 1.514538
training accuracy: 0.468750     test accuracy: 0.211788
Average cost in epoch 29: 1.509438
training accuracy: 0.375000     test accuracy: 0.240759

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 30: 1.512874
training accuracy: 0.500000     test accuracy: 0.215784
lr decays to 0.005314
Average cost in epoch 31: 1.501879
training accuracy: 0.468750     test accuracy: 0.207792
Average cost in epoch 32: 1.493300
training accuracy: 0.312500     test accuracy: 0.237762
Average cost in epoch 33: 1.488020
training accuracy: 0.250000     test accuracy: 0.229770
Average cost in epoch 34: 1.486525
training accuracy: 0.406250     test accuracy: 0.229770

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 35: 1.485146
training accuracy: 0.375000     test accuracy: 0.222777
lr decays to 0.004783
Average cost in epoch 36: 1.482303
training accuracy: 0.437500     test accuracy: 0.223776
Average cost in epoch 37: 1.469021
training accuracy: 0.437500     test accuracy: 0.219780
Average cost in epoch 38: 1.476046
training accuracy: 0.343750     test accuracy: 0.212787
Average cost in epoch 39: 1.476015
training accuracy: 0.500000     test accuracy: 0.210789

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 40: 1.479298
training accuracy: 0.406250     test accuracy: 0.240759
lr decays to 0.004305
Average cost in epoch 41: 1.466358
training accuracy: 0.343750     test accuracy: 0.214785
Average cost in epoch 42: 1.457907
training accuracy: 0.375000     test accuracy: 0.228771
Average cost in epoch 43: 1.448862
training accuracy: 0.375000     test accuracy: 0.211788
Average cost in epoch 44: 1.459265
training accuracy: 0.312500     test accuracy: 0.218781

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 45: 1.454101
training accuracy: 0.375000     test accuracy: 0.230769
lr decays to 0.003874
Average cost in epoch 46: 1.446875
training accuracy: 0.531250     test accuracy: 0.222777
Average cost in epoch 47: 1.449601
training accuracy: 0.562500     test accuracy: 0.226773
Average cost in epoch 48: 1.440799
training accuracy: 0.375000     test accuracy: 0.232767
Average cost in epoch 49: 1.442728
training accuracy: 0.343750     test accuracy: 0.228771

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 50: 1.434270
training accuracy: 0.375000     test accuracy: 0.226773
lr decays to 0.003487
Average cost in epoch 51: 1.439489
training accuracy: 0.437500     test accuracy: 0.216783
Average cost in epoch 52: 1.434887
training accuracy: 0.500000     test accuracy: 0.232767
Average cost in epoch 53: 1.432144
training accuracy: 0.406250     test accuracy: 0.223776
Average cost in epoch 54: 1.429099
training accuracy: 0.375000     test accuracy: 0.221778

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 55: 1.429979
training accuracy: 0.593750     test accuracy: 0.238761
lr decays to 0.003138
Average cost in epoch 56: 1.420518
training accuracy: 0.406250     test accuracy: 0.199800
Average cost in epoch 57: 1.416846
training accuracy: 0.468750     test accuracy: 0.216783
Average cost in epoch 58: 1.418298
training accuracy: 0.500000     test accuracy: 0.232767
Average cost in epoch 59: 1.410483
training accuracy: 0.468750     test accuracy: 0.224775

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 60: 1.410176
training accuracy: 0.406250     test accuracy: 0.232767
lr decays to 0.002824
Average cost in epoch 61: 1.404975
training accuracy: 0.375000     test accuracy: 0.224775
Average cost in epoch 62: 1.412236
training accuracy: 0.531250     test accuracy: 0.209790
Average cost in epoch 63: 1.398756
training accuracy: 0.468750     test accuracy: 0.218781
Average cost in epoch 64: 1.394929
training accuracy: 0.343750     test accuracy: 0.232767

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 65: 1.402595
training accuracy: 0.343750     test accuracy: 0.229770
lr decays to 0.002542
Average cost in epoch 66: 1.388620
training accuracy: 0.531250     test accuracy: 0.212787
Average cost in epoch 67: 1.388879
training accuracy: 0.531250     test accuracy: 0.208791
Average cost in epoch 68: 1.391041
training accuracy: 0.531250     test accuracy: 0.212787
Average cost in epoch 69: 1.383125
training accuracy: 0.250000     test accuracy: 0.239760

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 70: 1.388505
training accuracy: 0.437500     test accuracy: 0.209790
lr decays to 0.002288
Average cost in epoch 71: 1.375872
training accuracy: 0.500000     test accuracy: 0.203796
Average cost in epoch 72: 1.372527
training accuracy: 0.500000     test accuracy: 0.227772
Average cost in epoch 73: 1.380599
training accuracy: 0.562500     test accuracy: 0.212787
Average cost in epoch 74: 1.370865
training accuracy: 0.406250     test accuracy: 0.240759

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 75: 1.362307
training accuracy: 0.406250     test accuracy: 0.228771
lr decays to 0.002059
Average cost in epoch 76: 1.361925
training accuracy: 0.312500     test accuracy: 0.228771
Average cost in epoch 77: 1.362830
training accuracy: 0.437500     test accuracy: 0.214785
Average cost in epoch 78: 1.357926
training accuracy: 0.406250     test accuracy: 0.224775
Average cost in epoch 79: 1.365378
training accuracy: 0.562500     test accuracy: 0.199800

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 80: 1.369591
training accuracy: 0.406250     test accuracy: 0.216783
lr decays to 0.001853
Average cost in epoch 81: 1.362955
training accuracy: 0.406250     test accuracy: 0.227772
Average cost in epoch 82: 1.352047
training accuracy: 0.593750     test accuracy: 0.226773
Average cost in epoch 83: 1.348174
training accuracy: 0.468750     test accuracy: 0.215784
Average cost in epoch 84: 1.359847
training accuracy: 0.531250     test accuracy: 0.206793

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 85: 1.339973
training accuracy: 0.468750     test accuracy: 0.227772
lr decays to 0.001668
Average cost in epoch 86: 1.345551
training accuracy: 0.468750     test accuracy: 0.224775
Average cost in epoch 87: 1.352217
training accuracy: 0.343750     test accuracy: 0.229770
Average cost in epoch 88: 1.345995
training accuracy: 0.281250     test accuracy: 0.234765
Average cost in epoch 89: 1.330252
training accuracy: 0.531250     test accuracy: 0.215784

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 90: 1.345306
training accuracy: 0.281250     test accuracy: 0.225774
lr decays to 0.001501
Average cost in epoch 91: 1.331685
training accuracy: 0.468750     test accuracy: 0.227772
Average cost in epoch 92: 1.336318
training accuracy: 0.437500     test accuracy: 0.207792
Average cost in epoch 93: 1.326284
training accuracy: 0.437500     test accuracy: 0.230769
Average cost in epoch 94: 1.332594
training accuracy: 0.343750     test accuracy: 0.214785

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 95: 1.325264
training accuracy: 0.437500     test accuracy: 0.225774
lr decays to 0.001351
Average cost in epoch 96: 1.322460
training accuracy: 0.375000     test accuracy: 0.205794
Average cost in epoch 97: 1.319858
training accuracy: 0.406250     test accuracy: 0.222777
Average cost in epoch 98: 1.329272
training accuracy: 0.437500     test accuracy: 0.224775
Average cost in epoch 99: 1.307834
training accuracy: 0.531250     test accuracy: 0.227772

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 100: 1.316224
training accuracy: 0.500000     test accuracy: 0.233766
lr decays to 0.001216
Average cost in epoch 101: 1.325976
training accuracy: 0.500000     test accuracy: 0.226773
Average cost in epoch 102: 1.322104
training accuracy: 0.437500     test accuracy: 0.218781
Average cost in epoch 103: 1.314249
training accuracy: 0.531250     test accuracy: 0.213786
Average cost in epoch 104: 1.305582
training accuracy: 0.468750     test accuracy: 0.204795

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 105: 1.314343
training accuracy: 0.468750     test accuracy: 0.227772
Average cost in epoch 106: 1.307965
training accuracy: 0.406250     test accuracy: 0.236763
Average cost in epoch 107: 1.315317
training accuracy: 0.562500     test accuracy: 0.216783
Average cost in epoch 108: 1.315188
training accuracy: 0.531250     test accuracy: 0.226773
Average cost in epoch 109: 1.306828
training accuracy: 0.468750     test accuracy: 0.197802

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 110: 1.304914
training accuracy: 0.312500     test accuracy: 0.203796
Average cost in epoch 111: 1.302409
training accuracy: 0.500000     test accuracy: 0.208791
Average cost in epoch 112: 1.304246
training accuracy: 0.500000     test accuracy: 0.224775
Average cost in epoch 113: 1.302957
training accuracy: 0.593750     test accuracy: 0.209790
Average cost in epoch 114: 1.296208
training accuracy: 0.437500     test accuracy: 0.219780

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 115: 1.302251
training accuracy: 0.343750     test accuracy: 0.225774
Average cost in epoch 116: 1.305400
training accuracy: 0.593750     test accuracy: 0.226773
Average cost in epoch 117: 1.305539
training accuracy: 0.500000     test accuracy: 0.206793
Average cost in epoch 118: 1.304711
training accuracy: 0.500000     test accuracy: 0.201798
Average cost in epoch 119: 1.294700
training accuracy: 0.437500     test accuracy: 0.212787

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 120: 1.304468
training accuracy: 0.468750     test accuracy: 0.223776
Average cost in epoch 121: 1.289372
training accuracy: 0.500000     test accuracy: 0.222777
Average cost in epoch 122: 1.292152
training accuracy: 0.531250     test accuracy: 0.220779
Average cost in epoch 123: 1.293457
training accuracy: 0.437500     test accuracy: 0.189810
Average cost in epoch 124: 1.305577
training accuracy: 0.562500     test accuracy: 0.214785

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 125: 1.296872
training accuracy: 0.406250     test accuracy: 0.212787
Average cost in epoch 126: 1.303280
training accuracy: 0.375000     test accuracy: 0.223776
Average cost in epoch 127: 1.299751
training accuracy: 0.500000     test accuracy: 0.215784
Average cost in epoch 128: 1.295890
training accuracy: 0.406250     test accuracy: 0.209790
Average cost in epoch 129: 1.287607
training accuracy: 0.593750     test accuracy: 0.239760

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 130: 1.294156
training accuracy: 0.468750     test accuracy: 0.230769
Average cost in epoch 131: 1.288171
training accuracy: 0.531250     test accuracy: 0.216783
Average cost in epoch 132: 1.291516
training accuracy: 0.375000     test accuracy: 0.208791
Average cost in epoch 133: 1.287497
training accuracy: 0.343750     test accuracy: 0.215784
Average cost in epoch 134: 1.294729
training accuracy: 0.531250     test accuracy: 0.226773

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 135: 1.290617
training accuracy: 0.500000     test accuracy: 0.212787
Average cost in epoch 136: 1.288472
training accuracy: 0.531250     test accuracy: 0.213786
Average cost in epoch 137: 1.299059
training accuracy: 0.531250     test accuracy: 0.225774
Average cost in epoch 138: 1.284908
training accuracy: 0.500000     test accuracy: 0.218781
Average cost in epoch 139: 1.287043
training accuracy: 0.500000     test accuracy: 0.239760

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 140: 1.292910
training accuracy: 0.406250     test accuracy: 0.206793
Average cost in epoch 141: 1.282404
training accuracy: 0.500000     test accuracy: 0.225774
Average cost in epoch 142: 1.292955
training accuracy: 0.718750     test accuracy: 0.212787
Average cost in epoch 143: 1.289429
training accuracy: 0.375000     test accuracy: 0.210789
Average cost in epoch 144: 1.292826
training accuracy: 0.562500     test accuracy: 0.215784

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 145: 1.295087
training accuracy: 0.562500     test accuracy: 0.203796
Average cost in epoch 146: 1.282655
training accuracy: 0.375000     test accuracy: 0.207792
Average cost in epoch 147: 1.280566
training accuracy: 0.375000     test accuracy: 0.220779
Average cost in epoch 148: 1.295317
training accuracy: 0.500000     test accuracy: 0.218781
Average cost in epoch 149: 1.282837
training accuracy: 0.437500     test accuracy: 0.202797

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 150: 1.286903
training accuracy: 0.312500     test accuracy: 0.222777
Average cost in epoch 151: 1.280844
training accuracy: 0.437500     test accuracy: 0.217782
Average cost in epoch 152: 1.294210
training accuracy: 0.437500     test accuracy: 0.207792
Average cost in epoch 153: 1.283515
training accuracy: 0.406250     test accuracy: 0.219780
Average cost in epoch 154: 1.288625
training accuracy: 0.437500     test accuracy: 0.214785

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 155: 1.276486
training accuracy: 0.468750     test accuracy: 0.213786
Average cost in epoch 156: 1.275981
training accuracy: 0.468750     test accuracy: 0.211788
Average cost in epoch 157: 1.283251
training accuracy: 0.531250     test accuracy: 0.218781
Average cost in epoch 158: 1.283384
training accuracy: 0.375000     test accuracy: 0.213786
Average cost in epoch 159: 1.282272
training accuracy: 0.531250     test accuracy: 0.210789

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 160: 1.276862
training accuracy: 0.281250     test accuracy: 0.230769
Average cost in epoch 161: 1.290221
training accuracy: 0.468750     test accuracy: 0.231768
Average cost in epoch 162: 1.285243
training accuracy: 0.312500     test accuracy: 0.214785
Average cost in epoch 163: 1.282735
training accuracy: 0.562500     test accuracy: 0.215784
Average cost in epoch 164: 1.282052
training accuracy: 0.625000     test accuracy: 0.221778

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 165: 1.272912
training accuracy: 0.593750     test accuracy: 0.221778
Average cost in epoch 166: 1.277283
training accuracy: 0.500000     test accuracy: 0.232767
Average cost in epoch 167: 1.272170
training accuracy: 0.562500     test accuracy: 0.223776
Average cost in epoch 168: 1.285426
training accuracy: 0.531250     test accuracy: 0.212787
Average cost in epoch 169: 1.277779
training accuracy: 0.531250     test accuracy: 0.229770

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 170: 1.268210
training accuracy: 0.343750     test accuracy: 0.225774
Average cost in epoch 171: 1.279242
training accuracy: 0.375000     test accuracy: 0.210789
Average cost in epoch 172: 1.274608
training accuracy: 0.375000     test accuracy: 0.201798
Average cost in epoch 173: 1.269279
training accuracy: 0.468750     test accuracy: 0.222777
Average cost in epoch 174: 1.282215
training accuracy: 0.406250     test accuracy: 0.220779

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 175: 1.284181
training accuracy: 0.656250     test accuracy: 0.202797
Average cost in epoch 176: 1.276111
training accuracy: 0.437500     test accuracy: 0.224775
Average cost in epoch 177: 1.274792
training accuracy: 0.531250     test accuracy: 0.220779
Average cost in epoch 178: 1.278415
training accuracy: 0.593750     test accuracy: 0.217782
Average cost in epoch 179: 1.276130
training accuracy: 0.343750     test accuracy: 0.227772

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 180: 1.273489
training accuracy: 0.468750     test accuracy: 0.210789
Average cost in epoch 181: 1.291029
training accuracy: 0.562500     test accuracy: 0.220779
Average cost in epoch 182: 1.279148
training accuracy: 0.437500     test accuracy: 0.205794
Average cost in epoch 183: 1.273124
training accuracy: 0.531250     test accuracy: 0.208791
Average cost in epoch 184: 1.274475
training accuracy: 0.531250     test accuracy: 0.232767

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 185: 1.267353
training accuracy: 0.468750     test accuracy: 0.224775
Average cost in epoch 186: 1.287245
training accuracy: 0.437500     test accuracy: 0.238761
Average cost in epoch 187: 1.269817
training accuracy: 0.593750     test accuracy: 0.216783
Average cost in epoch 188: 1.273193
training accuracy: 0.468750     test accuracy: 0.227772
Average cost in epoch 189: 1.261482
training accuracy: 0.593750     test accuracy: 0.212787

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 190: 1.276178
training accuracy: 0.500000     test accuracy: 0.205794
Average cost in epoch 191: 1.271591
training accuracy: 0.593750     test accuracy: 0.217782
Average cost in epoch 192: 1.274888
training accuracy: 0.500000     test accuracy: 0.213786
Average cost in epoch 193: 1.262940
training accuracy: 0.437500     test accuracy: 0.238761
Average cost in epoch 194: 1.275737
training accuracy: 0.437500     test accuracy: 0.238761

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Average cost in epoch 195: 1.271920
training accuracy: 0.343750     test accuracy: 0.243756
Average cost in epoch 196: 1.269228
training accuracy: 0.375000     test accuracy: 0.233766
Average cost in epoch 197: 1.264712
training accuracy: 0.625000     test accuracy: 0.232767
Average cost in epoch 198: 1.280708
training accuracy: 0.468750     test accuracy: 0.246753
Average cost in epoch 199: 1.281464
training accuracy: 0.625000     test accuracy: 0.204795

dump to weights/pyramid-lstm/pyramid-lstm_3.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 4, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_4.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 184.05
Starting training...
Average cost in epoch 0: 1.464964
training accuracy: 0.531250     test accuracy: 0.641359
Average cost in epoch 1: 0.851145
training accuracy: 0.531250     test accuracy: 0.691309
Average cost in epoch 2: 0.753754
training accuracy: 0.593750     test accuracy: 0.726274
Average cost in epoch 3: 0.714370
training accuracy: 0.562500     test accuracy: 0.727273
Average cost in epoch 4: 0.686024
training accuracy: 0.750000     test accuracy: 0.720280

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 5: 0.668933
training accuracy: 0.656250     test accuracy: 0.718282
lr decays to 0.009000
Average cost in epoch 6: 0.640499
training accuracy: 0.593750     test accuracy: 0.731269
Average cost in epoch 7: 0.619903
training accuracy: 0.593750     test accuracy: 0.716284
Average cost in epoch 8: 0.611874
training accuracy: 0.656250     test accuracy: 0.719281
Average cost in epoch 9: 0.592554
training accuracy: 0.593750     test accuracy: 0.739261

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 10: 0.576354
training accuracy: 0.718750     test accuracy: 0.736264
lr decays to 0.008100
Average cost in epoch 11: 0.570363
training accuracy: 0.625000     test accuracy: 0.748252
Average cost in epoch 12: 0.559237
training accuracy: 0.687500     test accuracy: 0.758242
Average cost in epoch 13: 0.549343
training accuracy: 0.468750     test accuracy: 0.734266
Average cost in epoch 14: 0.548636
training accuracy: 0.531250     test accuracy: 0.746254

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 15: 0.542235
training accuracy: 0.656250     test accuracy: 0.753247
lr decays to 0.007290
Average cost in epoch 16: 0.528090
training accuracy: 0.718750     test accuracy: 0.767233
Average cost in epoch 17: 0.528297
training accuracy: 0.750000     test accuracy: 0.762238
Average cost in epoch 18: 0.528377
training accuracy: 0.750000     test accuracy: 0.761239
Average cost in epoch 19: 0.521967
training accuracy: 0.750000     test accuracy: 0.764236

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 20: 0.522690
training accuracy: 0.562500     test accuracy: 0.736264
lr decays to 0.006561
Average cost in epoch 21: 0.515690
training accuracy: 0.718750     test accuracy: 0.751249
Average cost in epoch 22: 0.512047
training accuracy: 0.687500     test accuracy: 0.760240
Average cost in epoch 23: 0.505931
training accuracy: 0.687500     test accuracy: 0.769231
Average cost in epoch 24: 0.500039
training accuracy: 0.718750     test accuracy: 0.779221

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 25: 0.507616
training accuracy: 0.687500     test accuracy: 0.768232
lr decays to 0.005905
Average cost in epoch 26: 0.501933
training accuracy: 0.687500     test accuracy: 0.791209
Average cost in epoch 27: 0.501114
training accuracy: 0.843750     test accuracy: 0.778222
Average cost in epoch 28: 0.494744
training accuracy: 0.687500     test accuracy: 0.780220
Average cost in epoch 29: 0.492972
training accuracy: 0.750000     test accuracy: 0.767233

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 30: 0.489363
training accuracy: 0.781250     test accuracy: 0.774226
lr decays to 0.005314
Average cost in epoch 31: 0.494918
training accuracy: 0.718750     test accuracy: 0.782218
Average cost in epoch 32: 0.487424
training accuracy: 0.750000     test accuracy: 0.777223
Average cost in epoch 33: 0.483461
training accuracy: 0.718750     test accuracy: 0.774226
Average cost in epoch 34: 0.482517
training accuracy: 0.781250     test accuracy: 0.773227

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 35: 0.489376
training accuracy: 0.687500     test accuracy: 0.764236
lr decays to 0.004783
Average cost in epoch 36: 0.488688
training accuracy: 0.812500     test accuracy: 0.786214
Average cost in epoch 37: 0.468891
training accuracy: 0.781250     test accuracy: 0.777223
Average cost in epoch 38: 0.479319
training accuracy: 0.718750     test accuracy: 0.774226
Average cost in epoch 39: 0.482701
training accuracy: 0.812500     test accuracy: 0.768232

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 40: 0.479975
training accuracy: 0.625000     test accuracy: 0.759241
lr decays to 0.004305
Average cost in epoch 41: 0.471806
training accuracy: 0.750000     test accuracy: 0.777223
Average cost in epoch 42: 0.478144
training accuracy: 0.687500     test accuracy: 0.778222
Average cost in epoch 43: 0.476220
training accuracy: 0.750000     test accuracy: 0.772228
Average cost in epoch 44: 0.478963
training accuracy: 0.656250     test accuracy: 0.763237

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 45: 0.477691
training accuracy: 0.687500     test accuracy: 0.778222
lr decays to 0.003874
Average cost in epoch 46: 0.472410
training accuracy: 0.812500     test accuracy: 0.776224
Average cost in epoch 47: 0.468208
training accuracy: 0.718750     test accuracy: 0.783217
Average cost in epoch 48: 0.467706
training accuracy: 0.781250     test accuracy: 0.777223
Average cost in epoch 49: 0.475879
training accuracy: 0.687500     test accuracy: 0.769231

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 50: 0.465663
training accuracy: 0.750000     test accuracy: 0.790210
lr decays to 0.003487
Average cost in epoch 51: 0.464484
training accuracy: 0.750000     test accuracy: 0.775225
Average cost in epoch 52: 0.464301
training accuracy: 0.718750     test accuracy: 0.776224
Average cost in epoch 53: 0.464288
training accuracy: 0.718750     test accuracy: 0.792208
Average cost in epoch 54: 0.466559
training accuracy: 0.718750     test accuracy: 0.761239

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 55: 0.463010
training accuracy: 0.750000     test accuracy: 0.776224
lr decays to 0.003138
Average cost in epoch 56: 0.458035
training accuracy: 0.656250     test accuracy: 0.756244
Average cost in epoch 57: 0.461373
training accuracy: 0.750000     test accuracy: 0.756244
Average cost in epoch 58: 0.459929
training accuracy: 0.750000     test accuracy: 0.772228
Average cost in epoch 59: 0.458626
training accuracy: 0.843750     test accuracy: 0.782218

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 60: 0.464042
training accuracy: 0.500000     test accuracy: 0.767233
lr decays to 0.002824
Average cost in epoch 61: 0.453211
training accuracy: 0.937500     test accuracy: 0.768232
Average cost in epoch 62: 0.461680
training accuracy: 0.718750     test accuracy: 0.780220
Average cost in epoch 63: 0.464207
training accuracy: 0.812500     test accuracy: 0.770230
Average cost in epoch 64: 0.457962
training accuracy: 0.625000     test accuracy: 0.781219

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 65: 0.460201
training accuracy: 0.843750     test accuracy: 0.774226
lr decays to 0.002542
Average cost in epoch 66: 0.457902
training accuracy: 0.812500     test accuracy: 0.776224
Average cost in epoch 67: 0.447998
training accuracy: 0.656250     test accuracy: 0.756244
Average cost in epoch 68: 0.458470
training accuracy: 0.750000     test accuracy: 0.777223
Average cost in epoch 69: 0.452461
training accuracy: 0.906250     test accuracy: 0.779221

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 70: 0.454046
training accuracy: 0.812500     test accuracy: 0.777223
lr decays to 0.002288
Average cost in epoch 71: 0.448874
training accuracy: 0.687500     test accuracy: 0.789211
Average cost in epoch 72: 0.457555
training accuracy: 0.593750     test accuracy: 0.786214
Average cost in epoch 73: 0.456788
training accuracy: 0.906250     test accuracy: 0.760240
Average cost in epoch 74: 0.454136
training accuracy: 0.812500     test accuracy: 0.774226

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 75: 0.456111
training accuracy: 0.718750     test accuracy: 0.781219
lr decays to 0.002059
Average cost in epoch 76: 0.441641
training accuracy: 0.625000     test accuracy: 0.787213
Average cost in epoch 77: 0.449568
training accuracy: 0.750000     test accuracy: 0.780220
Average cost in epoch 78: 0.455945
training accuracy: 0.656250     test accuracy: 0.779221
Average cost in epoch 79: 0.449872
training accuracy: 0.718750     test accuracy: 0.771229

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 80: 0.452479
training accuracy: 0.843750     test accuracy: 0.770230
lr decays to 0.001853
Average cost in epoch 81: 0.449109
training accuracy: 0.906250     test accuracy: 0.766234
Average cost in epoch 82: 0.448401
training accuracy: 0.781250     test accuracy: 0.774226
Average cost in epoch 83: 0.446761
training accuracy: 0.718750     test accuracy: 0.780220
Average cost in epoch 84: 0.453477
training accuracy: 0.656250     test accuracy: 0.772228

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 85: 0.441671
training accuracy: 0.875000     test accuracy: 0.776224
lr decays to 0.001668
Average cost in epoch 86: 0.445656
training accuracy: 0.781250     test accuracy: 0.776224
Average cost in epoch 87: 0.446043
training accuracy: 0.812500     test accuracy: 0.775225
Average cost in epoch 88: 0.442810
training accuracy: 0.718750     test accuracy: 0.792208
Average cost in epoch 89: 0.447149
training accuracy: 0.781250     test accuracy: 0.773227

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 90: 0.444783
training accuracy: 0.718750     test accuracy: 0.773227
lr decays to 0.001501
Average cost in epoch 91: 0.440394
training accuracy: 0.656250     test accuracy: 0.763237
Average cost in epoch 92: 0.453611
training accuracy: 0.843750     test accuracy: 0.772228
Average cost in epoch 93: 0.438464
training accuracy: 0.843750     test accuracy: 0.778222
Average cost in epoch 94: 0.445203
training accuracy: 0.812500     test accuracy: 0.771229

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 95: 0.453550
training accuracy: 0.718750     test accuracy: 0.763237
lr decays to 0.001351
Average cost in epoch 96: 0.436960
training accuracy: 0.718750     test accuracy: 0.775225
Average cost in epoch 97: 0.441098
training accuracy: 0.781250     test accuracy: 0.765235
Average cost in epoch 98: 0.447245
training accuracy: 0.656250     test accuracy: 0.771229
Average cost in epoch 99: 0.440960
training accuracy: 0.656250     test accuracy: 0.772228

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 100: 0.436965
training accuracy: 0.625000     test accuracy: 0.776224
lr decays to 0.001216
Average cost in epoch 101: 0.441552
training accuracy: 0.718750     test accuracy: 0.762238
Average cost in epoch 102: 0.436821
training accuracy: 0.781250     test accuracy: 0.781219
Average cost in epoch 103: 0.438136
training accuracy: 0.750000     test accuracy: 0.769231
Average cost in epoch 104: 0.436313
training accuracy: 0.906250     test accuracy: 0.771229

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 105: 0.439562
training accuracy: 0.781250     test accuracy: 0.792208
Average cost in epoch 106: 0.440839
training accuracy: 0.562500     test accuracy: 0.772228
Average cost in epoch 107: 0.441121
training accuracy: 0.875000     test accuracy: 0.775225
Average cost in epoch 108: 0.443854
training accuracy: 0.812500     test accuracy: 0.775225
Average cost in epoch 109: 0.435815
training accuracy: 0.812500     test accuracy: 0.793207

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 110: 0.447764
training accuracy: 0.781250     test accuracy: 0.782218
Average cost in epoch 111: 0.439597
training accuracy: 0.781250     test accuracy: 0.786214
Average cost in epoch 112: 0.437045
training accuracy: 0.781250     test accuracy: 0.787213
Average cost in epoch 113: 0.437253
training accuracy: 0.750000     test accuracy: 0.781219
Average cost in epoch 114: 0.438645
training accuracy: 0.781250     test accuracy: 0.784216

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 115: 0.440235
training accuracy: 0.781250     test accuracy: 0.782218
Average cost in epoch 116: 0.438226
training accuracy: 0.718750     test accuracy: 0.773227
Average cost in epoch 117: 0.441513
training accuracy: 0.625000     test accuracy: 0.765235
Average cost in epoch 118: 0.442421
training accuracy: 0.812500     test accuracy: 0.777223
Average cost in epoch 119: 0.442209
training accuracy: 0.812500     test accuracy: 0.773227

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 120: 0.431600
training accuracy: 0.812500     test accuracy: 0.763237
Average cost in epoch 121: 0.445946
training accuracy: 0.781250     test accuracy: 0.771229
Average cost in epoch 122: 0.438068
training accuracy: 0.812500     test accuracy: 0.782218
Average cost in epoch 123: 0.436560
training accuracy: 0.718750     test accuracy: 0.785215
Average cost in epoch 124: 0.440579
training accuracy: 0.718750     test accuracy: 0.776224

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 125: 0.442756
training accuracy: 0.562500     test accuracy: 0.772228
Average cost in epoch 126: 0.442818
training accuracy: 0.718750     test accuracy: 0.785215
Average cost in epoch 127: 0.437488
training accuracy: 0.656250     test accuracy: 0.780220
Average cost in epoch 128: 0.444474
training accuracy: 0.718750     test accuracy: 0.787213
Average cost in epoch 129: 0.438513
training accuracy: 0.718750     test accuracy: 0.787213

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 130: 0.444187
training accuracy: 0.750000     test accuracy: 0.779221
Average cost in epoch 131: 0.440683
training accuracy: 0.750000     test accuracy: 0.772228
Average cost in epoch 132: 0.433220
training accuracy: 0.687500     test accuracy: 0.779221
Average cost in epoch 133: 0.438800
training accuracy: 0.687500     test accuracy: 0.780220
Average cost in epoch 134: 0.443246
training accuracy: 0.562500     test accuracy: 0.766234

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 135: 0.439816
training accuracy: 0.843750     test accuracy: 0.779221
Average cost in epoch 136: 0.431767
training accuracy: 0.781250     test accuracy: 0.782218
Average cost in epoch 137: 0.441997
training accuracy: 0.812500     test accuracy: 0.771229
Average cost in epoch 138: 0.444439
training accuracy: 0.750000     test accuracy: 0.776224
Average cost in epoch 139: 0.435592
training accuracy: 0.812500     test accuracy: 0.779221

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 140: 0.446495
training accuracy: 0.750000     test accuracy: 0.770230
Average cost in epoch 141: 0.436995
training accuracy: 0.593750     test accuracy: 0.788212
Average cost in epoch 142: 0.439503
training accuracy: 0.875000     test accuracy: 0.774226
Average cost in epoch 143: 0.440243
training accuracy: 0.750000     test accuracy: 0.778222
Average cost in epoch 144: 0.434356
training accuracy: 0.750000     test accuracy: 0.789211

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 145: 0.444507
training accuracy: 0.687500     test accuracy: 0.790210
Average cost in epoch 146: 0.441393
training accuracy: 0.625000     test accuracy: 0.792208
Average cost in epoch 147: 0.437747
training accuracy: 0.843750     test accuracy: 0.783217
Average cost in epoch 148: 0.442601
training accuracy: 0.687500     test accuracy: 0.780220
Average cost in epoch 149: 0.437078
training accuracy: 0.750000     test accuracy: 0.775225

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 150: 0.436452
training accuracy: 0.875000     test accuracy: 0.774226
Average cost in epoch 151: 0.440598
training accuracy: 0.875000     test accuracy: 0.778222
Average cost in epoch 152: 0.440946
training accuracy: 0.750000     test accuracy: 0.780220
Average cost in epoch 153: 0.441159
training accuracy: 0.906250     test accuracy: 0.780220
Average cost in epoch 154: 0.440310
training accuracy: 0.750000     test accuracy: 0.776224

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 155: 0.441943
training accuracy: 0.781250     test accuracy: 0.777223
Average cost in epoch 156: 0.441707
training accuracy: 0.906250     test accuracy: 0.774226
Average cost in epoch 157: 0.435210
training accuracy: 0.906250     test accuracy: 0.784216
Average cost in epoch 158: 0.441277
training accuracy: 0.843750     test accuracy: 0.784216
Average cost in epoch 159: 0.436511
training accuracy: 0.781250     test accuracy: 0.781219

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 160: 0.438616
training accuracy: 0.843750     test accuracy: 0.772228
Average cost in epoch 161: 0.439561
training accuracy: 0.656250     test accuracy: 0.790210
Average cost in epoch 162: 0.437064
training accuracy: 0.718750     test accuracy: 0.762238
Average cost in epoch 163: 0.438858
training accuracy: 0.718750     test accuracy: 0.785215
Average cost in epoch 164: 0.437182
training accuracy: 0.781250     test accuracy: 0.780220

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 165: 0.440951
training accuracy: 0.812500     test accuracy: 0.778222
Average cost in epoch 166: 0.440484
training accuracy: 0.812500     test accuracy: 0.785215
Average cost in epoch 167: 0.442465
training accuracy: 0.812500     test accuracy: 0.782218
Average cost in epoch 168: 0.437630
training accuracy: 0.750000     test accuracy: 0.764236
Average cost in epoch 169: 0.441787
training accuracy: 0.750000     test accuracy: 0.771229

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 170: 0.436163
training accuracy: 0.781250     test accuracy: 0.778222
Average cost in epoch 171: 0.439009
training accuracy: 0.875000     test accuracy: 0.777223
Average cost in epoch 172: 0.430061
training accuracy: 0.875000     test accuracy: 0.788212
Average cost in epoch 173: 0.435870
training accuracy: 0.843750     test accuracy: 0.778222
Average cost in epoch 174: 0.435743
training accuracy: 0.750000     test accuracy: 0.778222

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 175: 0.434696
training accuracy: 0.812500     test accuracy: 0.791209
Average cost in epoch 176: 0.443217
training accuracy: 0.750000     test accuracy: 0.778222
Average cost in epoch 177: 0.435851
training accuracy: 0.750000     test accuracy: 0.784216
Average cost in epoch 178: 0.435188
training accuracy: 1.000000     test accuracy: 0.775225
Average cost in epoch 179: 0.440242
training accuracy: 0.750000     test accuracy: 0.783217

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 180: 0.437042
training accuracy: 0.781250     test accuracy: 0.774226
Average cost in epoch 181: 0.432141
training accuracy: 0.781250     test accuracy: 0.768232
Average cost in epoch 182: 0.441653
training accuracy: 0.781250     test accuracy: 0.770230
Average cost in epoch 183: 0.435395
training accuracy: 0.906250     test accuracy: 0.775225
Average cost in epoch 184: 0.428189
training accuracy: 0.812500     test accuracy: 0.781219

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 185: 0.441871
training accuracy: 0.718750     test accuracy: 0.782218
Average cost in epoch 186: 0.437641
training accuracy: 0.843750     test accuracy: 0.786214
Average cost in epoch 187: 0.438786
training accuracy: 0.750000     test accuracy: 0.789211
Average cost in epoch 188: 0.430489
training accuracy: 0.750000     test accuracy: 0.787213
Average cost in epoch 189: 0.442983
training accuracy: 0.750000     test accuracy: 0.782218

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 190: 0.443264
training accuracy: 0.843750     test accuracy: 0.794206
Average cost in epoch 191: 0.427639
training accuracy: 0.812500     test accuracy: 0.789211
Average cost in epoch 192: 0.439155
training accuracy: 0.750000     test accuracy: 0.775225
Average cost in epoch 193: 0.433202
training accuracy: 0.687500     test accuracy: 0.774226
Average cost in epoch 194: 0.432356
training accuracy: 0.812500     test accuracy: 0.776224

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Average cost in epoch 195: 0.435066
training accuracy: 0.812500     test accuracy: 0.782218
Average cost in epoch 196: 0.435918
training accuracy: 0.812500     test accuracy: 0.801199
Average cost in epoch 197: 0.440899
training accuracy: 0.781250     test accuracy: 0.786214
Average cost in epoch 198: 0.429848
training accuracy: 0.718750     test accuracy: 0.776224
Average cost in epoch 199: 0.438693
training accuracy: 0.781250     test accuracy: 0.783217

dump to weights/pyramid-lstm/pyramid-lstm_4.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 5, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_5.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 174.44
Starting training...
Average cost in epoch 0: 1.391183
training accuracy: 0.375000     test accuracy: 0.395604
Average cost in epoch 1: 1.152470
training accuracy: 0.500000     test accuracy: 0.488511
Average cost in epoch 2: 1.048116
training accuracy: 0.437500     test accuracy: 0.570430
Average cost in epoch 3: 0.993004
training accuracy: 0.625000     test accuracy: 0.613387
Average cost in epoch 4: 0.968242
training accuracy: 0.500000     test accuracy: 0.621379

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 5: 0.938771
training accuracy: 0.562500     test accuracy: 0.643357
lr decays to 0.009000
Average cost in epoch 6: 0.913650
training accuracy: 0.656250     test accuracy: 0.622378
Average cost in epoch 7: 0.931285
training accuracy: 0.625000     test accuracy: 0.625375
Average cost in epoch 8: 0.890463
training accuracy: 0.531250     test accuracy: 0.619381
Average cost in epoch 9: 0.878586
training accuracy: 0.500000     test accuracy: 0.629371

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 10: 0.866965
training accuracy: 0.406250     test accuracy: 0.626374
lr decays to 0.008100
Average cost in epoch 11: 0.860604
training accuracy: 0.500000     test accuracy: 0.639361
Average cost in epoch 12: 0.847933
training accuracy: 0.656250     test accuracy: 0.630370
Average cost in epoch 13: 0.841345
training accuracy: 0.593750     test accuracy: 0.645355
Average cost in epoch 14: 0.835627
training accuracy: 0.531250     test accuracy: 0.629371

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 15: 0.829811
training accuracy: 0.718750     test accuracy: 0.634366
lr decays to 0.007290
Average cost in epoch 16: 0.817932
training accuracy: 0.656250     test accuracy: 0.618382
Average cost in epoch 17: 0.817952
training accuracy: 0.531250     test accuracy: 0.663337
Average cost in epoch 18: 0.802582
training accuracy: 0.593750     test accuracy: 0.639361
Average cost in epoch 19: 0.799326
training accuracy: 0.625000     test accuracy: 0.617383

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 20: 0.793947
training accuracy: 0.593750     test accuracy: 0.638362
lr decays to 0.006561
Average cost in epoch 21: 0.788392
training accuracy: 0.718750     test accuracy: 0.636364
Average cost in epoch 22: 0.780617
training accuracy: 0.687500     test accuracy: 0.615385
Average cost in epoch 23: 0.772561
training accuracy: 0.562500     test accuracy: 0.649351
Average cost in epoch 24: 0.771160
training accuracy: 0.687500     test accuracy: 0.639361

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 25: 0.778961
training accuracy: 0.718750     test accuracy: 0.625375
lr decays to 0.005905
Average cost in epoch 26: 0.764890
training accuracy: 0.656250     test accuracy: 0.647353
Average cost in epoch 27: 0.752560
training accuracy: 0.562500     test accuracy: 0.614386
Average cost in epoch 28: 0.753170
training accuracy: 0.718750     test accuracy: 0.626374
Average cost in epoch 29: 0.745269
training accuracy: 0.750000     test accuracy: 0.627373

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 30: 0.739578
training accuracy: 0.750000     test accuracy: 0.632368
lr decays to 0.005314
Average cost in epoch 31: 0.739575
training accuracy: 0.656250     test accuracy: 0.635365
Average cost in epoch 32: 0.729007
training accuracy: 0.781250     test accuracy: 0.634366
Average cost in epoch 33: 0.722538
training accuracy: 0.562500     test accuracy: 0.625375
Average cost in epoch 34: 0.721085
training accuracy: 0.625000     test accuracy: 0.614386

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 35: 0.726744
training accuracy: 0.625000     test accuracy: 0.614386
lr decays to 0.004783
Average cost in epoch 36: 0.713252
training accuracy: 0.718750     test accuracy: 0.650350
Average cost in epoch 37: 0.712635
training accuracy: 0.687500     test accuracy: 0.627373
Average cost in epoch 38: 0.698297
training accuracy: 0.843750     test accuracy: 0.627373
Average cost in epoch 39: 0.694715
training accuracy: 0.562500     test accuracy: 0.650350

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 40: 0.706992
training accuracy: 0.687500     test accuracy: 0.630370
lr decays to 0.004305
Average cost in epoch 41: 0.683945
training accuracy: 0.843750     test accuracy: 0.643357
Average cost in epoch 42: 0.689070
training accuracy: 0.562500     test accuracy: 0.635365
Average cost in epoch 43: 0.686303
training accuracy: 0.781250     test accuracy: 0.638362
Average cost in epoch 44: 0.680675
training accuracy: 0.781250     test accuracy: 0.638362

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 45: 0.671919
training accuracy: 0.500000     test accuracy: 0.643357
lr decays to 0.003874
Average cost in epoch 46: 0.683831
training accuracy: 0.687500     test accuracy: 0.645355
Average cost in epoch 47: 0.660817
training accuracy: 0.562500     test accuracy: 0.632368
Average cost in epoch 48: 0.665014
training accuracy: 0.718750     test accuracy: 0.632368
Average cost in epoch 49: 0.673624
training accuracy: 0.718750     test accuracy: 0.631369

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 50: 0.654947
training accuracy: 0.750000     test accuracy: 0.632368
lr decays to 0.003487
Average cost in epoch 51: 0.655712
training accuracy: 0.718750     test accuracy: 0.644356
Average cost in epoch 52: 0.649010
training accuracy: 0.593750     test accuracy: 0.640360
Average cost in epoch 53: 0.654078
training accuracy: 0.750000     test accuracy: 0.643357
Average cost in epoch 54: 0.648734
training accuracy: 0.687500     test accuracy: 0.626374

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 55: 0.652317
training accuracy: 0.781250     test accuracy: 0.627373
lr decays to 0.003138
Average cost in epoch 56: 0.647070
training accuracy: 0.718750     test accuracy: 0.629371
Average cost in epoch 57: 0.640370
training accuracy: 0.625000     test accuracy: 0.626374
Average cost in epoch 58: 0.634176
training accuracy: 0.687500     test accuracy: 0.624376
Average cost in epoch 59: 0.624892
training accuracy: 0.750000     test accuracy: 0.635365

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 60: 0.632232
training accuracy: 0.812500     test accuracy: 0.637363
lr decays to 0.002824
Average cost in epoch 61: 0.626646
training accuracy: 0.718750     test accuracy: 0.641359
Average cost in epoch 62: 0.631470
training accuracy: 0.781250     test accuracy: 0.637363
Average cost in epoch 63: 0.624692
training accuracy: 0.718750     test accuracy: 0.629371
Average cost in epoch 64: 0.620959
training accuracy: 0.781250     test accuracy: 0.636364

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 65: 0.621899
training accuracy: 0.687500     test accuracy: 0.642358
lr decays to 0.002542
Average cost in epoch 66: 0.617743
training accuracy: 0.781250     test accuracy: 0.638362
Average cost in epoch 67: 0.616927
training accuracy: 0.718750     test accuracy: 0.641359
Average cost in epoch 68: 0.615110
training accuracy: 0.750000     test accuracy: 0.636364
Average cost in epoch 69: 0.614438
training accuracy: 0.750000     test accuracy: 0.634366

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 70: 0.614732
training accuracy: 0.812500     test accuracy: 0.632368
lr decays to 0.002288
Average cost in epoch 71: 0.607626
training accuracy: 0.781250     test accuracy: 0.640360
Average cost in epoch 72: 0.605176
training accuracy: 0.656250     test accuracy: 0.645355
Average cost in epoch 73: 0.611265
training accuracy: 0.750000     test accuracy: 0.633367
Average cost in epoch 74: 0.597664
training accuracy: 0.843750     test accuracy: 0.633367

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 75: 0.595361
training accuracy: 0.750000     test accuracy: 0.624376
lr decays to 0.002059
Average cost in epoch 76: 0.591189
training accuracy: 0.593750     test accuracy: 0.635365
Average cost in epoch 77: 0.596736
training accuracy: 0.812500     test accuracy: 0.644356
Average cost in epoch 78: 0.591940
training accuracy: 0.781250     test accuracy: 0.644356
Average cost in epoch 79: 0.591764
training accuracy: 0.781250     test accuracy: 0.654346

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 80: 0.587694
training accuracy: 0.812500     test accuracy: 0.636364
lr decays to 0.001853
Average cost in epoch 81: 0.584596
training accuracy: 0.718750     test accuracy: 0.639361
Average cost in epoch 82: 0.583106
training accuracy: 0.656250     test accuracy: 0.632368
Average cost in epoch 83: 0.588995
training accuracy: 0.781250     test accuracy: 0.634366
Average cost in epoch 84: 0.584892
training accuracy: 0.812500     test accuracy: 0.643357

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 85: 0.579931
training accuracy: 0.656250     test accuracy: 0.631369
lr decays to 0.001668
Average cost in epoch 86: 0.572201
training accuracy: 0.781250     test accuracy: 0.634366
Average cost in epoch 87: 0.568277
training accuracy: 0.656250     test accuracy: 0.623377
Average cost in epoch 88: 0.572808
training accuracy: 0.781250     test accuracy: 0.630370
Average cost in epoch 89: 0.578062
training accuracy: 0.812500     test accuracy: 0.637363

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 90: 0.563133
training accuracy: 0.812500     test accuracy: 0.621379
lr decays to 0.001501
Average cost in epoch 91: 0.576687
training accuracy: 0.875000     test accuracy: 0.630370
Average cost in epoch 92: 0.569230
training accuracy: 0.937500     test accuracy: 0.622378
Average cost in epoch 93: 0.560509
training accuracy: 0.843750     test accuracy: 0.631369
Average cost in epoch 94: 0.574343
training accuracy: 0.812500     test accuracy: 0.625375

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 95: 0.568854
training accuracy: 0.750000     test accuracy: 0.642358
lr decays to 0.001351
Average cost in epoch 96: 0.556267
training accuracy: 0.781250     test accuracy: 0.632368
Average cost in epoch 97: 0.565782
training accuracy: 0.687500     test accuracy: 0.629371
Average cost in epoch 98: 0.554996
training accuracy: 0.750000     test accuracy: 0.626374
Average cost in epoch 99: 0.561553
training accuracy: 0.781250     test accuracy: 0.629371

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 100: 0.563323
training accuracy: 0.843750     test accuracy: 0.638362
lr decays to 0.001216
Average cost in epoch 101: 0.557582
training accuracy: 0.718750     test accuracy: 0.639361
Average cost in epoch 102: 0.554338
training accuracy: 0.687500     test accuracy: 0.629371
Average cost in epoch 103: 0.553574
training accuracy: 0.750000     test accuracy: 0.634366
Average cost in epoch 104: 0.547220
training accuracy: 0.781250     test accuracy: 0.624376

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 105: 0.559593
training accuracy: 0.718750     test accuracy: 0.628372
Average cost in epoch 106: 0.554230
training accuracy: 0.656250     test accuracy: 0.635365
Average cost in epoch 107: 0.549269
training accuracy: 0.812500     test accuracy: 0.624376
Average cost in epoch 108: 0.552370
training accuracy: 0.781250     test accuracy: 0.634366
Average cost in epoch 109: 0.546413
training accuracy: 0.750000     test accuracy: 0.622378

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 110: 0.554567
training accuracy: 0.843750     test accuracy: 0.624376
Average cost in epoch 111: 0.549128
training accuracy: 0.812500     test accuracy: 0.617383
Average cost in epoch 112: 0.545583
training accuracy: 0.750000     test accuracy: 0.620380
Average cost in epoch 113: 0.544512
training accuracy: 0.812500     test accuracy: 0.631369
Average cost in epoch 114: 0.545166
training accuracy: 0.718750     test accuracy: 0.625375

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 115: 0.544339
training accuracy: 0.750000     test accuracy: 0.632368
Average cost in epoch 116: 0.549133
training accuracy: 0.750000     test accuracy: 0.621379
Average cost in epoch 117: 0.546328
training accuracy: 0.812500     test accuracy: 0.624376
Average cost in epoch 118: 0.540011
training accuracy: 0.750000     test accuracy: 0.631369
Average cost in epoch 119: 0.541598
training accuracy: 0.875000     test accuracy: 0.635365

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 120: 0.540318
training accuracy: 0.781250     test accuracy: 0.631369
Average cost in epoch 121: 0.544289
training accuracy: 0.750000     test accuracy: 0.629371
Average cost in epoch 122: 0.545263
training accuracy: 0.562500     test accuracy: 0.637363
Average cost in epoch 123: 0.526885
training accuracy: 0.843750     test accuracy: 0.621379
Average cost in epoch 124: 0.538620
training accuracy: 0.687500     test accuracy: 0.638362

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 125: 0.545998
training accuracy: 0.750000     test accuracy: 0.628372
Average cost in epoch 126: 0.541027
training accuracy: 0.781250     test accuracy: 0.627373
Average cost in epoch 127: 0.539953
training accuracy: 0.812500     test accuracy: 0.622378
Average cost in epoch 128: 0.541558
training accuracy: 0.781250     test accuracy: 0.623377
Average cost in epoch 129: 0.532751
training accuracy: 0.656250     test accuracy: 0.635365

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 130: 0.540634
training accuracy: 0.781250     test accuracy: 0.625375
Average cost in epoch 131: 0.544233
training accuracy: 0.781250     test accuracy: 0.627373
Average cost in epoch 132: 0.531293
training accuracy: 0.687500     test accuracy: 0.620380
Average cost in epoch 133: 0.541604
training accuracy: 0.750000     test accuracy: 0.630370
Average cost in epoch 134: 0.536054
training accuracy: 0.875000     test accuracy: 0.630370

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 135: 0.543230
training accuracy: 0.812500     test accuracy: 0.615385
Average cost in epoch 136: 0.528779
training accuracy: 0.843750     test accuracy: 0.631369
Average cost in epoch 137: 0.531384
training accuracy: 0.812500     test accuracy: 0.619381
Average cost in epoch 138: 0.538131
training accuracy: 0.781250     test accuracy: 0.626374
Average cost in epoch 139: 0.532749
training accuracy: 0.687500     test accuracy: 0.635365

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 140: 0.550798
training accuracy: 0.687500     test accuracy: 0.630370
Average cost in epoch 141: 0.549070
training accuracy: 0.812500     test accuracy: 0.627373
Average cost in epoch 142: 0.532288
training accuracy: 0.781250     test accuracy: 0.633367
Average cost in epoch 143: 0.541765
training accuracy: 0.750000     test accuracy: 0.638362
Average cost in epoch 144: 0.531560
training accuracy: 0.875000     test accuracy: 0.628372

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 145: 0.535272
training accuracy: 0.687500     test accuracy: 0.646354
Average cost in epoch 146: 0.535800
training accuracy: 0.843750     test accuracy: 0.639361
Average cost in epoch 147: 0.529898
training accuracy: 0.593750     test accuracy: 0.627373
Average cost in epoch 148: 0.525257
training accuracy: 0.687500     test accuracy: 0.632368
Average cost in epoch 149: 0.539349
training accuracy: 0.843750     test accuracy: 0.628372

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 150: 0.542635
training accuracy: 0.906250     test accuracy: 0.628372
Average cost in epoch 151: 0.525679
training accuracy: 0.781250     test accuracy: 0.641359
Average cost in epoch 152: 0.523216
training accuracy: 0.750000     test accuracy: 0.627373
Average cost in epoch 153: 0.536573
training accuracy: 0.750000     test accuracy: 0.632368
Average cost in epoch 154: 0.525210
training accuracy: 0.843750     test accuracy: 0.651349

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 155: 0.527658
training accuracy: 0.718750     test accuracy: 0.647353
Average cost in epoch 156: 0.542700
training accuracy: 0.750000     test accuracy: 0.639361
Average cost in epoch 157: 0.518934
training accuracy: 0.812500     test accuracy: 0.638362
Average cost in epoch 158: 0.527864
training accuracy: 0.843750     test accuracy: 0.631369
Average cost in epoch 159: 0.534862
training accuracy: 0.718750     test accuracy: 0.627373

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 160: 0.533780
training accuracy: 0.718750     test accuracy: 0.624376
Average cost in epoch 161: 0.537144
training accuracy: 0.812500     test accuracy: 0.635365
Average cost in epoch 162: 0.521319
training accuracy: 0.750000     test accuracy: 0.628372
Average cost in epoch 163: 0.533459
training accuracy: 0.875000     test accuracy: 0.623377
Average cost in epoch 164: 0.528438
training accuracy: 0.843750     test accuracy: 0.621379

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 165: 0.534297
training accuracy: 0.812500     test accuracy: 0.623377
Average cost in epoch 166: 0.517898
training accuracy: 0.750000     test accuracy: 0.636364
Average cost in epoch 167: 0.527866
training accuracy: 0.781250     test accuracy: 0.608392
Average cost in epoch 168: 0.528356
training accuracy: 0.781250     test accuracy: 0.636364
Average cost in epoch 169: 0.528862
training accuracy: 0.781250     test accuracy: 0.630370

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 170: 0.516780
training accuracy: 0.656250     test accuracy: 0.635365
Average cost in epoch 171: 0.527210
training accuracy: 0.937500     test accuracy: 0.630370
Average cost in epoch 172: 0.526589
training accuracy: 0.843750     test accuracy: 0.648352
Average cost in epoch 173: 0.532089
training accuracy: 0.812500     test accuracy: 0.627373
Average cost in epoch 174: 0.519549
training accuracy: 0.875000     test accuracy: 0.630370

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 175: 0.530407
training accuracy: 0.812500     test accuracy: 0.619381
Average cost in epoch 176: 0.529447
training accuracy: 0.718750     test accuracy: 0.635365
Average cost in epoch 177: 0.520030
training accuracy: 0.875000     test accuracy: 0.628372
Average cost in epoch 178: 0.518834
training accuracy: 0.750000     test accuracy: 0.633367
Average cost in epoch 179: 0.526933
training accuracy: 0.812500     test accuracy: 0.628372

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 180: 0.526359
training accuracy: 0.812500     test accuracy: 0.630370
Average cost in epoch 181: 0.520416
training accuracy: 0.781250     test accuracy: 0.616384
Average cost in epoch 182: 0.531656
training accuracy: 0.687500     test accuracy: 0.626374
Average cost in epoch 183: 0.525097
training accuracy: 0.687500     test accuracy: 0.627373
Average cost in epoch 184: 0.514878
training accuracy: 0.687500     test accuracy: 0.631369

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 185: 0.517490
training accuracy: 0.750000     test accuracy: 0.629371
Average cost in epoch 186: 0.525718
training accuracy: 0.656250     test accuracy: 0.635365
Average cost in epoch 187: 0.524995
training accuracy: 0.812500     test accuracy: 0.636364
Average cost in epoch 188: 0.516989
training accuracy: 0.843750     test accuracy: 0.621379
Average cost in epoch 189: 0.525029
training accuracy: 0.781250     test accuracy: 0.629371

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 190: 0.515959
training accuracy: 0.750000     test accuracy: 0.620380
Average cost in epoch 191: 0.527663
training accuracy: 0.781250     test accuracy: 0.628372
Average cost in epoch 192: 0.516759
training accuracy: 0.781250     test accuracy: 0.625375
Average cost in epoch 193: 0.517296
training accuracy: 0.843750     test accuracy: 0.629371
Average cost in epoch 194: 0.517798
training accuracy: 0.718750     test accuracy: 0.639361

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Average cost in epoch 195: 0.525270
training accuracy: 0.781250     test accuracy: 0.639361
Average cost in epoch 196: 0.521821
training accuracy: 0.687500     test accuracy: 0.631369
Average cost in epoch 197: 0.521332
training accuracy: 0.843750     test accuracy: 0.629371
Average cost in epoch 198: 0.514564
training accuracy: 0.687500     test accuracy: 0.645355
Average cost in epoch 199: 0.527543
training accuracy: 0.843750     test accuracy: 0.626374

dump to weights/pyramid-lstm/pyramid-lstm_5.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 6, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_6.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 193.30
Starting training...
Average cost in epoch 0: 0.736023
training accuracy: 0.687500     test accuracy: 0.507493
Average cost in epoch 1: 0.698524
training accuracy: 0.375000     test accuracy: 0.499500
Average cost in epoch 2: 0.696842
training accuracy: 0.406250     test accuracy: 0.497502
Average cost in epoch 3: 0.696010
training accuracy: 0.656250     test accuracy: 0.513487
Average cost in epoch 4: 0.700156
training accuracy: 0.562500     test accuracy: 0.504496

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 5: 0.694804
training accuracy: 0.406250     test accuracy: 0.532468
lr decays to 0.009000
Average cost in epoch 6: 0.703582
training accuracy: 0.687500     test accuracy: 0.463536
Average cost in epoch 7: 0.694003
training accuracy: 0.468750     test accuracy: 0.512488
Average cost in epoch 8: 0.694016
training accuracy: 0.562500     test accuracy: 0.476523
Average cost in epoch 9: 0.694141
training accuracy: 0.562500     test accuracy: 0.489510

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 10: 0.693813
training accuracy: 0.593750     test accuracy: 0.497502
lr decays to 0.008100
Average cost in epoch 11: 0.693862
training accuracy: 0.625000     test accuracy: 0.511489
Average cost in epoch 12: 0.693625
training accuracy: 0.500000     test accuracy: 0.506494
Average cost in epoch 13: 0.693203
training accuracy: 0.468750     test accuracy: 0.477522
Average cost in epoch 14: 0.693489
training accuracy: 0.468750     test accuracy: 0.483516

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 15: 0.693378
training accuracy: 0.468750     test accuracy: 0.505495
lr decays to 0.007290
Average cost in epoch 16: 0.692979
training accuracy: 0.437500     test accuracy: 0.506494
Average cost in epoch 17: 0.692448
training accuracy: 0.593750     test accuracy: 0.517483
Average cost in epoch 18: 0.692722
training accuracy: 0.656250     test accuracy: 0.516484
Average cost in epoch 19: 0.692327
training accuracy: 0.500000     test accuracy: 0.506494

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 20: 0.692106
training accuracy: 0.500000     test accuracy: 0.507493
lr decays to 0.006561
Average cost in epoch 21: 0.690920
training accuracy: 0.531250     test accuracy: 0.511489
Average cost in epoch 22: 0.690518
training accuracy: 0.531250     test accuracy: 0.514486
Average cost in epoch 23: 0.690277
training accuracy: 0.437500     test accuracy: 0.479520
Average cost in epoch 24: 0.689879
training accuracy: 0.437500     test accuracy: 0.483516

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 25: 0.689568
training accuracy: 0.656250     test accuracy: 0.499500
lr decays to 0.005905
Average cost in epoch 26: 0.689427
training accuracy: 0.531250     test accuracy: 0.492507
Average cost in epoch 27: 0.687407
training accuracy: 0.750000     test accuracy: 0.503497
Average cost in epoch 28: 0.685219
training accuracy: 0.562500     test accuracy: 0.487512
Average cost in epoch 29: 0.686393
training accuracy: 0.406250     test accuracy: 0.494505

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 30: 0.684146
training accuracy: 0.625000     test accuracy: 0.506494
lr decays to 0.005314
Average cost in epoch 31: 0.682669
training accuracy: 0.531250     test accuracy: 0.509491
Average cost in epoch 32: 0.679304
training accuracy: 0.500000     test accuracy: 0.497502
Average cost in epoch 33: 0.679313
training accuracy: 0.593750     test accuracy: 0.501499
Average cost in epoch 34: 0.678834
training accuracy: 0.437500     test accuracy: 0.483516

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 35: 0.678325
training accuracy: 0.437500     test accuracy: 0.514486
lr decays to 0.004783
Average cost in epoch 36: 0.676998
training accuracy: 0.375000     test accuracy: 0.510490
Average cost in epoch 37: 0.672380
training accuracy: 0.500000     test accuracy: 0.501499
Average cost in epoch 38: 0.671207
training accuracy: 0.593750     test accuracy: 0.509491
Average cost in epoch 39: 0.668918
training accuracy: 0.500000     test accuracy: 0.507493

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 40: 0.671885
training accuracy: 0.750000     test accuracy: 0.526474
lr decays to 0.004305
Average cost in epoch 41: 0.665732
training accuracy: 0.718750     test accuracy: 0.511489
Average cost in epoch 42: 0.665956
training accuracy: 0.656250     test accuracy: 0.529471
Average cost in epoch 43: 0.666899
training accuracy: 0.625000     test accuracy: 0.516484
Average cost in epoch 44: 0.662475
training accuracy: 0.562500     test accuracy: 0.505495

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 45: 0.659353
training accuracy: 0.625000     test accuracy: 0.498501
lr decays to 0.003874
Average cost in epoch 46: 0.660510
training accuracy: 0.500000     test accuracy: 0.505495
Average cost in epoch 47: 0.659887
training accuracy: 0.562500     test accuracy: 0.511489
Average cost in epoch 48: 0.654902
training accuracy: 0.687500     test accuracy: 0.511489
Average cost in epoch 49: 0.656396
training accuracy: 0.656250     test accuracy: 0.521479

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 50: 0.653872
training accuracy: 0.593750     test accuracy: 0.509491
lr decays to 0.003487
Average cost in epoch 51: 0.649079
training accuracy: 0.343750     test accuracy: 0.497502
Average cost in epoch 52: 0.650883
training accuracy: 0.625000     test accuracy: 0.525475
Average cost in epoch 53: 0.646937
training accuracy: 0.531250     test accuracy: 0.520480
Average cost in epoch 54: 0.643455
training accuracy: 0.687500     test accuracy: 0.515485

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 55: 0.647794
training accuracy: 0.625000     test accuracy: 0.522478
lr decays to 0.003138
Average cost in epoch 56: 0.645257
training accuracy: 0.562500     test accuracy: 0.518482
Average cost in epoch 57: 0.639302
training accuracy: 0.593750     test accuracy: 0.518482
Average cost in epoch 58: 0.640795
training accuracy: 0.687500     test accuracy: 0.506494
Average cost in epoch 59: 0.640627
training accuracy: 0.687500     test accuracy: 0.530470

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 60: 0.631586
training accuracy: 0.562500     test accuracy: 0.520480
lr decays to 0.002824
Average cost in epoch 61: 0.632984
training accuracy: 0.625000     test accuracy: 0.514486
Average cost in epoch 62: 0.630902
training accuracy: 0.656250     test accuracy: 0.521479
Average cost in epoch 63: 0.630682
training accuracy: 0.625000     test accuracy: 0.519481
Average cost in epoch 64: 0.629994
training accuracy: 0.687500     test accuracy: 0.530470

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 65: 0.630292
training accuracy: 0.625000     test accuracy: 0.530470
lr decays to 0.002542
Average cost in epoch 66: 0.626828
training accuracy: 0.625000     test accuracy: 0.504496
Average cost in epoch 67: 0.620165
training accuracy: 0.812500     test accuracy: 0.527473
Average cost in epoch 68: 0.620347
training accuracy: 0.562500     test accuracy: 0.516484
Average cost in epoch 69: 0.619864
training accuracy: 0.718750     test accuracy: 0.530470

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 70: 0.615925
training accuracy: 0.625000     test accuracy: 0.518482
lr decays to 0.002288
Average cost in epoch 71: 0.615113
training accuracy: 0.687500     test accuracy: 0.527473
Average cost in epoch 72: 0.610929
training accuracy: 0.781250     test accuracy: 0.516484
Average cost in epoch 73: 0.609641
training accuracy: 0.687500     test accuracy: 0.520480
Average cost in epoch 74: 0.611969
training accuracy: 0.781250     test accuracy: 0.529471

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 75: 0.607690
training accuracy: 0.750000     test accuracy: 0.532468
lr decays to 0.002059
Average cost in epoch 76: 0.608854
training accuracy: 0.656250     test accuracy: 0.528472
Average cost in epoch 77: 0.603389
training accuracy: 0.593750     test accuracy: 0.530470
Average cost in epoch 78: 0.602293
training accuracy: 0.781250     test accuracy: 0.519481
Average cost in epoch 79: 0.597635
training accuracy: 0.593750     test accuracy: 0.539461

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 80: 0.601694
training accuracy: 0.562500     test accuracy: 0.527473
lr decays to 0.001853
Average cost in epoch 81: 0.593072
training accuracy: 0.843750     test accuracy: 0.516484
Average cost in epoch 82: 0.595031
training accuracy: 0.500000     test accuracy: 0.532468
Average cost in epoch 83: 0.595409
training accuracy: 0.812500     test accuracy: 0.539461
Average cost in epoch 84: 0.592185
training accuracy: 0.656250     test accuracy: 0.528472

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 85: 0.591478
training accuracy: 0.718750     test accuracy: 0.530470
lr decays to 0.001668
Average cost in epoch 86: 0.593366
training accuracy: 0.687500     test accuracy: 0.532468
Average cost in epoch 87: 0.580556
training accuracy: 0.625000     test accuracy: 0.534466
Average cost in epoch 88: 0.589135
training accuracy: 0.750000     test accuracy: 0.531469
Average cost in epoch 89: 0.581502
training accuracy: 0.750000     test accuracy: 0.525475

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 90: 0.584641
training accuracy: 0.625000     test accuracy: 0.523477
lr decays to 0.001501
Average cost in epoch 91: 0.582692
training accuracy: 0.593750     test accuracy: 0.512488
Average cost in epoch 92: 0.578360
training accuracy: 0.750000     test accuracy: 0.523477
Average cost in epoch 93: 0.580207
training accuracy: 0.656250     test accuracy: 0.514486
Average cost in epoch 94: 0.585173
training accuracy: 0.656250     test accuracy: 0.507493

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 95: 0.576629
training accuracy: 0.718750     test accuracy: 0.513487
lr decays to 0.001351
Average cost in epoch 96: 0.576929
training accuracy: 0.687500     test accuracy: 0.519481
Average cost in epoch 97: 0.569100
training accuracy: 0.687500     test accuracy: 0.530470
Average cost in epoch 98: 0.571588
training accuracy: 0.687500     test accuracy: 0.514486
Average cost in epoch 99: 0.571751
training accuracy: 0.625000     test accuracy: 0.516484

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 100: 0.571552
training accuracy: 0.750000     test accuracy: 0.529471
lr decays to 0.001216
Average cost in epoch 101: 0.566324
training accuracy: 0.750000     test accuracy: 0.513487
Average cost in epoch 102: 0.563396
training accuracy: 0.656250     test accuracy: 0.504496
Average cost in epoch 103: 0.561909
training accuracy: 0.625000     test accuracy: 0.531469
Average cost in epoch 104: 0.561341
training accuracy: 0.718750     test accuracy: 0.518482

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 105: 0.565399
training accuracy: 0.750000     test accuracy: 0.520480
Average cost in epoch 106: 0.566343
training accuracy: 0.656250     test accuracy: 0.513487
Average cost in epoch 107: 0.556968
training accuracy: 0.875000     test accuracy: 0.522478
Average cost in epoch 108: 0.560989
training accuracy: 0.781250     test accuracy: 0.532468
Average cost in epoch 109: 0.560594
training accuracy: 0.812500     test accuracy: 0.519481

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 110: 0.556132
training accuracy: 0.718750     test accuracy: 0.525475
Average cost in epoch 111: 0.557590
training accuracy: 0.781250     test accuracy: 0.516484
Average cost in epoch 112: 0.552322
training accuracy: 0.906250     test accuracy: 0.525475
Average cost in epoch 113: 0.556405
training accuracy: 0.531250     test accuracy: 0.510490
Average cost in epoch 114: 0.556515
training accuracy: 0.593750     test accuracy: 0.508492

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 115: 0.557439
training accuracy: 0.562500     test accuracy: 0.520480
Average cost in epoch 116: 0.555023
training accuracy: 0.593750     test accuracy: 0.510490
Average cost in epoch 117: 0.557014
training accuracy: 0.656250     test accuracy: 0.518482
Average cost in epoch 118: 0.548750
training accuracy: 0.718750     test accuracy: 0.521479
Average cost in epoch 119: 0.560341
training accuracy: 0.625000     test accuracy: 0.517483

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 120: 0.551876
training accuracy: 0.656250     test accuracy: 0.528472
Average cost in epoch 121: 0.550325
training accuracy: 0.718750     test accuracy: 0.519481
Average cost in epoch 122: 0.554051
training accuracy: 0.687500     test accuracy: 0.515485
Average cost in epoch 123: 0.547407
training accuracy: 0.625000     test accuracy: 0.522478
Average cost in epoch 124: 0.549330
training accuracy: 0.687500     test accuracy: 0.523477

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 125: 0.553798
training accuracy: 0.593750     test accuracy: 0.523477
Average cost in epoch 126: 0.549120
training accuracy: 0.656250     test accuracy: 0.519481
Average cost in epoch 127: 0.548654
training accuracy: 0.687500     test accuracy: 0.517483
Average cost in epoch 128: 0.546465
training accuracy: 0.656250     test accuracy: 0.523477
Average cost in epoch 129: 0.547722
training accuracy: 0.750000     test accuracy: 0.528472

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 130: 0.543464
training accuracy: 0.687500     test accuracy: 0.520480
Average cost in epoch 131: 0.547326
training accuracy: 0.656250     test accuracy: 0.519481
Average cost in epoch 132: 0.547894
training accuracy: 0.656250     test accuracy: 0.517483
Average cost in epoch 133: 0.543456
training accuracy: 0.656250     test accuracy: 0.510490
Average cost in epoch 134: 0.543522
training accuracy: 0.500000     test accuracy: 0.510490

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 135: 0.542078
training accuracy: 0.656250     test accuracy: 0.526474
Average cost in epoch 136: 0.548681
training accuracy: 0.750000     test accuracy: 0.526474
Average cost in epoch 137: 0.535136
training accuracy: 0.750000     test accuracy: 0.523477
Average cost in epoch 138: 0.538641
training accuracy: 0.593750     test accuracy: 0.518482
Average cost in epoch 139: 0.544395
training accuracy: 0.843750     test accuracy: 0.519481

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 140: 0.533945
training accuracy: 0.625000     test accuracy: 0.516484
Average cost in epoch 141: 0.546057
training accuracy: 0.656250     test accuracy: 0.527473
Average cost in epoch 142: 0.541068
training accuracy: 0.781250     test accuracy: 0.518482
Average cost in epoch 143: 0.541561
training accuracy: 0.656250     test accuracy: 0.519481
Average cost in epoch 144: 0.537002
training accuracy: 0.687500     test accuracy: 0.525475

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 145: 0.532075
training accuracy: 0.718750     test accuracy: 0.519481
Average cost in epoch 146: 0.540407
training accuracy: 0.687500     test accuracy: 0.519481
Average cost in epoch 147: 0.543684
training accuracy: 0.625000     test accuracy: 0.535465
Average cost in epoch 148: 0.542537
training accuracy: 0.687500     test accuracy: 0.524476
Average cost in epoch 149: 0.536519
training accuracy: 0.562500     test accuracy: 0.531469

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 150: 0.538841
training accuracy: 0.687500     test accuracy: 0.525475
Average cost in epoch 151: 0.533524
training accuracy: 0.593750     test accuracy: 0.522478
Average cost in epoch 152: 0.532769
training accuracy: 0.750000     test accuracy: 0.532468
Average cost in epoch 153: 0.539892
training accuracy: 0.687500     test accuracy: 0.523477
Average cost in epoch 154: 0.533262
training accuracy: 0.750000     test accuracy: 0.520480

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 155: 0.525366
training accuracy: 0.781250     test accuracy: 0.529471
Average cost in epoch 156: 0.537677
training accuracy: 0.656250     test accuracy: 0.521479
Average cost in epoch 157: 0.528087
training accuracy: 0.718750     test accuracy: 0.510490
Average cost in epoch 158: 0.524117
training accuracy: 0.750000     test accuracy: 0.515485
Average cost in epoch 159: 0.536706
training accuracy: 0.562500     test accuracy: 0.530470

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 160: 0.532235
training accuracy: 0.468750     test accuracy: 0.533467
Average cost in epoch 161: 0.521862
training accuracy: 0.687500     test accuracy: 0.523477
Average cost in epoch 162: 0.527133
training accuracy: 0.656250     test accuracy: 0.516484
Average cost in epoch 163: 0.529889
training accuracy: 0.656250     test accuracy: 0.526474
Average cost in epoch 164: 0.530743
training accuracy: 0.781250     test accuracy: 0.525475

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 165: 0.525655
training accuracy: 0.468750     test accuracy: 0.545455
Average cost in epoch 166: 0.527413
training accuracy: 0.812500     test accuracy: 0.530470
Average cost in epoch 167: 0.525946
training accuracy: 0.843750     test accuracy: 0.527473
Average cost in epoch 168: 0.527982
training accuracy: 0.656250     test accuracy: 0.527473
Average cost in epoch 169: 0.521650
training accuracy: 0.718750     test accuracy: 0.517483

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 170: 0.536376
training accuracy: 0.781250     test accuracy: 0.526474
Average cost in epoch 171: 0.533406
training accuracy: 0.687500     test accuracy: 0.523477
Average cost in epoch 172: 0.526026
training accuracy: 0.718750     test accuracy: 0.532468
Average cost in epoch 173: 0.525349
training accuracy: 0.687500     test accuracy: 0.530470
Average cost in epoch 174: 0.520681
training accuracy: 0.687500     test accuracy: 0.522478

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 175: 0.529590
training accuracy: 0.781250     test accuracy: 0.532468
Average cost in epoch 176: 0.524735
training accuracy: 0.625000     test accuracy: 0.517483
Average cost in epoch 177: 0.526107
training accuracy: 0.656250     test accuracy: 0.520480
Average cost in epoch 178: 0.521703
training accuracy: 0.718750     test accuracy: 0.524476
Average cost in epoch 179: 0.532395
training accuracy: 0.625000     test accuracy: 0.538462

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 180: 0.518357
training accuracy: 0.718750     test accuracy: 0.519481
Average cost in epoch 181: 0.528696
training accuracy: 0.750000     test accuracy: 0.530470
Average cost in epoch 182: 0.525614
training accuracy: 0.656250     test accuracy: 0.517483
Average cost in epoch 183: 0.514974
training accuracy: 0.656250     test accuracy: 0.529471
Average cost in epoch 184: 0.523814
training accuracy: 0.687500     test accuracy: 0.535465

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 185: 0.520509
training accuracy: 0.593750     test accuracy: 0.529471
Average cost in epoch 186: 0.529714
training accuracy: 0.718750     test accuracy: 0.533467
Average cost in epoch 187: 0.526460
training accuracy: 0.656250     test accuracy: 0.531469
Average cost in epoch 188: 0.524672
training accuracy: 0.750000     test accuracy: 0.534466
Average cost in epoch 189: 0.529913
training accuracy: 0.812500     test accuracy: 0.534466

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 190: 0.518516
training accuracy: 0.687500     test accuracy: 0.536464
Average cost in epoch 191: 0.518319
training accuracy: 0.687500     test accuracy: 0.542458
Average cost in epoch 192: 0.518947
training accuracy: 0.468750     test accuracy: 0.535465
Average cost in epoch 193: 0.518505
training accuracy: 0.750000     test accuracy: 0.528472
Average cost in epoch 194: 0.519393
training accuracy: 0.875000     test accuracy: 0.534466

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Average cost in epoch 195: 0.522822
training accuracy: 0.812500     test accuracy: 0.526474
Average cost in epoch 196: 0.520589
training accuracy: 0.781250     test accuracy: 0.530470
Average cost in epoch 197: 0.520395
training accuracy: 0.750000     test accuracy: 0.533467
Average cost in epoch 198: 0.523348
training accuracy: 0.812500     test accuracy: 0.530470
Average cost in epoch 199: 0.525421
training accuracy: 0.843750     test accuracy: 0.529471

dump to weights/pyramid-lstm/pyramid-lstm_6.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 7, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_7.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 113.71
Starting training...
Average cost in epoch 0: 0.760124
training accuracy: 0.656250     test accuracy: 0.774226
Average cost in epoch 1: 0.558357
training accuracy: 0.843750     test accuracy: 0.788212
Average cost in epoch 2: 0.507281
training accuracy: 0.781250     test accuracy: 0.785215
Average cost in epoch 3: 0.513636
training accuracy: 0.843750     test accuracy: 0.773227
Average cost in epoch 4: 0.471850
training accuracy: 0.906250     test accuracy: 0.757243

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 5: 0.464593
training accuracy: 0.687500     test accuracy: 0.789211
lr decays to 0.009000
Average cost in epoch 6: 0.451440
training accuracy: 0.750000     test accuracy: 0.790210
Average cost in epoch 7: 0.449888
training accuracy: 0.781250     test accuracy: 0.792208
Average cost in epoch 8: 0.445050
training accuracy: 0.875000     test accuracy: 0.789211
Average cost in epoch 9: 0.444498
training accuracy: 0.875000     test accuracy: 0.778222

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 10: 0.443220
training accuracy: 0.718750     test accuracy: 0.794206
lr decays to 0.008100
Average cost in epoch 11: 0.433191
training accuracy: 0.843750     test accuracy: 0.786214
Average cost in epoch 12: 0.433662
training accuracy: 0.781250     test accuracy: 0.786214
Average cost in epoch 13: 0.424809
training accuracy: 0.718750     test accuracy: 0.795205
Average cost in epoch 14: 0.426557
training accuracy: 0.906250     test accuracy: 0.795205

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 15: 0.423969
training accuracy: 0.906250     test accuracy: 0.796204
lr decays to 0.007290
Average cost in epoch 16: 0.421256
training accuracy: 0.781250     test accuracy: 0.783217
Average cost in epoch 17: 0.420690
training accuracy: 0.875000     test accuracy: 0.781219
Average cost in epoch 18: 0.421835
training accuracy: 0.718750     test accuracy: 0.794206
Average cost in epoch 19: 0.414975
training accuracy: 0.812500     test accuracy: 0.800200

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 20: 0.417151
training accuracy: 0.750000     test accuracy: 0.788212
lr decays to 0.006561
Average cost in epoch 21: 0.408508
training accuracy: 0.781250     test accuracy: 0.782218
Average cost in epoch 22: 0.403029
training accuracy: 0.875000     test accuracy: 0.787213
Average cost in epoch 23: 0.406201
training accuracy: 0.875000     test accuracy: 0.787213
Average cost in epoch 24: 0.410292
training accuracy: 0.812500     test accuracy: 0.780220

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 25: 0.403344
training accuracy: 0.906250     test accuracy: 0.782218
lr decays to 0.005905
Average cost in epoch 26: 0.400163
training accuracy: 0.750000     test accuracy: 0.794206
Average cost in epoch 27: 0.402102
training accuracy: 0.843750     test accuracy: 0.794206
Average cost in epoch 28: 0.389660
training accuracy: 0.718750     test accuracy: 0.779221
Average cost in epoch 29: 0.394571
training accuracy: 0.812500     test accuracy: 0.780220

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 30: 0.394594
training accuracy: 0.843750     test accuracy: 0.793207
lr decays to 0.005314
Average cost in epoch 31: 0.388172
training accuracy: 0.812500     test accuracy: 0.776224
Average cost in epoch 32: 0.383723
training accuracy: 0.687500     test accuracy: 0.781219
Average cost in epoch 33: 0.395556
training accuracy: 0.781250     test accuracy: 0.784216
Average cost in epoch 34: 0.386876
training accuracy: 0.875000     test accuracy: 0.780220

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 35: 0.383889
training accuracy: 0.843750     test accuracy: 0.789211
lr decays to 0.004783
Average cost in epoch 36: 0.376455
training accuracy: 0.812500     test accuracy: 0.799201
Average cost in epoch 37: 0.382628
training accuracy: 0.781250     test accuracy: 0.792208
Average cost in epoch 38: 0.377882
training accuracy: 0.843750     test accuracy: 0.781219
Average cost in epoch 39: 0.371054
training accuracy: 0.843750     test accuracy: 0.787213

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 40: 0.372877
training accuracy: 0.906250     test accuracy: 0.782218
lr decays to 0.004305
Average cost in epoch 41: 0.365476
training accuracy: 0.843750     test accuracy: 0.775225
Average cost in epoch 42: 0.359681
training accuracy: 0.906250     test accuracy: 0.780220
Average cost in epoch 43: 0.358010
training accuracy: 0.750000     test accuracy: 0.773227
Average cost in epoch 44: 0.370488
training accuracy: 0.812500     test accuracy: 0.786214

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 45: 0.356417
training accuracy: 0.843750     test accuracy: 0.774226
lr decays to 0.003874
Average cost in epoch 46: 0.362607
training accuracy: 0.781250     test accuracy: 0.773227
Average cost in epoch 47: 0.360213
training accuracy: 0.875000     test accuracy: 0.774226
Average cost in epoch 48: 0.356989
training accuracy: 0.906250     test accuracy: 0.793207
Average cost in epoch 49: 0.343282
training accuracy: 0.750000     test accuracy: 0.772228

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 50: 0.355527
training accuracy: 0.906250     test accuracy: 0.778222
lr decays to 0.003487
Average cost in epoch 51: 0.344010
training accuracy: 0.812500     test accuracy: 0.782218
Average cost in epoch 52: 0.341628
training accuracy: 0.906250     test accuracy: 0.779221
Average cost in epoch 53: 0.341135
training accuracy: 0.906250     test accuracy: 0.786214
Average cost in epoch 54: 0.339330
training accuracy: 0.843750     test accuracy: 0.783217

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 55: 0.336905
training accuracy: 0.812500     test accuracy: 0.787213
lr decays to 0.003138
Average cost in epoch 56: 0.353953
training accuracy: 0.906250     test accuracy: 0.781219
Average cost in epoch 57: 0.332859
training accuracy: 0.781250     test accuracy: 0.776224
Average cost in epoch 58: 0.333425
training accuracy: 0.781250     test accuracy: 0.778222
Average cost in epoch 59: 0.337909
training accuracy: 0.812500     test accuracy: 0.776224

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 60: 0.332530
training accuracy: 0.875000     test accuracy: 0.766234
lr decays to 0.002824
Average cost in epoch 61: 0.321981
training accuracy: 0.812500     test accuracy: 0.782218
Average cost in epoch 62: 0.318704
training accuracy: 0.843750     test accuracy: 0.778222
Average cost in epoch 63: 0.324884
training accuracy: 0.968750     test accuracy: 0.790210
Average cost in epoch 64: 0.319822
training accuracy: 0.843750     test accuracy: 0.792208

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 65: 0.322254
training accuracy: 0.843750     test accuracy: 0.783217
lr decays to 0.002542
Average cost in epoch 66: 0.311436
training accuracy: 0.843750     test accuracy: 0.785215
Average cost in epoch 67: 0.312195
training accuracy: 0.906250     test accuracy: 0.777223
Average cost in epoch 68: 0.302237
training accuracy: 0.937500     test accuracy: 0.782218
Average cost in epoch 69: 0.313158
training accuracy: 0.781250     test accuracy: 0.788212

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 70: 0.303261
training accuracy: 0.906250     test accuracy: 0.775225
lr decays to 0.002288
Average cost in epoch 71: 0.306626
training accuracy: 0.781250     test accuracy: 0.784216
Average cost in epoch 72: 0.305296
training accuracy: 1.000000     test accuracy: 0.778222
Average cost in epoch 73: 0.293565
training accuracy: 0.875000     test accuracy: 0.782218
Average cost in epoch 74: 0.302328
training accuracy: 0.812500     test accuracy: 0.786214

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 75: 0.300050
training accuracy: 0.781250     test accuracy: 0.779221
lr decays to 0.002059
Average cost in epoch 76: 0.303741
training accuracy: 0.937500     test accuracy: 0.770230
Average cost in epoch 77: 0.288193
training accuracy: 0.937500     test accuracy: 0.790210
Average cost in epoch 78: 0.299219
training accuracy: 0.875000     test accuracy: 0.771229
Average cost in epoch 79: 0.291591
training accuracy: 0.875000     test accuracy: 0.769231

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 80: 0.292749
training accuracy: 0.843750     test accuracy: 0.776224
lr decays to 0.001853
Average cost in epoch 81: 0.283191
training accuracy: 0.875000     test accuracy: 0.778222
Average cost in epoch 82: 0.285343
training accuracy: 0.875000     test accuracy: 0.767233
Average cost in epoch 83: 0.285182
training accuracy: 0.968750     test accuracy: 0.780220
Average cost in epoch 84: 0.280628
training accuracy: 0.750000     test accuracy: 0.777223

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 85: 0.280113
training accuracy: 0.750000     test accuracy: 0.790210
lr decays to 0.001668
Average cost in epoch 86: 0.285102
training accuracy: 0.937500     test accuracy: 0.780220
Average cost in epoch 87: 0.263014
training accuracy: 0.875000     test accuracy: 0.773227
Average cost in epoch 88: 0.270055
training accuracy: 0.781250     test accuracy: 0.774226
Average cost in epoch 89: 0.269069
training accuracy: 0.906250     test accuracy: 0.767233

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 90: 0.267194
training accuracy: 0.875000     test accuracy: 0.772228
lr decays to 0.001501
Average cost in epoch 91: 0.259593
training accuracy: 0.906250     test accuracy: 0.769231
Average cost in epoch 92: 0.260504
training accuracy: 0.937500     test accuracy: 0.780220
Average cost in epoch 93: 0.263679
training accuracy: 0.968750     test accuracy: 0.768232
Average cost in epoch 94: 0.266072
training accuracy: 0.812500     test accuracy: 0.775225

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 95: 0.255811
training accuracy: 0.843750     test accuracy: 0.775225
lr decays to 0.001351
Average cost in epoch 96: 0.259053
training accuracy: 0.843750     test accuracy: 0.775225
Average cost in epoch 97: 0.250083
training accuracy: 0.875000     test accuracy: 0.764236
Average cost in epoch 98: 0.254047
training accuracy: 0.875000     test accuracy: 0.775225
Average cost in epoch 99: 0.256560
training accuracy: 0.906250     test accuracy: 0.767233

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 100: 0.248783
training accuracy: 0.968750     test accuracy: 0.765235
lr decays to 0.001216
Average cost in epoch 101: 0.250755
training accuracy: 0.906250     test accuracy: 0.766234
Average cost in epoch 102: 0.244272
training accuracy: 0.875000     test accuracy: 0.763237
Average cost in epoch 103: 0.248644
training accuracy: 0.906250     test accuracy: 0.762238
Average cost in epoch 104: 0.246755
training accuracy: 0.968750     test accuracy: 0.759241

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 105: 0.239881
training accuracy: 0.843750     test accuracy: 0.762238
Average cost in epoch 106: 0.253353
training accuracy: 0.812500     test accuracy: 0.767233
Average cost in epoch 107: 0.257121
training accuracy: 0.906250     test accuracy: 0.762238
Average cost in epoch 108: 0.249431
training accuracy: 0.937500     test accuracy: 0.765235
Average cost in epoch 109: 0.241647
training accuracy: 0.875000     test accuracy: 0.767233

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 110: 0.246171
training accuracy: 0.875000     test accuracy: 0.760240
Average cost in epoch 111: 0.249211
training accuracy: 1.000000     test accuracy: 0.763237
Average cost in epoch 112: 0.247865
training accuracy: 0.968750     test accuracy: 0.774226
Average cost in epoch 113: 0.230424
training accuracy: 0.875000     test accuracy: 0.763237
Average cost in epoch 114: 0.238484
training accuracy: 0.906250     test accuracy: 0.760240

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 115: 0.238100
training accuracy: 0.812500     test accuracy: 0.766234
Average cost in epoch 116: 0.239444
training accuracy: 1.000000     test accuracy: 0.764236
Average cost in epoch 117: 0.239816
training accuracy: 0.937500     test accuracy: 0.770230
Average cost in epoch 118: 0.241077
training accuracy: 0.906250     test accuracy: 0.766234
Average cost in epoch 119: 0.230799
training accuracy: 0.906250     test accuracy: 0.761239

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 120: 0.239733
training accuracy: 0.875000     test accuracy: 0.765235
Average cost in epoch 121: 0.236198
training accuracy: 0.906250     test accuracy: 0.770230
Average cost in epoch 122: 0.228818
training accuracy: 1.000000     test accuracy: 0.765235
Average cost in epoch 123: 0.230739
training accuracy: 0.875000     test accuracy: 0.775225
Average cost in epoch 124: 0.237568
training accuracy: 0.937500     test accuracy: 0.766234

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 125: 0.240663
training accuracy: 0.843750     test accuracy: 0.763237
Average cost in epoch 126: 0.230632
training accuracy: 1.000000     test accuracy: 0.765235
Average cost in epoch 127: 0.232672
training accuracy: 0.906250     test accuracy: 0.765235
Average cost in epoch 128: 0.240559
training accuracy: 0.875000     test accuracy: 0.769231
Average cost in epoch 129: 0.231247
training accuracy: 0.906250     test accuracy: 0.759241

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 130: 0.238350
training accuracy: 0.906250     test accuracy: 0.757243
Average cost in epoch 131: 0.234423
training accuracy: 0.906250     test accuracy: 0.770230
Average cost in epoch 132: 0.229678
training accuracy: 0.843750     test accuracy: 0.770230
Average cost in epoch 133: 0.237405
training accuracy: 0.937500     test accuracy: 0.764236
Average cost in epoch 134: 0.232392
training accuracy: 0.968750     test accuracy: 0.762238

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 135: 0.229707
training accuracy: 1.000000     test accuracy: 0.768232
Average cost in epoch 136: 0.229473
training accuracy: 0.906250     test accuracy: 0.766234
Average cost in epoch 137: 0.231611
training accuracy: 0.875000     test accuracy: 0.760240
Average cost in epoch 138: 0.229460
training accuracy: 0.937500     test accuracy: 0.775225
Average cost in epoch 139: 0.229415
training accuracy: 0.968750     test accuracy: 0.766234

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 140: 0.226827
training accuracy: 0.968750     test accuracy: 0.767233
Average cost in epoch 141: 0.236228
training accuracy: 0.875000     test accuracy: 0.764236
Average cost in epoch 142: 0.227303
training accuracy: 1.000000     test accuracy: 0.755245
Average cost in epoch 143: 0.228791
training accuracy: 0.937500     test accuracy: 0.769231
Average cost in epoch 144: 0.210786
training accuracy: 0.875000     test accuracy: 0.767233

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 145: 0.220732
training accuracy: 0.875000     test accuracy: 0.769231
Average cost in epoch 146: 0.223067
training accuracy: 0.875000     test accuracy: 0.764236
Average cost in epoch 147: 0.223236
training accuracy: 0.937500     test accuracy: 0.760240
Average cost in epoch 148: 0.222968
training accuracy: 0.906250     test accuracy: 0.765235
Average cost in epoch 149: 0.229986
training accuracy: 0.906250     test accuracy: 0.756244

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 150: 0.217079
training accuracy: 0.968750     test accuracy: 0.760240
Average cost in epoch 151: 0.233842
training accuracy: 0.843750     test accuracy: 0.757243
Average cost in epoch 152: 0.227030
training accuracy: 0.937500     test accuracy: 0.760240
Average cost in epoch 153: 0.219181
training accuracy: 0.906250     test accuracy: 0.752248
Average cost in epoch 154: 0.230637
training accuracy: 0.937500     test accuracy: 0.768232

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 155: 0.229011
training accuracy: 0.906250     test accuracy: 0.766234
Average cost in epoch 156: 0.218153
training accuracy: 0.781250     test accuracy: 0.763237
Average cost in epoch 157: 0.216082
training accuracy: 0.968750     test accuracy: 0.766234
Average cost in epoch 158: 0.238871
training accuracy: 0.843750     test accuracy: 0.753247
Average cost in epoch 159: 0.218165
training accuracy: 0.906250     test accuracy: 0.755245

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 160: 0.224551
training accuracy: 0.875000     test accuracy: 0.749251
Average cost in epoch 161: 0.218525
training accuracy: 0.937500     test accuracy: 0.753247
Average cost in epoch 162: 0.210641
training accuracy: 0.875000     test accuracy: 0.759241
Average cost in epoch 163: 0.214052
training accuracy: 0.968750     test accuracy: 0.770230
Average cost in epoch 164: 0.222495
training accuracy: 0.968750     test accuracy: 0.760240

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 165: 0.214722
training accuracy: 0.937500     test accuracy: 0.765235
Average cost in epoch 166: 0.219019
training accuracy: 0.968750     test accuracy: 0.769231
Average cost in epoch 167: 0.221726
training accuracy: 0.843750     test accuracy: 0.767233
Average cost in epoch 168: 0.217434
training accuracy: 0.937500     test accuracy: 0.772228
Average cost in epoch 169: 0.222825
training accuracy: 0.968750     test accuracy: 0.750250

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 170: 0.224066
training accuracy: 0.937500     test accuracy: 0.770230
Average cost in epoch 171: 0.229473
training accuracy: 0.843750     test accuracy: 0.757243
Average cost in epoch 172: 0.217658
training accuracy: 0.812500     test accuracy: 0.759241
Average cost in epoch 173: 0.212458
training accuracy: 0.937500     test accuracy: 0.770230
Average cost in epoch 174: 0.213417
training accuracy: 0.906250     test accuracy: 0.760240

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 175: 0.222511
training accuracy: 0.937500     test accuracy: 0.761239
Average cost in epoch 176: 0.209643
training accuracy: 0.875000     test accuracy: 0.775225
Average cost in epoch 177: 0.222277
training accuracy: 0.906250     test accuracy: 0.765235
Average cost in epoch 178: 0.215588
training accuracy: 0.875000     test accuracy: 0.761239
Average cost in epoch 179: 0.212256
training accuracy: 0.937500     test accuracy: 0.755245

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 180: 0.217233
training accuracy: 0.937500     test accuracy: 0.757243
Average cost in epoch 181: 0.204781
training accuracy: 0.906250     test accuracy: 0.754246
Average cost in epoch 182: 0.213420
training accuracy: 1.000000     test accuracy: 0.749251
Average cost in epoch 183: 0.220761
training accuracy: 0.937500     test accuracy: 0.761239
Average cost in epoch 184: 0.218979
training accuracy: 0.968750     test accuracy: 0.760240

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 185: 0.214526
training accuracy: 0.906250     test accuracy: 0.767233
Average cost in epoch 186: 0.224814
training accuracy: 0.937500     test accuracy: 0.763237
Average cost in epoch 187: 0.202305
training accuracy: 0.875000     test accuracy: 0.758242
Average cost in epoch 188: 0.211952
training accuracy: 0.937500     test accuracy: 0.766234
Average cost in epoch 189: 0.212445
training accuracy: 0.906250     test accuracy: 0.771229

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 190: 0.212796
training accuracy: 0.906250     test accuracy: 0.774226
Average cost in epoch 191: 0.217529
training accuracy: 0.906250     test accuracy: 0.761239
Average cost in epoch 192: 0.212184
training accuracy: 0.968750     test accuracy: 0.768232
Average cost in epoch 193: 0.226178
training accuracy: 0.906250     test accuracy: 0.756244
Average cost in epoch 194: 0.216452
training accuracy: 0.906250     test accuracy: 0.768232

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Average cost in epoch 195: 0.215805
training accuracy: 0.906250     test accuracy: 0.759241
Average cost in epoch 196: 0.207178
training accuracy: 0.968750     test accuracy: 0.783217
Average cost in epoch 197: 0.213482
training accuracy: 0.968750     test accuracy: 0.761239
Average cost in epoch 198: 0.209188
training accuracy: 0.968750     test accuracy: 0.754246
Average cost in epoch 199: 0.209422
training accuracy: 0.937500     test accuracy: 0.760240

dump to weights/pyramid-lstm/pyramid-lstm_7.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 8, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_8.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 174.30
Starting training...
Average cost in epoch 0: 1.460861
training accuracy: 0.687500     test accuracy: 0.685315
Average cost in epoch 1: 0.896183
training accuracy: 0.718750     test accuracy: 0.748252
Average cost in epoch 2: 0.761002
training accuracy: 0.687500     test accuracy: 0.752248
Average cost in epoch 3: 0.724680
training accuracy: 0.656250     test accuracy: 0.725275
Average cost in epoch 4: 0.697274
training accuracy: 0.781250     test accuracy: 0.746254

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 5: 0.687615
training accuracy: 0.718750     test accuracy: 0.759241
lr decays to 0.009000
Average cost in epoch 6: 0.665191
training accuracy: 0.812500     test accuracy: 0.755245
Average cost in epoch 7: 0.659815
training accuracy: 0.718750     test accuracy: 0.731269
Average cost in epoch 8: 0.653921
training accuracy: 0.750000     test accuracy: 0.756244
Average cost in epoch 9: 0.646192
training accuracy: 0.843750     test accuracy: 0.745255

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 10: 0.641638
training accuracy: 0.843750     test accuracy: 0.745255
lr decays to 0.008100
Average cost in epoch 11: 0.632390
training accuracy: 0.718750     test accuracy: 0.755245
Average cost in epoch 12: 0.627437
training accuracy: 0.625000     test accuracy: 0.740260
Average cost in epoch 13: 0.612383
training accuracy: 0.781250     test accuracy: 0.736264
Average cost in epoch 14: 0.624975
training accuracy: 0.718750     test accuracy: 0.742258

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 15: 0.610075
training accuracy: 0.906250     test accuracy: 0.733267
lr decays to 0.007290
Average cost in epoch 16: 0.606672
training accuracy: 0.781250     test accuracy: 0.746254
Average cost in epoch 17: 0.603074
training accuracy: 0.750000     test accuracy: 0.740260
Average cost in epoch 18: 0.600836
training accuracy: 0.781250     test accuracy: 0.738262
Average cost in epoch 19: 0.597565
training accuracy: 0.656250     test accuracy: 0.741259

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 20: 0.593840
training accuracy: 0.781250     test accuracy: 0.740260
lr decays to 0.006561
Average cost in epoch 21: 0.579054
training accuracy: 0.812500     test accuracy: 0.740260
Average cost in epoch 22: 0.581153
training accuracy: 0.812500     test accuracy: 0.730270
Average cost in epoch 23: 0.580336
training accuracy: 0.718750     test accuracy: 0.738262
Average cost in epoch 24: 0.566201
training accuracy: 0.812500     test accuracy: 0.744256

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 25: 0.572921
training accuracy: 0.812500     test accuracy: 0.735265
lr decays to 0.005905
Average cost in epoch 26: 0.568886
training accuracy: 0.812500     test accuracy: 0.744256
Average cost in epoch 27: 0.559158
training accuracy: 0.812500     test accuracy: 0.736264
Average cost in epoch 28: 0.553678
training accuracy: 0.812500     test accuracy: 0.739261
Average cost in epoch 29: 0.561874
training accuracy: 0.781250     test accuracy: 0.740260

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 30: 0.561503
training accuracy: 0.718750     test accuracy: 0.729271
lr decays to 0.005314
Average cost in epoch 31: 0.547036
training accuracy: 0.718750     test accuracy: 0.730270
Average cost in epoch 32: 0.546661
training accuracy: 0.718750     test accuracy: 0.733267
Average cost in epoch 33: 0.537708
training accuracy: 0.781250     test accuracy: 0.736264
Average cost in epoch 34: 0.539677
training accuracy: 0.906250     test accuracy: 0.739261

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 35: 0.534629
training accuracy: 0.843750     test accuracy: 0.737263
lr decays to 0.004783
Average cost in epoch 36: 0.527385
training accuracy: 0.812500     test accuracy: 0.729271
Average cost in epoch 37: 0.523425
training accuracy: 0.625000     test accuracy: 0.727273
Average cost in epoch 38: 0.520565
training accuracy: 0.843750     test accuracy: 0.730270
Average cost in epoch 39: 0.512451
training accuracy: 0.656250     test accuracy: 0.722278

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 40: 0.512650
training accuracy: 0.718750     test accuracy: 0.717283
lr decays to 0.004305
Average cost in epoch 41: 0.512518
training accuracy: 0.875000     test accuracy: 0.740260
Average cost in epoch 42: 0.505096
training accuracy: 0.750000     test accuracy: 0.723277
Average cost in epoch 43: 0.505487
training accuracy: 0.750000     test accuracy: 0.727273
Average cost in epoch 44: 0.498130
training accuracy: 0.750000     test accuracy: 0.731269

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 45: 0.504089
training accuracy: 0.750000     test accuracy: 0.723277
lr decays to 0.003874
Average cost in epoch 46: 0.492499
training accuracy: 0.812500     test accuracy: 0.731269
Average cost in epoch 47: 0.489460
training accuracy: 0.750000     test accuracy: 0.717283
Average cost in epoch 48: 0.485348
training accuracy: 0.750000     test accuracy: 0.730270
Average cost in epoch 49: 0.481301
training accuracy: 0.843750     test accuracy: 0.733267

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 50: 0.481882
training accuracy: 0.843750     test accuracy: 0.721279
lr decays to 0.003487
Average cost in epoch 51: 0.479951
training accuracy: 0.750000     test accuracy: 0.730270
Average cost in epoch 52: 0.465189
training accuracy: 0.906250     test accuracy: 0.732268
Average cost in epoch 53: 0.472051
training accuracy: 0.812500     test accuracy: 0.725275
Average cost in epoch 54: 0.473103
training accuracy: 0.843750     test accuracy: 0.725275

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 55: 0.469316
training accuracy: 0.906250     test accuracy: 0.722278
lr decays to 0.003138
Average cost in epoch 56: 0.464758
training accuracy: 0.843750     test accuracy: 0.727273
Average cost in epoch 57: 0.457391
training accuracy: 0.843750     test accuracy: 0.726274
Average cost in epoch 58: 0.452424
training accuracy: 0.750000     test accuracy: 0.723277
Average cost in epoch 59: 0.455452
training accuracy: 0.875000     test accuracy: 0.725275

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 60: 0.453391
training accuracy: 0.781250     test accuracy: 0.723277
lr decays to 0.002824
Average cost in epoch 61: 0.442860
training accuracy: 0.750000     test accuracy: 0.727273
Average cost in epoch 62: 0.440675
training accuracy: 0.718750     test accuracy: 0.722278
Average cost in epoch 63: 0.450574
training accuracy: 0.750000     test accuracy: 0.738262
Average cost in epoch 64: 0.441404
training accuracy: 0.781250     test accuracy: 0.727273

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 65: 0.432956
training accuracy: 0.718750     test accuracy: 0.723277
lr decays to 0.002542
Average cost in epoch 66: 0.427702
training accuracy: 0.875000     test accuracy: 0.721279
Average cost in epoch 67: 0.430791
training accuracy: 0.843750     test accuracy: 0.720280
Average cost in epoch 68: 0.429592
training accuracy: 0.750000     test accuracy: 0.719281
Average cost in epoch 69: 0.415875
training accuracy: 0.843750     test accuracy: 0.723277

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 70: 0.424176
training accuracy: 0.875000     test accuracy: 0.722278
lr decays to 0.002288
Average cost in epoch 71: 0.421644
training accuracy: 0.906250     test accuracy: 0.737263
Average cost in epoch 72: 0.410017
training accuracy: 0.875000     test accuracy: 0.724276
Average cost in epoch 73: 0.416805
training accuracy: 0.843750     test accuracy: 0.730270
Average cost in epoch 74: 0.409021
training accuracy: 0.843750     test accuracy: 0.714286

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 75: 0.417745
training accuracy: 0.812500     test accuracy: 0.718282
lr decays to 0.002059
Average cost in epoch 76: 0.395362
training accuracy: 0.843750     test accuracy: 0.732268
Average cost in epoch 77: 0.397608
training accuracy: 0.750000     test accuracy: 0.722278
Average cost in epoch 78: 0.396376
training accuracy: 0.843750     test accuracy: 0.724276
Average cost in epoch 79: 0.396218
training accuracy: 0.906250     test accuracy: 0.728272

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 80: 0.391663
training accuracy: 0.875000     test accuracy: 0.727273
lr decays to 0.001853
Average cost in epoch 81: 0.387145
training accuracy: 0.781250     test accuracy: 0.725275
Average cost in epoch 82: 0.381879
training accuracy: 0.718750     test accuracy: 0.730270
Average cost in epoch 83: 0.379616
training accuracy: 0.843750     test accuracy: 0.720280
Average cost in epoch 84: 0.387730
training accuracy: 0.906250     test accuracy: 0.728272

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 85: 0.388627
training accuracy: 0.843750     test accuracy: 0.726274
lr decays to 0.001668
Average cost in epoch 86: 0.379891
training accuracy: 0.750000     test accuracy: 0.729271
Average cost in epoch 87: 0.369799
training accuracy: 0.906250     test accuracy: 0.732268
Average cost in epoch 88: 0.379889
training accuracy: 0.843750     test accuracy: 0.726274
Average cost in epoch 89: 0.377368
training accuracy: 0.875000     test accuracy: 0.721279

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 90: 0.365921
training accuracy: 0.843750     test accuracy: 0.726274
lr decays to 0.001501
Average cost in epoch 91: 0.363747
training accuracy: 0.781250     test accuracy: 0.723277
Average cost in epoch 92: 0.369519
training accuracy: 0.906250     test accuracy: 0.725275
Average cost in epoch 93: 0.358380
training accuracy: 0.937500     test accuracy: 0.717283
Average cost in epoch 94: 0.364549
training accuracy: 0.906250     test accuracy: 0.725275

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 95: 0.345096
training accuracy: 0.718750     test accuracy: 0.723277
lr decays to 0.001351
Average cost in epoch 96: 0.354961
training accuracy: 0.812500     test accuracy: 0.731269
Average cost in epoch 97: 0.366548
training accuracy: 0.937500     test accuracy: 0.719281
Average cost in epoch 98: 0.355227
training accuracy: 0.843750     test accuracy: 0.722278
Average cost in epoch 99: 0.357561
training accuracy: 0.812500     test accuracy: 0.733267

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 100: 0.354245
training accuracy: 0.718750     test accuracy: 0.726274
lr decays to 0.001216
Average cost in epoch 101: 0.346868
training accuracy: 0.812500     test accuracy: 0.726274
Average cost in epoch 102: 0.358517
training accuracy: 0.875000     test accuracy: 0.719281
Average cost in epoch 103: 0.353569
training accuracy: 0.968750     test accuracy: 0.726274
Average cost in epoch 104: 0.355844
training accuracy: 0.812500     test accuracy: 0.722278

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 105: 0.342886
training accuracy: 0.781250     test accuracy: 0.717283
Average cost in epoch 106: 0.339759
training accuracy: 0.843750     test accuracy: 0.717283
Average cost in epoch 107: 0.345856
training accuracy: 0.781250     test accuracy: 0.716284
Average cost in epoch 108: 0.345763
training accuracy: 0.968750     test accuracy: 0.727273
Average cost in epoch 109: 0.339070
training accuracy: 0.937500     test accuracy: 0.716284

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 110: 0.340045
training accuracy: 0.781250     test accuracy: 0.721279
Average cost in epoch 111: 0.344631
training accuracy: 0.843750     test accuracy: 0.715285
Average cost in epoch 112: 0.345715
training accuracy: 0.843750     test accuracy: 0.721279
Average cost in epoch 113: 0.335047
training accuracy: 0.906250     test accuracy: 0.718282
Average cost in epoch 114: 0.336318
training accuracy: 0.906250     test accuracy: 0.712288

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 115: 0.339100
training accuracy: 0.843750     test accuracy: 0.725275
Average cost in epoch 116: 0.345290
training accuracy: 0.812500     test accuracy: 0.720280
Average cost in epoch 117: 0.329617
training accuracy: 0.875000     test accuracy: 0.719281
Average cost in epoch 118: 0.335084
training accuracy: 0.906250     test accuracy: 0.719281
Average cost in epoch 119: 0.323781
training accuracy: 0.875000     test accuracy: 0.719281

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 120: 0.341208
training accuracy: 0.937500     test accuracy: 0.716284
Average cost in epoch 121: 0.334764
training accuracy: 0.875000     test accuracy: 0.730270
Average cost in epoch 122: 0.331708
training accuracy: 0.968750     test accuracy: 0.724276
Average cost in epoch 123: 0.324952
training accuracy: 0.875000     test accuracy: 0.723277
Average cost in epoch 124: 0.338613
training accuracy: 1.000000     test accuracy: 0.725275

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 125: 0.332959
training accuracy: 0.906250     test accuracy: 0.725275
Average cost in epoch 126: 0.327951
training accuracy: 0.843750     test accuracy: 0.734266
Average cost in epoch 127: 0.326034
training accuracy: 0.812500     test accuracy: 0.722278
Average cost in epoch 128: 0.332569
training accuracy: 0.843750     test accuracy: 0.733267
Average cost in epoch 129: 0.343502
training accuracy: 0.875000     test accuracy: 0.721279

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 130: 0.311511
training accuracy: 0.968750     test accuracy: 0.722278
Average cost in epoch 131: 0.326303
training accuracy: 0.968750     test accuracy: 0.717283
Average cost in epoch 132: 0.331782
training accuracy: 0.750000     test accuracy: 0.720280
Average cost in epoch 133: 0.333799
training accuracy: 0.781250     test accuracy: 0.723277
Average cost in epoch 134: 0.326831
training accuracy: 0.937500     test accuracy: 0.721279

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 135: 0.328063
training accuracy: 0.875000     test accuracy: 0.725275
Average cost in epoch 136: 0.327094
training accuracy: 0.906250     test accuracy: 0.721279
Average cost in epoch 137: 0.323937
training accuracy: 0.812500     test accuracy: 0.731269
Average cost in epoch 138: 0.320338
training accuracy: 0.906250     test accuracy: 0.729271
Average cost in epoch 139: 0.326245
training accuracy: 0.906250     test accuracy: 0.730270

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 140: 0.326407
training accuracy: 0.937500     test accuracy: 0.725275
Average cost in epoch 141: 0.319575
training accuracy: 0.937500     test accuracy: 0.723277
Average cost in epoch 142: 0.323107
training accuracy: 0.875000     test accuracy: 0.728272
Average cost in epoch 143: 0.310535
training accuracy: 0.875000     test accuracy: 0.724276
Average cost in epoch 144: 0.321806
training accuracy: 0.781250     test accuracy: 0.729271

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 145: 0.328286
training accuracy: 0.843750     test accuracy: 0.724276
Average cost in epoch 146: 0.323877
training accuracy: 0.812500     test accuracy: 0.716284
Average cost in epoch 147: 0.314162
training accuracy: 0.750000     test accuracy: 0.716284
Average cost in epoch 148: 0.320471
training accuracy: 0.843750     test accuracy: 0.710290
Average cost in epoch 149: 0.319622
training accuracy: 0.843750     test accuracy: 0.714286

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 150: 0.321195
training accuracy: 0.875000     test accuracy: 0.714286
Average cost in epoch 151: 0.319332
training accuracy: 0.843750     test accuracy: 0.726274
Average cost in epoch 152: 0.327345
training accuracy: 0.968750     test accuracy: 0.718282
Average cost in epoch 153: 0.314975
training accuracy: 0.937500     test accuracy: 0.714286
Average cost in epoch 154: 0.314624
training accuracy: 0.843750     test accuracy: 0.726274

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 155: 0.316856
training accuracy: 0.906250     test accuracy: 0.716284
Average cost in epoch 156: 0.313961
training accuracy: 0.812500     test accuracy: 0.713287
Average cost in epoch 157: 0.315699
training accuracy: 0.906250     test accuracy: 0.716284
Average cost in epoch 158: 0.315139
training accuracy: 0.937500     test accuracy: 0.721279
Average cost in epoch 159: 0.310849
training accuracy: 0.875000     test accuracy: 0.722278

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 160: 0.307919
training accuracy: 0.875000     test accuracy: 0.716284
Average cost in epoch 161: 0.313718
training accuracy: 0.906250     test accuracy: 0.718282
Average cost in epoch 162: 0.321340
training accuracy: 0.937500     test accuracy: 0.722278
Average cost in epoch 163: 0.312242
training accuracy: 0.906250     test accuracy: 0.723277
Average cost in epoch 164: 0.316665
training accuracy: 0.906250     test accuracy: 0.725275

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 165: 0.311189
training accuracy: 0.906250     test accuracy: 0.713287
Average cost in epoch 166: 0.314182
training accuracy: 0.781250     test accuracy: 0.712288
Average cost in epoch 167: 0.306587
training accuracy: 0.875000     test accuracy: 0.720280
Average cost in epoch 168: 0.308929
training accuracy: 0.843750     test accuracy: 0.712288
Average cost in epoch 169: 0.310963
training accuracy: 0.906250     test accuracy: 0.700300

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 170: 0.301367
training accuracy: 0.875000     test accuracy: 0.716284
Average cost in epoch 171: 0.316775
training accuracy: 0.875000     test accuracy: 0.719281
Average cost in epoch 172: 0.306384
training accuracy: 0.875000     test accuracy: 0.714286
Average cost in epoch 173: 0.308084
training accuracy: 0.812500     test accuracy: 0.729271
Average cost in epoch 174: 0.304007
training accuracy: 0.937500     test accuracy: 0.721279

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 175: 0.308818
training accuracy: 0.875000     test accuracy: 0.721279
Average cost in epoch 176: 0.311672
training accuracy: 0.937500     test accuracy: 0.720280
Average cost in epoch 177: 0.308108
training accuracy: 0.875000     test accuracy: 0.732268
Average cost in epoch 178: 0.307107
training accuracy: 0.906250     test accuracy: 0.720280
Average cost in epoch 179: 0.298847
training accuracy: 0.906250     test accuracy: 0.725275

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 180: 0.308153
training accuracy: 0.906250     test accuracy: 0.725275
Average cost in epoch 181: 0.308714
training accuracy: 0.937500     test accuracy: 0.727273
Average cost in epoch 182: 0.304799
training accuracy: 0.937500     test accuracy: 0.709291
Average cost in epoch 183: 0.299086
training accuracy: 0.875000     test accuracy: 0.724276
Average cost in epoch 184: 0.300899
training accuracy: 0.875000     test accuracy: 0.723277

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 185: 0.298666
training accuracy: 0.875000     test accuracy: 0.726274
Average cost in epoch 186: 0.301332
training accuracy: 0.843750     test accuracy: 0.712288
Average cost in epoch 187: 0.305589
training accuracy: 0.906250     test accuracy: 0.717283
Average cost in epoch 188: 0.304986
training accuracy: 0.875000     test accuracy: 0.718282
Average cost in epoch 189: 0.291006
training accuracy: 0.812500     test accuracy: 0.711289

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 190: 0.303549
training accuracy: 0.718750     test accuracy: 0.721279
Average cost in epoch 191: 0.306478
training accuracy: 0.843750     test accuracy: 0.729271
Average cost in epoch 192: 0.301103
training accuracy: 0.937500     test accuracy: 0.710290
Average cost in epoch 193: 0.306026
training accuracy: 0.906250     test accuracy: 0.724276
Average cost in epoch 194: 0.299967
training accuracy: 0.937500     test accuracy: 0.720280

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Average cost in epoch 195: 0.310044
training accuracy: 0.906250     test accuracy: 0.719281
Average cost in epoch 196: 0.286637
training accuracy: 0.937500     test accuracy: 0.721279
Average cost in epoch 197: 0.300198
training accuracy: 0.906250     test accuracy: 0.725275
Average cost in epoch 198: 0.305567
training accuracy: 0.843750     test accuracy: 0.721279
Average cost in epoch 199: 0.304373
training accuracy: 0.937500     test accuracy: 0.723277

dump to weights/pyramid-lstm/pyramid-lstm_8.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 9, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_9.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 103.35
Starting training...
Average cost in epoch 0: 0.696028
training accuracy: 0.593750     test accuracy: 0.638362
Average cost in epoch 1: 0.638685
training accuracy: 0.781250     test accuracy: 0.638362
Average cost in epoch 2: 0.632520
training accuracy: 0.625000     test accuracy: 0.640360
Average cost in epoch 3: 0.628983
training accuracy: 0.593750     test accuracy: 0.614386
Average cost in epoch 4: 0.631410
training accuracy: 0.625000     test accuracy: 0.636364

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 5: 0.629896
training accuracy: 0.562500     test accuracy: 0.635365
lr decays to 0.009000
Average cost in epoch 6: 0.626825
training accuracy: 0.593750     test accuracy: 0.627373
Average cost in epoch 7: 0.626880
training accuracy: 0.625000     test accuracy: 0.616384
Average cost in epoch 8: 0.630655
training accuracy: 0.500000     test accuracy: 0.631369
Average cost in epoch 9: 0.626041
training accuracy: 0.687500     test accuracy: 0.603397

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 10: 0.624473
training accuracy: 0.625000     test accuracy: 0.641359
lr decays to 0.008100
Average cost in epoch 11: 0.623851
training accuracy: 0.656250     test accuracy: 0.629371
Average cost in epoch 12: 0.621039
training accuracy: 0.406250     test accuracy: 0.649351
Average cost in epoch 13: 0.622832
training accuracy: 0.687500     test accuracy: 0.647353
Average cost in epoch 14: 0.621105
training accuracy: 0.625000     test accuracy: 0.623377

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 15: 0.618865
training accuracy: 0.656250     test accuracy: 0.639361
lr decays to 0.007290
Average cost in epoch 16: 0.619705
training accuracy: 0.750000     test accuracy: 0.619381
Average cost in epoch 17: 0.615368
training accuracy: 0.656250     test accuracy: 0.615385
Average cost in epoch 18: 0.615437
training accuracy: 0.687500     test accuracy: 0.629371
Average cost in epoch 19: 0.616118
training accuracy: 0.718750     test accuracy: 0.617383

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 20: 0.613274
training accuracy: 0.625000     test accuracy: 0.628372
lr decays to 0.006561
Average cost in epoch 21: 0.612415
training accuracy: 0.718750     test accuracy: 0.639361
Average cost in epoch 22: 0.607114
training accuracy: 0.500000     test accuracy: 0.628372
Average cost in epoch 23: 0.608736
training accuracy: 0.687500     test accuracy: 0.610390
Average cost in epoch 24: 0.606495
training accuracy: 0.656250     test accuracy: 0.625375

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 25: 0.605834
training accuracy: 0.750000     test accuracy: 0.624376
lr decays to 0.005905
Average cost in epoch 26: 0.602282
training accuracy: 0.625000     test accuracy: 0.623377
Average cost in epoch 27: 0.603586
training accuracy: 0.812500     test accuracy: 0.622378
Average cost in epoch 28: 0.599159
training accuracy: 0.562500     test accuracy: 0.627373
Average cost in epoch 29: 0.600561
training accuracy: 0.625000     test accuracy: 0.625375

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 30: 0.597573
training accuracy: 0.656250     test accuracy: 0.616384
lr decays to 0.005314
Average cost in epoch 31: 0.593206
training accuracy: 0.625000     test accuracy: 0.631369
Average cost in epoch 32: 0.594463
training accuracy: 0.593750     test accuracy: 0.618382
Average cost in epoch 33: 0.586606
training accuracy: 0.593750     test accuracy: 0.620380
Average cost in epoch 34: 0.590581
training accuracy: 0.750000     test accuracy: 0.639361

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 35: 0.588223
training accuracy: 0.593750     test accuracy: 0.621379
lr decays to 0.004783
Average cost in epoch 36: 0.584658
training accuracy: 0.656250     test accuracy: 0.623377
Average cost in epoch 37: 0.582222
training accuracy: 0.687500     test accuracy: 0.616384
Average cost in epoch 38: 0.580902
training accuracy: 0.687500     test accuracy: 0.627373
Average cost in epoch 39: 0.581357
training accuracy: 0.812500     test accuracy: 0.624376

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 40: 0.577921
training accuracy: 0.531250     test accuracy: 0.625375
lr decays to 0.004305
Average cost in epoch 41: 0.572493
training accuracy: 0.593750     test accuracy: 0.632368
Average cost in epoch 42: 0.574871
training accuracy: 0.656250     test accuracy: 0.627373
Average cost in epoch 43: 0.569893
training accuracy: 0.687500     test accuracy: 0.624376
Average cost in epoch 44: 0.572460
training accuracy: 0.625000     test accuracy: 0.633367

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 45: 0.566240
training accuracy: 0.781250     test accuracy: 0.611389
lr decays to 0.003874
Average cost in epoch 46: 0.562566
training accuracy: 0.781250     test accuracy: 0.630370
Average cost in epoch 47: 0.562957
training accuracy: 0.531250     test accuracy: 0.629371
Average cost in epoch 48: 0.559876
training accuracy: 0.593750     test accuracy: 0.622378
Average cost in epoch 49: 0.561148
training accuracy: 0.593750     test accuracy: 0.616384

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 50: 0.555298
training accuracy: 0.812500     test accuracy: 0.618382
lr decays to 0.003487
Average cost in epoch 51: 0.558290
training accuracy: 0.750000     test accuracy: 0.624376
Average cost in epoch 52: 0.550325
training accuracy: 0.906250     test accuracy: 0.622378
Average cost in epoch 53: 0.550055
training accuracy: 0.718750     test accuracy: 0.607393
Average cost in epoch 54: 0.547673
training accuracy: 0.687500     test accuracy: 0.600400

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 55: 0.551062
training accuracy: 0.562500     test accuracy: 0.613387
lr decays to 0.003138
Average cost in epoch 56: 0.545768
training accuracy: 0.687500     test accuracy: 0.615385
Average cost in epoch 57: 0.548143
training accuracy: 0.593750     test accuracy: 0.608392
Average cost in epoch 58: 0.541258
training accuracy: 0.843750     test accuracy: 0.602398
Average cost in epoch 59: 0.536986
training accuracy: 0.656250     test accuracy: 0.612388

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 60: 0.537399
training accuracy: 0.781250     test accuracy: 0.597403
lr decays to 0.002824
Average cost in epoch 61: 0.535736
training accuracy: 0.781250     test accuracy: 0.614386
Average cost in epoch 62: 0.537528
training accuracy: 0.812500     test accuracy: 0.602398
Average cost in epoch 63: 0.534760
training accuracy: 0.906250     test accuracy: 0.604396
Average cost in epoch 64: 0.530227
training accuracy: 0.750000     test accuracy: 0.604396

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 65: 0.529602
training accuracy: 0.750000     test accuracy: 0.604396
lr decays to 0.002542
Average cost in epoch 66: 0.524327
training accuracy: 0.718750     test accuracy: 0.619381
Average cost in epoch 67: 0.522427
training accuracy: 0.843750     test accuracy: 0.613387
Average cost in epoch 68: 0.521814
training accuracy: 0.781250     test accuracy: 0.604396
Average cost in epoch 69: 0.525174
training accuracy: 0.687500     test accuracy: 0.598402

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 70: 0.521483
training accuracy: 0.812500     test accuracy: 0.604396
lr decays to 0.002288
Average cost in epoch 71: 0.514242
training accuracy: 0.687500     test accuracy: 0.605395
Average cost in epoch 72: 0.518711
training accuracy: 0.812500     test accuracy: 0.609391
Average cost in epoch 73: 0.513290
training accuracy: 0.812500     test accuracy: 0.607393
Average cost in epoch 74: 0.510227
training accuracy: 0.750000     test accuracy: 0.598402

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 75: 0.509295
training accuracy: 0.562500     test accuracy: 0.608392
lr decays to 0.002059
Average cost in epoch 76: 0.506992
training accuracy: 0.718750     test accuracy: 0.599401
Average cost in epoch 77: 0.508146
training accuracy: 0.812500     test accuracy: 0.600400
Average cost in epoch 78: 0.507983
training accuracy: 0.781250     test accuracy: 0.606394
Average cost in epoch 79: 0.509525
training accuracy: 0.718750     test accuracy: 0.607393

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 80: 0.509393
training accuracy: 0.687500     test accuracy: 0.602398
lr decays to 0.001853
Average cost in epoch 81: 0.499720
training accuracy: 0.718750     test accuracy: 0.609391
Average cost in epoch 82: 0.506575
training accuracy: 0.812500     test accuracy: 0.604396
Average cost in epoch 83: 0.497817
training accuracy: 0.781250     test accuracy: 0.600400
Average cost in epoch 84: 0.497048
training accuracy: 0.843750     test accuracy: 0.597403

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 85: 0.498616
training accuracy: 0.718750     test accuracy: 0.593407
lr decays to 0.001668
Average cost in epoch 86: 0.498668
training accuracy: 0.718750     test accuracy: 0.594406
Average cost in epoch 87: 0.487688
training accuracy: 0.718750     test accuracy: 0.599401
Average cost in epoch 88: 0.489145
training accuracy: 0.687500     test accuracy: 0.587413
Average cost in epoch 89: 0.491619
training accuracy: 0.687500     test accuracy: 0.606394

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 90: 0.487473
training accuracy: 0.656250     test accuracy: 0.596404
lr decays to 0.001501
Average cost in epoch 91: 0.484460
training accuracy: 0.812500     test accuracy: 0.586414
Average cost in epoch 92: 0.483608
training accuracy: 0.812500     test accuracy: 0.585415
Average cost in epoch 93: 0.482583
training accuracy: 0.625000     test accuracy: 0.612388
Average cost in epoch 94: 0.480395
training accuracy: 0.906250     test accuracy: 0.603397

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 95: 0.481509
training accuracy: 0.718750     test accuracy: 0.587413
lr decays to 0.001351
Average cost in epoch 96: 0.484543
training accuracy: 0.781250     test accuracy: 0.587413
Average cost in epoch 97: 0.479626
training accuracy: 0.718750     test accuracy: 0.592408
Average cost in epoch 98: 0.476572
training accuracy: 0.781250     test accuracy: 0.591409
Average cost in epoch 99: 0.474728
training accuracy: 0.718750     test accuracy: 0.600400

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 100: 0.478362
training accuracy: 0.750000     test accuracy: 0.593407
lr decays to 0.001216
Average cost in epoch 101: 0.475124
training accuracy: 0.656250     test accuracy: 0.595405
Average cost in epoch 102: 0.469155
training accuracy: 0.687500     test accuracy: 0.587413
Average cost in epoch 103: 0.471579
training accuracy: 0.718750     test accuracy: 0.598402
Average cost in epoch 104: 0.465204
training accuracy: 0.812500     test accuracy: 0.598402

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 105: 0.471334
training accuracy: 0.781250     test accuracy: 0.583417
Average cost in epoch 106: 0.470607
training accuracy: 0.906250     test accuracy: 0.588412
Average cost in epoch 107: 0.471095
training accuracy: 0.781250     test accuracy: 0.588412
Average cost in epoch 108: 0.466140
training accuracy: 0.718750     test accuracy: 0.582418
Average cost in epoch 109: 0.465843
training accuracy: 0.718750     test accuracy: 0.591409

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 110: 0.462907
training accuracy: 0.718750     test accuracy: 0.592408
Average cost in epoch 111: 0.465658
training accuracy: 0.718750     test accuracy: 0.602398
Average cost in epoch 112: 0.462940
training accuracy: 0.687500     test accuracy: 0.579421
Average cost in epoch 113: 0.461798
training accuracy: 0.781250     test accuracy: 0.580420
Average cost in epoch 114: 0.460611
training accuracy: 0.781250     test accuracy: 0.593407

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 115: 0.461610
training accuracy: 0.531250     test accuracy: 0.590410
Average cost in epoch 116: 0.464030
training accuracy: 0.812500     test accuracy: 0.592408
Average cost in epoch 117: 0.453307
training accuracy: 0.843750     test accuracy: 0.593407
Average cost in epoch 118: 0.454829
training accuracy: 0.781250     test accuracy: 0.587413
Average cost in epoch 119: 0.455043
training accuracy: 0.750000     test accuracy: 0.576424

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 120: 0.462987
training accuracy: 0.812500     test accuracy: 0.607393
Average cost in epoch 121: 0.455394
training accuracy: 0.625000     test accuracy: 0.598402
Average cost in epoch 122: 0.451944
training accuracy: 0.718750     test accuracy: 0.596404
Average cost in epoch 123: 0.464692
training accuracy: 0.781250     test accuracy: 0.593407
Average cost in epoch 124: 0.453340
training accuracy: 0.781250     test accuracy: 0.599401

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 125: 0.461959
training accuracy: 0.625000     test accuracy: 0.607393
Average cost in epoch 126: 0.449655
training accuracy: 0.875000     test accuracy: 0.607393
Average cost in epoch 127: 0.452851
training accuracy: 0.687500     test accuracy: 0.611389
Average cost in epoch 128: 0.447564
training accuracy: 0.656250     test accuracy: 0.599401
Average cost in epoch 129: 0.452462
training accuracy: 0.812500     test accuracy: 0.607393

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 130: 0.444689
training accuracy: 0.750000     test accuracy: 0.599401
Average cost in epoch 131: 0.453639
training accuracy: 0.718750     test accuracy: 0.598402
Average cost in epoch 132: 0.451060
training accuracy: 0.750000     test accuracy: 0.600400
Average cost in epoch 133: 0.447912
training accuracy: 0.687500     test accuracy: 0.595405
Average cost in epoch 134: 0.459404
training accuracy: 0.687500     test accuracy: 0.594406

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 135: 0.445678
training accuracy: 0.656250     test accuracy: 0.593407
Average cost in epoch 136: 0.454223
training accuracy: 0.750000     test accuracy: 0.587413
Average cost in epoch 137: 0.445994
training accuracy: 0.718750     test accuracy: 0.605395
Average cost in epoch 138: 0.454386
training accuracy: 0.812500     test accuracy: 0.586414
Average cost in epoch 139: 0.446202
training accuracy: 0.812500     test accuracy: 0.602398

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 140: 0.450691
training accuracy: 0.875000     test accuracy: 0.604396
Average cost in epoch 141: 0.448943
training accuracy: 0.687500     test accuracy: 0.613387
Average cost in epoch 142: 0.457366
training accuracy: 0.687500     test accuracy: 0.598402
Average cost in epoch 143: 0.441580
training accuracy: 0.750000     test accuracy: 0.611389
Average cost in epoch 144: 0.449426
training accuracy: 0.687500     test accuracy: 0.599401

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 145: 0.447257
training accuracy: 0.750000     test accuracy: 0.601399
Average cost in epoch 146: 0.440468
training accuracy: 0.656250     test accuracy: 0.606394
Average cost in epoch 147: 0.442459
training accuracy: 0.656250     test accuracy: 0.594406
Average cost in epoch 148: 0.440320
training accuracy: 0.781250     test accuracy: 0.598402
Average cost in epoch 149: 0.435293
training accuracy: 0.656250     test accuracy: 0.602398

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 150: 0.446868
training accuracy: 0.750000     test accuracy: 0.593407
Average cost in epoch 151: 0.443434
training accuracy: 0.843750     test accuracy: 0.605395
Average cost in epoch 152: 0.439043
training accuracy: 0.750000     test accuracy: 0.590410
Average cost in epoch 153: 0.440351
training accuracy: 0.812500     test accuracy: 0.596404
Average cost in epoch 154: 0.444008
training accuracy: 0.843750     test accuracy: 0.597403

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 155: 0.437379
training accuracy: 0.875000     test accuracy: 0.604396
Average cost in epoch 156: 0.444948
training accuracy: 0.812500     test accuracy: 0.605395
Average cost in epoch 157: 0.443584
training accuracy: 0.625000     test accuracy: 0.603397
Average cost in epoch 158: 0.437598
training accuracy: 0.812500     test accuracy: 0.612388
Average cost in epoch 159: 0.434817
training accuracy: 0.750000     test accuracy: 0.601399

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 160: 0.438236
training accuracy: 0.875000     test accuracy: 0.598402
Average cost in epoch 161: 0.437121
training accuracy: 0.843750     test accuracy: 0.601399
Average cost in epoch 162: 0.430863
training accuracy: 0.687500     test accuracy: 0.604396
Average cost in epoch 163: 0.441452
training accuracy: 0.718750     test accuracy: 0.607393
Average cost in epoch 164: 0.427845
training accuracy: 0.875000     test accuracy: 0.607393

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 165: 0.438993
training accuracy: 0.718750     test accuracy: 0.596404
Average cost in epoch 166: 0.427970
training accuracy: 0.875000     test accuracy: 0.595405
Average cost in epoch 167: 0.433806
training accuracy: 0.687500     test accuracy: 0.609391
Average cost in epoch 168: 0.429211
training accuracy: 0.812500     test accuracy: 0.598402
Average cost in epoch 169: 0.432087
training accuracy: 0.843750     test accuracy: 0.598402

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 170: 0.428589
training accuracy: 0.687500     test accuracy: 0.587413
Average cost in epoch 171: 0.431054
training accuracy: 0.687500     test accuracy: 0.588412
Average cost in epoch 172: 0.434758
training accuracy: 0.750000     test accuracy: 0.590410
Average cost in epoch 173: 0.427593
training accuracy: 0.750000     test accuracy: 0.610390
Average cost in epoch 174: 0.432718
training accuracy: 0.781250     test accuracy: 0.592408

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 175: 0.424308
training accuracy: 0.906250     test accuracy: 0.602398
Average cost in epoch 176: 0.430060
training accuracy: 0.812500     test accuracy: 0.590410
Average cost in epoch 177: 0.432863
training accuracy: 0.812500     test accuracy: 0.596404
Average cost in epoch 178: 0.432618
training accuracy: 0.656250     test accuracy: 0.596404
Average cost in epoch 179: 0.430216
training accuracy: 0.625000     test accuracy: 0.598402

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 180: 0.432937
training accuracy: 0.750000     test accuracy: 0.597403
Average cost in epoch 181: 0.427601
training accuracy: 0.718750     test accuracy: 0.607393
Average cost in epoch 182: 0.420543
training accuracy: 0.812500     test accuracy: 0.611389
Average cost in epoch 183: 0.435690
training accuracy: 0.875000     test accuracy: 0.601399
Average cost in epoch 184: 0.423044
training accuracy: 0.750000     test accuracy: 0.591409

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 185: 0.427296
training accuracy: 0.781250     test accuracy: 0.594406
Average cost in epoch 186: 0.433932
training accuracy: 0.843750     test accuracy: 0.603397
Average cost in epoch 187: 0.435151
training accuracy: 0.750000     test accuracy: 0.599401
Average cost in epoch 188: 0.433569
training accuracy: 0.781250     test accuracy: 0.598402
Average cost in epoch 189: 0.425203
training accuracy: 0.781250     test accuracy: 0.601399

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 190: 0.418791
training accuracy: 0.812500     test accuracy: 0.607393
Average cost in epoch 191: 0.428116
training accuracy: 0.656250     test accuracy: 0.605395
Average cost in epoch 192: 0.427904
training accuracy: 0.750000     test accuracy: 0.599401
Average cost in epoch 193: 0.417268
training accuracy: 0.625000     test accuracy: 0.597403
Average cost in epoch 194: 0.418824
training accuracy: 0.718750     test accuracy: 0.613387

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Average cost in epoch 195: 0.420320
training accuracy: 0.687500     test accuracy: 0.601399
Average cost in epoch 196: 0.423374
training accuracy: 0.687500     test accuracy: 0.600400
Average cost in epoch 197: 0.428419
training accuracy: 0.875000     test accuracy: 0.599401
Average cost in epoch 198: 0.423041
training accuracy: 0.750000     test accuracy: 0.593407
Average cost in epoch 199: 0.418814
training accuracy: 0.843750     test accuracy: 0.586414

dump to weights/pyramid-lstm/pyramid-lstm_9.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 10, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_10.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 80.62
Starting training...
Average cost in epoch 0: 1.017317
training accuracy: 0.437500     test accuracy: 0.487512
Average cost in epoch 1: 0.922520
training accuracy: 0.625000     test accuracy: 0.427572
Average cost in epoch 2: 0.918730
training accuracy: 0.531250     test accuracy: 0.435564
Average cost in epoch 3: 0.910658
training accuracy: 0.437500     test accuracy: 0.426573
Average cost in epoch 4: 0.907743
training accuracy: 0.500000     test accuracy: 0.438561

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 5: 0.907814
training accuracy: 0.437500     test accuracy: 0.434565
lr decays to 0.009000
Average cost in epoch 6: 0.902473
training accuracy: 0.500000     test accuracy: 0.491508
Average cost in epoch 7: 0.901851
training accuracy: 0.468750     test accuracy: 0.470529
Average cost in epoch 8: 0.901317
training accuracy: 0.531250     test accuracy: 0.479520
Average cost in epoch 9: 0.900533
training accuracy: 0.375000     test accuracy: 0.423576

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 10: 0.899753
training accuracy: 0.437500     test accuracy: 0.460539
lr decays to 0.008100
Average cost in epoch 11: 0.900335
training accuracy: 0.406250     test accuracy: 0.428571
Average cost in epoch 12: 0.897359
training accuracy: 0.531250     test accuracy: 0.470529
Average cost in epoch 13: 0.895651
training accuracy: 0.593750     test accuracy: 0.461538
Average cost in epoch 14: 0.891677
training accuracy: 0.468750     test accuracy: 0.432567

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 15: 0.892205
training accuracy: 0.562500     test accuracy: 0.480519
lr decays to 0.007290
Average cost in epoch 16: 0.890888
training accuracy: 0.500000     test accuracy: 0.472527
Average cost in epoch 17: 0.887561
training accuracy: 0.437500     test accuracy: 0.420579
Average cost in epoch 18: 0.887830
training accuracy: 0.531250     test accuracy: 0.466533
Average cost in epoch 19: 0.886624
training accuracy: 0.531250     test accuracy: 0.475524

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 20: 0.886676
training accuracy: 0.437500     test accuracy: 0.460539
lr decays to 0.006561
Average cost in epoch 21: 0.882147
training accuracy: 0.500000     test accuracy: 0.473526
Average cost in epoch 22: 0.879580
training accuracy: 0.593750     test accuracy: 0.474525
Average cost in epoch 23: 0.878605
training accuracy: 0.468750     test accuracy: 0.480519
Average cost in epoch 24: 0.879692
training accuracy: 0.625000     test accuracy: 0.466533

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 25: 0.873063
training accuracy: 0.625000     test accuracy: 0.474525
lr decays to 0.005905
Average cost in epoch 26: 0.870884
training accuracy: 0.468750     test accuracy: 0.447552
Average cost in epoch 27: 0.868084
training accuracy: 0.562500     test accuracy: 0.459540
Average cost in epoch 28: 0.866327
training accuracy: 0.531250     test accuracy: 0.452547
Average cost in epoch 29: 0.863790
training accuracy: 0.531250     test accuracy: 0.464535

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 30: 0.861940
training accuracy: 0.500000     test accuracy: 0.462537
lr decays to 0.005314
Average cost in epoch 31: 0.863535
training accuracy: 0.593750     test accuracy: 0.473526
Average cost in epoch 32: 0.858891
training accuracy: 0.500000     test accuracy: 0.482517
Average cost in epoch 33: 0.857988
training accuracy: 0.531250     test accuracy: 0.466533
Average cost in epoch 34: 0.853488
training accuracy: 0.500000     test accuracy: 0.430569

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 35: 0.848641
training accuracy: 0.531250     test accuracy: 0.483516
lr decays to 0.004783
Average cost in epoch 36: 0.847701
training accuracy: 0.406250     test accuracy: 0.453546
Average cost in epoch 37: 0.846410
training accuracy: 0.625000     test accuracy: 0.448551
Average cost in epoch 38: 0.842302
training accuracy: 0.468750     test accuracy: 0.468531
Average cost in epoch 39: 0.840508
training accuracy: 0.593750     test accuracy: 0.439560

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 40: 0.841122
training accuracy: 0.500000     test accuracy: 0.471528
lr decays to 0.004305
Average cost in epoch 41: 0.835605
training accuracy: 0.625000     test accuracy: 0.461538
Average cost in epoch 42: 0.832151
training accuracy: 0.437500     test accuracy: 0.473526
Average cost in epoch 43: 0.832137
training accuracy: 0.593750     test accuracy: 0.471528
Average cost in epoch 44: 0.829607
training accuracy: 0.562500     test accuracy: 0.443556

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 45: 0.827712
training accuracy: 0.468750     test accuracy: 0.452547
lr decays to 0.003874
Average cost in epoch 46: 0.823035
training accuracy: 0.656250     test accuracy: 0.437562
Average cost in epoch 47: 0.822701
training accuracy: 0.718750     test accuracy: 0.444555
Average cost in epoch 48: 0.821904
training accuracy: 0.656250     test accuracy: 0.465534
Average cost in epoch 49: 0.815622
training accuracy: 0.687500     test accuracy: 0.487512

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 50: 0.817103
training accuracy: 0.437500     test accuracy: 0.474525
lr decays to 0.003487
Average cost in epoch 51: 0.813542
training accuracy: 0.687500     test accuracy: 0.466533
Average cost in epoch 52: 0.810257
training accuracy: 0.593750     test accuracy: 0.463536
Average cost in epoch 53: 0.810331
training accuracy: 0.625000     test accuracy: 0.459540
Average cost in epoch 54: 0.801551
training accuracy: 0.437500     test accuracy: 0.454545

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 55: 0.814059
training accuracy: 0.468750     test accuracy: 0.439560
lr decays to 0.003138
Average cost in epoch 56: 0.797917
training accuracy: 0.375000     test accuracy: 0.456543
Average cost in epoch 57: 0.788322
training accuracy: 0.593750     test accuracy: 0.458541
Average cost in epoch 58: 0.799638
training accuracy: 0.593750     test accuracy: 0.427572
Average cost in epoch 59: 0.796978
training accuracy: 0.562500     test accuracy: 0.461538

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 60: 0.794238
training accuracy: 0.531250     test accuracy: 0.457542
lr decays to 0.002824
Average cost in epoch 61: 0.787245
training accuracy: 0.656250     test accuracy: 0.437562
Average cost in epoch 62: 0.778533
training accuracy: 0.531250     test accuracy: 0.444555
Average cost in epoch 63: 0.778265
training accuracy: 0.593750     test accuracy: 0.448551
Average cost in epoch 64: 0.778319
training accuracy: 0.593750     test accuracy: 0.464535

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 65: 0.777870
training accuracy: 0.687500     test accuracy: 0.449550
lr decays to 0.002542
Average cost in epoch 66: 0.779288
training accuracy: 0.687500     test accuracy: 0.442557
Average cost in epoch 67: 0.771944
training accuracy: 0.562500     test accuracy: 0.446553
Average cost in epoch 68: 0.767505
training accuracy: 0.625000     test accuracy: 0.442557
Average cost in epoch 69: 0.771100
training accuracy: 0.750000     test accuracy: 0.451548

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 70: 0.767402
training accuracy: 0.593750     test accuracy: 0.449550
lr decays to 0.002288
Average cost in epoch 71: 0.761837
training accuracy: 0.750000     test accuracy: 0.450549
Average cost in epoch 72: 0.759354
training accuracy: 0.437500     test accuracy: 0.448551
Average cost in epoch 73: 0.756083
training accuracy: 0.437500     test accuracy: 0.443556
Average cost in epoch 74: 0.762305
training accuracy: 0.750000     test accuracy: 0.445554

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 75: 0.757937
training accuracy: 0.687500     test accuracy: 0.445554
lr decays to 0.002059
Average cost in epoch 76: 0.748117
training accuracy: 0.531250     test accuracy: 0.450549
Average cost in epoch 77: 0.756132
training accuracy: 0.531250     test accuracy: 0.436563
Average cost in epoch 78: 0.747630
training accuracy: 0.500000     test accuracy: 0.443556
Average cost in epoch 79: 0.752967
training accuracy: 0.843750     test accuracy: 0.445554

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 80: 0.752154
training accuracy: 0.406250     test accuracy: 0.452547
lr decays to 0.001853
Average cost in epoch 81: 0.745102
training accuracy: 0.593750     test accuracy: 0.450549
Average cost in epoch 82: 0.733572
training accuracy: 0.593750     test accuracy: 0.452547
Average cost in epoch 83: 0.740989
training accuracy: 0.593750     test accuracy: 0.447552
Average cost in epoch 84: 0.739652
training accuracy: 0.656250     test accuracy: 0.452547

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 85: 0.737245
training accuracy: 0.687500     test accuracy: 0.462537
lr decays to 0.001668
Average cost in epoch 86: 0.734030
training accuracy: 0.562500     test accuracy: 0.453546
Average cost in epoch 87: 0.728398
training accuracy: 0.625000     test accuracy: 0.453546
Average cost in epoch 88: 0.722747
training accuracy: 0.531250     test accuracy: 0.461538
Average cost in epoch 89: 0.728112
training accuracy: 0.656250     test accuracy: 0.448551

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 90: 0.729712
training accuracy: 0.718750     test accuracy: 0.451548
lr decays to 0.001501
Average cost in epoch 91: 0.726394
training accuracy: 0.687500     test accuracy: 0.458541
Average cost in epoch 92: 0.722576
training accuracy: 0.531250     test accuracy: 0.465534
Average cost in epoch 93: 0.722343
training accuracy: 0.656250     test accuracy: 0.459540
Average cost in epoch 94: 0.718068
training accuracy: 0.687500     test accuracy: 0.459540

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 95: 0.713424
training accuracy: 0.687500     test accuracy: 0.452547
lr decays to 0.001351
Average cost in epoch 96: 0.716427
training accuracy: 0.687500     test accuracy: 0.462537
Average cost in epoch 97: 0.709868
training accuracy: 0.562500     test accuracy: 0.458541
Average cost in epoch 98: 0.718491
training accuracy: 0.718750     test accuracy: 0.461538
Average cost in epoch 99: 0.707373
training accuracy: 0.687500     test accuracy: 0.459540

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 100: 0.702196
training accuracy: 0.531250     test accuracy: 0.463536
lr decays to 0.001216
Average cost in epoch 101: 0.704364
training accuracy: 0.562500     test accuracy: 0.456543
Average cost in epoch 102: 0.702633
training accuracy: 0.531250     test accuracy: 0.464535
Average cost in epoch 103: 0.702349
training accuracy: 0.656250     test accuracy: 0.450549
Average cost in epoch 104: 0.695999
training accuracy: 0.500000     test accuracy: 0.460539

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 105: 0.698333
training accuracy: 0.593750     test accuracy: 0.463536
Average cost in epoch 106: 0.699302
training accuracy: 0.718750     test accuracy: 0.466533
Average cost in epoch 107: 0.694401
training accuracy: 0.500000     test accuracy: 0.456543
Average cost in epoch 108: 0.698867
training accuracy: 0.593750     test accuracy: 0.454545
Average cost in epoch 109: 0.690249
training accuracy: 0.656250     test accuracy: 0.447552

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 110: 0.698712
training accuracy: 0.593750     test accuracy: 0.452547
Average cost in epoch 111: 0.694329
training accuracy: 0.625000     test accuracy: 0.456543
Average cost in epoch 112: 0.700757
training accuracy: 0.531250     test accuracy: 0.453546
Average cost in epoch 113: 0.687672
training accuracy: 0.656250     test accuracy: 0.457542
Average cost in epoch 114: 0.695876
training accuracy: 0.625000     test accuracy: 0.467532

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 115: 0.693100
training accuracy: 0.656250     test accuracy: 0.457542
Average cost in epoch 116: 0.690978
training accuracy: 0.687500     test accuracy: 0.454545
Average cost in epoch 117: 0.691375
training accuracy: 0.562500     test accuracy: 0.446553
Average cost in epoch 118: 0.683590
training accuracy: 0.718750     test accuracy: 0.450549
Average cost in epoch 119: 0.691212
training accuracy: 0.812500     test accuracy: 0.448551

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 120: 0.688067
training accuracy: 0.781250     test accuracy: 0.448551
Average cost in epoch 121: 0.689355
training accuracy: 0.656250     test accuracy: 0.464535
Average cost in epoch 122: 0.683701
training accuracy: 0.625000     test accuracy: 0.442557
Average cost in epoch 123: 0.681880
training accuracy: 0.687500     test accuracy: 0.451548
Average cost in epoch 124: 0.687666
training accuracy: 0.562500     test accuracy: 0.446553

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 125: 0.681029
training accuracy: 0.500000     test accuracy: 0.452547
Average cost in epoch 126: 0.681953
training accuracy: 0.625000     test accuracy: 0.468531
Average cost in epoch 127: 0.672497
training accuracy: 0.593750     test accuracy: 0.456543
Average cost in epoch 128: 0.687503
training accuracy: 0.625000     test accuracy: 0.447552
Average cost in epoch 129: 0.680301
training accuracy: 0.562500     test accuracy: 0.439560

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 130: 0.676539
training accuracy: 0.593750     test accuracy: 0.471528
Average cost in epoch 131: 0.678838
training accuracy: 0.593750     test accuracy: 0.460539
Average cost in epoch 132: 0.679599
training accuracy: 0.531250     test accuracy: 0.452547
Average cost in epoch 133: 0.679408
training accuracy: 0.562500     test accuracy: 0.467532
Average cost in epoch 134: 0.676723
training accuracy: 0.812500     test accuracy: 0.469530

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 135: 0.674133
training accuracy: 0.687500     test accuracy: 0.455544
Average cost in epoch 136: 0.679261
training accuracy: 0.593750     test accuracy: 0.462537
Average cost in epoch 137: 0.674060
training accuracy: 0.593750     test accuracy: 0.450549
Average cost in epoch 138: 0.671898
training accuracy: 0.625000     test accuracy: 0.444555
Average cost in epoch 139: 0.670785
training accuracy: 0.562500     test accuracy: 0.457542

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 140: 0.672239
training accuracy: 0.531250     test accuracy: 0.450549
Average cost in epoch 141: 0.675120
training accuracy: 0.687500     test accuracy: 0.464535
Average cost in epoch 142: 0.666763
training accuracy: 0.750000     test accuracy: 0.456543
Average cost in epoch 143: 0.672490
training accuracy: 0.593750     test accuracy: 0.447552
Average cost in epoch 144: 0.672812
training accuracy: 0.468750     test accuracy: 0.446553

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 145: 0.671238
training accuracy: 0.718750     test accuracy: 0.448551
Average cost in epoch 146: 0.668726
training accuracy: 0.625000     test accuracy: 0.461538
Average cost in epoch 147: 0.676511
training accuracy: 0.718750     test accuracy: 0.458541
Average cost in epoch 148: 0.665725
training accuracy: 0.656250     test accuracy: 0.456543
Average cost in epoch 149: 0.661404
training accuracy: 0.468750     test accuracy: 0.443556

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 150: 0.667954
training accuracy: 0.656250     test accuracy: 0.453546
Average cost in epoch 151: 0.660663
training accuracy: 0.687500     test accuracy: 0.454545
Average cost in epoch 152: 0.663138
training accuracy: 0.750000     test accuracy: 0.456543
Average cost in epoch 153: 0.667472
training accuracy: 0.625000     test accuracy: 0.479520
Average cost in epoch 154: 0.662772
training accuracy: 0.625000     test accuracy: 0.457542

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 155: 0.671246
training accuracy: 0.625000     test accuracy: 0.447552
Average cost in epoch 156: 0.661197
training accuracy: 0.906250     test accuracy: 0.452547
Average cost in epoch 157: 0.665192
training accuracy: 0.656250     test accuracy: 0.459540
Average cost in epoch 158: 0.651993
training accuracy: 0.687500     test accuracy: 0.458541
Average cost in epoch 159: 0.661868
training accuracy: 0.687500     test accuracy: 0.462537

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 160: 0.660801
training accuracy: 0.812500     test accuracy: 0.451548
Average cost in epoch 161: 0.665014
training accuracy: 0.750000     test accuracy: 0.445554
Average cost in epoch 162: 0.658458
training accuracy: 0.500000     test accuracy: 0.446553
Average cost in epoch 163: 0.660937
training accuracy: 0.593750     test accuracy: 0.451548
Average cost in epoch 164: 0.668189
training accuracy: 0.656250     test accuracy: 0.456543

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 165: 0.658218
training accuracy: 0.750000     test accuracy: 0.453546
Average cost in epoch 166: 0.658248
training accuracy: 0.531250     test accuracy: 0.456543
Average cost in epoch 167: 0.648878
training accuracy: 0.593750     test accuracy: 0.457542
Average cost in epoch 168: 0.656122
training accuracy: 0.687500     test accuracy: 0.449550
Average cost in epoch 169: 0.655244
training accuracy: 0.531250     test accuracy: 0.451548

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 170: 0.654217
training accuracy: 0.500000     test accuracy: 0.456543
Average cost in epoch 171: 0.651762
training accuracy: 0.562500     test accuracy: 0.446553
Average cost in epoch 172: 0.657769
training accuracy: 0.656250     test accuracy: 0.447552
Average cost in epoch 173: 0.656872
training accuracy: 0.687500     test accuracy: 0.451548
Average cost in epoch 174: 0.649257
training accuracy: 0.750000     test accuracy: 0.446553

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 175: 0.651190
training accuracy: 0.687500     test accuracy: 0.441558
Average cost in epoch 176: 0.648404
training accuracy: 0.687500     test accuracy: 0.452547
Average cost in epoch 177: 0.650181
training accuracy: 0.656250     test accuracy: 0.455544
Average cost in epoch 178: 0.649485
training accuracy: 0.531250     test accuracy: 0.449550
Average cost in epoch 179: 0.653731
training accuracy: 0.687500     test accuracy: 0.450549

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 180: 0.650789
training accuracy: 0.656250     test accuracy: 0.461538
Average cost in epoch 181: 0.646011
training accuracy: 0.562500     test accuracy: 0.453546
Average cost in epoch 182: 0.648458
training accuracy: 0.562500     test accuracy: 0.460539
Average cost in epoch 183: 0.651998
training accuracy: 0.468750     test accuracy: 0.453546
Average cost in epoch 184: 0.647721
training accuracy: 0.625000     test accuracy: 0.449550

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 185: 0.643533
training accuracy: 0.656250     test accuracy: 0.453546
Average cost in epoch 186: 0.649855
training accuracy: 0.625000     test accuracy: 0.447552
Average cost in epoch 187: 0.653892
training accuracy: 0.500000     test accuracy: 0.445554
Average cost in epoch 188: 0.647073
training accuracy: 0.656250     test accuracy: 0.450549
Average cost in epoch 189: 0.647779
training accuracy: 0.625000     test accuracy: 0.442557

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 190: 0.644267
training accuracy: 0.656250     test accuracy: 0.447552
Average cost in epoch 191: 0.645703
training accuracy: 0.531250     test accuracy: 0.449550
Average cost in epoch 192: 0.649866
training accuracy: 0.500000     test accuracy: 0.458541
Average cost in epoch 193: 0.647824
training accuracy: 0.687500     test accuracy: 0.465534
Average cost in epoch 194: 0.645645
training accuracy: 0.781250     test accuracy: 0.455544

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Average cost in epoch 195: 0.643261
training accuracy: 0.718750     test accuracy: 0.454545
Average cost in epoch 196: 0.634004
training accuracy: 0.562500     test accuracy: 0.439560
Average cost in epoch 197: 0.637360
training accuracy: 0.687500     test accuracy: 0.442557
Average cost in epoch 198: 0.631184
training accuracy: 0.687500     test accuracy: 0.432567
Average cost in epoch 199: 0.648995
training accuracy: 0.687500     test accuracy: 0.442557

dump to weights/pyramid-lstm/pyramid-lstm_10.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 11, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_11.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 108.83
Starting training...
Average cost in epoch 0: 1.174960
training accuracy: 0.687500     test accuracy: 0.751249
Average cost in epoch 1: 0.950646
training accuracy: 0.593750     test accuracy: 0.743257
Average cost in epoch 2: 0.821671
training accuracy: 0.718750     test accuracy: 0.743257
Average cost in epoch 3: 0.791909
training accuracy: 0.687500     test accuracy: 0.743257
Average cost in epoch 4: 0.768252
training accuracy: 0.812500     test accuracy: 0.702298

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 5: 0.764885
training accuracy: 0.531250     test accuracy: 0.756244
lr decays to 0.009000
Average cost in epoch 6: 0.743453
training accuracy: 0.625000     test accuracy: 0.729271
Average cost in epoch 7: 0.723518
training accuracy: 0.687500     test accuracy: 0.734266
Average cost in epoch 8: 0.723749
training accuracy: 0.656250     test accuracy: 0.734266
Average cost in epoch 9: 0.706028
training accuracy: 0.781250     test accuracy: 0.746254

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 10: 0.714772
training accuracy: 0.750000     test accuracy: 0.743257
lr decays to 0.008100
Average cost in epoch 11: 0.701612
training accuracy: 0.687500     test accuracy: 0.729271
Average cost in epoch 12: 0.703178
training accuracy: 0.687500     test accuracy: 0.742258
Average cost in epoch 13: 0.693122
training accuracy: 0.687500     test accuracy: 0.730270
Average cost in epoch 14: 0.693312
training accuracy: 0.843750     test accuracy: 0.739261

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 15: 0.681632
training accuracy: 0.843750     test accuracy: 0.731269
lr decays to 0.007290
Average cost in epoch 16: 0.685617
training accuracy: 0.625000     test accuracy: 0.723277
Average cost in epoch 17: 0.673682
training accuracy: 0.843750     test accuracy: 0.735265
Average cost in epoch 18: 0.668314
training accuracy: 0.656250     test accuracy: 0.722278
Average cost in epoch 19: 0.672465
training accuracy: 0.687500     test accuracy: 0.739261

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 20: 0.666027
training accuracy: 0.687500     test accuracy: 0.746254
lr decays to 0.006561
Average cost in epoch 21: 0.659466
training accuracy: 0.593750     test accuracy: 0.732268
Average cost in epoch 22: 0.652970
training accuracy: 0.625000     test accuracy: 0.722278
Average cost in epoch 23: 0.651560
training accuracy: 0.531250     test accuracy: 0.747253
Average cost in epoch 24: 0.654814
training accuracy: 0.750000     test accuracy: 0.748252

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 25: 0.654922
training accuracy: 0.687500     test accuracy: 0.735265
lr decays to 0.005905
Average cost in epoch 26: 0.646190
training accuracy: 0.656250     test accuracy: 0.746254
Average cost in epoch 27: 0.646856
training accuracy: 0.687500     test accuracy: 0.737263
Average cost in epoch 28: 0.641494
training accuracy: 0.812500     test accuracy: 0.743257
Average cost in epoch 29: 0.641401
training accuracy: 0.656250     test accuracy: 0.748252

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 30: 0.648601
training accuracy: 0.656250     test accuracy: 0.754246
lr decays to 0.005314
Average cost in epoch 31: 0.634970
training accuracy: 0.781250     test accuracy: 0.753247
Average cost in epoch 32: 0.632949
training accuracy: 0.843750     test accuracy: 0.732268
Average cost in epoch 33: 0.635362
training accuracy: 0.687500     test accuracy: 0.743257
Average cost in epoch 34: 0.631318
training accuracy: 0.812500     test accuracy: 0.758242

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 35: 0.629065
training accuracy: 0.781250     test accuracy: 0.745255
lr decays to 0.004783
Average cost in epoch 36: 0.609865
training accuracy: 0.625000     test accuracy: 0.729271
Average cost in epoch 37: 0.621120
training accuracy: 0.812500     test accuracy: 0.733267
Average cost in epoch 38: 0.620691
training accuracy: 0.781250     test accuracy: 0.729271
Average cost in epoch 39: 0.617031
training accuracy: 0.625000     test accuracy: 0.732268

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 40: 0.614767
training accuracy: 0.500000     test accuracy: 0.735265
lr decays to 0.004305
Average cost in epoch 41: 0.604281
training accuracy: 0.625000     test accuracy: 0.746254
Average cost in epoch 42: 0.609074
training accuracy: 0.750000     test accuracy: 0.732268
Average cost in epoch 43: 0.589263
training accuracy: 0.812500     test accuracy: 0.743257
Average cost in epoch 44: 0.605215
training accuracy: 0.812500     test accuracy: 0.733267

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 45: 0.603740
training accuracy: 0.781250     test accuracy: 0.741259
lr decays to 0.003874
Average cost in epoch 46: 0.592371
training accuracy: 0.656250     test accuracy: 0.733267
Average cost in epoch 47: 0.589702
training accuracy: 0.750000     test accuracy: 0.743257
Average cost in epoch 48: 0.595155
training accuracy: 0.781250     test accuracy: 0.730270
Average cost in epoch 49: 0.588006
training accuracy: 0.781250     test accuracy: 0.741259

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 50: 0.582331
training accuracy: 0.718750     test accuracy: 0.733267
lr decays to 0.003487
Average cost in epoch 51: 0.575727
training accuracy: 0.750000     test accuracy: 0.740260
Average cost in epoch 52: 0.568127
training accuracy: 0.718750     test accuracy: 0.743257
Average cost in epoch 53: 0.573884
training accuracy: 0.781250     test accuracy: 0.732268
Average cost in epoch 54: 0.565176
training accuracy: 0.687500     test accuracy: 0.740260

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 55: 0.578124
training accuracy: 0.718750     test accuracy: 0.742258
lr decays to 0.003138
Average cost in epoch 56: 0.559547
training accuracy: 0.812500     test accuracy: 0.736264
Average cost in epoch 57: 0.564828
training accuracy: 0.718750     test accuracy: 0.734266
Average cost in epoch 58: 0.560910
training accuracy: 0.718750     test accuracy: 0.730270
Average cost in epoch 59: 0.563824
training accuracy: 0.718750     test accuracy: 0.732268

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 60: 0.549451
training accuracy: 0.843750     test accuracy: 0.735265
lr decays to 0.002824
Average cost in epoch 61: 0.559659
training accuracy: 0.812500     test accuracy: 0.726274
Average cost in epoch 62: 0.555444
training accuracy: 0.750000     test accuracy: 0.730270
Average cost in epoch 63: 0.547108
training accuracy: 0.781250     test accuracy: 0.734266
Average cost in epoch 64: 0.548876
training accuracy: 0.687500     test accuracy: 0.712288

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 65: 0.541845
training accuracy: 0.687500     test accuracy: 0.729271
lr decays to 0.002542
Average cost in epoch 66: 0.543001
training accuracy: 0.718750     test accuracy: 0.723277
Average cost in epoch 67: 0.544551
training accuracy: 0.843750     test accuracy: 0.717283
Average cost in epoch 68: 0.532321
training accuracy: 0.687500     test accuracy: 0.724276
Average cost in epoch 69: 0.524523
training accuracy: 0.750000     test accuracy: 0.718282

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 70: 0.528452
training accuracy: 0.781250     test accuracy: 0.720280
lr decays to 0.002288
Average cost in epoch 71: 0.524989
training accuracy: 0.718750     test accuracy: 0.726274
Average cost in epoch 72: 0.520789
training accuracy: 0.781250     test accuracy: 0.723277
Average cost in epoch 73: 0.525917
training accuracy: 0.781250     test accuracy: 0.736264
Average cost in epoch 74: 0.521432
training accuracy: 0.781250     test accuracy: 0.726274

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 75: 0.519740
training accuracy: 0.875000     test accuracy: 0.713287
lr decays to 0.002059
Average cost in epoch 76: 0.522312
training accuracy: 0.812500     test accuracy: 0.721279
Average cost in epoch 77: 0.517417
training accuracy: 0.718750     test accuracy: 0.718282
Average cost in epoch 78: 0.506546
training accuracy: 0.781250     test accuracy: 0.722278
Average cost in epoch 79: 0.503339
training accuracy: 0.843750     test accuracy: 0.726274

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 80: 0.509767
training accuracy: 0.750000     test accuracy: 0.713287
lr decays to 0.001853
Average cost in epoch 81: 0.499912
training accuracy: 0.812500     test accuracy: 0.726274
Average cost in epoch 82: 0.505016
training accuracy: 0.750000     test accuracy: 0.728272
Average cost in epoch 83: 0.495378
training accuracy: 0.750000     test accuracy: 0.729271
Average cost in epoch 84: 0.497319
training accuracy: 0.687500     test accuracy: 0.719281

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 85: 0.497310
training accuracy: 0.875000     test accuracy: 0.721279
lr decays to 0.001668
Average cost in epoch 86: 0.496949
training accuracy: 0.843750     test accuracy: 0.711289
Average cost in epoch 87: 0.488526
training accuracy: 0.812500     test accuracy: 0.719281
Average cost in epoch 88: 0.488451
training accuracy: 0.843750     test accuracy: 0.723277
Average cost in epoch 89: 0.488213
training accuracy: 0.781250     test accuracy: 0.721279

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 90: 0.482244
training accuracy: 0.750000     test accuracy: 0.711289
lr decays to 0.001501
Average cost in epoch 91: 0.485338
training accuracy: 0.718750     test accuracy: 0.715285
Average cost in epoch 92: 0.474613
training accuracy: 0.750000     test accuracy: 0.711289
Average cost in epoch 93: 0.476975
training accuracy: 0.718750     test accuracy: 0.715285
Average cost in epoch 94: 0.474331
training accuracy: 0.750000     test accuracy: 0.720280

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 95: 0.479857
training accuracy: 0.875000     test accuracy: 0.712288
lr decays to 0.001351
Average cost in epoch 96: 0.473760
training accuracy: 0.875000     test accuracy: 0.720280
Average cost in epoch 97: 0.464237
training accuracy: 0.906250     test accuracy: 0.719281
Average cost in epoch 98: 0.468198
training accuracy: 0.687500     test accuracy: 0.716284
Average cost in epoch 99: 0.471900
training accuracy: 0.843750     test accuracy: 0.720280

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 100: 0.465613
training accuracy: 0.812500     test accuracy: 0.726274
lr decays to 0.001216
Average cost in epoch 101: 0.462209
training accuracy: 0.750000     test accuracy: 0.704296
Average cost in epoch 102: 0.459545
training accuracy: 0.781250     test accuracy: 0.703297
Average cost in epoch 103: 0.463216
training accuracy: 0.875000     test accuracy: 0.706294
Average cost in epoch 104: 0.450894
training accuracy: 0.750000     test accuracy: 0.709291

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 105: 0.466674
training accuracy: 0.875000     test accuracy: 0.704296
Average cost in epoch 106: 0.445305
training accuracy: 0.718750     test accuracy: 0.710290
Average cost in epoch 107: 0.462623
training accuracy: 0.843750     test accuracy: 0.704296
Average cost in epoch 108: 0.445967
training accuracy: 0.812500     test accuracy: 0.702298
Average cost in epoch 109: 0.448843
training accuracy: 0.781250     test accuracy: 0.692308

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 110: 0.455845
training accuracy: 0.781250     test accuracy: 0.698302
Average cost in epoch 111: 0.443509
training accuracy: 0.781250     test accuracy: 0.712288
Average cost in epoch 112: 0.448207
training accuracy: 0.781250     test accuracy: 0.703297
Average cost in epoch 113: 0.437373
training accuracy: 0.875000     test accuracy: 0.699301
Average cost in epoch 114: 0.445712
training accuracy: 0.843750     test accuracy: 0.713287

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 115: 0.440688
training accuracy: 0.781250     test accuracy: 0.712288
Average cost in epoch 116: 0.454296
training accuracy: 0.812500     test accuracy: 0.709291
Average cost in epoch 117: 0.443330
training accuracy: 0.781250     test accuracy: 0.715285
Average cost in epoch 118: 0.445962
training accuracy: 0.843750     test accuracy: 0.704296
Average cost in epoch 119: 0.442183
training accuracy: 0.843750     test accuracy: 0.708292

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 120: 0.442223
training accuracy: 0.812500     test accuracy: 0.704296
Average cost in epoch 121: 0.429136
training accuracy: 0.875000     test accuracy: 0.698302
Average cost in epoch 122: 0.437085
training accuracy: 0.687500     test accuracy: 0.707293
Average cost in epoch 123: 0.439195
training accuracy: 0.718750     test accuracy: 0.699301
Average cost in epoch 124: 0.437512
training accuracy: 0.718750     test accuracy: 0.698302

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 125: 0.441469
training accuracy: 0.812500     test accuracy: 0.700300
Average cost in epoch 126: 0.440596
training accuracy: 0.625000     test accuracy: 0.704296
Average cost in epoch 127: 0.430590
training accuracy: 0.750000     test accuracy: 0.710290
Average cost in epoch 128: 0.444105
training accuracy: 0.843750     test accuracy: 0.698302
Average cost in epoch 129: 0.435752
training accuracy: 0.843750     test accuracy: 0.706294

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 130: 0.437923
training accuracy: 0.781250     test accuracy: 0.701299
Average cost in epoch 131: 0.429928
training accuracy: 0.781250     test accuracy: 0.702298
Average cost in epoch 132: 0.434984
training accuracy: 0.843750     test accuracy: 0.699301
Average cost in epoch 133: 0.428168
training accuracy: 0.843750     test accuracy: 0.697303
Average cost in epoch 134: 0.433606
training accuracy: 0.906250     test accuracy: 0.696304

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 135: 0.421075
training accuracy: 0.875000     test accuracy: 0.697303
Average cost in epoch 136: 0.431953
training accuracy: 0.906250     test accuracy: 0.699301
Average cost in epoch 137: 0.427597
training accuracy: 0.875000     test accuracy: 0.697303
Average cost in epoch 138: 0.417581
training accuracy: 0.843750     test accuracy: 0.704296
Average cost in epoch 139: 0.422592
training accuracy: 0.906250     test accuracy: 0.704296

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 140: 0.431837
training accuracy: 0.843750     test accuracy: 0.691309
Average cost in epoch 141: 0.422160
training accuracy: 0.875000     test accuracy: 0.701299
Average cost in epoch 142: 0.421727
training accuracy: 0.875000     test accuracy: 0.695305
Average cost in epoch 143: 0.413374
training accuracy: 0.843750     test accuracy: 0.703297
Average cost in epoch 144: 0.420633
training accuracy: 0.750000     test accuracy: 0.702298

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 145: 0.421323
training accuracy: 0.593750     test accuracy: 0.701299
Average cost in epoch 146: 0.420963
training accuracy: 0.781250     test accuracy: 0.685315
Average cost in epoch 147: 0.424603
training accuracy: 0.875000     test accuracy: 0.695305
Average cost in epoch 148: 0.414114
training accuracy: 0.750000     test accuracy: 0.694306
Average cost in epoch 149: 0.433830
training accuracy: 0.750000     test accuracy: 0.691309

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 150: 0.415011
training accuracy: 0.812500     test accuracy: 0.699301
Average cost in epoch 151: 0.411897
training accuracy: 0.812500     test accuracy: 0.698302
Average cost in epoch 152: 0.408206
training accuracy: 0.687500     test accuracy: 0.700300
Average cost in epoch 153: 0.415300
training accuracy: 0.687500     test accuracy: 0.703297
Average cost in epoch 154: 0.421339
training accuracy: 0.812500     test accuracy: 0.696304

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 155: 0.418340
training accuracy: 0.750000     test accuracy: 0.698302
Average cost in epoch 156: 0.404636
training accuracy: 0.781250     test accuracy: 0.682318
Average cost in epoch 157: 0.423525
training accuracy: 0.781250     test accuracy: 0.677323
Average cost in epoch 158: 0.407686
training accuracy: 0.843750     test accuracy: 0.693307
Average cost in epoch 159: 0.410415
training accuracy: 0.843750     test accuracy: 0.687313

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 160: 0.421735
training accuracy: 0.812500     test accuracy: 0.686314
Average cost in epoch 161: 0.410250
training accuracy: 0.843750     test accuracy: 0.691309
Average cost in epoch 162: 0.404746
training accuracy: 0.843750     test accuracy: 0.693307
Average cost in epoch 163: 0.409450
training accuracy: 0.906250     test accuracy: 0.693307
Average cost in epoch 164: 0.410892
training accuracy: 0.875000     test accuracy: 0.701299

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 165: 0.406324
training accuracy: 0.875000     test accuracy: 0.694306
Average cost in epoch 166: 0.411299
training accuracy: 0.906250     test accuracy: 0.703297
Average cost in epoch 167: 0.410144
training accuracy: 0.906250     test accuracy: 0.698302
Average cost in epoch 168: 0.408678
training accuracy: 0.687500     test accuracy: 0.692308
Average cost in epoch 169: 0.412785
training accuracy: 0.812500     test accuracy: 0.698302

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 170: 0.409895
training accuracy: 0.906250     test accuracy: 0.692308
Average cost in epoch 171: 0.405312
training accuracy: 0.843750     test accuracy: 0.690310
Average cost in epoch 172: 0.408099
training accuracy: 0.843750     test accuracy: 0.701299
Average cost in epoch 173: 0.406160
training accuracy: 0.781250     test accuracy: 0.699301
Average cost in epoch 174: 0.412401
training accuracy: 0.843750     test accuracy: 0.698302

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 175: 0.414086
training accuracy: 0.906250     test accuracy: 0.696304
Average cost in epoch 176: 0.406568
training accuracy: 0.875000     test accuracy: 0.685315
Average cost in epoch 177: 0.407672
training accuracy: 0.906250     test accuracy: 0.696304
Average cost in epoch 178: 0.409928
training accuracy: 0.781250     test accuracy: 0.689311
Average cost in epoch 179: 0.396621
training accuracy: 0.906250     test accuracy: 0.692308

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 180: 0.416742
training accuracy: 0.843750     test accuracy: 0.688312
Average cost in epoch 181: 0.394311
training accuracy: 0.906250     test accuracy: 0.681319
Average cost in epoch 182: 0.401882
training accuracy: 0.906250     test accuracy: 0.694306
Average cost in epoch 183: 0.406525
training accuracy: 0.750000     test accuracy: 0.693307
Average cost in epoch 184: 0.398540
training accuracy: 0.906250     test accuracy: 0.692308

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 185: 0.393035
training accuracy: 0.968750     test accuracy: 0.693307
Average cost in epoch 186: 0.390855
training accuracy: 0.843750     test accuracy: 0.686314
Average cost in epoch 187: 0.388895
training accuracy: 0.781250     test accuracy: 0.680320
Average cost in epoch 188: 0.389135
training accuracy: 0.843750     test accuracy: 0.685315
Average cost in epoch 189: 0.400961
training accuracy: 0.812500     test accuracy: 0.690310

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 190: 0.393741
training accuracy: 0.906250     test accuracy: 0.694306
Average cost in epoch 191: 0.396619
training accuracy: 0.812500     test accuracy: 0.684316
Average cost in epoch 192: 0.390444
training accuracy: 0.812500     test accuracy: 0.695305
Average cost in epoch 193: 0.410506
training accuracy: 0.812500     test accuracy: 0.698302
Average cost in epoch 194: 0.382673
training accuracy: 0.812500     test accuracy: 0.684316

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Average cost in epoch 195: 0.402255
training accuracy: 0.906250     test accuracy: 0.690310
Average cost in epoch 196: 0.379581
training accuracy: 0.781250     test accuracy: 0.690310
Average cost in epoch 197: 0.396857
training accuracy: 0.781250     test accuracy: 0.690310
Average cost in epoch 198: 0.398923
training accuracy: 0.875000     test accuracy: 0.700300
Average cost in epoch 199: 0.386686
training accuracy: 0.875000     test accuracy: 0.682318

dump to weights/pyramid-lstm/pyramid-lstm_11.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 12, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_12.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 79.43
Starting training...
Average cost in epoch 0: 1.050108
training accuracy: 0.656250     test accuracy: 0.772228
Average cost in epoch 1: 0.854987
training accuracy: 0.687500     test accuracy: 0.771229
Average cost in epoch 2: 0.821545
training accuracy: 0.531250     test accuracy: 0.772228
Average cost in epoch 3: 0.791395
training accuracy: 0.625000     test accuracy: 0.770230
Average cost in epoch 4: 0.780837
training accuracy: 0.687500     test accuracy: 0.772228

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 5: 0.765854
training accuracy: 0.843750     test accuracy: 0.772228
lr decays to 0.009000
Average cost in epoch 6: 0.748273
training accuracy: 0.687500     test accuracy: 0.769231
Average cost in epoch 7: 0.746416
training accuracy: 0.625000     test accuracy: 0.772228
Average cost in epoch 8: 0.748696
training accuracy: 0.593750     test accuracy: 0.771229
Average cost in epoch 9: 0.733827
training accuracy: 0.750000     test accuracy: 0.772228

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 10: 0.733582
training accuracy: 0.750000     test accuracy: 0.772228
lr decays to 0.008100
Average cost in epoch 11: 0.728265
training accuracy: 0.843750     test accuracy: 0.770230
Average cost in epoch 12: 0.725008
training accuracy: 0.687500     test accuracy: 0.767233
Average cost in epoch 13: 0.725785
training accuracy: 0.812500     test accuracy: 0.772228
Average cost in epoch 14: 0.716057
training accuracy: 0.718750     test accuracy: 0.770230

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 15: 0.717430
training accuracy: 0.625000     test accuracy: 0.772228
lr decays to 0.007290
Average cost in epoch 16: 0.709340
training accuracy: 0.687500     test accuracy: 0.772228
Average cost in epoch 17: 0.709802
training accuracy: 0.625000     test accuracy: 0.772228
Average cost in epoch 18: 0.703473
training accuracy: 0.750000     test accuracy: 0.772228
Average cost in epoch 19: 0.696557
training accuracy: 0.625000     test accuracy: 0.772228

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 20: 0.688465
training accuracy: 0.562500     test accuracy: 0.770230
lr decays to 0.006561
Average cost in epoch 21: 0.693000
training accuracy: 0.750000     test accuracy: 0.767233
Average cost in epoch 22: 0.690921
training accuracy: 0.750000     test accuracy: 0.770230
Average cost in epoch 23: 0.685513
training accuracy: 0.625000     test accuracy: 0.771229
Average cost in epoch 24: 0.683181
training accuracy: 0.718750     test accuracy: 0.767233

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 25: 0.681669
training accuracy: 0.593750     test accuracy: 0.770230
lr decays to 0.005905
Average cost in epoch 26: 0.674767
training accuracy: 0.500000     test accuracy: 0.770230
Average cost in epoch 27: 0.675933
training accuracy: 0.687500     test accuracy: 0.764236
Average cost in epoch 28: 0.666685
training accuracy: 0.781250     test accuracy: 0.771229
Average cost in epoch 29: 0.664984
training accuracy: 0.593750     test accuracy: 0.773227

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 30: 0.666016
training accuracy: 0.687500     test accuracy: 0.772228
lr decays to 0.005314
Average cost in epoch 31: 0.663434
training accuracy: 0.687500     test accuracy: 0.768232
Average cost in epoch 32: 0.661632
training accuracy: 0.656250     test accuracy: 0.761239
Average cost in epoch 33: 0.661326
training accuracy: 0.718750     test accuracy: 0.773227
Average cost in epoch 34: 0.654099
training accuracy: 0.718750     test accuracy: 0.771229

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 35: 0.648767
training accuracy: 0.656250     test accuracy: 0.768232
lr decays to 0.004783
Average cost in epoch 36: 0.648530
training accuracy: 0.750000     test accuracy: 0.770230
Average cost in epoch 37: 0.639895
training accuracy: 0.625000     test accuracy: 0.767233
Average cost in epoch 38: 0.637451
training accuracy: 0.750000     test accuracy: 0.771229
Average cost in epoch 39: 0.646293
training accuracy: 0.718750     test accuracy: 0.750250

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 40: 0.640473
training accuracy: 0.718750     test accuracy: 0.766234
lr decays to 0.004305
Average cost in epoch 41: 0.632728
training accuracy: 0.687500     test accuracy: 0.765235
Average cost in epoch 42: 0.621671
training accuracy: 0.656250     test accuracy: 0.765235
Average cost in epoch 43: 0.629085
training accuracy: 0.812500     test accuracy: 0.769231
Average cost in epoch 44: 0.630792
training accuracy: 0.875000     test accuracy: 0.767233

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 45: 0.621999
training accuracy: 0.781250     test accuracy: 0.766234
lr decays to 0.003874
Average cost in epoch 46: 0.621586
training accuracy: 0.843750     test accuracy: 0.768232
Average cost in epoch 47: 0.617850
training accuracy: 0.687500     test accuracy: 0.762238
Average cost in epoch 48: 0.614997
training accuracy: 0.843750     test accuracy: 0.768232
Average cost in epoch 49: 0.619240
training accuracy: 0.718750     test accuracy: 0.763237

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 50: 0.609519
training accuracy: 0.718750     test accuracy: 0.770230
lr decays to 0.003487
Average cost in epoch 51: 0.596582
training accuracy: 0.687500     test accuracy: 0.762238
Average cost in epoch 52: 0.599097
training accuracy: 0.812500     test accuracy: 0.754246
Average cost in epoch 53: 0.591878
training accuracy: 0.750000     test accuracy: 0.766234
Average cost in epoch 54: 0.589123
training accuracy: 0.812500     test accuracy: 0.759241

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 55: 0.595951
training accuracy: 0.781250     test accuracy: 0.757243
lr decays to 0.003138
Average cost in epoch 56: 0.587695
training accuracy: 0.750000     test accuracy: 0.759241
Average cost in epoch 57: 0.579736
training accuracy: 0.812500     test accuracy: 0.762238
Average cost in epoch 58: 0.588004
training accuracy: 0.718750     test accuracy: 0.761239
Average cost in epoch 59: 0.583342
training accuracy: 0.906250     test accuracy: 0.755245

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 60: 0.582918
training accuracy: 0.687500     test accuracy: 0.762238
lr decays to 0.002824
Average cost in epoch 61: 0.570756
training accuracy: 0.781250     test accuracy: 0.764236
Average cost in epoch 62: 0.570716
training accuracy: 0.750000     test accuracy: 0.754246
Average cost in epoch 63: 0.574724
training accuracy: 0.906250     test accuracy: 0.758242
Average cost in epoch 64: 0.561324
training accuracy: 0.781250     test accuracy: 0.759241

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 65: 0.570007
training accuracy: 0.843750     test accuracy: 0.752248
lr decays to 0.002542
Average cost in epoch 66: 0.561050
training accuracy: 0.718750     test accuracy: 0.750250
Average cost in epoch 67: 0.558682
training accuracy: 0.875000     test accuracy: 0.753247
Average cost in epoch 68: 0.554451
training accuracy: 0.750000     test accuracy: 0.762238
Average cost in epoch 69: 0.562976
training accuracy: 0.812500     test accuracy: 0.753247

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 70: 0.556805
training accuracy: 0.718750     test accuracy: 0.758242
lr decays to 0.002288
Average cost in epoch 71: 0.553852
training accuracy: 0.750000     test accuracy: 0.746254
Average cost in epoch 72: 0.536561
training accuracy: 0.750000     test accuracy: 0.753247
Average cost in epoch 73: 0.550544
training accuracy: 0.781250     test accuracy: 0.756244
Average cost in epoch 74: 0.538863
training accuracy: 0.781250     test accuracy: 0.754246

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 75: 0.534510
training accuracy: 0.812500     test accuracy: 0.738262
lr decays to 0.002059
Average cost in epoch 76: 0.543046
training accuracy: 0.593750     test accuracy: 0.745255
Average cost in epoch 77: 0.536672
training accuracy: 0.750000     test accuracy: 0.755245
Average cost in epoch 78: 0.531844
training accuracy: 0.781250     test accuracy: 0.746254
Average cost in epoch 79: 0.535876
training accuracy: 0.781250     test accuracy: 0.743257

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 80: 0.530304
training accuracy: 0.812500     test accuracy: 0.749251
lr decays to 0.001853
Average cost in epoch 81: 0.524475
training accuracy: 0.843750     test accuracy: 0.748252
Average cost in epoch 82: 0.524884
training accuracy: 0.812500     test accuracy: 0.748252
Average cost in epoch 83: 0.520678
training accuracy: 0.750000     test accuracy: 0.746254
Average cost in epoch 84: 0.522593
training accuracy: 0.812500     test accuracy: 0.748252

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 85: 0.518787
training accuracy: 0.718750     test accuracy: 0.747253
lr decays to 0.001668
Average cost in epoch 86: 0.514639
training accuracy: 0.812500     test accuracy: 0.745255
Average cost in epoch 87: 0.514392
training accuracy: 0.750000     test accuracy: 0.747253
Average cost in epoch 88: 0.501654
training accuracy: 0.718750     test accuracy: 0.746254
Average cost in epoch 89: 0.510038
training accuracy: 0.781250     test accuracy: 0.751249

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 90: 0.506143
training accuracy: 0.781250     test accuracy: 0.757243
lr decays to 0.001501
Average cost in epoch 91: 0.506181
training accuracy: 0.781250     test accuracy: 0.746254
Average cost in epoch 92: 0.507062
training accuracy: 0.781250     test accuracy: 0.750250
Average cost in epoch 93: 0.504817
training accuracy: 0.812500     test accuracy: 0.744256
Average cost in epoch 94: 0.499068
training accuracy: 0.718750     test accuracy: 0.739261

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 95: 0.501052
training accuracy: 0.875000     test accuracy: 0.745255
lr decays to 0.001351
Average cost in epoch 96: 0.490766
training accuracy: 0.812500     test accuracy: 0.742258
Average cost in epoch 97: 0.493186
training accuracy: 0.843750     test accuracy: 0.738262
Average cost in epoch 98: 0.480855
training accuracy: 0.687500     test accuracy: 0.742258
Average cost in epoch 99: 0.487363
training accuracy: 0.906250     test accuracy: 0.741259

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 100: 0.488615
training accuracy: 0.875000     test accuracy: 0.734266
lr decays to 0.001216
Average cost in epoch 101: 0.483728
training accuracy: 0.812500     test accuracy: 0.739261
Average cost in epoch 102: 0.487821
training accuracy: 0.687500     test accuracy: 0.730270
Average cost in epoch 103: 0.481980
training accuracy: 0.812500     test accuracy: 0.737263
Average cost in epoch 104: 0.480050
training accuracy: 0.781250     test accuracy: 0.731269

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 105: 0.486680
training accuracy: 0.718750     test accuracy: 0.749251
Average cost in epoch 106: 0.473156
training accuracy: 0.718750     test accuracy: 0.729271
Average cost in epoch 107: 0.481450
training accuracy: 0.750000     test accuracy: 0.742258
Average cost in epoch 108: 0.474844
training accuracy: 0.812500     test accuracy: 0.740260
Average cost in epoch 109: 0.482109
training accuracy: 0.875000     test accuracy: 0.737263

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 110: 0.481261
training accuracy: 0.781250     test accuracy: 0.733267
Average cost in epoch 111: 0.466927
training accuracy: 0.781250     test accuracy: 0.734266
Average cost in epoch 112: 0.467682
training accuracy: 0.750000     test accuracy: 0.736264
Average cost in epoch 113: 0.478017
training accuracy: 0.750000     test accuracy: 0.732268
Average cost in epoch 114: 0.469021
training accuracy: 0.906250     test accuracy: 0.727273

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 115: 0.480481
training accuracy: 0.906250     test accuracy: 0.733267
Average cost in epoch 116: 0.472477
training accuracy: 0.843750     test accuracy: 0.733267
Average cost in epoch 117: 0.466690
training accuracy: 0.812500     test accuracy: 0.736264
Average cost in epoch 118: 0.478953
training accuracy: 0.781250     test accuracy: 0.718282
Average cost in epoch 119: 0.477799
training accuracy: 0.750000     test accuracy: 0.726274

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 120: 0.472090
training accuracy: 0.781250     test accuracy: 0.730270
Average cost in epoch 121: 0.471427
training accuracy: 0.781250     test accuracy: 0.728272
Average cost in epoch 122: 0.472076
training accuracy: 0.781250     test accuracy: 0.732268
Average cost in epoch 123: 0.472460
training accuracy: 0.906250     test accuracy: 0.737263
Average cost in epoch 124: 0.481841
training accuracy: 0.750000     test accuracy: 0.731269

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 125: 0.465472
training accuracy: 0.812500     test accuracy: 0.728272
Average cost in epoch 126: 0.466492
training accuracy: 0.656250     test accuracy: 0.717283
Average cost in epoch 127: 0.465619
training accuracy: 0.781250     test accuracy: 0.733267
Average cost in epoch 128: 0.461022
training accuracy: 0.781250     test accuracy: 0.725275
Average cost in epoch 129: 0.469694
training accuracy: 0.843750     test accuracy: 0.721279

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 130: 0.458248
training accuracy: 0.937500     test accuracy: 0.734266
Average cost in epoch 131: 0.468814
training accuracy: 0.843750     test accuracy: 0.727273
Average cost in epoch 132: 0.461132
training accuracy: 0.750000     test accuracy: 0.736264
Average cost in epoch 133: 0.469283
training accuracy: 0.687500     test accuracy: 0.728272
Average cost in epoch 134: 0.465090
training accuracy: 0.812500     test accuracy: 0.728272

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 135: 0.469045
training accuracy: 0.812500     test accuracy: 0.721279
Average cost in epoch 136: 0.455416
training accuracy: 0.750000     test accuracy: 0.738262
Average cost in epoch 137: 0.464477
training accuracy: 0.812500     test accuracy: 0.719281
Average cost in epoch 138: 0.457075
training accuracy: 0.718750     test accuracy: 0.728272
Average cost in epoch 139: 0.460776
training accuracy: 0.843750     test accuracy: 0.728272

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 140: 0.452359
training accuracy: 0.718750     test accuracy: 0.723277
Average cost in epoch 141: 0.468491
training accuracy: 0.875000     test accuracy: 0.735265
Average cost in epoch 142: 0.462540
training accuracy: 0.812500     test accuracy: 0.724276
Average cost in epoch 143: 0.458316
training accuracy: 0.906250     test accuracy: 0.732268
Average cost in epoch 144: 0.459653
training accuracy: 0.781250     test accuracy: 0.726274

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 145: 0.462086
training accuracy: 0.781250     test accuracy: 0.723277
Average cost in epoch 146: 0.450033
training accuracy: 0.687500     test accuracy: 0.731269
Average cost in epoch 147: 0.458937
training accuracy: 0.843750     test accuracy: 0.731269
Average cost in epoch 148: 0.442858
training accuracy: 0.718750     test accuracy: 0.705295
Average cost in epoch 149: 0.457254
training accuracy: 0.812500     test accuracy: 0.728272

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 150: 0.457713
training accuracy: 0.906250     test accuracy: 0.718282
Average cost in epoch 151: 0.452664
training accuracy: 0.812500     test accuracy: 0.725275
Average cost in epoch 152: 0.467642
training accuracy: 0.750000     test accuracy: 0.722278
Average cost in epoch 153: 0.450173
training accuracy: 0.812500     test accuracy: 0.727273
Average cost in epoch 154: 0.450471
training accuracy: 0.906250     test accuracy: 0.715285

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 155: 0.458473
training accuracy: 0.656250     test accuracy: 0.730270
Average cost in epoch 156: 0.453183
training accuracy: 0.812500     test accuracy: 0.729271
Average cost in epoch 157: 0.456693
training accuracy: 0.875000     test accuracy: 0.720280
Average cost in epoch 158: 0.445129
training accuracy: 0.718750     test accuracy: 0.722278
Average cost in epoch 159: 0.449416
training accuracy: 0.843750     test accuracy: 0.721279

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 160: 0.447251
training accuracy: 0.843750     test accuracy: 0.711289
Average cost in epoch 161: 0.451545
training accuracy: 0.812500     test accuracy: 0.724276
Average cost in epoch 162: 0.451926
training accuracy: 0.781250     test accuracy: 0.727273
Average cost in epoch 163: 0.453188
training accuracy: 0.843750     test accuracy: 0.720280
Average cost in epoch 164: 0.440950
training accuracy: 0.875000     test accuracy: 0.722278

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 165: 0.455952
training accuracy: 0.781250     test accuracy: 0.714286
Average cost in epoch 166: 0.443054
training accuracy: 0.781250     test accuracy: 0.722278
Average cost in epoch 167: 0.456524
training accuracy: 0.843750     test accuracy: 0.727273
Average cost in epoch 168: 0.446340
training accuracy: 0.906250     test accuracy: 0.708292
Average cost in epoch 169: 0.445048
training accuracy: 0.781250     test accuracy: 0.702298

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 170: 0.446347
training accuracy: 0.750000     test accuracy: 0.714286
Average cost in epoch 171: 0.451343
training accuracy: 0.843750     test accuracy: 0.723277
Average cost in epoch 172: 0.437343
training accuracy: 0.781250     test accuracy: 0.716284
Average cost in epoch 173: 0.440277
training accuracy: 0.875000     test accuracy: 0.716284
Average cost in epoch 174: 0.444544
training accuracy: 0.781250     test accuracy: 0.711289

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 175: 0.452195
training accuracy: 0.750000     test accuracy: 0.708292
Average cost in epoch 176: 0.445037
training accuracy: 0.812500     test accuracy: 0.715285
Average cost in epoch 177: 0.447993
training accuracy: 0.843750     test accuracy: 0.714286
Average cost in epoch 178: 0.445116
training accuracy: 0.687500     test accuracy: 0.718282
Average cost in epoch 179: 0.454415
training accuracy: 0.875000     test accuracy: 0.725275

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 180: 0.445145
training accuracy: 0.812500     test accuracy: 0.718282
Average cost in epoch 181: 0.444597
training accuracy: 0.718750     test accuracy: 0.727273
Average cost in epoch 182: 0.445212
training accuracy: 0.750000     test accuracy: 0.716284
Average cost in epoch 183: 0.442280
training accuracy: 0.781250     test accuracy: 0.715285
Average cost in epoch 184: 0.444591
training accuracy: 0.781250     test accuracy: 0.712288

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 185: 0.447589
training accuracy: 0.781250     test accuracy: 0.713287
Average cost in epoch 186: 0.436411
training accuracy: 0.625000     test accuracy: 0.726274
Average cost in epoch 187: 0.446870
training accuracy: 0.812500     test accuracy: 0.719281
Average cost in epoch 188: 0.442397
training accuracy: 0.750000     test accuracy: 0.718282
Average cost in epoch 189: 0.438901
training accuracy: 0.687500     test accuracy: 0.719281

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 190: 0.435454
training accuracy: 0.750000     test accuracy: 0.704296
Average cost in epoch 191: 0.435156
training accuracy: 0.781250     test accuracy: 0.715285
Average cost in epoch 192: 0.442539
training accuracy: 0.781250     test accuracy: 0.718282
Average cost in epoch 193: 0.436527
training accuracy: 0.812500     test accuracy: 0.708292
Average cost in epoch 194: 0.446124
training accuracy: 0.750000     test accuracy: 0.715285

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Average cost in epoch 195: 0.437399
training accuracy: 0.781250     test accuracy: 0.720280
Average cost in epoch 196: 0.433128
training accuracy: 0.781250     test accuracy: 0.723277
Average cost in epoch 197: 0.445076
training accuracy: 0.875000     test accuracy: 0.715285
Average cost in epoch 198: 0.439977
training accuracy: 0.625000     test accuracy: 0.720280
Average cost in epoch 199: 0.439415
training accuracy: 0.812500     test accuracy: 0.709291

dump to weights/pyramid-lstm/pyramid-lstm_12.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 13, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_13.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 80.90
Starting training...
Average cost in epoch 0: 0.485485
training accuracy: 0.875000     test accuracy: 0.944056
Average cost in epoch 1: 0.359118
training accuracy: 0.968750     test accuracy: 0.944056
Average cost in epoch 2: 0.339044
training accuracy: 0.937500     test accuracy: 0.942058
Average cost in epoch 3: 0.315961
training accuracy: 0.937500     test accuracy: 0.944056
Average cost in epoch 4: 0.298965
training accuracy: 0.906250     test accuracy: 0.944056

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 5: 0.293118
training accuracy: 0.875000     test accuracy: 0.944056
lr decays to 0.009000
Average cost in epoch 6: 0.280318
training accuracy: 0.968750     test accuracy: 0.944056
Average cost in epoch 7: 0.271451
training accuracy: 0.906250     test accuracy: 0.944056
Average cost in epoch 8: 0.264084
training accuracy: 0.937500     test accuracy: 0.944056
Average cost in epoch 9: 0.267838
training accuracy: 0.968750     test accuracy: 0.944056

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 10: 0.264708
training accuracy: 0.875000     test accuracy: 0.944056
lr decays to 0.008100
Average cost in epoch 11: 0.262377
training accuracy: 0.937500     test accuracy: 0.942058
Average cost in epoch 12: 0.257183
training accuracy: 0.968750     test accuracy: 0.944056
Average cost in epoch 13: 0.258694
training accuracy: 0.906250     test accuracy: 0.943057
Average cost in epoch 14: 0.255090
training accuracy: 0.843750     test accuracy: 0.944056

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 15: 0.256071
training accuracy: 0.968750     test accuracy: 0.944056
lr decays to 0.007290
Average cost in epoch 16: 0.247022
training accuracy: 0.937500     test accuracy: 0.944056
Average cost in epoch 17: 0.244264
training accuracy: 0.937500     test accuracy: 0.944056
Average cost in epoch 18: 0.247684
training accuracy: 0.906250     test accuracy: 0.943057
Average cost in epoch 19: 0.252057
training accuracy: 1.000000     test accuracy: 0.943057

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 20: 0.246075
training accuracy: 0.968750     test accuracy: 0.943057
lr decays to 0.006561
Average cost in epoch 21: 0.247380
training accuracy: 0.968750     test accuracy: 0.943057
Average cost in epoch 22: 0.240549
training accuracy: 0.937500     test accuracy: 0.944056
Average cost in epoch 23: 0.242066
training accuracy: 0.875000     test accuracy: 0.944056
Average cost in epoch 24: 0.237553
training accuracy: 1.000000     test accuracy: 0.944056

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 25: 0.241269
training accuracy: 0.906250     test accuracy: 0.941059
lr decays to 0.005905
Average cost in epoch 26: 0.234152
training accuracy: 0.906250     test accuracy: 0.944056
Average cost in epoch 27: 0.236192
training accuracy: 1.000000     test accuracy: 0.943057
Average cost in epoch 28: 0.231647
training accuracy: 0.875000     test accuracy: 0.944056
Average cost in epoch 29: 0.228824
training accuracy: 0.812500     test accuracy: 0.943057

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 30: 0.227666
training accuracy: 0.906250     test accuracy: 0.944056
lr decays to 0.005314
Average cost in epoch 31: 0.225748
training accuracy: 1.000000     test accuracy: 0.943057
Average cost in epoch 32: 0.224267
training accuracy: 0.906250     test accuracy: 0.941059
Average cost in epoch 33: 0.227266
training accuracy: 0.968750     test accuracy: 0.938062
Average cost in epoch 34: 0.221982
training accuracy: 0.968750     test accuracy: 0.942058

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 35: 0.226068
training accuracy: 1.000000     test accuracy: 0.937063
lr decays to 0.004783
Average cost in epoch 36: 0.218676
training accuracy: 0.937500     test accuracy: 0.940060
Average cost in epoch 37: 0.215856
training accuracy: 0.937500     test accuracy: 0.941059
Average cost in epoch 38: 0.219314
training accuracy: 0.906250     test accuracy: 0.940060
Average cost in epoch 39: 0.210240
training accuracy: 0.937500     test accuracy: 0.941059

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 40: 0.216678
training accuracy: 0.968750     test accuracy: 0.940060
lr decays to 0.004305
Average cost in epoch 41: 0.204931
training accuracy: 0.968750     test accuracy: 0.939061
Average cost in epoch 42: 0.204466
training accuracy: 1.000000     test accuracy: 0.939061
Average cost in epoch 43: 0.201606
training accuracy: 0.906250     test accuracy: 0.940060
Average cost in epoch 44: 0.203032
training accuracy: 0.968750     test accuracy: 0.940060

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 45: 0.198315
training accuracy: 0.937500     test accuracy: 0.942058
lr decays to 0.003874
Average cost in epoch 46: 0.195683
training accuracy: 0.843750     test accuracy: 0.940060
Average cost in epoch 47: 0.191426
training accuracy: 0.906250     test accuracy: 0.938062
Average cost in epoch 48: 0.188670
training accuracy: 0.968750     test accuracy: 0.937063
Average cost in epoch 49: 0.186994
training accuracy: 0.937500     test accuracy: 0.940060

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 50: 0.183715
training accuracy: 0.937500     test accuracy: 0.937063
lr decays to 0.003487
Average cost in epoch 51: 0.176804
training accuracy: 0.843750     test accuracy: 0.936064
Average cost in epoch 52: 0.177725
training accuracy: 0.906250     test accuracy: 0.939061
Average cost in epoch 53: 0.176718
training accuracy: 0.968750     test accuracy: 0.935065
Average cost in epoch 54: 0.167618
training accuracy: 1.000000     test accuracy: 0.932068

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 55: 0.172047
training accuracy: 1.000000     test accuracy: 0.940060
lr decays to 0.003138
Average cost in epoch 56: 0.160672
training accuracy: 0.968750     test accuracy: 0.931069
Average cost in epoch 57: 0.162257
training accuracy: 0.937500     test accuracy: 0.936064
Average cost in epoch 58: 0.164088
training accuracy: 0.968750     test accuracy: 0.931069
Average cost in epoch 59: 0.157029
training accuracy: 0.937500     test accuracy: 0.937063

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 60: 0.153333
training accuracy: 0.968750     test accuracy: 0.935065
lr decays to 0.002824
Average cost in epoch 61: 0.150108
training accuracy: 1.000000     test accuracy: 0.934066
Average cost in epoch 62: 0.151226
training accuracy: 0.937500     test accuracy: 0.936064
Average cost in epoch 63: 0.149879
training accuracy: 0.937500     test accuracy: 0.932068
Average cost in epoch 64: 0.144577
training accuracy: 0.937500     test accuracy: 0.932068

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 65: 0.139159
training accuracy: 0.968750     test accuracy: 0.932068
lr decays to 0.002542
Average cost in epoch 66: 0.140138
training accuracy: 1.000000     test accuracy: 0.932068
Average cost in epoch 67: 0.135602
training accuracy: 0.937500     test accuracy: 0.932068
Average cost in epoch 68: 0.128610
training accuracy: 1.000000     test accuracy: 0.926074
Average cost in epoch 69: 0.132497
training accuracy: 1.000000     test accuracy: 0.924076

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 70: 0.126372
training accuracy: 0.906250     test accuracy: 0.928072
lr decays to 0.002288
Average cost in epoch 71: 0.129924
training accuracy: 0.968750     test accuracy: 0.933067
Average cost in epoch 72: 0.124687
training accuracy: 0.968750     test accuracy: 0.928072
Average cost in epoch 73: 0.124064
training accuracy: 1.000000     test accuracy: 0.920080
Average cost in epoch 74: 0.117296
training accuracy: 0.968750     test accuracy: 0.923077

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 75: 0.124492
training accuracy: 0.968750     test accuracy: 0.924076
lr decays to 0.002059
Average cost in epoch 76: 0.116127
training accuracy: 0.968750     test accuracy: 0.926074
Average cost in epoch 77: 0.119382
training accuracy: 0.968750     test accuracy: 0.919081
Average cost in epoch 78: 0.109969
training accuracy: 1.000000     test accuracy: 0.924076
Average cost in epoch 79: 0.110058
training accuracy: 0.906250     test accuracy: 0.918082

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 80: 0.103687
training accuracy: 1.000000     test accuracy: 0.927073
lr decays to 0.001853
Average cost in epoch 81: 0.107298
training accuracy: 0.968750     test accuracy: 0.923077
Average cost in epoch 82: 0.105635
training accuracy: 1.000000     test accuracy: 0.917083
Average cost in epoch 83: 0.103076
training accuracy: 0.937500     test accuracy: 0.914086
Average cost in epoch 84: 0.102214
training accuracy: 1.000000     test accuracy: 0.919081

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 85: 0.101782
training accuracy: 0.968750     test accuracy: 0.908092
lr decays to 0.001668
Average cost in epoch 86: 0.099498
training accuracy: 0.968750     test accuracy: 0.907093
Average cost in epoch 87: 0.102705
training accuracy: 0.968750     test accuracy: 0.903097
Average cost in epoch 88: 0.093808
training accuracy: 0.968750     test accuracy: 0.908092
Average cost in epoch 89: 0.093945
training accuracy: 0.968750     test accuracy: 0.907093

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 90: 0.088597
training accuracy: 1.000000     test accuracy: 0.913087
lr decays to 0.001501
Average cost in epoch 91: 0.088846
training accuracy: 1.000000     test accuracy: 0.917083
Average cost in epoch 92: 0.090111
training accuracy: 1.000000     test accuracy: 0.902098
Average cost in epoch 93: 0.077736
training accuracy: 1.000000     test accuracy: 0.912088
Average cost in epoch 94: 0.088996
training accuracy: 0.968750     test accuracy: 0.905095

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 95: 0.081174
training accuracy: 1.000000     test accuracy: 0.911089
lr decays to 0.001351
Average cost in epoch 96: 0.079924
training accuracy: 0.968750     test accuracy: 0.908092
Average cost in epoch 97: 0.090391
training accuracy: 0.968750     test accuracy: 0.912088
Average cost in epoch 98: 0.074873
training accuracy: 0.968750     test accuracy: 0.909091
Average cost in epoch 99: 0.074499
training accuracy: 1.000000     test accuracy: 0.911089

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 100: 0.080328
training accuracy: 1.000000     test accuracy: 0.910090
lr decays to 0.001216
Average cost in epoch 101: 0.074097
training accuracy: 1.000000     test accuracy: 0.909091
Average cost in epoch 102: 0.068999
training accuracy: 0.906250     test accuracy: 0.910090
Average cost in epoch 103: 0.074269
training accuracy: 1.000000     test accuracy: 0.904096
Average cost in epoch 104: 0.074532
training accuracy: 0.968750     test accuracy: 0.910090

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 105: 0.072633
training accuracy: 0.968750     test accuracy: 0.904096
Average cost in epoch 106: 0.066166
training accuracy: 0.937500     test accuracy: 0.903097
Average cost in epoch 107: 0.074148
training accuracy: 1.000000     test accuracy: 0.908092
Average cost in epoch 108: 0.070328
training accuracy: 1.000000     test accuracy: 0.902098
Average cost in epoch 109: 0.067493
training accuracy: 0.937500     test accuracy: 0.900100

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 110: 0.062872
training accuracy: 1.000000     test accuracy: 0.901099
Average cost in epoch 111: 0.066909
training accuracy: 0.968750     test accuracy: 0.905095
Average cost in epoch 112: 0.069102
training accuracy: 1.000000     test accuracy: 0.903097
Average cost in epoch 113: 0.066929
training accuracy: 0.968750     test accuracy: 0.899101
Average cost in epoch 114: 0.062188
training accuracy: 1.000000     test accuracy: 0.905095

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 115: 0.065329
training accuracy: 1.000000     test accuracy: 0.903097
Average cost in epoch 116: 0.058990
training accuracy: 0.968750     test accuracy: 0.892108
Average cost in epoch 117: 0.061709
training accuracy: 1.000000     test accuracy: 0.897103
Average cost in epoch 118: 0.061071
training accuracy: 1.000000     test accuracy: 0.900100
Average cost in epoch 119: 0.063411
training accuracy: 0.968750     test accuracy: 0.900100

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 120: 0.057019
training accuracy: 1.000000     test accuracy: 0.900100
Average cost in epoch 121: 0.063968
training accuracy: 0.937500     test accuracy: 0.896104
Average cost in epoch 122: 0.062409
training accuracy: 0.968750     test accuracy: 0.903097
Average cost in epoch 123: 0.055031
training accuracy: 0.968750     test accuracy: 0.902098
Average cost in epoch 124: 0.060140
training accuracy: 1.000000     test accuracy: 0.898102

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 125: 0.057264
training accuracy: 0.968750     test accuracy: 0.896104
Average cost in epoch 126: 0.056268
training accuracy: 0.968750     test accuracy: 0.892108
Average cost in epoch 127: 0.056321
training accuracy: 1.000000     test accuracy: 0.896104
Average cost in epoch 128: 0.061691
training accuracy: 1.000000     test accuracy: 0.904096
Average cost in epoch 129: 0.058841
training accuracy: 0.968750     test accuracy: 0.900100

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 130: 0.062854
training accuracy: 1.000000     test accuracy: 0.900100
Average cost in epoch 131: 0.057004
training accuracy: 1.000000     test accuracy: 0.895105
Average cost in epoch 132: 0.055035
training accuracy: 1.000000     test accuracy: 0.894106
Average cost in epoch 133: 0.053322
training accuracy: 0.968750     test accuracy: 0.893107
Average cost in epoch 134: 0.053905
training accuracy: 0.906250     test accuracy: 0.897103

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 135: 0.055336
training accuracy: 1.000000     test accuracy: 0.893107
Average cost in epoch 136: 0.050711
training accuracy: 1.000000     test accuracy: 0.899101
Average cost in epoch 137: 0.057877
training accuracy: 1.000000     test accuracy: 0.898102
Average cost in epoch 138: 0.060856
training accuracy: 1.000000     test accuracy: 0.901099
Average cost in epoch 139: 0.050269
training accuracy: 1.000000     test accuracy: 0.896104

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 140: 0.054185
training accuracy: 1.000000     test accuracy: 0.896104
Average cost in epoch 141: 0.046799
training accuracy: 0.968750     test accuracy: 0.895105
Average cost in epoch 142: 0.050578
training accuracy: 0.968750     test accuracy: 0.896104
Average cost in epoch 143: 0.047348
training accuracy: 1.000000     test accuracy: 0.893107
Average cost in epoch 144: 0.056423
training accuracy: 1.000000     test accuracy: 0.896104

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 145: 0.055392
training accuracy: 0.968750     test accuracy: 0.896104
Average cost in epoch 146: 0.051513
training accuracy: 0.937500     test accuracy: 0.901099
Average cost in epoch 147: 0.057550
training accuracy: 1.000000     test accuracy: 0.896104
Average cost in epoch 148: 0.052504
training accuracy: 1.000000     test accuracy: 0.895105
Average cost in epoch 149: 0.050549
training accuracy: 1.000000     test accuracy: 0.892108

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 150: 0.048387
training accuracy: 1.000000     test accuracy: 0.900100
Average cost in epoch 151: 0.050323
training accuracy: 1.000000     test accuracy: 0.905095
Average cost in epoch 152: 0.048087
training accuracy: 0.968750     test accuracy: 0.901099
Average cost in epoch 153: 0.046847
training accuracy: 1.000000     test accuracy: 0.885115
Average cost in epoch 154: 0.049894
training accuracy: 1.000000     test accuracy: 0.894106

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 155: 0.055267
training accuracy: 1.000000     test accuracy: 0.897103
Average cost in epoch 156: 0.053933
training accuracy: 0.937500     test accuracy: 0.887113
Average cost in epoch 157: 0.043238
training accuracy: 1.000000     test accuracy: 0.895105
Average cost in epoch 158: 0.047790
training accuracy: 0.968750     test accuracy: 0.892108
Average cost in epoch 159: 0.047756
training accuracy: 0.937500     test accuracy: 0.892108

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 160: 0.043405
training accuracy: 0.968750     test accuracy: 0.886114
Average cost in epoch 161: 0.042630
training accuracy: 1.000000     test accuracy: 0.893107
Average cost in epoch 162: 0.046630
training accuracy: 1.000000     test accuracy: 0.902098
Average cost in epoch 163: 0.049338
training accuracy: 1.000000     test accuracy: 0.898102
Average cost in epoch 164: 0.048270
training accuracy: 0.968750     test accuracy: 0.894106

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 165: 0.047412
training accuracy: 1.000000     test accuracy: 0.887113
Average cost in epoch 166: 0.045021
training accuracy: 1.000000     test accuracy: 0.891109
Average cost in epoch 167: 0.044824
training accuracy: 1.000000     test accuracy: 0.897103
Average cost in epoch 168: 0.045810
training accuracy: 1.000000     test accuracy: 0.896104
Average cost in epoch 169: 0.044139
training accuracy: 1.000000     test accuracy: 0.888112

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 170: 0.041783
training accuracy: 1.000000     test accuracy: 0.898102
Average cost in epoch 171: 0.046972
training accuracy: 1.000000     test accuracy: 0.892108
Average cost in epoch 172: 0.049379
training accuracy: 0.968750     test accuracy: 0.901099
Average cost in epoch 173: 0.042979
training accuracy: 1.000000     test accuracy: 0.902098
Average cost in epoch 174: 0.042592
training accuracy: 0.906250     test accuracy: 0.894106

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 175: 0.042829
training accuracy: 1.000000     test accuracy: 0.897103
Average cost in epoch 176: 0.037200
training accuracy: 0.968750     test accuracy: 0.886114
Average cost in epoch 177: 0.041576
training accuracy: 1.000000     test accuracy: 0.897103
Average cost in epoch 178: 0.044598
training accuracy: 1.000000     test accuracy: 0.892108
Average cost in epoch 179: 0.043230
training accuracy: 1.000000     test accuracy: 0.903097

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 180: 0.043473
training accuracy: 0.968750     test accuracy: 0.894106
Average cost in epoch 181: 0.039212
training accuracy: 1.000000     test accuracy: 0.893107
Average cost in epoch 182: 0.045876
training accuracy: 0.968750     test accuracy: 0.897103
Average cost in epoch 183: 0.034485
training accuracy: 1.000000     test accuracy: 0.902098
Average cost in epoch 184: 0.041332
training accuracy: 1.000000     test accuracy: 0.898102

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 185: 0.047656
training accuracy: 1.000000     test accuracy: 0.905095
Average cost in epoch 186: 0.038458
training accuracy: 1.000000     test accuracy: 0.894106
Average cost in epoch 187: 0.039309
training accuracy: 0.937500     test accuracy: 0.896104
Average cost in epoch 188: 0.038085
training accuracy: 0.968750     test accuracy: 0.895105
Average cost in epoch 189: 0.037696
training accuracy: 1.000000     test accuracy: 0.898102

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 190: 0.038954
training accuracy: 1.000000     test accuracy: 0.895105
Average cost in epoch 191: 0.041561
training accuracy: 0.937500     test accuracy: 0.898102
Average cost in epoch 192: 0.046012
training accuracy: 0.968750     test accuracy: 0.898102
Average cost in epoch 193: 0.042615
training accuracy: 1.000000     test accuracy: 0.897103
Average cost in epoch 194: 0.042865
training accuracy: 1.000000     test accuracy: 0.882118

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Average cost in epoch 195: 0.035678
training accuracy: 1.000000     test accuracy: 0.900100
Average cost in epoch 196: 0.038153
training accuracy: 1.000000     test accuracy: 0.904096
Average cost in epoch 197: 0.041995
training accuracy: 1.000000     test accuracy: 0.896104
Average cost in epoch 198: 0.037915
training accuracy: 1.000000     test accuracy: 0.896104
Average cost in epoch 199: 0.042619
training accuracy: 0.875000     test accuracy: 0.898102

dump to weights/pyramid-lstm/pyramid-lstm_13.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 14, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_14.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 89.02
Starting training...
Average cost in epoch 0: 1.782102
training accuracy: 0.250000     test accuracy: 0.341658
Average cost in epoch 1: 1.574900
training accuracy: 0.531250     test accuracy: 0.410589
Average cost in epoch 2: 1.471619
training accuracy: 0.468750     test accuracy: 0.439560
Average cost in epoch 3: 1.405987
training accuracy: 0.375000     test accuracy: 0.434565
Average cost in epoch 4: 1.376219
training accuracy: 0.500000     test accuracy: 0.434565

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 5: 1.343401
training accuracy: 0.343750     test accuracy: 0.445554
lr decays to 0.009000
Average cost in epoch 6: 1.315639
training accuracy: 0.343750     test accuracy: 0.436563
Average cost in epoch 7: 1.305263
training accuracy: 0.500000     test accuracy: 0.471528
Average cost in epoch 8: 1.289647
training accuracy: 0.375000     test accuracy: 0.456543
Average cost in epoch 9: 1.282231
training accuracy: 0.406250     test accuracy: 0.468531

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 10: 1.263090
training accuracy: 0.500000     test accuracy: 0.458541
lr decays to 0.008100
Average cost in epoch 11: 1.254452
training accuracy: 0.531250     test accuracy: 0.469530
Average cost in epoch 12: 1.245461
training accuracy: 0.406250     test accuracy: 0.443556
Average cost in epoch 13: 1.239106
training accuracy: 0.531250     test accuracy: 0.440559
Average cost in epoch 14: 1.233343
training accuracy: 0.375000     test accuracy: 0.440559

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 15: 1.235109
training accuracy: 0.437500     test accuracy: 0.441558
lr decays to 0.007290
Average cost in epoch 16: 1.232356
training accuracy: 0.468750     test accuracy: 0.443556
Average cost in epoch 17: 1.228638
training accuracy: 0.500000     test accuracy: 0.474525
Average cost in epoch 18: 1.218751
training accuracy: 0.406250     test accuracy: 0.454545
Average cost in epoch 19: 1.225512
training accuracy: 0.562500     test accuracy: 0.457542

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 20: 1.220242
training accuracy: 0.500000     test accuracy: 0.463536
lr decays to 0.006561
Average cost in epoch 21: 1.223745
training accuracy: 0.437500     test accuracy: 0.460539
Average cost in epoch 22: 1.212709
training accuracy: 0.437500     test accuracy: 0.467532
Average cost in epoch 23: 1.208825
training accuracy: 0.593750     test accuracy: 0.436563
Average cost in epoch 24: 1.211974
training accuracy: 0.312500     test accuracy: 0.451548

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 25: 1.200016
training accuracy: 0.437500     test accuracy: 0.460539
lr decays to 0.005905
Average cost in epoch 26: 1.205090
training accuracy: 0.468750     test accuracy: 0.471528
Average cost in epoch 27: 1.189017
training accuracy: 0.437500     test accuracy: 0.450549
Average cost in epoch 28: 1.200190
training accuracy: 0.531250     test accuracy: 0.461538
Average cost in epoch 29: 1.192187
training accuracy: 0.406250     test accuracy: 0.451548

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 30: 1.195254
training accuracy: 0.562500     test accuracy: 0.452547
lr decays to 0.005314
Average cost in epoch 31: 1.188951
training accuracy: 0.437500     test accuracy: 0.465534
Average cost in epoch 32: 1.189632
training accuracy: 0.406250     test accuracy: 0.456543
Average cost in epoch 33: 1.185098
training accuracy: 0.500000     test accuracy: 0.472527
Average cost in epoch 34: 1.177164
training accuracy: 0.343750     test accuracy: 0.460539

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 35: 1.177422
training accuracy: 0.437500     test accuracy: 0.470529
lr decays to 0.004783
Average cost in epoch 36: 1.165587
training accuracy: 0.531250     test accuracy: 0.456543
Average cost in epoch 37: 1.177176
training accuracy: 0.656250     test accuracy: 0.472527
Average cost in epoch 38: 1.175675
training accuracy: 0.625000     test accuracy: 0.458541
Average cost in epoch 39: 1.159336
training accuracy: 0.500000     test accuracy: 0.465534

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 40: 1.168798
training accuracy: 0.562500     test accuracy: 0.467532
lr decays to 0.004305
Average cost in epoch 41: 1.162158
training accuracy: 0.437500     test accuracy: 0.466533
Average cost in epoch 42: 1.158414
training accuracy: 0.468750     test accuracy: 0.476523
Average cost in epoch 43: 1.152482
training accuracy: 0.468750     test accuracy: 0.465534
Average cost in epoch 44: 1.155846
training accuracy: 0.500000     test accuracy: 0.471528

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 45: 1.150750
training accuracy: 0.531250     test accuracy: 0.462537
lr decays to 0.003874
Average cost in epoch 46: 1.156891
training accuracy: 0.406250     test accuracy: 0.473526
Average cost in epoch 47: 1.151060
training accuracy: 0.312500     test accuracy: 0.462537
Average cost in epoch 48: 1.154873
training accuracy: 0.437500     test accuracy: 0.461538
Average cost in epoch 49: 1.142720
training accuracy: 0.500000     test accuracy: 0.468531

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 50: 1.143227
training accuracy: 0.375000     test accuracy: 0.469530
lr decays to 0.003487
Average cost in epoch 51: 1.147315
training accuracy: 0.531250     test accuracy: 0.484515
Average cost in epoch 52: 1.145160
training accuracy: 0.406250     test accuracy: 0.467532
Average cost in epoch 53: 1.140705
training accuracy: 0.500000     test accuracy: 0.467532
Average cost in epoch 54: 1.139930
training accuracy: 0.406250     test accuracy: 0.457542

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 55: 1.124954
training accuracy: 0.375000     test accuracy: 0.464535
lr decays to 0.003138
Average cost in epoch 56: 1.128888
training accuracy: 0.562500     test accuracy: 0.461538
Average cost in epoch 57: 1.126044
training accuracy: 0.562500     test accuracy: 0.471528
Average cost in epoch 58: 1.126399
training accuracy: 0.437500     test accuracy: 0.459540
Average cost in epoch 59: 1.129199
training accuracy: 0.531250     test accuracy: 0.466533

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 60: 1.124566
training accuracy: 0.375000     test accuracy: 0.457542
lr decays to 0.002824
Average cost in epoch 61: 1.126224
training accuracy: 0.531250     test accuracy: 0.460539
Average cost in epoch 62: 1.114123
training accuracy: 0.500000     test accuracy: 0.462537
Average cost in epoch 63: 1.117827
training accuracy: 0.562500     test accuracy: 0.475524
Average cost in epoch 64: 1.120610
training accuracy: 0.562500     test accuracy: 0.471528

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 65: 1.115153
training accuracy: 0.656250     test accuracy: 0.472527
lr decays to 0.002542
Average cost in epoch 66: 1.109052
training accuracy: 0.437500     test accuracy: 0.468531
Average cost in epoch 67: 1.113312
training accuracy: 0.531250     test accuracy: 0.453546
Average cost in epoch 68: 1.117869
training accuracy: 0.437500     test accuracy: 0.467532
Average cost in epoch 69: 1.106123
training accuracy: 0.593750     test accuracy: 0.459540

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 70: 1.109475
training accuracy: 0.562500     test accuracy: 0.470529
lr decays to 0.002288
Average cost in epoch 71: 1.101881
training accuracy: 0.468750     test accuracy: 0.463536
Average cost in epoch 72: 1.097914
training accuracy: 0.437500     test accuracy: 0.467532
Average cost in epoch 73: 1.100268
training accuracy: 0.437500     test accuracy: 0.470529
Average cost in epoch 74: 1.099711
training accuracy: 0.593750     test accuracy: 0.467532

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 75: 1.104629
training accuracy: 0.562500     test accuracy: 0.469530
lr decays to 0.002059
Average cost in epoch 76: 1.087595
training accuracy: 0.406250     test accuracy: 0.479520
Average cost in epoch 77: 1.099576
training accuracy: 0.562500     test accuracy: 0.465534
Average cost in epoch 78: 1.093256
training accuracy: 0.500000     test accuracy: 0.460539
Average cost in epoch 79: 1.092086
training accuracy: 0.531250     test accuracy: 0.457542

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 80: 1.094534
training accuracy: 0.375000     test accuracy: 0.453546
lr decays to 0.001853
Average cost in epoch 81: 1.080413
training accuracy: 0.468750     test accuracy: 0.452547
Average cost in epoch 82: 1.088617
training accuracy: 0.531250     test accuracy: 0.467532
Average cost in epoch 83: 1.083125
training accuracy: 0.500000     test accuracy: 0.456543
Average cost in epoch 84: 1.082233
training accuracy: 0.468750     test accuracy: 0.459540

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 85: 1.084372
training accuracy: 0.687500     test accuracy: 0.460539
lr decays to 0.001668
Average cost in epoch 86: 1.070311
training accuracy: 0.406250     test accuracy: 0.466533
Average cost in epoch 87: 1.082144
training accuracy: 0.531250     test accuracy: 0.474525
Average cost in epoch 88: 1.083991
training accuracy: 0.343750     test accuracy: 0.476523
Average cost in epoch 89: 1.078374
training accuracy: 0.750000     test accuracy: 0.459540

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 90: 1.075109
training accuracy: 0.562500     test accuracy: 0.463536
lr decays to 0.001501
Average cost in epoch 91: 1.077186
training accuracy: 0.437500     test accuracy: 0.457542
Average cost in epoch 92: 1.074739
training accuracy: 0.531250     test accuracy: 0.464535
Average cost in epoch 93: 1.072534
training accuracy: 0.468750     test accuracy: 0.457542
Average cost in epoch 94: 1.079407
training accuracy: 0.656250     test accuracy: 0.451548

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 95: 1.058861
training accuracy: 0.375000     test accuracy: 0.463536
lr decays to 0.001351
Average cost in epoch 96: 1.062739
training accuracy: 0.500000     test accuracy: 0.469530
Average cost in epoch 97: 1.068450
training accuracy: 0.593750     test accuracy: 0.454545
Average cost in epoch 98: 1.077430
training accuracy: 0.593750     test accuracy: 0.467532
Average cost in epoch 99: 1.067472
training accuracy: 0.531250     test accuracy: 0.471528

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 100: 1.052287
training accuracy: 0.593750     test accuracy: 0.474525
lr decays to 0.001216
Average cost in epoch 101: 1.060331
training accuracy: 0.593750     test accuracy: 0.479520
Average cost in epoch 102: 1.071304
training accuracy: 0.562500     test accuracy: 0.478521
Average cost in epoch 103: 1.066894
training accuracy: 0.718750     test accuracy: 0.472527
Average cost in epoch 104: 1.056699
training accuracy: 0.562500     test accuracy: 0.468531

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 105: 1.056378
training accuracy: 0.750000     test accuracy: 0.467532
Average cost in epoch 106: 1.054027
training accuracy: 0.656250     test accuracy: 0.468531
Average cost in epoch 107: 1.052866
training accuracy: 0.500000     test accuracy: 0.471528
Average cost in epoch 108: 1.053103
training accuracy: 0.531250     test accuracy: 0.463536
Average cost in epoch 109: 1.055829
training accuracy: 0.562500     test accuracy: 0.461538

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 110: 1.042180
training accuracy: 0.656250     test accuracy: 0.466533
Average cost in epoch 111: 1.049614
training accuracy: 0.656250     test accuracy: 0.461538
Average cost in epoch 112: 1.060100
training accuracy: 0.531250     test accuracy: 0.460539
Average cost in epoch 113: 1.031155
training accuracy: 0.656250     test accuracy: 0.460539
Average cost in epoch 114: 1.048593
training accuracy: 0.593750     test accuracy: 0.458541

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 115: 1.050777
training accuracy: 0.562500     test accuracy: 0.452547
Average cost in epoch 116: 1.048837
training accuracy: 0.500000     test accuracy: 0.447552
Average cost in epoch 117: 1.042619
training accuracy: 0.531250     test accuracy: 0.454545
Average cost in epoch 118: 1.061069
training accuracy: 0.500000     test accuracy: 0.460539
Average cost in epoch 119: 1.059753
training accuracy: 0.437500     test accuracy: 0.456543

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 120: 1.040663
training accuracy: 0.468750     test accuracy: 0.461538
Average cost in epoch 121: 1.054153
training accuracy: 0.437500     test accuracy: 0.453546
Average cost in epoch 122: 1.048753
training accuracy: 0.687500     test accuracy: 0.452547
Average cost in epoch 123: 1.039216
training accuracy: 0.468750     test accuracy: 0.449550
Average cost in epoch 124: 1.041837
training accuracy: 0.531250     test accuracy: 0.449550

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 125: 1.036282
training accuracy: 0.656250     test accuracy: 0.448551
Average cost in epoch 126: 1.047074
training accuracy: 0.468750     test accuracy: 0.447552
Average cost in epoch 127: 1.038783
training accuracy: 0.562500     test accuracy: 0.450549
Average cost in epoch 128: 1.050133
training accuracy: 0.406250     test accuracy: 0.461538
Average cost in epoch 129: 1.037624
training accuracy: 0.531250     test accuracy: 0.461538

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 130: 1.034068
training accuracy: 0.468750     test accuracy: 0.456543
Average cost in epoch 131: 1.042333
training accuracy: 0.406250     test accuracy: 0.449550
Average cost in epoch 132: 1.044053
training accuracy: 0.718750     test accuracy: 0.453546
Average cost in epoch 133: 1.030193
training accuracy: 0.593750     test accuracy: 0.448551
Average cost in epoch 134: 1.040060
training accuracy: 0.531250     test accuracy: 0.458541

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 135: 1.035639
training accuracy: 0.500000     test accuracy: 0.456543
Average cost in epoch 136: 1.028089
training accuracy: 0.500000     test accuracy: 0.451548
Average cost in epoch 137: 1.038656
training accuracy: 0.500000     test accuracy: 0.462537
Average cost in epoch 138: 1.045371
training accuracy: 0.625000     test accuracy: 0.453546
Average cost in epoch 139: 1.028189
training accuracy: 0.593750     test accuracy: 0.455544

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 140: 1.040087
training accuracy: 0.593750     test accuracy: 0.451548
Average cost in epoch 141: 1.031292
training accuracy: 0.562500     test accuracy: 0.445554
Average cost in epoch 142: 1.030116
training accuracy: 0.656250     test accuracy: 0.459540
Average cost in epoch 143: 1.033654
training accuracy: 0.687500     test accuracy: 0.456543
Average cost in epoch 144: 1.030231
training accuracy: 0.625000     test accuracy: 0.444555

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 145: 1.031930
training accuracy: 0.562500     test accuracy: 0.461538
Average cost in epoch 146: 1.031513
training accuracy: 0.468750     test accuracy: 0.456543
Average cost in epoch 147: 1.040183
training accuracy: 0.562500     test accuracy: 0.452547
Average cost in epoch 148: 1.033664
training accuracy: 0.437500     test accuracy: 0.457542
Average cost in epoch 149: 1.024804
training accuracy: 0.593750     test accuracy: 0.449550

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 150: 1.036693
training accuracy: 0.625000     test accuracy: 0.462537
Average cost in epoch 151: 1.030387
training accuracy: 0.593750     test accuracy: 0.449550
Average cost in epoch 152: 1.027482
training accuracy: 0.687500     test accuracy: 0.451548
Average cost in epoch 153: 1.031683
training accuracy: 0.593750     test accuracy: 0.449550
Average cost in epoch 154: 1.019292
training accuracy: 0.375000     test accuracy: 0.441558

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 155: 1.043859
training accuracy: 0.562500     test accuracy: 0.450549
Average cost in epoch 156: 1.021303
training accuracy: 0.562500     test accuracy: 0.454545
Average cost in epoch 157: 1.023470
training accuracy: 0.593750     test accuracy: 0.453546
Average cost in epoch 158: 1.016979
training accuracy: 0.625000     test accuracy: 0.456543
Average cost in epoch 159: 1.023507
training accuracy: 0.531250     test accuracy: 0.444555

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 160: 1.027515
training accuracy: 0.718750     test accuracy: 0.436563
Average cost in epoch 161: 1.012868
training accuracy: 0.468750     test accuracy: 0.440559
Average cost in epoch 162: 1.019071
training accuracy: 0.406250     test accuracy: 0.453546
Average cost in epoch 163: 1.020501
training accuracy: 0.718750     test accuracy: 0.442557
Average cost in epoch 164: 1.030107
training accuracy: 0.656250     test accuracy: 0.435564

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 165: 1.031912
training accuracy: 0.343750     test accuracy: 0.448551
Average cost in epoch 166: 1.023090
training accuracy: 0.656250     test accuracy: 0.442557
Average cost in epoch 167: 1.026677
training accuracy: 0.437500     test accuracy: 0.453546
Average cost in epoch 168: 1.015897
training accuracy: 0.593750     test accuracy: 0.453546
Average cost in epoch 169: 1.024533
training accuracy: 0.531250     test accuracy: 0.448551

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 170: 1.020502
training accuracy: 0.375000     test accuracy: 0.446553
Average cost in epoch 171: 1.020937
training accuracy: 0.593750     test accuracy: 0.457542
Average cost in epoch 172: 1.034312
training accuracy: 0.593750     test accuracy: 0.437562
Average cost in epoch 173: 1.025936
training accuracy: 0.531250     test accuracy: 0.443556
Average cost in epoch 174: 1.011241
training accuracy: 0.687500     test accuracy: 0.445554

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 175: 1.028219
training accuracy: 0.500000     test accuracy: 0.449550
Average cost in epoch 176: 1.019203
training accuracy: 0.531250     test accuracy: 0.441558
Average cost in epoch 177: 1.026648
training accuracy: 0.625000     test accuracy: 0.447552
Average cost in epoch 178: 1.023779
training accuracy: 0.625000     test accuracy: 0.434565
Average cost in epoch 179: 1.016860
training accuracy: 0.437500     test accuracy: 0.442557

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 180: 1.012183
training accuracy: 0.562500     test accuracy: 0.439560
Average cost in epoch 181: 1.026033
training accuracy: 0.593750     test accuracy: 0.443556
Average cost in epoch 182: 1.018476
training accuracy: 0.593750     test accuracy: 0.456543
Average cost in epoch 183: 1.023728
training accuracy: 0.343750     test accuracy: 0.451548
Average cost in epoch 184: 1.010325
training accuracy: 0.656250     test accuracy: 0.444555

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 185: 1.024773
training accuracy: 0.687500     test accuracy: 0.445554
Average cost in epoch 186: 1.008963
training accuracy: 0.656250     test accuracy: 0.443556
Average cost in epoch 187: 1.015404
training accuracy: 0.375000     test accuracy: 0.450549
Average cost in epoch 188: 1.022350
training accuracy: 0.593750     test accuracy: 0.453546
Average cost in epoch 189: 1.027234
training accuracy: 0.562500     test accuracy: 0.445554

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 190: 1.012952
training accuracy: 0.531250     test accuracy: 0.446553
Average cost in epoch 191: 1.009972
training accuracy: 0.437500     test accuracy: 0.449550
Average cost in epoch 192: 1.014862
training accuracy: 0.468750     test accuracy: 0.440559
Average cost in epoch 193: 1.014744
training accuracy: 0.562500     test accuracy: 0.452547
Average cost in epoch 194: 1.014351
training accuracy: 0.625000     test accuracy: 0.442557

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Average cost in epoch 195: 1.014048
training accuracy: 0.562500     test accuracy: 0.448551
Average cost in epoch 196: 1.011809
training accuracy: 0.625000     test accuracy: 0.449550
Average cost in epoch 197: 1.017546
training accuracy: 0.687500     test accuracy: 0.448551
Average cost in epoch 198: 1.010471
training accuracy: 0.500000     test accuracy: 0.445554
Average cost in epoch 199: 1.002557
training accuracy: 0.656250     test accuracy: 0.435564

dump to weights/pyramid-lstm/pyramid-lstm_14.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 15, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_15.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 81.11
Starting training...
Average cost in epoch 0: 1.435090
training accuracy: 0.343750     test accuracy: 0.212787
Average cost in epoch 1: 1.299639
training accuracy: 0.406250     test accuracy: 0.431568
Average cost in epoch 2: 1.240741
training accuracy: 0.406250     test accuracy: 0.450549
Average cost in epoch 3: 1.229609
training accuracy: 0.437500     test accuracy: 0.481518
Average cost in epoch 4: 1.136858
training accuracy: 0.687500     test accuracy: 0.537463

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 5: 1.021648
training accuracy: 0.468750     test accuracy: 0.597403
lr decays to 0.009000
Average cost in epoch 6: 0.960869
training accuracy: 0.531250     test accuracy: 0.578422
Average cost in epoch 7: 0.932520
training accuracy: 0.593750     test accuracy: 0.578422
Average cost in epoch 8: 0.914485
training accuracy: 0.468750     test accuracy: 0.581419
Average cost in epoch 9: 0.897778
training accuracy: 0.625000     test accuracy: 0.602398

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 10: 0.888806
training accuracy: 0.406250     test accuracy: 0.593407
lr decays to 0.008100
Average cost in epoch 11: 0.881000
training accuracy: 0.593750     test accuracy: 0.597403
Average cost in epoch 12: 0.880442
training accuracy: 0.562500     test accuracy: 0.603397
Average cost in epoch 13: 0.865112
training accuracy: 0.625000     test accuracy: 0.576424
Average cost in epoch 14: 0.868559
training accuracy: 0.593750     test accuracy: 0.571429

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 15: 0.857560
training accuracy: 0.718750     test accuracy: 0.577423
lr decays to 0.007290
Average cost in epoch 16: 0.846398
training accuracy: 0.718750     test accuracy: 0.578422
Average cost in epoch 17: 0.846913
training accuracy: 0.593750     test accuracy: 0.564436
Average cost in epoch 18: 0.845394
training accuracy: 0.593750     test accuracy: 0.579421
Average cost in epoch 19: 0.841854
training accuracy: 0.406250     test accuracy: 0.573427

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 20: 0.831106
training accuracy: 0.656250     test accuracy: 0.576424
lr decays to 0.006561
Average cost in epoch 21: 0.833261
training accuracy: 0.562500     test accuracy: 0.590410
Average cost in epoch 22: 0.824183
training accuracy: 0.562500     test accuracy: 0.584416
Average cost in epoch 23: 0.814418
training accuracy: 0.875000     test accuracy: 0.575425
Average cost in epoch 24: 0.822194
training accuracy: 0.750000     test accuracy: 0.579421

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 25: 0.810912
training accuracy: 0.562500     test accuracy: 0.566434
lr decays to 0.005905
Average cost in epoch 26: 0.803366
training accuracy: 0.375000     test accuracy: 0.585415
Average cost in epoch 27: 0.800182
training accuracy: 0.562500     test accuracy: 0.554446
Average cost in epoch 28: 0.804051
training accuracy: 0.593750     test accuracy: 0.565435
Average cost in epoch 29: 0.799894
training accuracy: 0.781250     test accuracy: 0.580420

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 30: 0.806831
training accuracy: 0.500000     test accuracy: 0.576424
lr decays to 0.005314
Average cost in epoch 31: 0.790287
training accuracy: 0.656250     test accuracy: 0.586414
Average cost in epoch 32: 0.778955
training accuracy: 0.781250     test accuracy: 0.565435
Average cost in epoch 33: 0.782229
training accuracy: 0.718750     test accuracy: 0.563437
Average cost in epoch 34: 0.790559
training accuracy: 0.593750     test accuracy: 0.576424

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 35: 0.778275
training accuracy: 0.656250     test accuracy: 0.563437
lr decays to 0.004783
Average cost in epoch 36: 0.782001
training accuracy: 0.687500     test accuracy: 0.565435
Average cost in epoch 37: 0.775235
training accuracy: 0.656250     test accuracy: 0.576424
Average cost in epoch 38: 0.774411
training accuracy: 0.625000     test accuracy: 0.568432
Average cost in epoch 39: 0.766787
training accuracy: 0.656250     test accuracy: 0.569431

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 40: 0.773093
training accuracy: 0.625000     test accuracy: 0.581419
lr decays to 0.004305
Average cost in epoch 41: 0.762905
training accuracy: 0.562500     test accuracy: 0.555445
Average cost in epoch 42: 0.764991
training accuracy: 0.687500     test accuracy: 0.579421
Average cost in epoch 43: 0.760240
training accuracy: 0.750000     test accuracy: 0.573427
Average cost in epoch 44: 0.758483
training accuracy: 0.625000     test accuracy: 0.572428

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 45: 0.749477
training accuracy: 0.437500     test accuracy: 0.583417
lr decays to 0.003874
Average cost in epoch 46: 0.751095
training accuracy: 0.531250     test accuracy: 0.577423
Average cost in epoch 47: 0.750156
training accuracy: 0.531250     test accuracy: 0.579421
Average cost in epoch 48: 0.741626
training accuracy: 0.687500     test accuracy: 0.573427
Average cost in epoch 49: 0.744495
training accuracy: 0.781250     test accuracy: 0.587413

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 50: 0.742426
training accuracy: 0.687500     test accuracy: 0.567433
lr decays to 0.003487
Average cost in epoch 51: 0.738646
training accuracy: 0.687500     test accuracy: 0.576424
Average cost in epoch 52: 0.735739
training accuracy: 0.656250     test accuracy: 0.577423
Average cost in epoch 53: 0.738515
training accuracy: 0.750000     test accuracy: 0.562438
Average cost in epoch 54: 0.729889
training accuracy: 0.562500     test accuracy: 0.561439

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 55: 0.733336
training accuracy: 0.625000     test accuracy: 0.555445
lr decays to 0.003138
Average cost in epoch 56: 0.732889
training accuracy: 0.687500     test accuracy: 0.558442
Average cost in epoch 57: 0.726288
training accuracy: 0.531250     test accuracy: 0.564436
Average cost in epoch 58: 0.720274
training accuracy: 0.656250     test accuracy: 0.554446
Average cost in epoch 59: 0.720875
training accuracy: 0.656250     test accuracy: 0.555445

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 60: 0.730831
training accuracy: 0.406250     test accuracy: 0.545455
lr decays to 0.002824
Average cost in epoch 61: 0.719136
training accuracy: 0.656250     test accuracy: 0.551449
Average cost in epoch 62: 0.717571
training accuracy: 0.687500     test accuracy: 0.540460
Average cost in epoch 63: 0.723662
training accuracy: 0.718750     test accuracy: 0.552448
Average cost in epoch 64: 0.715350
training accuracy: 0.593750     test accuracy: 0.575425

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 65: 0.710145
training accuracy: 0.687500     test accuracy: 0.562438
lr decays to 0.002542
Average cost in epoch 66: 0.711720
training accuracy: 0.718750     test accuracy: 0.542458
Average cost in epoch 67: 0.705199
training accuracy: 0.687500     test accuracy: 0.561439
Average cost in epoch 68: 0.714405
training accuracy: 0.687500     test accuracy: 0.568432
Average cost in epoch 69: 0.716204
training accuracy: 0.718750     test accuracy: 0.549451

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 70: 0.715045
training accuracy: 0.718750     test accuracy: 0.552448
lr decays to 0.002288
Average cost in epoch 71: 0.700512
training accuracy: 0.687500     test accuracy: 0.572428
Average cost in epoch 72: 0.704196
training accuracy: 0.843750     test accuracy: 0.566434
Average cost in epoch 73: 0.705437
training accuracy: 0.687500     test accuracy: 0.557443
Average cost in epoch 74: 0.700192
training accuracy: 0.812500     test accuracy: 0.570430

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 75: 0.705464
training accuracy: 0.625000     test accuracy: 0.566434
lr decays to 0.002059
Average cost in epoch 76: 0.697265
training accuracy: 0.687500     test accuracy: 0.561439
Average cost in epoch 77: 0.691622
training accuracy: 0.750000     test accuracy: 0.572428
Average cost in epoch 78: 0.698631
training accuracy: 0.781250     test accuracy: 0.550450
Average cost in epoch 79: 0.691637
training accuracy: 0.687500     test accuracy: 0.547453

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 80: 0.684429
training accuracy: 0.625000     test accuracy: 0.546454
lr decays to 0.001853
Average cost in epoch 81: 0.696624
training accuracy: 0.562500     test accuracy: 0.565435
Average cost in epoch 82: 0.685331
training accuracy: 0.718750     test accuracy: 0.559441
Average cost in epoch 83: 0.690668
training accuracy: 0.781250     test accuracy: 0.553447
Average cost in epoch 84: 0.683138
training accuracy: 0.593750     test accuracy: 0.553447

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 85: 0.687965
training accuracy: 0.750000     test accuracy: 0.559441
lr decays to 0.001668
Average cost in epoch 86: 0.686420
training accuracy: 0.812500     test accuracy: 0.552448
Average cost in epoch 87: 0.671376
training accuracy: 0.687500     test accuracy: 0.555445
Average cost in epoch 88: 0.682239
training accuracy: 0.593750     test accuracy: 0.558442
Average cost in epoch 89: 0.688518
training accuracy: 0.687500     test accuracy: 0.548452

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 90: 0.681307
training accuracy: 0.562500     test accuracy: 0.545455
lr decays to 0.001501
Average cost in epoch 91: 0.679613
training accuracy: 0.812500     test accuracy: 0.539461
Average cost in epoch 92: 0.673314
training accuracy: 0.625000     test accuracy: 0.538462
Average cost in epoch 93: 0.673925
training accuracy: 0.562500     test accuracy: 0.545455
Average cost in epoch 94: 0.676716
training accuracy: 0.562500     test accuracy: 0.533467

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 95: 0.678846
training accuracy: 0.687500     test accuracy: 0.544456
lr decays to 0.001351
Average cost in epoch 96: 0.674752
training accuracy: 0.500000     test accuracy: 0.541459
Average cost in epoch 97: 0.664626
training accuracy: 0.593750     test accuracy: 0.541459
Average cost in epoch 98: 0.666214
training accuracy: 0.562500     test accuracy: 0.545455
Average cost in epoch 99: 0.673123
training accuracy: 0.750000     test accuracy: 0.540460

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 100: 0.670120
training accuracy: 0.750000     test accuracy: 0.559441
lr decays to 0.001216
Average cost in epoch 101: 0.666570
training accuracy: 0.531250     test accuracy: 0.545455
Average cost in epoch 102: 0.669832
training accuracy: 0.625000     test accuracy: 0.541459
Average cost in epoch 103: 0.673735
training accuracy: 0.656250     test accuracy: 0.548452
Average cost in epoch 104: 0.667721
training accuracy: 0.781250     test accuracy: 0.546454

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 105: 0.668125
training accuracy: 0.781250     test accuracy: 0.540460
Average cost in epoch 106: 0.665315
training accuracy: 0.687500     test accuracy: 0.550450
Average cost in epoch 107: 0.662330
training accuracy: 0.593750     test accuracy: 0.557443
Average cost in epoch 108: 0.676092
training accuracy: 0.625000     test accuracy: 0.554446
Average cost in epoch 109: 0.668451
training accuracy: 0.750000     test accuracy: 0.538462

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 110: 0.659896
training accuracy: 0.625000     test accuracy: 0.534466
Average cost in epoch 111: 0.658219
training accuracy: 0.687500     test accuracy: 0.536464
Average cost in epoch 112: 0.666731
training accuracy: 0.750000     test accuracy: 0.553447
Average cost in epoch 113: 0.673890
training accuracy: 0.843750     test accuracy: 0.545455
Average cost in epoch 114: 0.665734
training accuracy: 0.750000     test accuracy: 0.528472

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 115: 0.666899
training accuracy: 0.687500     test accuracy: 0.537463
Average cost in epoch 116: 0.663363
training accuracy: 0.687500     test accuracy: 0.529471
Average cost in epoch 117: 0.657833
training accuracy: 0.625000     test accuracy: 0.518482
Average cost in epoch 118: 0.661720
training accuracy: 0.687500     test accuracy: 0.528472
Average cost in epoch 119: 0.657162
training accuracy: 0.718750     test accuracy: 0.534466

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 120: 0.668030
training accuracy: 0.718750     test accuracy: 0.545455
Average cost in epoch 121: 0.659604
training accuracy: 0.656250     test accuracy: 0.535465
Average cost in epoch 122: 0.661300
training accuracy: 0.718750     test accuracy: 0.554446
Average cost in epoch 123: 0.655779
training accuracy: 0.750000     test accuracy: 0.564436
Average cost in epoch 124: 0.660832
training accuracy: 0.781250     test accuracy: 0.560440

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 125: 0.661715
training accuracy: 0.656250     test accuracy: 0.555445
Average cost in epoch 126: 0.664351
training accuracy: 0.500000     test accuracy: 0.559441
Average cost in epoch 127: 0.662482
training accuracy: 0.593750     test accuracy: 0.532468
Average cost in epoch 128: 0.653575
training accuracy: 0.687500     test accuracy: 0.541459
Average cost in epoch 129: 0.661577
training accuracy: 0.562500     test accuracy: 0.554446

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 130: 0.653429
training accuracy: 0.531250     test accuracy: 0.534466
Average cost in epoch 131: 0.655275
training accuracy: 0.750000     test accuracy: 0.552448
Average cost in epoch 132: 0.654478
training accuracy: 0.562500     test accuracy: 0.560440
Average cost in epoch 133: 0.658140
training accuracy: 0.562500     test accuracy: 0.555445
Average cost in epoch 134: 0.652747
training accuracy: 0.750000     test accuracy: 0.545455

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 135: 0.660904
training accuracy: 0.656250     test accuracy: 0.549451
Average cost in epoch 136: 0.654090
training accuracy: 0.687500     test accuracy: 0.542458
Average cost in epoch 137: 0.661042
training accuracy: 0.781250     test accuracy: 0.546454
Average cost in epoch 138: 0.663080
training accuracy: 0.718750     test accuracy: 0.537463
Average cost in epoch 139: 0.658576
training accuracy: 0.781250     test accuracy: 0.556444

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 140: 0.652745
training accuracy: 0.687500     test accuracy: 0.554446
Average cost in epoch 141: 0.650468
training accuracy: 0.593750     test accuracy: 0.555445
Average cost in epoch 142: 0.656691
training accuracy: 0.656250     test accuracy: 0.544456
Average cost in epoch 143: 0.654401
training accuracy: 0.781250     test accuracy: 0.556444
Average cost in epoch 144: 0.657412
training accuracy: 0.656250     test accuracy: 0.553447

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 145: 0.654892
training accuracy: 0.656250     test accuracy: 0.557443
Average cost in epoch 146: 0.650717
training accuracy: 0.718750     test accuracy: 0.559441
Average cost in epoch 147: 0.656827
training accuracy: 0.625000     test accuracy: 0.551449
Average cost in epoch 148: 0.651539
training accuracy: 0.718750     test accuracy: 0.544456
Average cost in epoch 149: 0.652140
training accuracy: 0.750000     test accuracy: 0.549451

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 150: 0.659655
training accuracy: 0.781250     test accuracy: 0.551449
Average cost in epoch 151: 0.653895
training accuracy: 0.562500     test accuracy: 0.559441
Average cost in epoch 152: 0.653056
training accuracy: 0.781250     test accuracy: 0.536464
Average cost in epoch 153: 0.659103
training accuracy: 0.781250     test accuracy: 0.536464
Average cost in epoch 154: 0.646588
training accuracy: 0.656250     test accuracy: 0.540460

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 155: 0.650427
training accuracy: 0.625000     test accuracy: 0.551449
Average cost in epoch 156: 0.655294
training accuracy: 0.656250     test accuracy: 0.540460
Average cost in epoch 157: 0.655908
training accuracy: 0.625000     test accuracy: 0.539461
Average cost in epoch 158: 0.655270
training accuracy: 0.531250     test accuracy: 0.544456
Average cost in epoch 159: 0.650990
training accuracy: 0.718750     test accuracy: 0.548452

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 160: 0.653245
training accuracy: 0.718750     test accuracy: 0.553447
Average cost in epoch 161: 0.649962
training accuracy: 0.625000     test accuracy: 0.533467
Average cost in epoch 162: 0.653397
training accuracy: 0.781250     test accuracy: 0.545455
Average cost in epoch 163: 0.650570
training accuracy: 0.718750     test accuracy: 0.555445
Average cost in epoch 164: 0.649895
training accuracy: 0.750000     test accuracy: 0.526474

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 165: 0.657375
training accuracy: 0.750000     test accuracy: 0.531469
Average cost in epoch 166: 0.646502
training accuracy: 0.750000     test accuracy: 0.540460
Average cost in epoch 167: 0.662559
training accuracy: 0.687500     test accuracy: 0.535465
Average cost in epoch 168: 0.647542
training accuracy: 0.656250     test accuracy: 0.548452
Average cost in epoch 169: 0.654704
training accuracy: 0.625000     test accuracy: 0.542458

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 170: 0.647364
training accuracy: 0.750000     test accuracy: 0.560440
Average cost in epoch 171: 0.653787
training accuracy: 0.718750     test accuracy: 0.543457
Average cost in epoch 172: 0.644395
training accuracy: 0.656250     test accuracy: 0.542458
Average cost in epoch 173: 0.651172
training accuracy: 0.593750     test accuracy: 0.551449
Average cost in epoch 174: 0.650727
training accuracy: 0.656250     test accuracy: 0.543457

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 175: 0.642690
training accuracy: 0.500000     test accuracy: 0.545455
Average cost in epoch 176: 0.657067
training accuracy: 0.687500     test accuracy: 0.524476
Average cost in epoch 177: 0.641366
training accuracy: 0.718750     test accuracy: 0.546454
Average cost in epoch 178: 0.655575
training accuracy: 0.718750     test accuracy: 0.554446
Average cost in epoch 179: 0.648469
training accuracy: 0.781250     test accuracy: 0.536464

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 180: 0.654361
training accuracy: 0.625000     test accuracy: 0.560440
Average cost in epoch 181: 0.639111
training accuracy: 0.687500     test accuracy: 0.539461
Average cost in epoch 182: 0.638620
training accuracy: 0.687500     test accuracy: 0.545455
Average cost in epoch 183: 0.654269
training accuracy: 0.750000     test accuracy: 0.558442
Average cost in epoch 184: 0.657142
training accuracy: 0.593750     test accuracy: 0.531469

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 185: 0.641879
training accuracy: 0.625000     test accuracy: 0.548452
Average cost in epoch 186: 0.648520
training accuracy: 0.656250     test accuracy: 0.546454
Average cost in epoch 187: 0.645489
training accuracy: 0.625000     test accuracy: 0.541459
Average cost in epoch 188: 0.649709
training accuracy: 0.781250     test accuracy: 0.541459
Average cost in epoch 189: 0.648594
training accuracy: 0.718750     test accuracy: 0.548452

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 190: 0.645348
training accuracy: 0.687500     test accuracy: 0.542458
Average cost in epoch 191: 0.639728
training accuracy: 0.625000     test accuracy: 0.554446
Average cost in epoch 192: 0.650069
training accuracy: 0.656250     test accuracy: 0.555445
Average cost in epoch 193: 0.651879
training accuracy: 0.687500     test accuracy: 0.561439
Average cost in epoch 194: 0.648963
training accuracy: 0.750000     test accuracy: 0.537463

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Average cost in epoch 195: 0.641904
training accuracy: 0.687500     test accuracy: 0.537463
Average cost in epoch 196: 0.639121
training accuracy: 0.718750     test accuracy: 0.543457
Average cost in epoch 197: 0.644480
training accuracy: 0.656250     test accuracy: 0.544456
Average cost in epoch 198: 0.647155
training accuracy: 0.687500     test accuracy: 0.546454
Average cost in epoch 199: 0.641085
training accuracy: 0.687500     test accuracy: 0.533467

dump to weights/pyramid-lstm/pyramid-lstm_15.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 16, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_16.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 78.19
Starting training...
Average cost in epoch 0: 1.246171
training accuracy: 0.406250     test accuracy: 0.490509
Average cost in epoch 1: 0.997277
training accuracy: 0.406250     test accuracy: 0.461538
Average cost in epoch 2: 0.944619
training accuracy: 0.406250     test accuracy: 0.469530
Average cost in epoch 3: 0.923306
training accuracy: 0.593750     test accuracy: 0.487512
Average cost in epoch 4: 0.916091
training accuracy: 0.531250     test accuracy: 0.479520

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 5: 0.916989
training accuracy: 0.468750     test accuracy: 0.469530
lr decays to 0.009000
Average cost in epoch 6: 0.904799
training accuracy: 0.500000     test accuracy: 0.497502
Average cost in epoch 7: 0.899995
training accuracy: 0.562500     test accuracy: 0.469530
Average cost in epoch 8: 0.895895
training accuracy: 0.531250     test accuracy: 0.480519
Average cost in epoch 9: 0.895784
training accuracy: 0.468750     test accuracy: 0.457542

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 10: 0.892160
training accuracy: 0.406250     test accuracy: 0.463536
lr decays to 0.008100
Average cost in epoch 11: 0.890461
training accuracy: 0.468750     test accuracy: 0.479520
Average cost in epoch 12: 0.886394
training accuracy: 0.375000     test accuracy: 0.486513
Average cost in epoch 13: 0.885440
training accuracy: 0.593750     test accuracy: 0.473526
Average cost in epoch 14: 0.887917
training accuracy: 0.531250     test accuracy: 0.481518

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 15: 0.880174
training accuracy: 0.312500     test accuracy: 0.452547
lr decays to 0.007290
Average cost in epoch 16: 0.880702
training accuracy: 0.218750     test accuracy: 0.474525
Average cost in epoch 17: 0.877389
training accuracy: 0.562500     test accuracy: 0.479520
Average cost in epoch 18: 0.876309
training accuracy: 0.531250     test accuracy: 0.482517
Average cost in epoch 19: 0.872432
training accuracy: 0.531250     test accuracy: 0.468531

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 20: 0.874079
training accuracy: 0.531250     test accuracy: 0.486513
lr decays to 0.006561
Average cost in epoch 21: 0.872741
training accuracy: 0.500000     test accuracy: 0.471528
Average cost in epoch 22: 0.869687
training accuracy: 0.437500     test accuracy: 0.485514
Average cost in epoch 23: 0.863711
training accuracy: 0.687500     test accuracy: 0.489510
Average cost in epoch 24: 0.862232
training accuracy: 0.531250     test accuracy: 0.507493

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 25: 0.858650
training accuracy: 0.406250     test accuracy: 0.478521
lr decays to 0.005905
Average cost in epoch 26: 0.855022
training accuracy: 0.625000     test accuracy: 0.488511
Average cost in epoch 27: 0.858710
training accuracy: 0.437500     test accuracy: 0.498501
Average cost in epoch 28: 0.853201
training accuracy: 0.531250     test accuracy: 0.487512
Average cost in epoch 29: 0.856961
training accuracy: 0.625000     test accuracy: 0.477522

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 30: 0.848738
training accuracy: 0.593750     test accuracy: 0.478521
lr decays to 0.005314
Average cost in epoch 31: 0.852406
training accuracy: 0.468750     test accuracy: 0.480519
Average cost in epoch 32: 0.847038
training accuracy: 0.750000     test accuracy: 0.479520
Average cost in epoch 33: 0.845570
training accuracy: 0.500000     test accuracy: 0.487512
Average cost in epoch 34: 0.838586
training accuracy: 0.500000     test accuracy: 0.491508

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 35: 0.834533
training accuracy: 0.468750     test accuracy: 0.480519
lr decays to 0.004783
Average cost in epoch 36: 0.830825
training accuracy: 0.687500     test accuracy: 0.471528
Average cost in epoch 37: 0.832289
training accuracy: 0.375000     test accuracy: 0.496503
Average cost in epoch 38: 0.821972
training accuracy: 0.531250     test accuracy: 0.475524
Average cost in epoch 39: 0.825164
training accuracy: 0.562500     test accuracy: 0.484515

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 40: 0.823753
training accuracy: 0.593750     test accuracy: 0.484515
lr decays to 0.004305
Average cost in epoch 41: 0.814226
training accuracy: 0.500000     test accuracy: 0.475524
Average cost in epoch 42: 0.818675
training accuracy: 0.593750     test accuracy: 0.486513
Average cost in epoch 43: 0.810454
training accuracy: 0.718750     test accuracy: 0.479520
Average cost in epoch 44: 0.804917
training accuracy: 0.500000     test accuracy: 0.500500

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 45: 0.807370
training accuracy: 0.406250     test accuracy: 0.462537
lr decays to 0.003874
Average cost in epoch 46: 0.806875
training accuracy: 0.687500     test accuracy: 0.490509
Average cost in epoch 47: 0.796329
training accuracy: 0.625000     test accuracy: 0.467532
Average cost in epoch 48: 0.801436
training accuracy: 0.562500     test accuracy: 0.487512
Average cost in epoch 49: 0.794075
training accuracy: 0.437500     test accuracy: 0.473526

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 50: 0.794389
training accuracy: 0.500000     test accuracy: 0.471528
lr decays to 0.003487
Average cost in epoch 51: 0.791816
training accuracy: 0.593750     test accuracy: 0.482517
Average cost in epoch 52: 0.788805
training accuracy: 0.562500     test accuracy: 0.471528
Average cost in epoch 53: 0.781199
training accuracy: 0.750000     test accuracy: 0.483516
Average cost in epoch 54: 0.779698
training accuracy: 0.718750     test accuracy: 0.465534

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 55: 0.784142
training accuracy: 0.531250     test accuracy: 0.474525
lr decays to 0.003138
Average cost in epoch 56: 0.780647
training accuracy: 0.625000     test accuracy: 0.458541
Average cost in epoch 57: 0.771419
training accuracy: 0.593750     test accuracy: 0.467532
Average cost in epoch 58: 0.764557
training accuracy: 0.593750     test accuracy: 0.471528
Average cost in epoch 59: 0.771409
training accuracy: 0.687500     test accuracy: 0.486513

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 60: 0.764410
training accuracy: 0.687500     test accuracy: 0.470529
lr decays to 0.002824
Average cost in epoch 61: 0.765873
training accuracy: 0.531250     test accuracy: 0.477522
Average cost in epoch 62: 0.761953
training accuracy: 0.687500     test accuracy: 0.461538
Average cost in epoch 63: 0.747754
training accuracy: 0.593750     test accuracy: 0.459540
Average cost in epoch 64: 0.759552
training accuracy: 0.562500     test accuracy: 0.462537

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 65: 0.748561
training accuracy: 0.656250     test accuracy: 0.479520
lr decays to 0.002542
Average cost in epoch 66: 0.749832
training accuracy: 0.562500     test accuracy: 0.485514
Average cost in epoch 67: 0.745130
training accuracy: 0.656250     test accuracy: 0.477522
Average cost in epoch 68: 0.736367
training accuracy: 0.500000     test accuracy: 0.452547
Average cost in epoch 69: 0.746837
training accuracy: 0.687500     test accuracy: 0.462537

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 70: 0.742643
training accuracy: 0.531250     test accuracy: 0.466533
lr decays to 0.002288
Average cost in epoch 71: 0.736447
training accuracy: 0.687500     test accuracy: 0.462537
Average cost in epoch 72: 0.726034
training accuracy: 0.687500     test accuracy: 0.469530
Average cost in epoch 73: 0.735746
training accuracy: 0.593750     test accuracy: 0.460539
Average cost in epoch 74: 0.734934
training accuracy: 0.562500     test accuracy: 0.469530

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 75: 0.727458
training accuracy: 0.656250     test accuracy: 0.477522
lr decays to 0.002059
Average cost in epoch 76: 0.720825
training accuracy: 0.500000     test accuracy: 0.468531
Average cost in epoch 77: 0.727162
training accuracy: 0.500000     test accuracy: 0.465534
Average cost in epoch 78: 0.722047
training accuracy: 0.718750     test accuracy: 0.463536
Average cost in epoch 79: 0.718010
training accuracy: 0.625000     test accuracy: 0.453546

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 80: 0.717605
training accuracy: 0.531250     test accuracy: 0.466533
lr decays to 0.001853
Average cost in epoch 81: 0.710630
training accuracy: 0.593750     test accuracy: 0.474525
Average cost in epoch 82: 0.706413
training accuracy: 0.562500     test accuracy: 0.460539
Average cost in epoch 83: 0.709501
training accuracy: 0.625000     test accuracy: 0.473526
Average cost in epoch 84: 0.705010
training accuracy: 0.500000     test accuracy: 0.474525

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 85: 0.703578
training accuracy: 0.812500     test accuracy: 0.460539
lr decays to 0.001668
Average cost in epoch 86: 0.708655
training accuracy: 0.687500     test accuracy: 0.457542
Average cost in epoch 87: 0.701642
training accuracy: 0.656250     test accuracy: 0.458541
Average cost in epoch 88: 0.699794
training accuracy: 0.375000     test accuracy: 0.469530
Average cost in epoch 89: 0.703901
training accuracy: 0.625000     test accuracy: 0.464535

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 90: 0.692689
training accuracy: 0.812500     test accuracy: 0.451548
lr decays to 0.001501
Average cost in epoch 91: 0.689854
training accuracy: 0.656250     test accuracy: 0.474525
Average cost in epoch 92: 0.694914
training accuracy: 0.593750     test accuracy: 0.474525
Average cost in epoch 93: 0.689440
training accuracy: 0.593750     test accuracy: 0.467532
Average cost in epoch 94: 0.693689
training accuracy: 0.687500     test accuracy: 0.460539

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 95: 0.689033
training accuracy: 0.531250     test accuracy: 0.458541
lr decays to 0.001351
Average cost in epoch 96: 0.686399
training accuracy: 0.812500     test accuracy: 0.457542
Average cost in epoch 97: 0.679245
training accuracy: 0.593750     test accuracy: 0.460539
Average cost in epoch 98: 0.685621
training accuracy: 0.625000     test accuracy: 0.460539
Average cost in epoch 99: 0.681909
training accuracy: 0.562500     test accuracy: 0.464535

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 100: 0.680733
training accuracy: 0.656250     test accuracy: 0.472527
lr decays to 0.001216
Average cost in epoch 101: 0.679381
training accuracy: 0.687500     test accuracy: 0.455544
Average cost in epoch 102: 0.673665
training accuracy: 0.656250     test accuracy: 0.453546
Average cost in epoch 103: 0.678861
training accuracy: 0.656250     test accuracy: 0.449550
Average cost in epoch 104: 0.668441
training accuracy: 0.718750     test accuracy: 0.452547

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 105: 0.682104
training accuracy: 0.562500     test accuracy: 0.471528
Average cost in epoch 106: 0.662849
training accuracy: 0.625000     test accuracy: 0.469530
Average cost in epoch 107: 0.667544
training accuracy: 0.718750     test accuracy: 0.477522
Average cost in epoch 108: 0.665211
training accuracy: 0.750000     test accuracy: 0.470529
Average cost in epoch 109: 0.673596
training accuracy: 0.625000     test accuracy: 0.463536

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 110: 0.659792
training accuracy: 0.687500     test accuracy: 0.473526
Average cost in epoch 111: 0.662867
training accuracy: 0.500000     test accuracy: 0.467532
Average cost in epoch 112: 0.665741
training accuracy: 0.687500     test accuracy: 0.466533
Average cost in epoch 113: 0.663678
training accuracy: 0.531250     test accuracy: 0.477522
Average cost in epoch 114: 0.655438
training accuracy: 0.656250     test accuracy: 0.470529

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 115: 0.667421
training accuracy: 0.781250     test accuracy: 0.464535
Average cost in epoch 116: 0.664725
training accuracy: 0.718750     test accuracy: 0.459540
Average cost in epoch 117: 0.662793
training accuracy: 0.562500     test accuracy: 0.458541
Average cost in epoch 118: 0.665066
training accuracy: 0.656250     test accuracy: 0.472527
Average cost in epoch 119: 0.655461
training accuracy: 0.531250     test accuracy: 0.481518

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 120: 0.659917
training accuracy: 0.781250     test accuracy: 0.469530
Average cost in epoch 121: 0.665473
training accuracy: 0.531250     test accuracy: 0.476523
Average cost in epoch 122: 0.651952
training accuracy: 0.812500     test accuracy: 0.475524
Average cost in epoch 123: 0.654819
training accuracy: 0.812500     test accuracy: 0.481518
Average cost in epoch 124: 0.657280
training accuracy: 0.500000     test accuracy: 0.485514

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 125: 0.649807
training accuracy: 0.593750     test accuracy: 0.489510
Average cost in epoch 126: 0.650365
training accuracy: 0.718750     test accuracy: 0.471528
Average cost in epoch 127: 0.661730
training accuracy: 0.625000     test accuracy: 0.466533
Average cost in epoch 128: 0.645980
training accuracy: 0.656250     test accuracy: 0.477522
Average cost in epoch 129: 0.659228
training accuracy: 0.687500     test accuracy: 0.471528

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 130: 0.648242
training accuracy: 0.718750     test accuracy: 0.470529
Average cost in epoch 131: 0.653623
training accuracy: 0.625000     test accuracy: 0.478521
Average cost in epoch 132: 0.647503
training accuracy: 0.750000     test accuracy: 0.466533
Average cost in epoch 133: 0.650498
training accuracy: 0.687500     test accuracy: 0.479520
Average cost in epoch 134: 0.654192
training accuracy: 0.593750     test accuracy: 0.478521

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 135: 0.647199
training accuracy: 0.656250     test accuracy: 0.476523
Average cost in epoch 136: 0.646900
training accuracy: 0.750000     test accuracy: 0.475524
Average cost in epoch 137: 0.645619
training accuracy: 0.718750     test accuracy: 0.478521
Average cost in epoch 138: 0.643438
training accuracy: 0.687500     test accuracy: 0.478521
Average cost in epoch 139: 0.644198
training accuracy: 0.687500     test accuracy: 0.483516

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 140: 0.646293
training accuracy: 0.718750     test accuracy: 0.474525
Average cost in epoch 141: 0.633141
training accuracy: 0.781250     test accuracy: 0.481518
Average cost in epoch 142: 0.642117
training accuracy: 0.687500     test accuracy: 0.476523
Average cost in epoch 143: 0.642922
training accuracy: 0.718750     test accuracy: 0.476523
Average cost in epoch 144: 0.639363
training accuracy: 0.531250     test accuracy: 0.475524

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 145: 0.633439
training accuracy: 0.718750     test accuracy: 0.485514
Average cost in epoch 146: 0.638796
training accuracy: 0.625000     test accuracy: 0.474525
Average cost in epoch 147: 0.639849
training accuracy: 0.718750     test accuracy: 0.468531
Average cost in epoch 148: 0.638267
training accuracy: 0.843750     test accuracy: 0.461538
Average cost in epoch 149: 0.629538
training accuracy: 0.750000     test accuracy: 0.472527

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 150: 0.632324
training accuracy: 0.562500     test accuracy: 0.468531
Average cost in epoch 151: 0.639394
training accuracy: 0.687500     test accuracy: 0.472527
Average cost in epoch 152: 0.629361
training accuracy: 0.718750     test accuracy: 0.462537
Average cost in epoch 153: 0.637351
training accuracy: 0.781250     test accuracy: 0.465534
Average cost in epoch 154: 0.632460
training accuracy: 0.531250     test accuracy: 0.480519

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 155: 0.637630
training accuracy: 0.687500     test accuracy: 0.476523
Average cost in epoch 156: 0.639444
training accuracy: 0.718750     test accuracy: 0.481518
Average cost in epoch 157: 0.625356
training accuracy: 0.562500     test accuracy: 0.473526
Average cost in epoch 158: 0.630740
training accuracy: 0.687500     test accuracy: 0.481518
Average cost in epoch 159: 0.637509
training accuracy: 0.750000     test accuracy: 0.475524

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 160: 0.628956
training accuracy: 0.812500     test accuracy: 0.474525
Average cost in epoch 161: 0.633270
training accuracy: 0.781250     test accuracy: 0.473526
Average cost in epoch 162: 0.621164
training accuracy: 0.625000     test accuracy: 0.486513
Average cost in epoch 163: 0.629064
training accuracy: 0.687500     test accuracy: 0.472527
Average cost in epoch 164: 0.627196
training accuracy: 0.687500     test accuracy: 0.473526

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 165: 0.629896
training accuracy: 0.875000     test accuracy: 0.479520
Average cost in epoch 166: 0.617574
training accuracy: 0.593750     test accuracy: 0.479520
Average cost in epoch 167: 0.628118
training accuracy: 0.687500     test accuracy: 0.477522
Average cost in epoch 168: 0.629578
training accuracy: 0.656250     test accuracy: 0.483516
Average cost in epoch 169: 0.625623
training accuracy: 0.750000     test accuracy: 0.473526

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 170: 0.626911
training accuracy: 0.500000     test accuracy: 0.467532
Average cost in epoch 171: 0.621671
training accuracy: 0.656250     test accuracy: 0.476523
Average cost in epoch 172: 0.618986
training accuracy: 0.468750     test accuracy: 0.473526
Average cost in epoch 173: 0.616946
training accuracy: 0.718750     test accuracy: 0.483516
Average cost in epoch 174: 0.631230
training accuracy: 0.687500     test accuracy: 0.473526

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 175: 0.628063
training accuracy: 0.750000     test accuracy: 0.491508
Average cost in epoch 176: 0.629214
training accuracy: 0.656250     test accuracy: 0.471528
Average cost in epoch 177: 0.622199
training accuracy: 0.562500     test accuracy: 0.482517
Average cost in epoch 178: 0.618271
training accuracy: 0.843750     test accuracy: 0.474525
Average cost in epoch 179: 0.618662
training accuracy: 0.750000     test accuracy: 0.471528

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 180: 0.609934
training accuracy: 0.718750     test accuracy: 0.479520
Average cost in epoch 181: 0.621222
training accuracy: 0.687500     test accuracy: 0.470529
Average cost in epoch 182: 0.620190
training accuracy: 0.812500     test accuracy: 0.485514
Average cost in epoch 183: 0.615263
training accuracy: 0.593750     test accuracy: 0.490509
Average cost in epoch 184: 0.616518
training accuracy: 0.750000     test accuracy: 0.473526

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 185: 0.625575
training accuracy: 0.593750     test accuracy: 0.469530
Average cost in epoch 186: 0.617059
training accuracy: 0.781250     test accuracy: 0.479520
Average cost in epoch 187: 0.616273
training accuracy: 0.718750     test accuracy: 0.477522
Average cost in epoch 188: 0.614968
training accuracy: 0.593750     test accuracy: 0.481518
Average cost in epoch 189: 0.609415
training accuracy: 0.687500     test accuracy: 0.475524

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 190: 0.614013
training accuracy: 0.812500     test accuracy: 0.470529
Average cost in epoch 191: 0.608438
training accuracy: 0.656250     test accuracy: 0.482517
Average cost in epoch 192: 0.607592
training accuracy: 0.781250     test accuracy: 0.477522
Average cost in epoch 193: 0.610103
training accuracy: 0.812500     test accuracy: 0.470529
Average cost in epoch 194: 0.613399
training accuracy: 0.781250     test accuracy: 0.467532

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Average cost in epoch 195: 0.607829
training accuracy: 0.625000     test accuracy: 0.481518
Average cost in epoch 196: 0.604079
training accuracy: 0.562500     test accuracy: 0.478521
Average cost in epoch 197: 0.609463
training accuracy: 0.625000     test accuracy: 0.475524
Average cost in epoch 198: 0.605037
training accuracy: 0.687500     test accuracy: 0.470529
Average cost in epoch 199: 0.611982
training accuracy: 0.718750     test accuracy: 0.477522

dump to weights/pyramid-lstm/pyramid-lstm_16.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 17, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_17.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 79.05
Starting training...
Average cost in epoch 0: 0.727753
training accuracy: 0.437500     test accuracy: 0.479520
Average cost in epoch 1: 0.698039
training accuracy: 0.500000     test accuracy: 0.479520
Average cost in epoch 2: 0.695743
training accuracy: 0.625000     test accuracy: 0.479520
Average cost in epoch 3: 0.694881
training accuracy: 0.406250     test accuracy: 0.520480
Average cost in epoch 4: 0.695081
training accuracy: 0.656250     test accuracy: 0.479520

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 5: 0.694460
training accuracy: 0.406250     test accuracy: 0.483516
lr decays to 0.009000
Average cost in epoch 6: 0.694446
training accuracy: 0.437500     test accuracy: 0.474525
Average cost in epoch 7: 0.694174
training accuracy: 0.375000     test accuracy: 0.479520
Average cost in epoch 8: 0.694245
training accuracy: 0.531250     test accuracy: 0.520480
Average cost in epoch 9: 0.694120
training accuracy: 0.500000     test accuracy: 0.470529

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 10: 0.693511
training accuracy: 0.562500     test accuracy: 0.462537
lr decays to 0.008100
Average cost in epoch 11: 0.693887
training accuracy: 0.406250     test accuracy: 0.516484
Average cost in epoch 12: 0.693474
training accuracy: 0.468750     test accuracy: 0.465534
Average cost in epoch 13: 0.693644
training accuracy: 0.562500     test accuracy: 0.477522
Average cost in epoch 14: 0.693948
training accuracy: 0.718750     test accuracy: 0.463536

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 15: 0.693619
training accuracy: 0.593750     test accuracy: 0.467532
lr decays to 0.007290
Average cost in epoch 16: 0.693656
training accuracy: 0.718750     test accuracy: 0.472527
Average cost in epoch 17: 0.693613
training accuracy: 0.406250     test accuracy: 0.505495
Average cost in epoch 18: 0.693012
training accuracy: 0.437500     test accuracy: 0.525475
Average cost in epoch 19: 0.693903
training accuracy: 0.531250     test accuracy: 0.480519

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 20: 0.692825
training accuracy: 0.437500     test accuracy: 0.505495
lr decays to 0.006561
Average cost in epoch 21: 0.692676
training accuracy: 0.437500     test accuracy: 0.491508
Average cost in epoch 22: 0.692890
training accuracy: 0.468750     test accuracy: 0.474525
Average cost in epoch 23: 0.693262
training accuracy: 0.593750     test accuracy: 0.489510
Average cost in epoch 24: 0.693105
training accuracy: 0.437500     test accuracy: 0.494505

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 25: 0.693433
training accuracy: 0.593750     test accuracy: 0.486513
lr decays to 0.005905
Average cost in epoch 26: 0.693149
training accuracy: 0.625000     test accuracy: 0.526474
Average cost in epoch 27: 0.692740
training accuracy: 0.562500     test accuracy: 0.495504
Average cost in epoch 28: 0.692569
training accuracy: 0.500000     test accuracy: 0.465534
Average cost in epoch 29: 0.692375
training accuracy: 0.531250     test accuracy: 0.481518

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 30: 0.692493
training accuracy: 0.562500     test accuracy: 0.493506
lr decays to 0.005314
Average cost in epoch 31: 0.691919
training accuracy: 0.687500     test accuracy: 0.508492
Average cost in epoch 32: 0.692360
training accuracy: 0.562500     test accuracy: 0.506494
Average cost in epoch 33: 0.692521
training accuracy: 0.531250     test accuracy: 0.492507
Average cost in epoch 34: 0.691941
training accuracy: 0.593750     test accuracy: 0.494505

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 35: 0.692203
training accuracy: 0.531250     test accuracy: 0.488511
lr decays to 0.004783
Average cost in epoch 36: 0.691993
training accuracy: 0.562500     test accuracy: 0.504496
Average cost in epoch 37: 0.691868
training accuracy: 0.437500     test accuracy: 0.481518
Average cost in epoch 38: 0.691999
training accuracy: 0.562500     test accuracy: 0.476523
Average cost in epoch 39: 0.690980
training accuracy: 0.531250     test accuracy: 0.460539

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 40: 0.692499
training accuracy: 0.406250     test accuracy: 0.505495
lr decays to 0.004305
Average cost in epoch 41: 0.691609
training accuracy: 0.312500     test accuracy: 0.451548
Average cost in epoch 42: 0.690924
training accuracy: 0.593750     test accuracy: 0.466533
Average cost in epoch 43: 0.691131
training accuracy: 0.500000     test accuracy: 0.497502
Average cost in epoch 44: 0.692328
training accuracy: 0.500000     test accuracy: 0.493506

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 45: 0.691114
training accuracy: 0.687500     test accuracy: 0.498501
lr decays to 0.003874
Average cost in epoch 46: 0.689789
training accuracy: 0.437500     test accuracy: 0.453546
Average cost in epoch 47: 0.689864
training accuracy: 0.375000     test accuracy: 0.470529
Average cost in epoch 48: 0.690072
training accuracy: 0.531250     test accuracy: 0.436563
Average cost in epoch 49: 0.691320
training accuracy: 0.375000     test accuracy: 0.501499

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 50: 0.690134
training accuracy: 0.718750     test accuracy: 0.461538
lr decays to 0.003487
Average cost in epoch 51: 0.689554
training accuracy: 0.750000     test accuracy: 0.497502
Average cost in epoch 52: 0.689693
training accuracy: 0.468750     test accuracy: 0.469530
Average cost in epoch 53: 0.690208
training accuracy: 0.437500     test accuracy: 0.486513
Average cost in epoch 54: 0.690450
training accuracy: 0.625000     test accuracy: 0.468531

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 55: 0.688818
training accuracy: 0.625000     test accuracy: 0.482517
lr decays to 0.003138
Average cost in epoch 56: 0.690815
training accuracy: 0.531250     test accuracy: 0.469530
Average cost in epoch 57: 0.688128
training accuracy: 0.468750     test accuracy: 0.474525
Average cost in epoch 58: 0.689910
training accuracy: 0.500000     test accuracy: 0.483516
Average cost in epoch 59: 0.690413
training accuracy: 0.562500     test accuracy: 0.483516

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 60: 0.689854
training accuracy: 0.500000     test accuracy: 0.472527
lr decays to 0.002824
Average cost in epoch 61: 0.689138
training accuracy: 0.687500     test accuracy: 0.481518
Average cost in epoch 62: 0.689431
training accuracy: 0.375000     test accuracy: 0.495504
Average cost in epoch 63: 0.688031
training accuracy: 0.500000     test accuracy: 0.467532
Average cost in epoch 64: 0.689758
training accuracy: 0.718750     test accuracy: 0.484515

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 65: 0.686414
training accuracy: 0.562500     test accuracy: 0.470529
lr decays to 0.002542
Average cost in epoch 66: 0.688344
training accuracy: 0.531250     test accuracy: 0.480519
Average cost in epoch 67: 0.688074
training accuracy: 0.406250     test accuracy: 0.476523
Average cost in epoch 68: 0.688602
training accuracy: 0.562500     test accuracy: 0.475524
Average cost in epoch 69: 0.688076
training accuracy: 0.468750     test accuracy: 0.442557

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 70: 0.687801
training accuracy: 0.656250     test accuracy: 0.479520
lr decays to 0.002288
Average cost in epoch 71: 0.687473
training accuracy: 0.531250     test accuracy: 0.466533
Average cost in epoch 72: 0.685780
training accuracy: 0.687500     test accuracy: 0.465534
Average cost in epoch 73: 0.687298
training accuracy: 0.500000     test accuracy: 0.467532
Average cost in epoch 74: 0.686496
training accuracy: 0.468750     test accuracy: 0.469530

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 75: 0.685714
training accuracy: 0.531250     test accuracy: 0.471528
lr decays to 0.002059
Average cost in epoch 76: 0.686707
training accuracy: 0.625000     test accuracy: 0.465534
Average cost in epoch 77: 0.684421
training accuracy: 0.375000     test accuracy: 0.476523
Average cost in epoch 78: 0.686600
training accuracy: 0.468750     test accuracy: 0.466533
Average cost in epoch 79: 0.684033
training accuracy: 0.687500     test accuracy: 0.469530

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 80: 0.685145
training accuracy: 0.406250     test accuracy: 0.466533
lr decays to 0.001853
Average cost in epoch 81: 0.684975
training accuracy: 0.562500     test accuracy: 0.483516
Average cost in epoch 82: 0.683630
training accuracy: 0.593750     test accuracy: 0.475524
Average cost in epoch 83: 0.684807
training accuracy: 0.468750     test accuracy: 0.488511
Average cost in epoch 84: 0.682483
training accuracy: 0.468750     test accuracy: 0.487512

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 85: 0.684118
training accuracy: 0.406250     test accuracy: 0.484515
lr decays to 0.001668
Average cost in epoch 86: 0.683542
training accuracy: 0.656250     test accuracy: 0.477522
Average cost in epoch 87: 0.684244
training accuracy: 0.593750     test accuracy: 0.492507
Average cost in epoch 88: 0.682617
training accuracy: 0.562500     test accuracy: 0.494505
Average cost in epoch 89: 0.682646
training accuracy: 0.531250     test accuracy: 0.485514

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 90: 0.683327
training accuracy: 0.500000     test accuracy: 0.486513
lr decays to 0.001501
Average cost in epoch 91: 0.684221
training accuracy: 0.656250     test accuracy: 0.499500
Average cost in epoch 92: 0.682144
training accuracy: 0.500000     test accuracy: 0.462537
Average cost in epoch 93: 0.681423
training accuracy: 0.593750     test accuracy: 0.490509
Average cost in epoch 94: 0.682578
training accuracy: 0.531250     test accuracy: 0.492507

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 95: 0.682493
training accuracy: 0.343750     test accuracy: 0.492507
lr decays to 0.001351
Average cost in epoch 96: 0.680140
training accuracy: 0.531250     test accuracy: 0.473526
Average cost in epoch 97: 0.682866
training accuracy: 0.625000     test accuracy: 0.480519
Average cost in epoch 98: 0.681019
training accuracy: 0.531250     test accuracy: 0.493506
Average cost in epoch 99: 0.681413
training accuracy: 0.593750     test accuracy: 0.494505

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 100: 0.679471
training accuracy: 0.625000     test accuracy: 0.491508
lr decays to 0.001216
Average cost in epoch 101: 0.681119
training accuracy: 0.593750     test accuracy: 0.489510
Average cost in epoch 102: 0.679480
training accuracy: 0.625000     test accuracy: 0.487512
Average cost in epoch 103: 0.681377
training accuracy: 0.562500     test accuracy: 0.497502
Average cost in epoch 104: 0.680748
training accuracy: 0.437500     test accuracy: 0.468531

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 105: 0.677870
training accuracy: 0.343750     test accuracy: 0.495504
Average cost in epoch 106: 0.677398
training accuracy: 0.687500     test accuracy: 0.478521
Average cost in epoch 107: 0.678181
training accuracy: 0.562500     test accuracy: 0.487512
Average cost in epoch 108: 0.678786
training accuracy: 0.593750     test accuracy: 0.488511
Average cost in epoch 109: 0.678527
training accuracy: 0.687500     test accuracy: 0.485514

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 110: 0.678866
training accuracy: 0.656250     test accuracy: 0.493506
Average cost in epoch 111: 0.679239
training accuracy: 0.468750     test accuracy: 0.471528
Average cost in epoch 112: 0.679397
training accuracy: 0.625000     test accuracy: 0.488511
Average cost in epoch 113: 0.679344
training accuracy: 0.500000     test accuracy: 0.488511
Average cost in epoch 114: 0.677853
training accuracy: 0.687500     test accuracy: 0.482517

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 115: 0.678632
training accuracy: 0.500000     test accuracy: 0.481518
Average cost in epoch 116: 0.678134
training accuracy: 0.500000     test accuracy: 0.477522
Average cost in epoch 117: 0.676531
training accuracy: 0.656250     test accuracy: 0.477522
Average cost in epoch 118: 0.678105
training accuracy: 0.531250     test accuracy: 0.477522
Average cost in epoch 119: 0.675655
training accuracy: 0.437500     test accuracy: 0.454545

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 120: 0.674829
training accuracy: 0.531250     test accuracy: 0.459540
Average cost in epoch 121: 0.676529
training accuracy: 0.625000     test accuracy: 0.463536
Average cost in epoch 122: 0.679557
training accuracy: 0.437500     test accuracy: 0.475524
Average cost in epoch 123: 0.674325
training accuracy: 0.531250     test accuracy: 0.471528
Average cost in epoch 124: 0.677853
training accuracy: 0.375000     test accuracy: 0.495504

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 125: 0.674931
training accuracy: 0.656250     test accuracy: 0.487512
Average cost in epoch 126: 0.676392
training accuracy: 0.593750     test accuracy: 0.503497
Average cost in epoch 127: 0.677487
training accuracy: 0.625000     test accuracy: 0.468531
Average cost in epoch 128: 0.673791
training accuracy: 0.500000     test accuracy: 0.471528
Average cost in epoch 129: 0.674262
training accuracy: 0.531250     test accuracy: 0.477522

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 130: 0.673770
training accuracy: 0.468750     test accuracy: 0.504496
Average cost in epoch 131: 0.674413
training accuracy: 0.656250     test accuracy: 0.478521
Average cost in epoch 132: 0.675066
training accuracy: 0.625000     test accuracy: 0.461538
Average cost in epoch 133: 0.674410
training accuracy: 0.406250     test accuracy: 0.498501
Average cost in epoch 134: 0.676256
training accuracy: 0.718750     test accuracy: 0.483516

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 135: 0.676231
training accuracy: 0.500000     test accuracy: 0.502498
Average cost in epoch 136: 0.674474
training accuracy: 0.656250     test accuracy: 0.499500
Average cost in epoch 137: 0.675040
training accuracy: 0.562500     test accuracy: 0.500500
Average cost in epoch 138: 0.676057
training accuracy: 0.656250     test accuracy: 0.486513
Average cost in epoch 139: 0.672161
training accuracy: 0.625000     test accuracy: 0.508492

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 140: 0.676187
training accuracy: 0.593750     test accuracy: 0.500500
Average cost in epoch 141: 0.673844
training accuracy: 0.656250     test accuracy: 0.490509
Average cost in epoch 142: 0.672159
training accuracy: 0.437500     test accuracy: 0.489510
Average cost in epoch 143: 0.674730
training accuracy: 0.593750     test accuracy: 0.482517
Average cost in epoch 144: 0.673549
training accuracy: 0.687500     test accuracy: 0.483516

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 145: 0.673533
training accuracy: 0.625000     test accuracy: 0.504496
Average cost in epoch 146: 0.674621
training accuracy: 0.437500     test accuracy: 0.520480
Average cost in epoch 147: 0.671885
training accuracy: 0.625000     test accuracy: 0.497502
Average cost in epoch 148: 0.675287
training accuracy: 0.656250     test accuracy: 0.487512
Average cost in epoch 149: 0.672306
training accuracy: 0.687500     test accuracy: 0.478521

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 150: 0.674851
training accuracy: 0.625000     test accuracy: 0.495504
Average cost in epoch 151: 0.669654
training accuracy: 0.531250     test accuracy: 0.494505
Average cost in epoch 152: 0.674243
training accuracy: 0.625000     test accuracy: 0.502498
Average cost in epoch 153: 0.672206
training accuracy: 0.562500     test accuracy: 0.501499
Average cost in epoch 154: 0.668839
training accuracy: 0.562500     test accuracy: 0.466533

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 155: 0.673889
training accuracy: 0.750000     test accuracy: 0.490509
Average cost in epoch 156: 0.671125
training accuracy: 0.593750     test accuracy: 0.498501
Average cost in epoch 157: 0.670525
training accuracy: 0.593750     test accuracy: 0.490509
Average cost in epoch 158: 0.671271
training accuracy: 0.687500     test accuracy: 0.491508
Average cost in epoch 159: 0.675207
training accuracy: 0.500000     test accuracy: 0.499500

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 160: 0.669341
training accuracy: 0.625000     test accuracy: 0.512488
Average cost in epoch 161: 0.672313
training accuracy: 0.593750     test accuracy: 0.487512
Average cost in epoch 162: 0.670041
training accuracy: 0.437500     test accuracy: 0.492507
Average cost in epoch 163: 0.671279
training accuracy: 0.625000     test accuracy: 0.490509
Average cost in epoch 164: 0.673270
training accuracy: 0.531250     test accuracy: 0.498501

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 165: 0.670640
training accuracy: 0.500000     test accuracy: 0.505495
Average cost in epoch 166: 0.670098
training accuracy: 0.562500     test accuracy: 0.494505
Average cost in epoch 167: 0.672202
training accuracy: 0.625000     test accuracy: 0.480519
Average cost in epoch 168: 0.669558
training accuracy: 0.687500     test accuracy: 0.506494
Average cost in epoch 169: 0.669428
training accuracy: 0.593750     test accuracy: 0.491508

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 170: 0.670582
training accuracy: 0.531250     test accuracy: 0.496503
Average cost in epoch 171: 0.671273
training accuracy: 0.625000     test accuracy: 0.497502
Average cost in epoch 172: 0.668842
training accuracy: 0.656250     test accuracy: 0.500500
Average cost in epoch 173: 0.670724
training accuracy: 0.687500     test accuracy: 0.499500
Average cost in epoch 174: 0.670591
training accuracy: 0.687500     test accuracy: 0.516484

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 175: 0.672647
training accuracy: 0.625000     test accuracy: 0.488511
Average cost in epoch 176: 0.669609
training accuracy: 0.687500     test accuracy: 0.490509
Average cost in epoch 177: 0.670251
training accuracy: 0.406250     test accuracy: 0.496503
Average cost in epoch 178: 0.669450
training accuracy: 0.687500     test accuracy: 0.497502
Average cost in epoch 179: 0.669867
training accuracy: 0.468750     test accuracy: 0.500500

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 180: 0.670856
training accuracy: 0.625000     test accuracy: 0.487512
Average cost in epoch 181: 0.670409
training accuracy: 0.562500     test accuracy: 0.486513
Average cost in epoch 182: 0.670273
training accuracy: 0.562500     test accuracy: 0.483516
Average cost in epoch 183: 0.668797
training accuracy: 0.656250     test accuracy: 0.487512
Average cost in epoch 184: 0.665335
training accuracy: 0.562500     test accuracy: 0.499500

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 185: 0.670570
training accuracy: 0.687500     test accuracy: 0.503497
Average cost in epoch 186: 0.671903
training accuracy: 0.531250     test accuracy: 0.514486
Average cost in epoch 187: 0.670691
training accuracy: 0.625000     test accuracy: 0.488511
Average cost in epoch 188: 0.669544
training accuracy: 0.531250     test accuracy: 0.490509
Average cost in epoch 189: 0.668316
training accuracy: 0.562500     test accuracy: 0.514486

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 190: 0.668822
training accuracy: 0.687500     test accuracy: 0.480519
Average cost in epoch 191: 0.669727
training accuracy: 0.437500     test accuracy: 0.494505
Average cost in epoch 192: 0.666587
training accuracy: 0.656250     test accuracy: 0.482517
Average cost in epoch 193: 0.669895
training accuracy: 0.656250     test accuracy: 0.484515
Average cost in epoch 194: 0.670881
training accuracy: 0.687500     test accuracy: 0.497502

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Average cost in epoch 195: 0.666366
training accuracy: 0.656250     test accuracy: 0.501499
Average cost in epoch 196: 0.669491
training accuracy: 0.562500     test accuracy: 0.479520
Average cost in epoch 197: 0.666458
training accuracy: 0.500000     test accuracy: 0.484515
Average cost in epoch 198: 0.669442
training accuracy: 0.656250     test accuracy: 0.474525
Average cost in epoch 199: 0.668041
training accuracy: 0.500000     test accuracy: 0.472527

dump to weights/pyramid-lstm/pyramid-lstm_17.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 4007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 18, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_18.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 679.38
Starting training...
Average cost in epoch 0: 0.339685
training accuracy: 0.906250     test accuracy: 0.893107
Average cost in epoch 1: 0.134204
training accuracy: 1.000000     test accuracy: 0.893107
Average cost in epoch 2: 0.129673
training accuracy: 0.843750     test accuracy: 0.893107
Average cost in epoch 3: 0.139719
training accuracy: 0.875000     test accuracy: 0.893107
Average cost in epoch 4: 0.124002
training accuracy: 0.812500     test accuracy: 0.919081

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 5: 0.129470
training accuracy: 0.968750     test accuracy: 0.892108
lr decays to 0.009000
Average cost in epoch 6: 0.123549
training accuracy: 0.843750     test accuracy: 0.899101
Average cost in epoch 7: 0.123699
training accuracy: 0.906250     test accuracy: 0.917083
Average cost in epoch 8: 0.123119
training accuracy: 1.000000     test accuracy: 0.893107
Average cost in epoch 9: 0.123329
training accuracy: 0.937500     test accuracy: 0.897103

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 10: 0.124452
training accuracy: 0.875000     test accuracy: 0.919081
lr decays to 0.008100
Average cost in epoch 11: 0.123050
training accuracy: 0.937500     test accuracy: 0.910090
Average cost in epoch 12: 0.123689
training accuracy: 0.906250     test accuracy: 0.920080
Average cost in epoch 13: 0.122270
training accuracy: 0.875000     test accuracy: 0.915085
Average cost in epoch 14: 0.122481
training accuracy: 0.781250     test accuracy: 0.916084

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 15: 0.121618
training accuracy: 0.968750     test accuracy: 0.903097
lr decays to 0.007290
Average cost in epoch 16: 0.120369
training accuracy: 0.937500     test accuracy: 0.905095
Average cost in epoch 17: 0.120694
training accuracy: 0.937500     test accuracy: 0.913087
Average cost in epoch 18: 0.120805
training accuracy: 0.937500     test accuracy: 0.906094
Average cost in epoch 19: 0.120601
training accuracy: 0.875000     test accuracy: 0.904096

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 20: 0.119941
training accuracy: 0.968750     test accuracy: 0.902098
lr decays to 0.006561
Average cost in epoch 21: 0.120521
training accuracy: 0.937500     test accuracy: 0.890110
Average cost in epoch 22: 0.116698
training accuracy: 0.968750     test accuracy: 0.895105
Average cost in epoch 23: 0.117248
training accuracy: 0.906250     test accuracy: 0.906094
Average cost in epoch 24: 0.118069
training accuracy: 0.968750     test accuracy: 0.900100

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 25: 0.118988
training accuracy: 1.000000     test accuracy: 0.895105
lr decays to 0.005905
Average cost in epoch 26: 0.116009
training accuracy: 0.906250     test accuracy: 0.878122
Average cost in epoch 27: 0.116214
training accuracy: 0.906250     test accuracy: 0.889111
Average cost in epoch 28: 0.118748
training accuracy: 0.968750     test accuracy: 0.890110
Average cost in epoch 29: 0.116292
training accuracy: 0.937500     test accuracy: 0.911089

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 30: 0.115475
training accuracy: 0.875000     test accuracy: 0.900100
lr decays to 0.005314
Average cost in epoch 31: 0.115296
training accuracy: 0.875000     test accuracy: 0.897103
Average cost in epoch 32: 0.115460
training accuracy: 0.937500     test accuracy: 0.911089
Average cost in epoch 33: 0.114713
training accuracy: 0.937500     test accuracy: 0.895105
Average cost in epoch 34: 0.113867
training accuracy: 0.937500     test accuracy: 0.891109

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 35: 0.113974
training accuracy: 1.000000     test accuracy: 0.895105
lr decays to 0.004783
Average cost in epoch 36: 0.110771
training accuracy: 0.906250     test accuracy: 0.898102
Average cost in epoch 37: 0.113037
training accuracy: 0.937500     test accuracy: 0.890110
Average cost in epoch 38: 0.111176
training accuracy: 1.000000     test accuracy: 0.906094
Average cost in epoch 39: 0.112407
training accuracy: 0.937500     test accuracy: 0.891109

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 40: 0.110820
training accuracy: 1.000000     test accuracy: 0.906094
lr decays to 0.004305
Average cost in epoch 41: 0.108482
training accuracy: 1.000000     test accuracy: 0.899101
Average cost in epoch 42: 0.107277
training accuracy: 1.000000     test accuracy: 0.905095
Average cost in epoch 43: 0.107915
training accuracy: 0.968750     test accuracy: 0.908092
Average cost in epoch 44: 0.108025
training accuracy: 0.906250     test accuracy: 0.901099

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 45: 0.106599
training accuracy: 0.937500     test accuracy: 0.895105
lr decays to 0.003874
Average cost in epoch 46: 0.102863
training accuracy: 1.000000     test accuracy: 0.898102
Average cost in epoch 47: 0.104517
training accuracy: 0.968750     test accuracy: 0.893107
Average cost in epoch 48: 0.102864
training accuracy: 0.843750     test accuracy: 0.900100
Average cost in epoch 49: 0.105338
training accuracy: 1.000000     test accuracy: 0.891109

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 50: 0.101742
training accuracy: 0.968750     test accuracy: 0.896104
lr decays to 0.003487
Average cost in epoch 51: 0.105296
training accuracy: 0.843750     test accuracy: 0.897103
Average cost in epoch 52: 0.100344
training accuracy: 0.968750     test accuracy: 0.905095
Average cost in epoch 53: 0.102001
training accuracy: 0.906250     test accuracy: 0.900100
Average cost in epoch 54: 0.100381
training accuracy: 0.937500     test accuracy: 0.902098

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 55: 0.102577
training accuracy: 0.968750     test accuracy: 0.899101
lr decays to 0.003138
Average cost in epoch 56: 0.098405
training accuracy: 0.906250     test accuracy: 0.891109
Average cost in epoch 57: 0.098046
training accuracy: 0.968750     test accuracy: 0.908092
Average cost in epoch 58: 0.095878
training accuracy: 0.937500     test accuracy: 0.899101
Average cost in epoch 59: 0.100001
training accuracy: 1.000000     test accuracy: 0.894106

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 60: 0.098566
training accuracy: 1.000000     test accuracy: 0.900100
lr decays to 0.002824
Average cost in epoch 61: 0.097799
training accuracy: 0.875000     test accuracy: 0.892108
Average cost in epoch 62: 0.096238
training accuracy: 0.937500     test accuracy: 0.902098
Average cost in epoch 63: 0.099774
training accuracy: 0.968750     test accuracy: 0.898102
Average cost in epoch 64: 0.094743
training accuracy: 0.968750     test accuracy: 0.895105

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 65: 0.099081
training accuracy: 0.968750     test accuracy: 0.886114
lr decays to 0.002542
Average cost in epoch 66: 0.090838
training accuracy: 1.000000     test accuracy: 0.891109
Average cost in epoch 67: 0.093612
training accuracy: 0.937500     test accuracy: 0.899101
Average cost in epoch 68: 0.093295
training accuracy: 0.906250     test accuracy: 0.896104
Average cost in epoch 69: 0.097865
training accuracy: 1.000000     test accuracy: 0.896104

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 70: 0.093338
training accuracy: 0.968750     test accuracy: 0.903097
lr decays to 0.002288
Average cost in epoch 71: 0.093598
training accuracy: 0.937500     test accuracy: 0.893107
Average cost in epoch 72: 0.092343
training accuracy: 1.000000     test accuracy: 0.888112
Average cost in epoch 73: 0.089766
training accuracy: 0.968750     test accuracy: 0.898102
Average cost in epoch 74: 0.094251
training accuracy: 0.906250     test accuracy: 0.894106

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 75: 0.094988
training accuracy: 1.000000     test accuracy: 0.892108
lr decays to 0.002059
Average cost in epoch 76: 0.093216
training accuracy: 1.000000     test accuracy: 0.897103
Average cost in epoch 77: 0.090437
training accuracy: 0.968750     test accuracy: 0.893107
Average cost in epoch 78: 0.090088
training accuracy: 0.906250     test accuracy: 0.902098
Average cost in epoch 79: 0.091594
training accuracy: 1.000000     test accuracy: 0.900100

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 80: 0.092537
training accuracy: 1.000000     test accuracy: 0.912088
lr decays to 0.001853
Average cost in epoch 81: 0.092636
training accuracy: 1.000000     test accuracy: 0.890110
Average cost in epoch 82: 0.090345
training accuracy: 0.937500     test accuracy: 0.894106
Average cost in epoch 83: 0.089594
training accuracy: 0.937500     test accuracy: 0.898102
Average cost in epoch 84: 0.091144
training accuracy: 0.968750     test accuracy: 0.891109

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 85: 0.086644
training accuracy: 0.937500     test accuracy: 0.900100
lr decays to 0.001668
Average cost in epoch 86: 0.089724
training accuracy: 0.937500     test accuracy: 0.896104
Average cost in epoch 87: 0.090917
training accuracy: 0.968750     test accuracy: 0.897103
Average cost in epoch 88: 0.090084
training accuracy: 0.937500     test accuracy: 0.900100
Average cost in epoch 89: 0.083970
training accuracy: 1.000000     test accuracy: 0.904096

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 90: 0.090451
training accuracy: 1.000000     test accuracy: 0.899101
lr decays to 0.001501
Average cost in epoch 91: 0.086526
training accuracy: 0.906250     test accuracy: 0.894106
Average cost in epoch 92: 0.089574
training accuracy: 0.968750     test accuracy: 0.895105
Average cost in epoch 93: 0.086209
training accuracy: 1.000000     test accuracy: 0.908092
Average cost in epoch 94: 0.088315
training accuracy: 0.968750     test accuracy: 0.893107

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 95: 0.083973
training accuracy: 0.968750     test accuracy: 0.902098
lr decays to 0.001351
Average cost in epoch 96: 0.087037
training accuracy: 0.937500     test accuracy: 0.897103
Average cost in epoch 97: 0.082396
training accuracy: 0.968750     test accuracy: 0.905095
Average cost in epoch 98: 0.087506
training accuracy: 0.968750     test accuracy: 0.901099
Average cost in epoch 99: 0.083575
training accuracy: 0.937500     test accuracy: 0.914086

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 100: 0.085755
training accuracy: 0.968750     test accuracy: 0.900100
lr decays to 0.001216
Average cost in epoch 101: 0.085159
training accuracy: 1.000000     test accuracy: 0.892108
Average cost in epoch 102: 0.083497
training accuracy: 1.000000     test accuracy: 0.904096
Average cost in epoch 103: 0.085403
training accuracy: 1.000000     test accuracy: 0.909091
Average cost in epoch 104: 0.083630
training accuracy: 0.937500     test accuracy: 0.903097

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 105: 0.084825
training accuracy: 1.000000     test accuracy: 0.896104
Average cost in epoch 106: 0.085680
training accuracy: 0.906250     test accuracy: 0.894106
Average cost in epoch 107: 0.085754
training accuracy: 0.968750     test accuracy: 0.893107
Average cost in epoch 108: 0.078996
training accuracy: 0.875000     test accuracy: 0.904096
Average cost in epoch 109: 0.083013
training accuracy: 0.968750     test accuracy: 0.895105

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 110: 0.084096
training accuracy: 0.937500     test accuracy: 0.904096
Average cost in epoch 111: 0.079552
training accuracy: 1.000000     test accuracy: 0.907093
Average cost in epoch 112: 0.087886
training accuracy: 0.968750     test accuracy: 0.897103
Average cost in epoch 113: 0.084641
training accuracy: 1.000000     test accuracy: 0.908092
Average cost in epoch 114: 0.083502
training accuracy: 0.968750     test accuracy: 0.906094

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 115: 0.082256
training accuracy: 0.968750     test accuracy: 0.904096
Average cost in epoch 116: 0.084704
training accuracy: 1.000000     test accuracy: 0.906094
Average cost in epoch 117: 0.083785
training accuracy: 0.937500     test accuracy: 0.900100
Average cost in epoch 118: 0.085210
training accuracy: 0.968750     test accuracy: 0.910090
Average cost in epoch 119: 0.081287
training accuracy: 1.000000     test accuracy: 0.900100

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 120: 0.085509
training accuracy: 0.968750     test accuracy: 0.907093
Average cost in epoch 121: 0.083498
training accuracy: 0.937500     test accuracy: 0.902098
Average cost in epoch 122: 0.080414
training accuracy: 0.906250     test accuracy: 0.899101
Average cost in epoch 123: 0.084959
training accuracy: 0.968750     test accuracy: 0.892108
Average cost in epoch 124: 0.082991
training accuracy: 1.000000     test accuracy: 0.895105

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 125: 0.083402
training accuracy: 0.968750     test accuracy: 0.899101
Average cost in epoch 126: 0.083606
training accuracy: 0.937500     test accuracy: 0.903097
Average cost in epoch 127: 0.086538
training accuracy: 0.875000     test accuracy: 0.905095
Average cost in epoch 128: 0.084407
training accuracy: 1.000000     test accuracy: 0.899101
Average cost in epoch 129: 0.084256
training accuracy: 0.968750     test accuracy: 0.896104

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 130: 0.080684
training accuracy: 0.968750     test accuracy: 0.895105
Average cost in epoch 131: 0.082483
training accuracy: 1.000000     test accuracy: 0.896104
Average cost in epoch 132: 0.080579
training accuracy: 1.000000     test accuracy: 0.895105
Average cost in epoch 133: 0.083618
training accuracy: 1.000000     test accuracy: 0.898102
Average cost in epoch 134: 0.082031
training accuracy: 0.906250     test accuracy: 0.904096

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 135: 0.082687
training accuracy: 0.968750     test accuracy: 0.903097
Average cost in epoch 136: 0.085554
training accuracy: 0.968750     test accuracy: 0.902098
Average cost in epoch 137: 0.080087
training accuracy: 0.968750     test accuracy: 0.897103
Average cost in epoch 138: 0.083852
training accuracy: 0.968750     test accuracy: 0.894106
Average cost in epoch 139: 0.079743
training accuracy: 0.968750     test accuracy: 0.894106

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 140: 0.081226
training accuracy: 1.000000     test accuracy: 0.900100
Average cost in epoch 141: 0.079184
training accuracy: 0.937500     test accuracy: 0.899101
Average cost in epoch 142: 0.082736
training accuracy: 0.968750     test accuracy: 0.890110
Average cost in epoch 143: 0.081407
training accuracy: 0.937500     test accuracy: 0.901099
Average cost in epoch 144: 0.081633
training accuracy: 0.968750     test accuracy: 0.893107

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 145: 0.082760
training accuracy: 0.906250     test accuracy: 0.900100
Average cost in epoch 146: 0.083472
training accuracy: 1.000000     test accuracy: 0.898102
Average cost in epoch 147: 0.080231
training accuracy: 1.000000     test accuracy: 0.906094
Average cost in epoch 148: 0.081577
training accuracy: 1.000000     test accuracy: 0.895105
Average cost in epoch 149: 0.081110
training accuracy: 0.968750     test accuracy: 0.894106

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 150: 0.085261
training accuracy: 1.000000     test accuracy: 0.892108
Average cost in epoch 151: 0.082803
training accuracy: 0.937500     test accuracy: 0.903097
Average cost in epoch 152: 0.082120
training accuracy: 0.937500     test accuracy: 0.900100
Average cost in epoch 153: 0.079626
training accuracy: 0.968750     test accuracy: 0.895105
Average cost in epoch 154: 0.083199
training accuracy: 0.968750     test accuracy: 0.897103

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 155: 0.079331
training accuracy: 0.968750     test accuracy: 0.913087
Average cost in epoch 156: 0.084293
training accuracy: 0.906250     test accuracy: 0.894106
Average cost in epoch 157: 0.080250
training accuracy: 0.968750     test accuracy: 0.903097
Average cost in epoch 158: 0.082618
training accuracy: 0.968750     test accuracy: 0.899101
Average cost in epoch 159: 0.082175
training accuracy: 1.000000     test accuracy: 0.898102

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 160: 0.083937
training accuracy: 0.937500     test accuracy: 0.901099
Average cost in epoch 161: 0.080568
training accuracy: 1.000000     test accuracy: 0.902098
Average cost in epoch 162: 0.079786
training accuracy: 0.968750     test accuracy: 0.899101
Average cost in epoch 163: 0.080626
training accuracy: 0.968750     test accuracy: 0.896104
Average cost in epoch 164: 0.077277
training accuracy: 0.968750     test accuracy: 0.898102

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 165: 0.082871
training accuracy: 1.000000     test accuracy: 0.902098
Average cost in epoch 166: 0.085550
training accuracy: 0.937500     test accuracy: 0.890110
Average cost in epoch 167: 0.081033
training accuracy: 1.000000     test accuracy: 0.890110
Average cost in epoch 168: 0.079321
training accuracy: 1.000000     test accuracy: 0.889111
Average cost in epoch 169: 0.082300
training accuracy: 0.968750     test accuracy: 0.894106

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 170: 0.077191
training accuracy: 0.968750     test accuracy: 0.891109
Average cost in epoch 171: 0.082126
training accuracy: 0.937500     test accuracy: 0.897103
Average cost in epoch 172: 0.079609
training accuracy: 1.000000     test accuracy: 0.899101
Average cost in epoch 173: 0.082255
training accuracy: 0.968750     test accuracy: 0.884116
Average cost in epoch 174: 0.078901
training accuracy: 0.968750     test accuracy: 0.892108

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 175: 0.085005
training accuracy: 0.968750     test accuracy: 0.906094
Average cost in epoch 176: 0.080662
training accuracy: 0.968750     test accuracy: 0.901099
Average cost in epoch 177: 0.082817
training accuracy: 1.000000     test accuracy: 0.902098
Average cost in epoch 178: 0.078248
training accuracy: 1.000000     test accuracy: 0.899101
Average cost in epoch 179: 0.082684
training accuracy: 0.937500     test accuracy: 0.904096

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 180: 0.080811
training accuracy: 0.968750     test accuracy: 0.888112
Average cost in epoch 181: 0.080604
training accuracy: 0.968750     test accuracy: 0.892108
Average cost in epoch 182: 0.080231
training accuracy: 0.937500     test accuracy: 0.904096
Average cost in epoch 183: 0.077684
training accuracy: 0.937500     test accuracy: 0.897103
Average cost in epoch 184: 0.080956
training accuracy: 0.937500     test accuracy: 0.896104

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 185: 0.077928
training accuracy: 0.937500     test accuracy: 0.899101
Average cost in epoch 186: 0.081713
training accuracy: 0.937500     test accuracy: 0.899101
Average cost in epoch 187: 0.079274
training accuracy: 1.000000     test accuracy: 0.893107
Average cost in epoch 188: 0.082299
training accuracy: 0.906250     test accuracy: 0.895105
Average cost in epoch 189: 0.078002
training accuracy: 1.000000     test accuracy: 0.895105

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 190: 0.081973
training accuracy: 0.968750     test accuracy: 0.887113
Average cost in epoch 191: 0.074888
training accuracy: 0.968750     test accuracy: 0.892108
Average cost in epoch 192: 0.079337
training accuracy: 1.000000     test accuracy: 0.892108
Average cost in epoch 193: 0.081744
training accuracy: 1.000000     test accuracy: 0.906094
Average cost in epoch 194: 0.079726
training accuracy: 0.937500     test accuracy: 0.905095

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Average cost in epoch 195: 0.079068
training accuracy: 0.937500     test accuracy: 0.900100
Average cost in epoch 196: 0.078361
training accuracy: 0.968750     test accuracy: 0.900100
Average cost in epoch 197: 0.081338
training accuracy: 0.906250     test accuracy: 0.897103
Average cost in epoch 198: 0.079676
training accuracy: 0.968750     test accuracy: 0.905095
Average cost in epoch 199: 0.083867
training accuracy: 0.968750     test accuracy: 0.895105

dump to weights/pyramid-lstm/pyramid-lstm_18.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 4007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 19, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_19.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 439.31
Starting training...
Average cost in epoch 0: 2.523786
training accuracy: 0.093750     test accuracy: 0.116883
Average cost in epoch 1: 2.471414
training accuracy: 0.250000     test accuracy: 0.100899
Average cost in epoch 2: 2.461279
training accuracy: 0.156250     test accuracy: 0.096903
Average cost in epoch 3: 2.457178
training accuracy: 0.093750     test accuracy: 0.091908
Average cost in epoch 4: 2.454612
training accuracy: 0.218750     test accuracy: 0.095904

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 5: 2.452739
training accuracy: 0.218750     test accuracy: 0.112887
lr decays to 0.009000
Average cost in epoch 6: 2.450332
training accuracy: 0.093750     test accuracy: 0.096903
Average cost in epoch 7: 2.449668
training accuracy: 0.187500     test accuracy: 0.107892
Average cost in epoch 8: 2.448678
training accuracy: 0.062500     test accuracy: 0.093906
Average cost in epoch 9: 2.445684
training accuracy: 0.000000     test accuracy: 0.102897

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 10: 2.445327
training accuracy: 0.187500     test accuracy: 0.093906
lr decays to 0.008100
Average cost in epoch 11: 2.441406
training accuracy: 0.125000     test accuracy: 0.095904
Average cost in epoch 12: 2.442712
training accuracy: 0.093750     test accuracy: 0.102897
Average cost in epoch 13: 2.441782
training accuracy: 0.187500     test accuracy: 0.104895
Average cost in epoch 14: 2.439410
training accuracy: 0.062500     test accuracy: 0.091908

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 15: 2.439956
training accuracy: 0.250000     test accuracy: 0.094905
lr decays to 0.007290
Average cost in epoch 16: 2.437627
training accuracy: 0.093750     test accuracy: 0.099900
Average cost in epoch 17: 2.431653
training accuracy: 0.093750     test accuracy: 0.080919
Average cost in epoch 18: 2.433647
training accuracy: 0.125000     test accuracy: 0.088911
Average cost in epoch 19: 2.432509
training accuracy: 0.156250     test accuracy: 0.098901

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 20: 2.431240
training accuracy: 0.218750     test accuracy: 0.102897
lr decays to 0.006561
Average cost in epoch 21: 2.425776
training accuracy: 0.125000     test accuracy: 0.106893
Average cost in epoch 22: 2.426398
training accuracy: 0.156250     test accuracy: 0.091908
Average cost in epoch 23: 2.422687
training accuracy: 0.093750     test accuracy: 0.098901
Average cost in epoch 24: 2.418870
training accuracy: 0.156250     test accuracy: 0.086913

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 25: 2.423671
training accuracy: 0.062500     test accuracy: 0.088911
lr decays to 0.005905
Average cost in epoch 26: 2.418375
training accuracy: 0.312500     test accuracy: 0.091908
Average cost in epoch 27: 2.414998
training accuracy: 0.156250     test accuracy: 0.094905
Average cost in epoch 28: 2.412481
training accuracy: 0.125000     test accuracy: 0.104895
Average cost in epoch 29: 2.410006
training accuracy: 0.187500     test accuracy: 0.100899

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 30: 2.406696
training accuracy: 0.062500     test accuracy: 0.079920
lr decays to 0.005314
Average cost in epoch 31: 2.403798
training accuracy: 0.187500     test accuracy: 0.096903
Average cost in epoch 32: 2.400912
training accuracy: 0.093750     test accuracy: 0.093906
Average cost in epoch 33: 2.396829
training accuracy: 0.093750     test accuracy: 0.093906
Average cost in epoch 34: 2.398330
training accuracy: 0.093750     test accuracy: 0.094905

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 35: 2.398129
training accuracy: 0.125000     test accuracy: 0.084915
lr decays to 0.004783
Average cost in epoch 36: 2.392957
training accuracy: 0.156250     test accuracy: 0.088911
Average cost in epoch 37: 2.385829
training accuracy: 0.031250     test accuracy: 0.089910
Average cost in epoch 38: 2.383957
training accuracy: 0.156250     test accuracy: 0.096903
Average cost in epoch 39: 2.384069
training accuracy: 0.062500     test accuracy: 0.090909

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 40: 2.382697
training accuracy: 0.156250     test accuracy: 0.088911
lr decays to 0.004305
Average cost in epoch 41: 2.376368
training accuracy: 0.156250     test accuracy: 0.093906
Average cost in epoch 42: 2.373040
training accuracy: 0.125000     test accuracy: 0.087912
Average cost in epoch 43: 2.368435
training accuracy: 0.218750     test accuracy: 0.076923
Average cost in epoch 44: 2.367642
training accuracy: 0.125000     test accuracy: 0.081918

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 45: 2.364270
training accuracy: 0.125000     test accuracy: 0.082917
lr decays to 0.003874
Average cost in epoch 46: 2.363358
training accuracy: 0.218750     test accuracy: 0.094905
Average cost in epoch 47: 2.359432
training accuracy: 0.218750     test accuracy: 0.092907
Average cost in epoch 48: 2.359461
training accuracy: 0.156250     test accuracy: 0.093906
Average cost in epoch 49: 2.355795
training accuracy: 0.156250     test accuracy: 0.093906

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 50: 2.354602
training accuracy: 0.156250     test accuracy: 0.093906
lr decays to 0.003487
Average cost in epoch 51: 2.342016
training accuracy: 0.093750     test accuracy: 0.092907
Average cost in epoch 52: 2.351020
training accuracy: 0.156250     test accuracy: 0.088911
Average cost in epoch 53: 2.347824
training accuracy: 0.125000     test accuracy: 0.093906
Average cost in epoch 54: 2.341000
training accuracy: 0.187500     test accuracy: 0.102897

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 55: 2.340438
training accuracy: 0.343750     test accuracy: 0.091908
lr decays to 0.003138
Average cost in epoch 56: 2.332943
training accuracy: 0.156250     test accuracy: 0.089910
Average cost in epoch 57: 2.333161
training accuracy: 0.125000     test accuracy: 0.102897
Average cost in epoch 58: 2.332598
training accuracy: 0.187500     test accuracy: 0.091908
Average cost in epoch 59: 2.323999
training accuracy: 0.125000     test accuracy: 0.101898

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 60: 2.327370
training accuracy: 0.312500     test accuracy: 0.087912
lr decays to 0.002824
Average cost in epoch 61: 2.326987
training accuracy: 0.187500     test accuracy: 0.088911
Average cost in epoch 62: 2.319455
training accuracy: 0.218750     test accuracy: 0.093906
Average cost in epoch 63: 2.315667
training accuracy: 0.093750     test accuracy: 0.087912
Average cost in epoch 64: 2.312338
training accuracy: 0.156250     test accuracy: 0.089910

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 65: 2.311248
training accuracy: 0.156250     test accuracy: 0.100899
lr decays to 0.002542
Average cost in epoch 66: 2.310112
training accuracy: 0.062500     test accuracy: 0.084915
Average cost in epoch 67: 2.299192
training accuracy: 0.156250     test accuracy: 0.091908
Average cost in epoch 68: 2.307536
training accuracy: 0.187500     test accuracy: 0.094905
Average cost in epoch 69: 2.307116
training accuracy: 0.125000     test accuracy: 0.093906

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 70: 2.299346
training accuracy: 0.250000     test accuracy: 0.094905
lr decays to 0.002288
Average cost in epoch 71: 2.297574
training accuracy: 0.218750     test accuracy: 0.087912
Average cost in epoch 72: 2.292421
training accuracy: 0.187500     test accuracy: 0.094905
Average cost in epoch 73: 2.291746
training accuracy: 0.062500     test accuracy: 0.090909
Average cost in epoch 74: 2.284442
training accuracy: 0.312500     test accuracy: 0.087912

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 75: 2.291570
training accuracy: 0.218750     test accuracy: 0.087912
lr decays to 0.002059
Average cost in epoch 76: 2.292584
training accuracy: 0.156250     test accuracy: 0.095904
Average cost in epoch 77: 2.279474
training accuracy: 0.218750     test accuracy: 0.102897
Average cost in epoch 78: 2.280657
training accuracy: 0.187500     test accuracy: 0.096903
Average cost in epoch 79: 2.282208
training accuracy: 0.187500     test accuracy: 0.097902

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 80: 2.269389
training accuracy: 0.218750     test accuracy: 0.097902
lr decays to 0.001853
Average cost in epoch 81: 2.283255
training accuracy: 0.156250     test accuracy: 0.096903
Average cost in epoch 82: 2.275468
training accuracy: 0.125000     test accuracy: 0.100899
Average cost in epoch 83: 2.275178
training accuracy: 0.156250     test accuracy: 0.096903
Average cost in epoch 84: 2.261658
training accuracy: 0.093750     test accuracy: 0.087912

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 85: 2.270749
training accuracy: 0.218750     test accuracy: 0.093906
lr decays to 0.001668
Average cost in epoch 86: 2.257937
training accuracy: 0.218750     test accuracy: 0.095904
Average cost in epoch 87: 2.262502
training accuracy: 0.187500     test accuracy: 0.096903
Average cost in epoch 88: 2.257077
training accuracy: 0.187500     test accuracy: 0.088911
Average cost in epoch 89: 2.262292
training accuracy: 0.125000     test accuracy: 0.101898

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 90: 2.251673
training accuracy: 0.125000     test accuracy: 0.095904
lr decays to 0.001501
Average cost in epoch 91: 2.248678
training accuracy: 0.187500     test accuracy: 0.094905
Average cost in epoch 92: 2.248403
training accuracy: 0.281250     test accuracy: 0.099900
Average cost in epoch 93: 2.247379
training accuracy: 0.218750     test accuracy: 0.093906
Average cost in epoch 94: 2.239522
training accuracy: 0.218750     test accuracy: 0.105894

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 95: 2.242919
training accuracy: 0.187500     test accuracy: 0.102897
lr decays to 0.001351
Average cost in epoch 96: 2.249180
training accuracy: 0.218750     test accuracy: 0.092907
Average cost in epoch 97: 2.236475
training accuracy: 0.281250     test accuracy: 0.094905
Average cost in epoch 98: 2.239989
training accuracy: 0.312500     test accuracy: 0.103896
Average cost in epoch 99: 2.236714
training accuracy: 0.125000     test accuracy: 0.089910

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 100: 2.236737
training accuracy: 0.250000     test accuracy: 0.098901
lr decays to 0.001216
Average cost in epoch 101: 2.233636
training accuracy: 0.250000     test accuracy: 0.097902
Average cost in epoch 102: 2.231500
training accuracy: 0.187500     test accuracy: 0.095904
Average cost in epoch 103: 2.226651
training accuracy: 0.250000     test accuracy: 0.096903
Average cost in epoch 104: 2.231265
training accuracy: 0.250000     test accuracy: 0.097902

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 105: 2.229440
training accuracy: 0.281250     test accuracy: 0.097902
Average cost in epoch 106: 2.227319
training accuracy: 0.312500     test accuracy: 0.095904
Average cost in epoch 107: 2.228943
training accuracy: 0.125000     test accuracy: 0.093906
Average cost in epoch 108: 2.225099
training accuracy: 0.218750     test accuracy: 0.102897
Average cost in epoch 109: 2.219440
training accuracy: 0.218750     test accuracy: 0.100899

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 110: 2.217833
training accuracy: 0.218750     test accuracy: 0.103896
Average cost in epoch 111: 2.219321
training accuracy: 0.218750     test accuracy: 0.104895
Average cost in epoch 112: 2.213449
training accuracy: 0.187500     test accuracy: 0.087912
Average cost in epoch 113: 2.215512
training accuracy: 0.250000     test accuracy: 0.094905
Average cost in epoch 114: 2.215587
training accuracy: 0.156250     test accuracy: 0.095904

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 115: 2.217123
training accuracy: 0.375000     test accuracy: 0.098901
Average cost in epoch 116: 2.231426
training accuracy: 0.187500     test accuracy: 0.104895
Average cost in epoch 117: 2.207135
training accuracy: 0.218750     test accuracy: 0.102897
Average cost in epoch 118: 2.214056
training accuracy: 0.187500     test accuracy: 0.092907
Average cost in epoch 119: 2.213224
training accuracy: 0.312500     test accuracy: 0.100899

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 120: 2.209747
training accuracy: 0.250000     test accuracy: 0.102897
Average cost in epoch 121: 2.206762
training accuracy: 0.187500     test accuracy: 0.098901
Average cost in epoch 122: 2.209711
training accuracy: 0.187500     test accuracy: 0.099900
Average cost in epoch 123: 2.209213
training accuracy: 0.218750     test accuracy: 0.098901
Average cost in epoch 124: 2.203971
training accuracy: 0.312500     test accuracy: 0.095904

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 125: 2.204047
training accuracy: 0.218750     test accuracy: 0.100899
Average cost in epoch 126: 2.212590
training accuracy: 0.250000     test accuracy: 0.098901
Average cost in epoch 127: 2.199632
training accuracy: 0.187500     test accuracy: 0.087912
Average cost in epoch 128: 2.202077
training accuracy: 0.312500     test accuracy: 0.093906
Average cost in epoch 129: 2.201822
training accuracy: 0.218750     test accuracy: 0.100899

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 130: 2.203631
training accuracy: 0.187500     test accuracy: 0.092907
Average cost in epoch 131: 2.198089
training accuracy: 0.250000     test accuracy: 0.094905
Average cost in epoch 132: 2.203323
training accuracy: 0.218750     test accuracy: 0.096903
Average cost in epoch 133: 2.199254
training accuracy: 0.187500     test accuracy: 0.094905
Average cost in epoch 134: 2.197229
training accuracy: 0.250000     test accuracy: 0.098901

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 135: 2.204447
training accuracy: 0.281250     test accuracy: 0.096903
Average cost in epoch 136: 2.200157
training accuracy: 0.218750     test accuracy: 0.100899
Average cost in epoch 137: 2.195163
training accuracy: 0.187500     test accuracy: 0.090909
Average cost in epoch 138: 2.197892
training accuracy: 0.125000     test accuracy: 0.094905
Average cost in epoch 139: 2.197108
training accuracy: 0.312500     test accuracy: 0.094905

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 140: 2.192713
training accuracy: 0.312500     test accuracy: 0.093906
Average cost in epoch 141: 2.200649
training accuracy: 0.250000     test accuracy: 0.090909
Average cost in epoch 142: 2.190423
training accuracy: 0.343750     test accuracy: 0.095904
Average cost in epoch 143: 2.202134
training accuracy: 0.218750     test accuracy: 0.096903
Average cost in epoch 144: 2.196210
training accuracy: 0.250000     test accuracy: 0.103896

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 145: 2.197811
training accuracy: 0.375000     test accuracy: 0.101898
Average cost in epoch 146: 2.191186
training accuracy: 0.218750     test accuracy: 0.096903
Average cost in epoch 147: 2.200288
training accuracy: 0.187500     test accuracy: 0.094905
Average cost in epoch 148: 2.195703
training accuracy: 0.250000     test accuracy: 0.101898
Average cost in epoch 149: 2.187836
training accuracy: 0.218750     test accuracy: 0.097902

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 150: 2.192743
training accuracy: 0.343750     test accuracy: 0.098901
Average cost in epoch 151: 2.183307
training accuracy: 0.312500     test accuracy: 0.106893
Average cost in epoch 152: 2.188081
training accuracy: 0.218750     test accuracy: 0.093906
Average cost in epoch 153: 2.187286
training accuracy: 0.343750     test accuracy: 0.097902
Average cost in epoch 154: 2.178586
training accuracy: 0.125000     test accuracy: 0.099900

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 155: 2.193406
training accuracy: 0.187500     test accuracy: 0.096903
Average cost in epoch 156: 2.185983
training accuracy: 0.218750     test accuracy: 0.097902
Average cost in epoch 157: 2.187989
training accuracy: 0.312500     test accuracy: 0.095904
Average cost in epoch 158: 2.189698
training accuracy: 0.406250     test accuracy: 0.092907
Average cost in epoch 159: 2.176328
training accuracy: 0.281250     test accuracy: 0.099900

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 160: 2.186720
training accuracy: 0.218750     test accuracy: 0.093906
Average cost in epoch 161: 2.181959
training accuracy: 0.218750     test accuracy: 0.092907
Average cost in epoch 162: 2.193051
training accuracy: 0.250000     test accuracy: 0.100899
Average cost in epoch 163: 2.182715
training accuracy: 0.187500     test accuracy: 0.097902
Average cost in epoch 164: 2.178302
training accuracy: 0.250000     test accuracy: 0.101898

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 165: 2.177118
training accuracy: 0.343750     test accuracy: 0.095904
Average cost in epoch 166: 2.182200
training accuracy: 0.187500     test accuracy: 0.096903
Average cost in epoch 167: 2.186251
training accuracy: 0.250000     test accuracy: 0.091908
Average cost in epoch 168: 2.181108
training accuracy: 0.093750     test accuracy: 0.100899
Average cost in epoch 169: 2.173559
training accuracy: 0.187500     test accuracy: 0.099900

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 170: 2.181594
training accuracy: 0.156250     test accuracy: 0.098901
Average cost in epoch 171: 2.170385
training accuracy: 0.375000     test accuracy: 0.102897
Average cost in epoch 172: 2.167485
training accuracy: 0.187500     test accuracy: 0.100899
Average cost in epoch 173: 2.170648
training accuracy: 0.187500     test accuracy: 0.098901
Average cost in epoch 174: 2.176673
training accuracy: 0.343750     test accuracy: 0.103896

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 175: 2.182204
training accuracy: 0.375000     test accuracy: 0.094905
Average cost in epoch 176: 2.165631
training accuracy: 0.250000     test accuracy: 0.091908
Average cost in epoch 177: 2.168390
training accuracy: 0.218750     test accuracy: 0.101898
Average cost in epoch 178: 2.167790
training accuracy: 0.343750     test accuracy: 0.100899
Average cost in epoch 179: 2.170558
training accuracy: 0.156250     test accuracy: 0.091908

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 180: 2.173142
training accuracy: 0.250000     test accuracy: 0.098901
Average cost in epoch 181: 2.171598
training accuracy: 0.250000     test accuracy: 0.107892
Average cost in epoch 182: 2.170372
training accuracy: 0.062500     test accuracy: 0.099900
Average cost in epoch 183: 2.164105
training accuracy: 0.281250     test accuracy: 0.105894
Average cost in epoch 184: 2.172506
training accuracy: 0.187500     test accuracy: 0.103896

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 185: 2.164399
training accuracy: 0.250000     test accuracy: 0.100899
Average cost in epoch 186: 2.168858
training accuracy: 0.250000     test accuracy: 0.098901
Average cost in epoch 187: 2.165521
training accuracy: 0.156250     test accuracy: 0.097902
Average cost in epoch 188: 2.184077
training accuracy: 0.125000     test accuracy: 0.102897
Average cost in epoch 189: 2.156335
training accuracy: 0.187500     test accuracy: 0.097902

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 190: 2.171227
training accuracy: 0.312500     test accuracy: 0.097902
Average cost in epoch 191: 2.163817
training accuracy: 0.218750     test accuracy: 0.101898
Average cost in epoch 192: 2.176156
training accuracy: 0.343750     test accuracy: 0.089910
Average cost in epoch 193: 2.161568
training accuracy: 0.156250     test accuracy: 0.097902
Average cost in epoch 194: 2.163310
training accuracy: 0.187500     test accuracy: 0.097902

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Average cost in epoch 195: 2.172510
training accuracy: 0.312500     test accuracy: 0.105894
Average cost in epoch 196: 2.168504
training accuracy: 0.187500     test accuracy: 0.104895
Average cost in epoch 197: 2.160766
training accuracy: 0.187500     test accuracy: 0.100899
Average cost in epoch 198: 2.155374
training accuracy: 0.125000     test accuracy: 0.089910
Average cost in epoch 199: 2.166776
training accuracy: 0.218750     test accuracy: 0.100899

dump to weights/pyramid-lstm/pyramid-lstm_19.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 4007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 20, 
        "data_path": "bAbI", 
        "language": "en-10k", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-lstm_20.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 435.58
Starting training...
Average cost in epoch 0: 0.298993
training accuracy: 0.906250     test accuracy: 0.911089
Average cost in epoch 1: 0.092664
training accuracy: 1.000000     test accuracy: 0.979021
Average cost in epoch 2: 0.071494
training accuracy: 0.968750     test accuracy: 0.978022
Average cost in epoch 3: 0.058403
training accuracy: 1.000000     test accuracy: 0.982018
Average cost in epoch 4: 0.056463
training accuracy: 1.000000     test accuracy: 0.978022

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 5: 0.057929
training accuracy: 1.000000     test accuracy: 0.980020
lr decays to 0.009000
Average cost in epoch 6: 0.052688
training accuracy: 0.937500     test accuracy: 0.982018
Average cost in epoch 7: 0.052882
training accuracy: 0.937500     test accuracy: 0.982018
Average cost in epoch 8: 0.051043
training accuracy: 0.906250     test accuracy: 0.983017
Average cost in epoch 9: 0.044786
training accuracy: 1.000000     test accuracy: 0.984016

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 10: 0.050781
training accuracy: 1.000000     test accuracy: 0.982018
lr decays to 0.008100
Average cost in epoch 11: 0.045265
training accuracy: 1.000000     test accuracy: 0.981019
Average cost in epoch 12: 0.046669
training accuracy: 1.000000     test accuracy: 0.980020
Average cost in epoch 13: 0.044435
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 14: 0.040209
training accuracy: 0.937500     test accuracy: 0.984016

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 15: 0.041716
training accuracy: 0.968750     test accuracy: 0.984016
lr decays to 0.007290
Average cost in epoch 16: 0.038323
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 17: 0.038543
training accuracy: 0.937500     test accuracy: 0.984016
Average cost in epoch 18: 0.033003
training accuracy: 1.000000     test accuracy: 0.982018
Average cost in epoch 19: 0.035058
training accuracy: 0.968750     test accuracy: 0.986014

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 20: 0.030657
training accuracy: 0.937500     test accuracy: 0.987013
lr decays to 0.006561
Average cost in epoch 21: 0.030808
training accuracy: 0.937500     test accuracy: 0.984016
Average cost in epoch 22: 0.027663
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 23: 0.030193
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 24: 0.026747
training accuracy: 1.000000     test accuracy: 0.982018

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 25: 0.026397
training accuracy: 0.968750     test accuracy: 0.987013
lr decays to 0.005905
Average cost in epoch 26: 0.022256
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 27: 0.019229
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 28: 0.018800
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 29: 0.021339
training accuracy: 1.000000     test accuracy: 0.987013

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 30: 0.019625
training accuracy: 1.000000     test accuracy: 0.988012
lr decays to 0.005314
Average cost in epoch 31: 0.016105
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 32: 0.018730
training accuracy: 0.968750     test accuracy: 0.986014
Average cost in epoch 33: 0.016727
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 34: 0.013669
training accuracy: 1.000000     test accuracy: 0.985015

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 35: 0.008963
training accuracy: 1.000000     test accuracy: 0.989011
lr decays to 0.004783
Average cost in epoch 36: 0.010794
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 37: 0.009514
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 38: 0.012476
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 39: 0.011286
training accuracy: 1.000000     test accuracy: 0.985015

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 40: 0.009127
training accuracy: 1.000000     test accuracy: 0.989011
lr decays to 0.004305
Average cost in epoch 41: 0.010930
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 42: 0.006532
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 43: 0.010241
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 44: 0.007429
training accuracy: 1.000000     test accuracy: 0.985015

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 45: 0.009473
training accuracy: 1.000000     test accuracy: 0.988012
lr decays to 0.003874
Average cost in epoch 46: 0.006939
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 47: 0.007440
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 48: 0.006415
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 49: 0.005597
training accuracy: 1.000000     test accuracy: 0.988012

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 50: 0.004444
training accuracy: 1.000000     test accuracy: 0.989011
lr decays to 0.003487
Average cost in epoch 51: 0.002789
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 52: 0.007029
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 53: 0.005735
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 54: 0.008259
training accuracy: 1.000000     test accuracy: 0.990010

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 55: 0.005430
training accuracy: 1.000000     test accuracy: 0.989011
lr decays to 0.003138
Average cost in epoch 56: 0.002348
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 57: 0.005337
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 58: 0.004064
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 59: 0.002408
training accuracy: 1.000000     test accuracy: 0.988012

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 60: 0.004262
training accuracy: 1.000000     test accuracy: 0.986014
lr decays to 0.002824
Average cost in epoch 61: 0.002781
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 62: 0.003221
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 63: 0.002992
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 64: 0.002669
training accuracy: 1.000000     test accuracy: 0.986014

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 65: 0.000950
training accuracy: 1.000000     test accuracy: 0.987013
lr decays to 0.002542
Average cost in epoch 66: 0.003872
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 67: 0.002050
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 68: 0.004417
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 69: 0.001937
training accuracy: 1.000000     test accuracy: 0.987013

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 70: 0.004075
training accuracy: 1.000000     test accuracy: 0.987013
lr decays to 0.002288
Average cost in epoch 71: 0.001736
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 72: 0.001152
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 73: 0.000771
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 74: 0.001062
training accuracy: 1.000000     test accuracy: 0.983017

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 75: 0.002959
training accuracy: 1.000000     test accuracy: 0.983017
lr decays to 0.002059
Average cost in epoch 76: 0.005358
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 77: 0.001763
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 78: 0.000248
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 79: 0.002334
training accuracy: 1.000000     test accuracy: 0.985015

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 80: 0.002534
training accuracy: 1.000000     test accuracy: 0.985015
lr decays to 0.001853
Average cost in epoch 81: 0.001072
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 82: 0.002873
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 83: 0.002139
training accuracy: 1.000000     test accuracy: 0.983017
Average cost in epoch 84: 0.002295
training accuracy: 1.000000     test accuracy: 0.983017

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 85: 0.002213
training accuracy: 1.000000     test accuracy: 0.983017
lr decays to 0.001668
Average cost in epoch 86: 0.003668
training accuracy: 1.000000     test accuracy: 0.983017
Average cost in epoch 87: 0.003077
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 88: 0.001202
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 89: 0.000923
training accuracy: 1.000000     test accuracy: 0.986014

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 90: 0.000794
training accuracy: 1.000000     test accuracy: 0.988012
lr decays to 0.001501
Average cost in epoch 91: 0.002056
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 92: 0.000863
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 93: 0.003263
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 94: 0.000911
training accuracy: 0.968750     test accuracy: 0.985015

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 95: 0.000596
training accuracy: 1.000000     test accuracy: 0.984016
lr decays to 0.001351
Average cost in epoch 96: 0.002442
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 97: 0.000651
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 98: 0.000270
training accuracy: 1.000000     test accuracy: 0.983017
Average cost in epoch 99: 0.000333
training accuracy: 1.000000     test accuracy: 0.981019

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 100: 0.000291
training accuracy: 1.000000     test accuracy: 0.984016
lr decays to 0.001216
Average cost in epoch 101: 0.001066
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 102: 0.000848
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 103: 0.002165
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 104: 0.000693
training accuracy: 1.000000     test accuracy: 0.983017

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 105: 0.000627
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 106: 0.000156
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 107: 0.000588
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 108: 0.000946
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 109: 0.000554
training accuracy: 1.000000     test accuracy: 0.987013

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 110: 0.000154
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 111: 0.000077
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 112: 0.000515
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 113: 0.000602
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 114: 0.000292
training accuracy: 1.000000     test accuracy: 0.986014

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 115: 0.001563
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 116: 0.000973
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 117: 0.001883
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 118: 0.000802
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 119: 0.001220
training accuracy: 1.000000     test accuracy: 0.988012

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 120: 0.000779
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 121: 0.000779
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 122: 0.001395
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 123: 0.000788
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 124: 0.001351
training accuracy: 1.000000     test accuracy: 0.988012

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 125: 0.000192
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 126: 0.000555
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 127: 0.000503
training accuracy: 1.000000     test accuracy: 0.992008
Average cost in epoch 128: 0.000119
training accuracy: 1.000000     test accuracy: 0.990010
Average cost in epoch 129: 0.000407
training accuracy: 1.000000     test accuracy: 0.990010

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 130: 0.000668
training accuracy: 1.000000     test accuracy: 0.991009
Average cost in epoch 131: 0.001399
training accuracy: 1.000000     test accuracy: 0.990010
Average cost in epoch 132: 0.000571
training accuracy: 1.000000     test accuracy: 0.990010
Average cost in epoch 133: 0.000185
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 134: 0.000108
training accuracy: 1.000000     test accuracy: 0.986014

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 135: 0.000716
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 136: 0.000080
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 137: 0.001953
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 138: 0.000987
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 139: 0.000665
training accuracy: 1.000000     test accuracy: 0.985015

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 140: 0.000180
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 141: 0.000876
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 142: 0.000657
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 143: 0.002347
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 144: 0.000322
training accuracy: 1.000000     test accuracy: 0.989011

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 145: 0.000754
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 146: 0.002143
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 147: 0.000455
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 148: 0.001397
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 149: 0.000084
training accuracy: 1.000000     test accuracy: 0.987013

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 150: 0.001254
training accuracy: 1.000000     test accuracy: 0.983017
Average cost in epoch 151: 0.001150
training accuracy: 1.000000     test accuracy: 0.990010
Average cost in epoch 152: 0.000359
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 153: 0.000511
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 154: 0.000358
training accuracy: 1.000000     test accuracy: 0.988012

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 155: 0.001484
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 156: 0.000556
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 157: 0.000674
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 158: 0.000111
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 159: 0.003127
training accuracy: 1.000000     test accuracy: 0.986014

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 160: 0.000347
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 161: 0.000382
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 162: 0.000111
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 163: 0.001559
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 164: 0.001648
training accuracy: 1.000000     test accuracy: 0.991009

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 165: 0.000503
training accuracy: 1.000000     test accuracy: 0.990010
Average cost in epoch 166: 0.002775
training accuracy: 1.000000     test accuracy: 0.992008
Average cost in epoch 167: 0.000069
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 168: 0.000060
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 169: 0.001552
training accuracy: 1.000000     test accuracy: 0.989011

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 170: 0.000610
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 171: 0.000015
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 172: 0.003108
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 173: 0.000210
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 174: 0.001214
training accuracy: 1.000000     test accuracy: 0.985015

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 175: 0.001645
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 176: 0.000198
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 177: 0.000108
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 178: 0.000598
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 179: 0.000403
training accuracy: 1.000000     test accuracy: 0.988012

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 180: 0.001181
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 181: 0.001259
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 182: 0.000030
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 183: 0.002978
training accuracy: 1.000000     test accuracy: 0.988012
Average cost in epoch 184: 0.000046
training accuracy: 1.000000     test accuracy: 0.989011

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 185: 0.000592
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 186: 0.000434
training accuracy: 1.000000     test accuracy: 0.985015
Average cost in epoch 187: 0.000763
training accuracy: 1.000000     test accuracy: 0.986014
Average cost in epoch 188: 0.000865
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 189: 0.000304
training accuracy: 1.000000     test accuracy: 0.989011

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 190: 0.000229
training accuracy: 1.000000     test accuracy: 0.990010
Average cost in epoch 191: 0.000152
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 192: 0.000317
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 193: 0.000133
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 194: 0.000204
training accuracy: 1.000000     test accuracy: 0.989011

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Average cost in epoch 195: 0.000178
training accuracy: 1.000000     test accuracy: 0.989011
Average cost in epoch 196: 0.000783
training accuracy: 1.000000     test accuracy: 0.987013
Average cost in epoch 197: 0.002690
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 198: 0.000383
training accuracy: 1.000000     test accuracy: 0.984016
Average cost in epoch 199: 0.000149
training accuracy: 1.000000     test accuracy: 0.986014

dump to weights/pyramid-lstm/pyramid-lstm_20.pkl

Locking... locked.
No job requests to schedule
