/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 1, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_1.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
INFO (theano.gof.compilelock): Waiting for existing lock by unknown process (I am process '24736')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '25197' (I am process '24736')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '25197' (I am process '24736')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '25197' (I am process '24736')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
Ending compiling...
Compiling time: 131.94
Starting training...
Average cost in epoch 0: 2.038547
training accuracy: 0.406250     test accuracy: 0.480519
Average cost in epoch 1: 1.591886
training accuracy: 0.609375     test accuracy: 0.526474
Average cost in epoch 2: 1.503206
training accuracy: 0.671875     test accuracy: 0.526474
Average cost in epoch 3: 1.471384
training accuracy: 0.500000     test accuracy: 0.513487
Average cost in epoch 4: 1.403331
training accuracy: 0.515625     test accuracy: 0.523477

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 5: 1.362556
training accuracy: 0.546875     test accuracy: 0.518482
lr decays to 0.009000
Average cost in epoch 6: 1.371402
training accuracy: 0.468750     test accuracy: 0.527473
Average cost in epoch 7: 1.311885
training accuracy: 0.562500     test accuracy: 0.507493
Average cost in epoch 8: 1.281139
training accuracy: 0.546875     test accuracy: 0.514486
Average cost in epoch 9: 1.312737
training accuracy: 0.640625     test accuracy: 0.516484

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 10: 1.302499
training accuracy: 0.562500     test accuracy: 0.507493
lr decays to 0.008100
Average cost in epoch 11: 1.228174
training accuracy: 0.484375     test accuracy: 0.516484
Average cost in epoch 12: 1.228569
training accuracy: 0.500000     test accuracy: 0.507493
Average cost in epoch 13: 1.268300
training accuracy: 0.703125     test accuracy: 0.504496
Average cost in epoch 14: 1.172671
training accuracy: 0.656250     test accuracy: 0.502498

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 15: 1.215203
training accuracy: 0.562500     test accuracy: 0.512488
lr decays to 0.007290
Average cost in epoch 16: 1.151906
training accuracy: 0.640625     test accuracy: 0.487512
Average cost in epoch 17: 1.148726
training accuracy: 0.640625     test accuracy: 0.502498
Average cost in epoch 18: 1.137496
training accuracy: 0.468750     test accuracy: 0.507493
Average cost in epoch 19: 1.122821
training accuracy: 0.625000     test accuracy: 0.499500

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 20: 1.160549
training accuracy: 0.593750     test accuracy: 0.503497
lr decays to 0.006561
Average cost in epoch 21: 1.072362
training accuracy: 0.515625     test accuracy: 0.515485
Average cost in epoch 22: 1.134116
training accuracy: 0.531250     test accuracy: 0.476523
Average cost in epoch 23: 1.071260
training accuracy: 0.593750     test accuracy: 0.491508
Average cost in epoch 24: 1.116783
training accuracy: 0.687500     test accuracy: 0.509491

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 25: 1.093578
training accuracy: 0.609375     test accuracy: 0.489510
lr decays to 0.005905
Average cost in epoch 26: 1.061792
training accuracy: 0.687500     test accuracy: 0.477522
Average cost in epoch 27: 1.088519
training accuracy: 0.625000     test accuracy: 0.490509
Average cost in epoch 28: 1.058655
training accuracy: 0.500000     test accuracy: 0.490509
Average cost in epoch 29: 1.040146
training accuracy: 0.687500     test accuracy: 0.500500

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 30: 1.000325
training accuracy: 0.531250     test accuracy: 0.491508
lr decays to 0.005314
Average cost in epoch 31: 0.996216
training accuracy: 0.625000     test accuracy: 0.474525
Average cost in epoch 32: 1.005380
training accuracy: 0.656250     test accuracy: 0.494505
Average cost in epoch 33: 1.036322
training accuracy: 0.734375     test accuracy: 0.484515
Average cost in epoch 34: 0.962493
training accuracy: 0.640625     test accuracy: 0.481518

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 35: 0.992435
training accuracy: 0.562500     test accuracy: 0.481518
lr decays to 0.004783
Average cost in epoch 36: 0.979406
training accuracy: 0.546875     test accuracy: 0.457542
Average cost in epoch 37: 0.911110
training accuracy: 0.609375     test accuracy: 0.476523
Average cost in epoch 38: 0.944959
training accuracy: 0.625000     test accuracy: 0.463536
Average cost in epoch 39: 0.932925
training accuracy: 0.625000     test accuracy: 0.487512

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 40: 0.966805
training accuracy: 0.734375     test accuracy: 0.496503
lr decays to 0.004305
Average cost in epoch 41: 0.886429
training accuracy: 0.640625     test accuracy: 0.470529
Average cost in epoch 42: 0.929023
training accuracy: 0.671875     test accuracy: 0.463536
Average cost in epoch 43: 0.940734
training accuracy: 0.562500     test accuracy: 0.480519
Average cost in epoch 44: 0.918388
training accuracy: 0.640625     test accuracy: 0.479520

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 45: 0.899183
training accuracy: 0.671875     test accuracy: 0.473526
lr decays to 0.003874
Average cost in epoch 46: 0.889528
training accuracy: 0.703125     test accuracy: 0.459540
Average cost in epoch 47: 0.861369
training accuracy: 0.734375     test accuracy: 0.473526
Average cost in epoch 48: 0.894781
training accuracy: 0.750000     test accuracy: 0.479520
Average cost in epoch 49: 0.886071
training accuracy: 0.796875     test accuracy: 0.461538

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 50: 0.817011
training accuracy: 0.718750     test accuracy: 0.480519
lr decays to 0.003487
Average cost in epoch 51: 0.865182
training accuracy: 0.703125     test accuracy: 0.471528
Average cost in epoch 52: 0.849779
training accuracy: 0.765625     test accuracy: 0.473526
Average cost in epoch 53: 0.820316
training accuracy: 0.718750     test accuracy: 0.483516
Average cost in epoch 54: 0.842451
training accuracy: 0.671875     test accuracy: 0.445554

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 55: 0.834024
training accuracy: 0.640625     test accuracy: 0.473526
lr decays to 0.003138
Average cost in epoch 56: 0.759776
training accuracy: 0.703125     test accuracy: 0.465534
Average cost in epoch 57: 0.828409
training accuracy: 0.765625     test accuracy: 0.464535
Average cost in epoch 58: 0.774799
training accuracy: 0.765625     test accuracy: 0.462537
Average cost in epoch 59: 0.809229
training accuracy: 0.765625     test accuracy: 0.460539

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 60: 0.784847
training accuracy: 0.875000     test accuracy: 0.464535
lr decays to 0.002824
Average cost in epoch 61: 0.810666
training accuracy: 0.781250     test accuracy: 0.463536
Average cost in epoch 62: 0.768680
training accuracy: 0.828125     test accuracy: 0.475524
Average cost in epoch 63: 0.800137
training accuracy: 0.671875     test accuracy: 0.484515
Average cost in epoch 64: 0.785233
training accuracy: 0.734375     test accuracy: 0.475524

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 65: 0.788207
training accuracy: 0.656250     test accuracy: 0.469530
lr decays to 0.002542
Average cost in epoch 66: 0.744300
training accuracy: 0.734375     test accuracy: 0.464535
Average cost in epoch 67: 0.745214
training accuracy: 0.843750     test accuracy: 0.455544
Average cost in epoch 68: 0.741376
training accuracy: 0.750000     test accuracy: 0.468531
Average cost in epoch 69: 0.714806
training accuracy: 0.687500     test accuracy: 0.468531

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 70: 0.738739
training accuracy: 0.687500     test accuracy: 0.473526
lr decays to 0.002288
Average cost in epoch 71: 0.736601
training accuracy: 0.687500     test accuracy: 0.458541
Average cost in epoch 72: 0.686506
training accuracy: 0.765625     test accuracy: 0.466533
Average cost in epoch 73: 0.735722
training accuracy: 0.796875     test accuracy: 0.457542
Average cost in epoch 74: 0.707317
training accuracy: 0.750000     test accuracy: 0.461538

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 75: 0.685897
training accuracy: 0.781250     test accuracy: 0.467532
lr decays to 0.002059
Average cost in epoch 76: 0.678110
training accuracy: 0.671875     test accuracy: 0.466533
Average cost in epoch 77: 0.687986
training accuracy: 0.656250     test accuracy: 0.463536
Average cost in epoch 78: 0.675051
training accuracy: 0.796875     test accuracy: 0.472527
Average cost in epoch 79: 0.702489
training accuracy: 0.781250     test accuracy: 0.460539

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 80: 0.616613
training accuracy: 0.718750     test accuracy: 0.457542
lr decays to 0.001853
Average cost in epoch 81: 0.636533
training accuracy: 0.703125     test accuracy: 0.473526
Average cost in epoch 82: 0.690640
training accuracy: 0.734375     test accuracy: 0.475524
Average cost in epoch 83: 0.639630
training accuracy: 0.796875     test accuracy: 0.460539
Average cost in epoch 84: 0.650182
training accuracy: 0.843750     test accuracy: 0.475524

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 85: 0.663932
training accuracy: 0.703125     test accuracy: 0.468531
lr decays to 0.001668
Average cost in epoch 86: 0.629802
training accuracy: 0.843750     test accuracy: 0.474525
Average cost in epoch 87: 0.655478
training accuracy: 0.734375     test accuracy: 0.470529
Average cost in epoch 88: 0.657431
training accuracy: 0.718750     test accuracy: 0.468531
Average cost in epoch 89: 0.632631
training accuracy: 0.750000     test accuracy: 0.468531

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 90: 0.608033
training accuracy: 0.734375     test accuracy: 0.472527
lr decays to 0.001501
Average cost in epoch 91: 0.650379
training accuracy: 0.843750     test accuracy: 0.460539
Average cost in epoch 92: 0.637936
training accuracy: 0.765625     test accuracy: 0.471528
Average cost in epoch 93: 0.597936
training accuracy: 0.843750     test accuracy: 0.469530
Average cost in epoch 94: 0.659095
training accuracy: 0.828125     test accuracy: 0.460539

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 95: 0.572249
training accuracy: 0.718750     test accuracy: 0.460539
lr decays to 0.001351
Average cost in epoch 96: 0.641829
training accuracy: 0.859375     test accuracy: 0.461538
Average cost in epoch 97: 0.583280
training accuracy: 0.828125     test accuracy: 0.458541
Average cost in epoch 98: 0.669377
training accuracy: 0.921875     test accuracy: 0.459540
Average cost in epoch 99: 0.606911
training accuracy: 0.812500     test accuracy: 0.457542

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 100: 0.573713
training accuracy: 0.843750     test accuracy: 0.472527
lr decays to 0.001216
Average cost in epoch 101: 0.619127
training accuracy: 0.828125     test accuracy: 0.463536
Average cost in epoch 102: 0.604051
training accuracy: 0.765625     test accuracy: 0.458541
Average cost in epoch 103: 0.573487
training accuracy: 0.937500     test accuracy: 0.461538
Average cost in epoch 104: 0.597875
training accuracy: 0.859375     test accuracy: 0.472527

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 105: 0.676290
training accuracy: 0.796875     test accuracy: 0.469530
Average cost in epoch 106: 0.575823
training accuracy: 0.781250     test accuracy: 0.470529
Average cost in epoch 107: 0.598156
training accuracy: 0.843750     test accuracy: 0.468531
Average cost in epoch 108: 0.614301
training accuracy: 0.781250     test accuracy: 0.450549
Average cost in epoch 109: 0.578689
training accuracy: 0.875000     test accuracy: 0.453546

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 110: 0.574113
training accuracy: 0.843750     test accuracy: 0.455544
Average cost in epoch 111: 0.571986
training accuracy: 0.781250     test accuracy: 0.459540
Average cost in epoch 112: 0.548512
training accuracy: 0.703125     test accuracy: 0.458541
Average cost in epoch 113: 0.561938
training accuracy: 0.796875     test accuracy: 0.464535
Average cost in epoch 114: 0.581150
training accuracy: 0.843750     test accuracy: 0.462537

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 115: 0.540762
training accuracy: 0.796875     test accuracy: 0.455544
Average cost in epoch 116: 0.596740
training accuracy: 0.781250     test accuracy: 0.465534
Average cost in epoch 117: 0.595773
training accuracy: 0.828125     test accuracy: 0.462537
Average cost in epoch 118: 0.561475
training accuracy: 0.828125     test accuracy: 0.462537
Average cost in epoch 119: 0.529039
training accuracy: 0.781250     test accuracy: 0.463536

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 120: 0.565462
training accuracy: 0.781250     test accuracy: 0.463536
Average cost in epoch 121: 0.553803
training accuracy: 0.796875     test accuracy: 0.462537
Average cost in epoch 122: 0.579978
training accuracy: 0.859375     test accuracy: 0.458541
Average cost in epoch 123: 0.572846
training accuracy: 0.812500     test accuracy: 0.464535
Average cost in epoch 124: 0.574243
training accuracy: 0.796875     test accuracy: 0.464535

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 125: 0.568315
training accuracy: 0.796875     test accuracy: 0.472527
Average cost in epoch 126: 0.541429
training accuracy: 0.703125     test accuracy: 0.464535
Average cost in epoch 127: 0.558959
training accuracy: 0.734375     test accuracy: 0.457542
Average cost in epoch 128: 0.531557
training accuracy: 0.890625     test accuracy: 0.476523
Average cost in epoch 129: 0.564249
training accuracy: 0.812500     test accuracy: 0.465534

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 130: 0.542684
training accuracy: 0.859375     test accuracy: 0.467532
Average cost in epoch 131: 0.532891
training accuracy: 0.875000     test accuracy: 0.459540
Average cost in epoch 132: 0.535243
training accuracy: 0.828125     test accuracy: 0.463536
Average cost in epoch 133: 0.542903
training accuracy: 0.796875     test accuracy: 0.459540
Average cost in epoch 134: 0.529221
training accuracy: 0.875000     test accuracy: 0.461538

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 135: 0.563959
training accuracy: 0.875000     test accuracy: 0.473526
Average cost in epoch 136: 0.500388
training accuracy: 0.765625     test accuracy: 0.458541
Average cost in epoch 137: 0.511168
training accuracy: 0.796875     test accuracy: 0.461538
Average cost in epoch 138: 0.505466
training accuracy: 0.828125     test accuracy: 0.466533
Average cost in epoch 139: 0.520432
training accuracy: 0.968750     test accuracy: 0.463536

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 140: 0.560284
training accuracy: 0.765625     test accuracy: 0.452547
Average cost in epoch 141: 0.497680
training accuracy: 0.812500     test accuracy: 0.448551
Average cost in epoch 142: 0.547187
training accuracy: 0.843750     test accuracy: 0.457542
Average cost in epoch 143: 0.521776
training accuracy: 0.828125     test accuracy: 0.452547
Average cost in epoch 144: 0.552527
training accuracy: 0.843750     test accuracy: 0.460539

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 145: 0.492913
training accuracy: 0.828125     test accuracy: 0.459540
Average cost in epoch 146: 0.501832
training accuracy: 0.750000     test accuracy: 0.458541
Average cost in epoch 147: 0.526477
training accuracy: 0.750000     test accuracy: 0.457542
Average cost in epoch 148: 0.476936
training accuracy: 0.812500     test accuracy: 0.463536
Average cost in epoch 149: 0.514397
training accuracy: 0.796875     test accuracy: 0.445554

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 150: 0.501731
training accuracy: 0.734375     test accuracy: 0.461538
Average cost in epoch 151: 0.538118
training accuracy: 0.828125     test accuracy: 0.457542
Average cost in epoch 152: 0.511784
training accuracy: 0.843750     test accuracy: 0.456543
Average cost in epoch 153: 0.514739
training accuracy: 0.859375     test accuracy: 0.450549
Average cost in epoch 154: 0.464677
training accuracy: 0.812500     test accuracy: 0.457542

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 155: 0.502716
training accuracy: 0.843750     test accuracy: 0.455544
Average cost in epoch 156: 0.511308
training accuracy: 0.859375     test accuracy: 0.455544
Average cost in epoch 157: 0.498543
training accuracy: 0.859375     test accuracy: 0.460539
Average cost in epoch 158: 0.463181
training accuracy: 0.875000     test accuracy: 0.456543
Average cost in epoch 159: 0.470062
training accuracy: 0.796875     test accuracy: 0.460539

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 160: 0.492349
training accuracy: 0.875000     test accuracy: 0.463536
Average cost in epoch 161: 0.521128
training accuracy: 0.843750     test accuracy: 0.461538
Average cost in epoch 162: 0.489446
training accuracy: 0.843750     test accuracy: 0.448551
Average cost in epoch 163: 0.496412
training accuracy: 0.937500     test accuracy: 0.452547
Average cost in epoch 164: 0.540617
training accuracy: 0.875000     test accuracy: 0.461538

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 165: 0.471029
training accuracy: 0.796875     test accuracy: 0.457542
Average cost in epoch 166: 0.429853
training accuracy: 0.843750     test accuracy: 0.461538
Average cost in epoch 167: 0.488193
training accuracy: 0.765625     test accuracy: 0.454545
Average cost in epoch 168: 0.502885
training accuracy: 0.859375     test accuracy: 0.460539
Average cost in epoch 169: 0.492560
training accuracy: 0.796875     test accuracy: 0.462537

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 170: 0.460120
training accuracy: 0.828125     test accuracy: 0.463536
Average cost in epoch 171: 0.478248
training accuracy: 0.812500     test accuracy: 0.455544
Average cost in epoch 172: 0.423862
training accuracy: 0.750000     test accuracy: 0.451548
Average cost in epoch 173: 0.462502
training accuracy: 0.890625     test accuracy: 0.455544
Average cost in epoch 174: 0.481679
training accuracy: 0.890625     test accuracy: 0.446553

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 175: 0.442531
training accuracy: 0.859375     test accuracy: 0.452547
Average cost in epoch 176: 0.435200
training accuracy: 0.812500     test accuracy: 0.461538
Average cost in epoch 177: 0.493514
training accuracy: 0.859375     test accuracy: 0.461538
Average cost in epoch 178: 0.474302
training accuracy: 0.890625     test accuracy: 0.455544
Average cost in epoch 179: 0.443602
training accuracy: 0.828125     test accuracy: 0.452547

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 180: 0.450827
training accuracy: 0.843750     test accuracy: 0.449550
Average cost in epoch 181: 0.472304
training accuracy: 0.781250     test accuracy: 0.457542
Average cost in epoch 182: 0.444006
training accuracy: 0.843750     test accuracy: 0.462537
Average cost in epoch 183: 0.477465
training accuracy: 0.906250     test accuracy: 0.459540
Average cost in epoch 184: 0.506106
training accuracy: 0.812500     test accuracy: 0.462537

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 185: 0.447409
training accuracy: 0.828125     test accuracy: 0.455544
Average cost in epoch 186: 0.484520
training accuracy: 0.875000     test accuracy: 0.457542
Average cost in epoch 187: 0.453523
training accuracy: 0.890625     test accuracy: 0.463536
Average cost in epoch 188: 0.514439
training accuracy: 0.875000     test accuracy: 0.454545
Average cost in epoch 189: 0.440167
training accuracy: 0.859375     test accuracy: 0.450549

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 190: 0.426799
training accuracy: 0.890625     test accuracy: 0.464535
Average cost in epoch 191: 0.442615
training accuracy: 0.859375     test accuracy: 0.464535
Average cost in epoch 192: 0.438332
training accuracy: 0.843750     test accuracy: 0.456543
Average cost in epoch 193: 0.462718
training accuracy: 0.859375     test accuracy: 0.469530
Average cost in epoch 194: 0.482821
training accuracy: 0.859375     test accuracy: 0.463536

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 195: 0.406672
training accuracy: 0.843750     test accuracy: 0.461538
Average cost in epoch 196: 0.490615
training accuracy: 0.890625     test accuracy: 0.457542
Average cost in epoch 197: 0.390868
training accuracy: 0.828125     test accuracy: 0.458541
Average cost in epoch 198: 0.447042
training accuracy: 0.859375     test accuracy: 0.462537
Average cost in epoch 199: 0.415067
training accuracy: 0.890625     test accuracy: 0.466533

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Locking... locked.
Executing '9222-yetian1' on deep7/1 as yetian1...
Executing '9223-yetian1' on deep10/3 as yetian1...
Executing '9224-yetian1' on deep11/0 as yetian1...
INFO (theano.gof.compilelock): Waiting for existing lock by process '24736' (I am process '24954')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 1, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_1.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
INFO (theano.gof.compilelock): Waiting for existing lock by process '27482' (I am process '24954')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '27708' (I am process '24954')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '13401' (I am process '24954')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23385' (I am process '24954')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23609' (I am process '24954')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '1057' (I am process '24954')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
Ending compiling...
Compiling time: 144.41
Starting training...
Average cost in epoch 0: 2.082668
training accuracy: 0.281250     test accuracy: 0.312687
Average cost in epoch 1: 1.670302
training accuracy: 0.375000     test accuracy: 0.438561
Average cost in epoch 2: 1.588383
training accuracy: 0.484375     test accuracy: 0.438561
Average cost in epoch 3: 1.513533
training accuracy: 0.578125     test accuracy: 0.526474
Average cost in epoch 4: 1.485261
training accuracy: 0.500000     test accuracy: 0.522478

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 5: 1.423650
training accuracy: 0.531250     test accuracy: 0.524476
lr decays to 0.009000
Average cost in epoch 6: 1.427561
training accuracy: 0.562500     test accuracy: 0.521479
Average cost in epoch 7: 1.420354
training accuracy: 0.437500     test accuracy: 0.497502
Average cost in epoch 8: 1.368070
training accuracy: 0.500000     test accuracy: 0.523477
Average cost in epoch 9: 1.323442
training accuracy: 0.562500     test accuracy: 0.516484

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 10: 1.282035
training accuracy: 0.484375     test accuracy: 0.485514
lr decays to 0.008100
Average cost in epoch 11: 1.301205
training accuracy: 0.593750     test accuracy: 0.508492
Average cost in epoch 12: 1.245642
training accuracy: 0.578125     test accuracy: 0.506494
Average cost in epoch 13: 1.262827
training accuracy: 0.468750     test accuracy: 0.497502
Average cost in epoch 14: 1.184838
training accuracy: 0.609375     test accuracy: 0.511489

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 15: 1.219540
training accuracy: 0.515625     test accuracy: 0.509491
lr decays to 0.007290
Average cost in epoch 16: 1.189523
training accuracy: 0.625000     test accuracy: 0.509491
Average cost in epoch 17: 1.178419
training accuracy: 0.671875     test accuracy: 0.513487
Average cost in epoch 18: 1.187394
training accuracy: 0.562500     test accuracy: 0.508492
Average cost in epoch 19: 1.122170
training accuracy: 0.593750     test accuracy: 0.495504

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 20: 1.134807
training accuracy: 0.562500     test accuracy: 0.503497
lr decays to 0.006561
Average cost in epoch 21: 1.177729
training accuracy: 0.640625     test accuracy: 0.509491
Average cost in epoch 22: 1.103988
training accuracy: 0.578125     test accuracy: 0.497502
Average cost in epoch 23: 1.131352
training accuracy: 0.562500     test accuracy: 0.494505
Average cost in epoch 24: 1.082653
training accuracy: 0.625000     test accuracy: 0.494505

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 25: 1.081620
training accuracy: 0.609375     test accuracy: 0.517483
lr decays to 0.005905
Average cost in epoch 26: 1.034366
training accuracy: 0.578125     test accuracy: 0.502498
Average cost in epoch 27: 1.027724
training accuracy: 0.625000     test accuracy: 0.496503
Average cost in epoch 28: 1.010860
training accuracy: 0.578125     test accuracy: 0.503497
Average cost in epoch 29: 1.008351
training accuracy: 0.609375     test accuracy: 0.499500

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 30: 1.029674
training accuracy: 0.578125     test accuracy: 0.508492
lr decays to 0.005314
Average cost in epoch 31: 1.014352
training accuracy: 0.609375     test accuracy: 0.488511
Average cost in epoch 32: 0.963172
training accuracy: 0.671875     test accuracy: 0.484515
Average cost in epoch 33: 0.980267
training accuracy: 0.578125     test accuracy: 0.485514
Average cost in epoch 34: 0.919093
training accuracy: 0.687500     test accuracy: 0.503497

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 35: 0.931177
training accuracy: 0.562500     test accuracy: 0.481518
lr decays to 0.004783
Average cost in epoch 36: 0.926089
training accuracy: 0.671875     test accuracy: 0.493506
Average cost in epoch 37: 0.944723
training accuracy: 0.734375     test accuracy: 0.480519
Average cost in epoch 38: 0.954637
training accuracy: 0.703125     test accuracy: 0.482517
Average cost in epoch 39: 0.900385
training accuracy: 0.515625     test accuracy: 0.462537

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 40: 0.908029
training accuracy: 0.609375     test accuracy: 0.462537
lr decays to 0.004305
Average cost in epoch 41: 0.908897
training accuracy: 0.656250     test accuracy: 0.484515
Average cost in epoch 42: 0.867019
training accuracy: 0.671875     test accuracy: 0.472527
Average cost in epoch 43: 0.867511
training accuracy: 0.671875     test accuracy: 0.467532
Average cost in epoch 44: 0.848411
training accuracy: 0.781250     test accuracy: 0.472527

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 45: 0.902240
training accuracy: 0.750000     test accuracy: 0.485514
lr decays to 0.003874
Average cost in epoch 46: 0.816231
training accuracy: 0.781250     test accuracy: 0.473526
Average cost in epoch 47: 0.851838
training accuracy: 0.765625     test accuracy: 0.469530
Average cost in epoch 48: 0.761116
training accuracy: 0.656250     test accuracy: 0.490509
Average cost in epoch 49: 0.814462
training accuracy: 0.671875     test accuracy: 0.478521

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 50: 0.862309
training accuracy: 0.593750     test accuracy: 0.474525
lr decays to 0.003487
Average cost in epoch 51: 0.765570
training accuracy: 0.765625     test accuracy: 0.471528
Average cost in epoch 52: 0.776701
training accuracy: 0.671875     test accuracy: 0.486513
Average cost in epoch 53: 0.789710
training accuracy: 0.703125     test accuracy: 0.471528
Average cost in epoch 54: 0.723332
training accuracy: 0.625000     test accuracy: 0.471528

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 55: 0.779555
training accuracy: 0.750000     test accuracy: 0.468531
lr decays to 0.003138
Average cost in epoch 56: 0.736086
training accuracy: 0.703125     test accuracy: 0.472527
Average cost in epoch 57: 0.752567
training accuracy: 0.765625     test accuracy: 0.471528
Average cost in epoch 58: 0.749323
training accuracy: 0.765625     test accuracy: 0.476523
Average cost in epoch 59: 0.711121
training accuracy: 0.765625     test accuracy: 0.480519

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 60: 0.787970
training accuracy: 0.671875     test accuracy: 0.474525
lr decays to 0.002824
Average cost in epoch 61: 0.666124
training accuracy: 0.812500     test accuracy: 0.481518
Average cost in epoch 62: 0.700091
training accuracy: 0.671875     test accuracy: 0.469530
GAverage cost in epoch 63: 0.693779
training accuracy: 0.734375     test accuracy: 0.482517
Average cost in epoch 64: 0.654492
training accuracy: 0.765625     test accuracy: 0.466533

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 65: 0.674841
training accuracy: 0.718750     test accuracy: 0.477522
lr decays to 0.002542
Average cost in epoch 66: 0.715575
training accuracy: 0.765625     test accuracy: 0.477522
Average cost in epoch 67: 0.668963
training accuracy: 0.812500     test accuracy: 0.482517
Average cost in epoch 68: 0.667739
training accuracy: 0.796875     test accuracy: 0.482517
Average cost in epoch 69: 0.665613
training accuracy: 0.875000     test accuracy: 0.479520

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 70: 0.650913
training accuracy: 0.781250     test accuracy: 0.480519
lr decays to 0.002288
Average cost in epoch 71: 0.693182
training accuracy: 0.703125     test accuracy: 0.478521
Average cost in epoch 72: 0.589041
training accuracy: 0.703125     test accuracy: 0.475524
Average cost in epoch 73: 0.637888
training accuracy: 0.812500     test accuracy: 0.460539
Average cost in epoch 74: 0.622105
training accuracy: 0.734375     test accuracy: 0.470529

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 75: 0.578585
training accuracy: 0.843750     test accuracy: 0.478521
lr decays to 0.002059
Average cost in epoch 76: 0.598371
training accuracy: 0.765625     test accuracy: 0.479520
Average cost in epoch 77: 0.606701
training accuracy: 0.843750     test accuracy: 0.468531
Average cost in epoch 78: 0.610716
training accuracy: 0.843750     test accuracy: 0.473526
Average cost in epoch 79: 0.613387
training accuracy: 0.765625     test accuracy: 0.468531

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 80: 0.601167
training accuracy: 0.781250     test accuracy: 0.478521
lr decays to 0.001853
Average cost in epoch 81: 0.590028
training accuracy: 0.828125     test accuracy: 0.461538
Average cost in epoch 82: 0.575409
training accuracy: 0.750000     test accuracy: 0.467532
Average cost in epoch 83: 0.591018
training accuracy: 0.796875     test accuracy: 0.462537
Average cost in epoch 84: 0.582553
training accuracy: 0.812500     test accuracy: 0.468531

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 85: 0.573368
training accuracy: 0.734375     test accuracy: 0.467532
lr decays to 0.001668
Average cost in epoch 86: 0.572090
training accuracy: 0.765625     test accuracy: 0.475524
Average cost in epoch 87: 0.554488
training accuracy: 0.796875     test accuracy: 0.477522
Average cost in epoch 88: 0.568156
training accuracy: 0.765625     test accuracy: 0.462537
Average cost in epoch 89: 0.553774
training accuracy: 0.937500     test accuracy: 0.479520

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 90: 0.566013
training accuracy: 0.843750     test accuracy: 0.476523
lr decays to 0.001501
Average cost in epoch 91: 0.506839
training accuracy: 0.812500     test accuracy: 0.475524
Average cost in epoch 92: 0.527907
training accuracy: 0.843750     test accuracy: 0.480519
Average cost in epoch 93: 0.544242
training accuracy: 0.875000     test accuracy: 0.474525
Average cost in epoch 94: 0.507358
training accuracy: 0.765625     test accuracy: 0.475524

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 95: 0.524572
training accuracy: 0.781250     test accuracy: 0.476523
lr decays to 0.001351
Average cost in epoch 96: 0.513865
training accuracy: 0.906250     test accuracy: 0.482517
Average cost in epoch 97: 0.505625
training accuracy: 0.890625     test accuracy: 0.474525
Average cost in epoch 98: 0.486738
training accuracy: 0.828125     test accuracy: 0.466533
Average cost in epoch 99: 0.520222
training accuracy: 0.890625     test accuracy: 0.476523

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 100: 0.510367
training accuracy: 0.843750     test accuracy: 0.477522
lr decays to 0.001216
Average cost in epoch 101: 0.478860
training accuracy: 0.859375     test accuracy: 0.479520
Average cost in epoch 102: 0.488934
training accuracy: 0.843750     test accuracy: 0.479520
Average cost in epoch 103: 0.489166
training accuracy: 0.859375     test accuracy: 0.471528
Average cost in epoch 104: 0.496368
training accuracy: 0.765625     test accuracy: 0.466533

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 105: 0.494126
training accuracy: 0.812500     test accuracy: 0.474525
Average cost in epoch 106: 0.482404
training accuracy: 0.828125     test accuracy: 0.477522
Average cost in epoch 107: 0.530310
training accuracy: 0.843750     test accuracy: 0.464535
Average cost in epoch 108: 0.475455
training accuracy: 0.750000     test accuracy: 0.469530
Average cost in epoch 109: 0.498019
training accuracy: 0.921875     test accuracy: 0.468531

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 110: 0.438023
training accuracy: 0.906250     test accuracy: 0.475524
Average cost in epoch 111: 0.475794
training accuracy: 0.906250     test accuracy: 0.477522
Average cost in epoch 112: 0.479816
training accuracy: 0.796875     test accuracy: 0.469530
Average cost in epoch 113: 0.464552
training accuracy: 0.796875     test accuracy: 0.471528
Average cost in epoch 114: 0.447512
training accuracy: 0.812500     test accuracy: 0.470529

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 115: 0.505278
training accuracy: 0.843750     test accuracy: 0.469530
Average cost in epoch 116: 0.493692
training accuracy: 0.828125     test accuracy: 0.473526
Average cost in epoch 117: 0.474250
training accuracy: 0.812500     test accuracy: 0.473526
Average cost in epoch 118: 0.493896
training accuracy: 0.859375     test accuracy: 0.473526
Average cost in epoch 119: 0.457933
training accuracy: 0.859375     test accuracy: 0.469530

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 120: 0.446427
training accuracy: 0.843750     test accuracy: 0.470529
Average cost in epoch 121: 0.465618
training accuracy: 0.828125     test accuracy: 0.468531
Average cost in epoch 122: 0.465196
training accuracy: 0.828125     test accuracy: 0.474525
Average cost in epoch 123: 0.430968
training accuracy: 0.843750     test accuracy: 0.481518
Average cost in epoch 124: 0.443728
training accuracy: 0.781250     test accuracy: 0.466533

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 125: 0.447071
training accuracy: 0.843750     test accuracy: 0.476523
Average cost in epoch 126: 0.431553
training accuracy: 0.828125     test accuracy: 0.469530
Average cost in epoch 127: 0.428486
training accuracy: 0.843750     test accuracy: 0.469530
Average cost in epoch 128: 0.410439
training accuracy: 0.921875     test accuracy: 0.471528
Average cost in epoch 129: 0.444515
training accuracy: 0.828125     test accuracy: 0.471528

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 130: 0.456335
training accuracy: 0.859375     test accuracy: 0.471528
Average cost in epoch 131: 0.468937
training accuracy: 0.859375     test accuracy: 0.476523
Average cost in epoch 132: 0.417984
training accuracy: 0.796875     test accuracy: 0.471528
Average cost in epoch 133: 0.451176
training accuracy: 0.859375     test accuracy: 0.472527
Average cost in epoch 134: 0.439016
training accuracy: 0.890625     test accuracy: 0.473526

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 135: 0.405533
training accuracy: 0.796875     test accuracy: 0.475524
Average cost in epoch 136: 0.408897
training accuracy: 0.875000     test accuracy: 0.474525
Average cost in epoch 137: 0.442671
training accuracy: 0.812500     test accuracy: 0.475524
Average cost in epoch 138: 0.420410
training accuracy: 0.843750     test accuracy: 0.461538
Average cost in epoch 139: 0.404983
training accuracy: 0.906250     test accuracy: 0.475524

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 140: 0.413952
training accuracy: 0.859375     test accuracy: 0.466533
Average cost in epoch 141: 0.411295
training accuracy: 0.906250     test accuracy: 0.467532
Average cost in epoch 142: 0.436954
training accuracy: 0.812500     test accuracy: 0.461538
Average cost in epoch 143: 0.426654
training accuracy: 0.875000     test accuracy: 0.472527
Average cost in epoch 144: 0.409248
training accuracy: 0.875000     test accuracy: 0.474525

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 145: 0.399194
training accuracy: 0.859375     test accuracy: 0.461538
Average cost in epoch 146: 0.388643
training accuracy: 0.890625     test accuracy: 0.468531
Average cost in epoch 147: 0.455877
training accuracy: 0.921875     test accuracy: 0.479520
Average cost in epoch 148: 0.416785
training accuracy: 0.859375     test accuracy: 0.474525
Average cost in epoch 149: 0.401643
training accuracy: 0.859375     test accuracy: 0.466533

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 150: 0.398574
training accuracy: 0.859375     test accuracy: 0.474525
Average cost in epoch 151: 0.451939
training accuracy: 0.781250     test accuracy: 0.472527
Average cost in epoch 152: 0.420684
training accuracy: 0.828125     test accuracy: 0.465534
Average cost in epoch 153: 0.397190
training accuracy: 0.859375     test accuracy: 0.464535
Average cost in epoch 154: 0.395990
training accuracy: 0.828125     test accuracy: 0.465534

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 155: 0.337460
training accuracy: 0.843750     test accuracy: 0.459540
Average cost in epoch 156: 0.426123
training accuracy: 0.875000     test accuracy: 0.467532
Average cost in epoch 157: 0.393731
training accuracy: 0.937500     test accuracy: 0.466533
Average cost in epoch 158: 0.414944
training accuracy: 0.875000     test accuracy: 0.472527
Average cost in epoch 159: 0.396127
training accuracy: 0.828125     test accuracy: 0.463536

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 160: 0.379896
training accuracy: 0.875000     test accuracy: 0.471528
Average cost in epoch 161: 0.391015
training accuracy: 0.765625     test accuracy: 0.472527
Average cost in epoch 162: 0.343292
training accuracy: 0.921875     test accuracy: 0.475524
Average cost in epoch 163: 0.374345
training accuracy: 0.859375     test accuracy: 0.478521
Average cost in epoch 164: 0.385174
training accuracy: 0.890625     test accuracy: 0.474525

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 165: 0.379216
training accuracy: 0.921875     test accuracy: 0.475524
Average cost in epoch 166: 0.387664
training accuracy: 0.859375     test accuracy: 0.469530
Average cost in epoch 167: 0.418265
training accuracy: 0.890625     test accuracy: 0.475524
Average cost in epoch 168: 0.386880
training accuracy: 0.875000     test accuracy: 0.464535
Average cost in epoch 169: 0.379211
training accuracy: 0.953125     test accuracy: 0.470529

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 170: 0.368985
training accuracy: 0.890625     test accuracy: 0.470529
Average cost in epoch 171: 0.335341
training accuracy: 0.937500     test accuracy: 0.470529
Average cost in epoch 172: 0.399734
training accuracy: 0.859375     test accuracy: 0.461538
Average cost in epoch 173: 0.354370
training accuracy: 0.859375     test accuracy: 0.466533
Average cost in epoch 174: 0.368289
training accuracy: 0.875000     test accuracy: 0.465534

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 175: 0.413248
training accuracy: 0.859375     test accuracy: 0.472527
Average cost in epoch 176: 0.378259
training accuracy: 0.921875     test accuracy: 0.459540
Average cost in epoch 177: 0.375150
training accuracy: 0.890625     test accuracy: 0.467532
Average cost in epoch 178: 0.333947
training accuracy: 0.859375     test accuracy: 0.473526
Average cost in epoch 179: 0.368308
training accuracy: 0.843750     test accuracy: 0.457542

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 180: 0.391595
training accuracy: 0.796875     test accuracy: 0.466533
Average cost in epoch 181: 0.363830
training accuracy: 0.890625     test accuracy: 0.468531
Average cost in epoch 182: 0.315186
training accuracy: 0.875000     test accuracy: 0.465534
Average cost in epoch 183: 0.371712
training accuracy: 0.937500     test accuracy: 0.467532
Average cost in epoch 184: 0.373505
training accuracy: 0.843750     test accuracy: 0.472527

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 185: 0.331296
training accuracy: 0.890625     test accuracy: 0.465534
Average cost in epoch 186: 0.351674
training accuracy: 0.875000     test accuracy: 0.464535
Average cost in epoch 187: 0.377883
training accuracy: 0.859375     test accuracy: 0.473526
Average cost in epoch 188: 0.356370
training accuracy: 0.937500     test accuracy: 0.481518
Average cost in epoch 189: 0.374400
training accuracy: 0.859375     test accuracy: 0.471528

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 190: 0.368722
training accuracy: 0.937500     test accuracy: 0.470529
Average cost in epoch 191: 0.337032
training accuracy: 0.859375     test accuracy: 0.475524
Average cost in epoch 192: 0.344571
training accuracy: 0.859375     test accuracy: 0.468531
Average cost in epoch 193: 0.362615
training accuracy: 0.890625     test accuracy: 0.474525
Average cost in epoch 194: 0.346513
training accuracy: 0.906250     test accuracy: 0.465534

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Average cost in epoch 195: 0.358956
training accuracy: 0.843750     test accuracy: 0.470529
Average cost in epoch 196: 0.352755
training accuracy: 0.859375     test accuracy: 0.472527
Average cost in epoch 197: 0.360336
training accuracy: 0.859375     test accuracy: 0.467532
Average cost in epoch 198: 0.355245
training accuracy: 0.906250     test accuracy: 0.476523
Average cost in epoch 199: 0.393244
training accuracy: 0.875000     test accuracy: 0.467532

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_1.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 2, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_2.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 119.80
Starting training...
Average cost in epoch 0: 2.251886
training accuracy: 0.218750     test accuracy: 0.145854
Average cost in epoch 1: 1.858782
training accuracy: 0.156250     test accuracy: 0.160839
Average cost in epoch 2: 1.853800
training accuracy: 0.312500     test accuracy: 0.191808
Average cost in epoch 3: 1.817070
training accuracy: 0.140625     test accuracy: 0.166833
Average cost in epoch 4: 1.788803
training accuracy: 0.328125     test accuracy: 0.145854

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 5: 1.779962
training accuracy: 0.312500     test accuracy: 0.212787
lr decays to 0.009000
Average cost in epoch 6: 1.779359
training accuracy: 0.250000     test accuracy: 0.243756
Average cost in epoch 7: 1.739784
training accuracy: 0.328125     test accuracy: 0.244755
Average cost in epoch 8: 1.755584
training accuracy: 0.265625     test accuracy: 0.230769
Average cost in epoch 9: 1.726654
training accuracy: 0.281250     test accuracy: 0.255744

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 10: 1.701334
training accuracy: 0.296875     test accuracy: 0.222777
lr decays to 0.008100
Average cost in epoch 11: 1.719748
training accuracy: 0.312500     test accuracy: 0.279720
Average cost in epoch 12: 1.697781
training accuracy: 0.359375     test accuracy: 0.255744
Average cost in epoch 13: 1.696342
training accuracy: 0.343750     test accuracy: 0.283716
Average cost in epoch 14: 1.662306
training accuracy: 0.312500     test accuracy: 0.269730

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 15: 1.648151
training accuracy: 0.406250     test accuracy: 0.267732
lr decays to 0.007290
Average cost in epoch 16: 1.630594
training accuracy: 0.468750     test accuracy: 0.280719
Average cost in epoch 17: 1.611361
training accuracy: 0.328125     test accuracy: 0.276723
Average cost in epoch 18: 1.632222
training accuracy: 0.312500     test accuracy: 0.287712
Average cost in epoch 19: 1.599110
training accuracy: 0.343750     test accuracy: 0.287712

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 20: 1.586553
training accuracy: 0.453125     test accuracy: 0.289710
lr decays to 0.006561
Average cost in epoch 21: 1.533617
training accuracy: 0.421875     test accuracy: 0.271728
Average cost in epoch 22: 1.547705
training accuracy: 0.312500     test accuracy: 0.293706
Average cost in epoch 23: 1.532861
training accuracy: 0.343750     test accuracy: 0.289710
Average cost in epoch 24: 1.524621
training accuracy: 0.453125     test accuracy: 0.285714

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 25: 1.515164
training accuracy: 0.359375     test accuracy: 0.286713
lr decays to 0.005905
Average cost in epoch 26: 1.508155
training accuracy: 0.406250     test accuracy: 0.291708
Average cost in epoch 27: 1.466964
training accuracy: 0.296875     test accuracy: 0.273726
Average cost in epoch 28: 1.443216
training accuracy: 0.546875     test accuracy: 0.252747
Average cost in epoch 29: 1.472566
training accuracy: 0.484375     test accuracy: 0.278721

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 30: 1.440906
training accuracy: 0.359375     test accuracy: 0.287712
lr decays to 0.005314
Average cost in epoch 31: 1.443965
training accuracy: 0.546875     test accuracy: 0.279720
Average cost in epoch 32: 1.433663
training accuracy: 0.390625     test accuracy: 0.270729
Average cost in epoch 33: 1.412068
training accuracy: 0.546875     test accuracy: 0.287712
Average cost in epoch 34: 1.422240
training accuracy: 0.546875     test accuracy: 0.286713

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 35: 1.408065
training accuracy: 0.500000     test accuracy: 0.279720
lr decays to 0.004783
Average cost in epoch 36: 1.386310
training accuracy: 0.453125     test accuracy: 0.293706
Average cost in epoch 37: 1.385722
training accuracy: 0.484375     test accuracy: 0.276723
Average cost in epoch 38: 1.374879
training accuracy: 0.500000     test accuracy: 0.284715
Average cost in epoch 39: 1.399378
training accuracy: 0.421875     test accuracy: 0.266733

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 40: 1.376765
training accuracy: 0.390625     test accuracy: 0.281718
lr decays to 0.004305
Average cost in epoch 41: 1.336054
training accuracy: 0.437500     test accuracy: 0.273726
Average cost in epoch 42: 1.359081
training accuracy: 0.531250     test accuracy: 0.274725
Average cost in epoch 43: 1.349948
training accuracy: 0.531250     test accuracy: 0.290709
Average cost in epoch 44: 1.363299
training accuracy: 0.531250     test accuracy: 0.279720

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 45: 1.310773
training accuracy: 0.500000     test accuracy: 0.273726
lr decays to 0.003874
Average cost in epoch 46: 1.315418
training accuracy: 0.562500     test accuracy: 0.273726
Average cost in epoch 47: 1.294818
training accuracy: 0.546875     test accuracy: 0.288711
Average cost in epoch 48: 1.271693
training accuracy: 0.593750     test accuracy: 0.275724
Average cost in epoch 49: 1.279787
training accuracy: 0.546875     test accuracy: 0.271728

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 50: 1.303064
training accuracy: 0.453125     test accuracy: 0.261738
lr decays to 0.003487
Average cost in epoch 51: 1.297728
training accuracy: 0.640625     test accuracy: 0.266733
Average cost in epoch 52: 1.243647
training accuracy: 0.500000     test accuracy: 0.262737
Average cost in epoch 53: 1.259317
training accuracy: 0.578125     test accuracy: 0.246753
Average cost in epoch 54: 1.267584
training accuracy: 0.562500     test accuracy: 0.258741

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 55: 1.258347
training accuracy: 0.515625     test accuracy: 0.268731
lr decays to 0.003138
Average cost in epoch 56: 1.253369
training accuracy: 0.671875     test accuracy: 0.272727
Average cost in epoch 57: 1.201498
training accuracy: 0.625000     test accuracy: 0.260739
Average cost in epoch 58: 1.208111
training accuracy: 0.562500     test accuracy: 0.262737
Average cost in epoch 59: 1.202037
training accuracy: 0.593750     test accuracy: 0.245754

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 60: 1.209701
training accuracy: 0.515625     test accuracy: 0.263736
lr decays to 0.002824
Average cost in epoch 61: 1.161005
training accuracy: 0.562500     test accuracy: 0.257742
Average cost in epoch 62: 1.189870
training accuracy: 0.562500     test accuracy: 0.266733
Average cost in epoch 63: 1.138375
training accuracy: 0.562500     test accuracy: 0.257742
Average cost in epoch 64: 1.189584
training accuracy: 0.500000     test accuracy: 0.260739

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 65: 1.109114
training accuracy: 0.468750     test accuracy: 0.254745
lr decays to 0.002542
Average cost in epoch 66: 1.155064
training accuracy: 0.625000     test accuracy: 0.266733
Average cost in epoch 67: 1.172260
training accuracy: 0.656250     test accuracy: 0.247752
Average cost in epoch 68: 1.132613
training accuracy: 0.625000     test accuracy: 0.259740
Average cost in epoch 69: 1.110744
training accuracy: 0.546875     test accuracy: 0.272727

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 70: 1.156600
training accuracy: 0.562500     test accuracy: 0.269730
lr decays to 0.002288
Average cost in epoch 71: 1.178724
training accuracy: 0.609375     test accuracy: 0.272727
Average cost in epoch 72: 1.140887
training accuracy: 0.625000     test accuracy: 0.258741
Average cost in epoch 73: 1.110735
training accuracy: 0.562500     test accuracy: 0.258741
Average cost in epoch 74: 1.076087
training accuracy: 0.656250     test accuracy: 0.256743

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 75: 1.199573
training accuracy: 0.578125     test accuracy: 0.261738
lr decays to 0.002059
Average cost in epoch 76: 1.014250
training accuracy: 0.515625     test accuracy: 0.261738
Average cost in epoch 77: 1.163160
training accuracy: 0.671875     test accuracy: 0.254745
Average cost in epoch 78: 1.079657
training accuracy: 0.671875     test accuracy: 0.265734
Average cost in epoch 79: 1.060384
training accuracy: 0.515625     test accuracy: 0.273726

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 80: 1.146444
training accuracy: 0.578125     test accuracy: 0.254745
lr decays to 0.001853
Average cost in epoch 81: 1.092756
training accuracy: 0.703125     test accuracy: 0.268731
Average cost in epoch 82: 1.066615
training accuracy: 0.578125     test accuracy: 0.266733
Average cost in epoch 83: 1.090014
training accuracy: 0.640625     test accuracy: 0.268731
Average cost in epoch 84: 1.081185
training accuracy: 0.546875     test accuracy: 0.270729

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 85: 1.068370
training accuracy: 0.578125     test accuracy: 0.262737
lr decays to 0.001668
Average cost in epoch 86: 1.098855
training accuracy: 0.765625     test accuracy: 0.262737
Average cost in epoch 87: 1.063452
training accuracy: 0.593750     test accuracy: 0.261738
Average cost in epoch 88: 1.072739
training accuracy: 0.531250     test accuracy: 0.265734
Average cost in epoch 89: 1.022222
training accuracy: 0.546875     test accuracy: 0.260739

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 90: 1.063112
training accuracy: 0.640625     test accuracy: 0.263736
lr decays to 0.001501
Average cost in epoch 91: 1.042944
training accuracy: 0.656250     test accuracy: 0.255744
Average cost in epoch 92: 1.004801
training accuracy: 0.640625     test accuracy: 0.263736
Average cost in epoch 93: 0.986201
training accuracy: 0.640625     test accuracy: 0.260739
Average cost in epoch 94: 1.033800
training accuracy: 0.640625     test accuracy: 0.257742

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 95: 0.991222
training accuracy: 0.593750     test accuracy: 0.266733
lr decays to 0.001351
Average cost in epoch 96: 1.025270
training accuracy: 0.546875     test accuracy: 0.262737
Average cost in epoch 97: 0.974821
training accuracy: 0.703125     test accuracy: 0.255744
Average cost in epoch 98: 0.998846
training accuracy: 0.671875     test accuracy: 0.264735
Average cost in epoch 99: 0.999634
training accuracy: 0.625000     test accuracy: 0.257742

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 100: 1.053462
training accuracy: 0.703125     test accuracy: 0.258741
lr decays to 0.001216
Average cost in epoch 101: 1.034939
training accuracy: 0.609375     test accuracy: 0.260739
Average cost in epoch 102: 0.976330
training accuracy: 0.625000     test accuracy: 0.264735
Average cost in epoch 103: 0.966691
training accuracy: 0.687500     test accuracy: 0.258741
Average cost in epoch 104: 0.955677
training accuracy: 0.500000     test accuracy: 0.261738

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 105: 1.013347
training accuracy: 0.656250     test accuracy: 0.252747
Average cost in epoch 106: 1.021733
training accuracy: 0.718750     test accuracy: 0.244755
Average cost in epoch 107: 1.006909
training accuracy: 0.734375     test accuracy: 0.258741
Average cost in epoch 108: 0.912404
training accuracy: 0.687500     test accuracy: 0.243756
Average cost in epoch 109: 0.992972
training accuracy: 0.609375     test accuracy: 0.249750

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 110: 0.986676
training accuracy: 0.734375     test accuracy: 0.248751
Average cost in epoch 111: 0.930938
training accuracy: 0.625000     test accuracy: 0.246753
Average cost in epoch 112: 0.980768
training accuracy: 0.640625     test accuracy: 0.246753
Average cost in epoch 113: 0.947274
training accuracy: 0.671875     test accuracy: 0.250749
Average cost in epoch 114: 0.957868
training accuracy: 0.640625     test accuracy: 0.246753

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 115: 0.948085
training accuracy: 0.562500     test accuracy: 0.264735
Average cost in epoch 116: 0.997244
training accuracy: 0.687500     test accuracy: 0.250749
Average cost in epoch 117: 0.902118
training accuracy: 0.671875     test accuracy: 0.250749
Average cost in epoch 118: 0.943272
training accuracy: 0.750000     test accuracy: 0.243756
Average cost in epoch 119: 0.973253
training accuracy: 0.718750     test accuracy: 0.244755

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 120: 0.949169
training accuracy: 0.656250     test accuracy: 0.248751
Average cost in epoch 121: 0.943012
training accuracy: 0.687500     test accuracy: 0.250749
Average cost in epoch 122: 0.908823
training accuracy: 0.625000     test accuracy: 0.242757
Average cost in epoch 123: 0.970349
training accuracy: 0.687500     test accuracy: 0.244755
Average cost in epoch 124: 0.929949
training accuracy: 0.687500     test accuracy: 0.240759

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 125: 0.923356
training accuracy: 0.546875     test accuracy: 0.248751
Average cost in epoch 126: 0.955259
training accuracy: 0.781250     test accuracy: 0.250749
Average cost in epoch 127: 0.935772
training accuracy: 0.703125     test accuracy: 0.248751
Average cost in epoch 128: 0.944700
training accuracy: 0.687500     test accuracy: 0.250749
Average cost in epoch 129: 0.925871
training accuracy: 0.656250     test accuracy: 0.256743

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 130: 0.918067
training accuracy: 0.609375     test accuracy: 0.262737
Average cost in epoch 131: 0.910548
training accuracy: 0.671875     test accuracy: 0.251748
Average cost in epoch 132: 0.907612
training accuracy: 0.656250     test accuracy: 0.255744
Average cost in epoch 133: 0.911445
training accuracy: 0.593750     test accuracy: 0.265734
Average cost in epoch 134: 0.921831
training accuracy: 0.609375     test accuracy: 0.247752

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 135: 0.886440
training accuracy: 0.656250     test accuracy: 0.254745
Average cost in epoch 136: 0.901799
training accuracy: 0.609375     test accuracy: 0.256743
Average cost in epoch 137: 0.878776
training accuracy: 0.593750     test accuracy: 0.259740
Average cost in epoch 138: 0.905401
training accuracy: 0.609375     test accuracy: 0.251748
Average cost in epoch 139: 0.943799
training accuracy: 0.687500     test accuracy: 0.255744

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 140: 0.927156
training accuracy: 0.546875     test accuracy: 0.249750
Average cost in epoch 141: 0.861330
training accuracy: 0.718750     test accuracy: 0.240759
Average cost in epoch 142: 0.928778
training accuracy: 0.765625     test accuracy: 0.254745
Average cost in epoch 143: 0.895912
training accuracy: 0.625000     test accuracy: 0.250749
Average cost in epoch 144: 0.895021
training accuracy: 0.656250     test accuracy: 0.248751

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 145: 0.889153
training accuracy: 0.718750     test accuracy: 0.244755
Average cost in epoch 146: 0.861035
training accuracy: 0.625000     test accuracy: 0.248751
Average cost in epoch 147: 0.904452
training accuracy: 0.734375     test accuracy: 0.245754
Average cost in epoch 148: 0.874659
training accuracy: 0.609375     test accuracy: 0.252747
Average cost in epoch 149: 0.898438
training accuracy: 0.671875     test accuracy: 0.250749

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 150: 0.909257
training accuracy: 0.718750     test accuracy: 0.256743
Average cost in epoch 151: 0.870249
training accuracy: 0.593750     test accuracy: 0.249750
Average cost in epoch 152: 0.937893
training accuracy: 0.734375     test accuracy: 0.246753
Average cost in epoch 153: 0.891248
training accuracy: 0.593750     test accuracy: 0.256743
Average cost in epoch 154: 0.892820
training accuracy: 0.625000     test accuracy: 0.247752

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 155: 0.895227
training accuracy: 0.734375     test accuracy: 0.243756
Average cost in epoch 156: 0.908004
training accuracy: 0.843750     test accuracy: 0.253746
Average cost in epoch 157: 0.878570
training accuracy: 0.687500     test accuracy: 0.253746
Average cost in epoch 158: 0.884147
training accuracy: 0.796875     test accuracy: 0.242757
Average cost in epoch 159: 0.863347
training accuracy: 0.765625     test accuracy: 0.244755

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 160: 0.877396
training accuracy: 0.703125     test accuracy: 0.237762
Average cost in epoch 161: 0.854262
training accuracy: 0.687500     test accuracy: 0.251748
Average cost in epoch 162: 0.880300
training accuracy: 0.671875     test accuracy: 0.249750
Average cost in epoch 163: 0.906894
training accuracy: 0.656250     test accuracy: 0.251748
Average cost in epoch 164: 0.856180
training accuracy: 0.703125     test accuracy: 0.246753

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 165: 0.845050
training accuracy: 0.734375     test accuracy: 0.245754
Average cost in epoch 166: 0.866119
training accuracy: 0.687500     test accuracy: 0.250749
Average cost in epoch 167: 0.912269
training accuracy: 0.734375     test accuracy: 0.236763
Average cost in epoch 168: 0.855322
training accuracy: 0.734375     test accuracy: 0.233766
Average cost in epoch 169: 0.840693
training accuracy: 0.750000     test accuracy: 0.241758

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 170: 0.867985
training accuracy: 0.750000     test accuracy: 0.240759
Average cost in epoch 171: 0.855187
training accuracy: 0.781250     test accuracy: 0.244755
Average cost in epoch 172: 0.863197
training accuracy: 0.656250     test accuracy: 0.243756
Average cost in epoch 173: 0.851463
training accuracy: 0.765625     test accuracy: 0.255744
Average cost in epoch 174: 0.875429
training accuracy: 0.734375     test accuracy: 0.255744

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 175: 0.861030
training accuracy: 0.750000     test accuracy: 0.254745
Average cost in epoch 176: 0.833844
training accuracy: 0.750000     test accuracy: 0.247752
Average cost in epoch 177: 0.885108
training accuracy: 0.656250     test accuracy: 0.253746
Average cost in epoch 178: 0.858091
training accuracy: 0.703125     test accuracy: 0.255744
Average cost in epoch 179: 0.835006
training accuracy: 0.734375     test accuracy: 0.248751

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 180: 0.833373
training accuracy: 0.625000     test accuracy: 0.260739
Average cost in epoch 181: 0.835131
training accuracy: 0.765625     test accuracy: 0.255744
Average cost in epoch 182: 0.822846
training accuracy: 0.640625     test accuracy: 0.266733
Average cost in epoch 183: 0.834182
training accuracy: 0.640625     test accuracy: 0.251748
Average cost in epoch 184: 0.802896
training accuracy: 0.640625     test accuracy: 0.240759

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 185: 0.870350
training accuracy: 0.781250     test accuracy: 0.259740
Average cost in epoch 186: 0.806625
training accuracy: 0.734375     test accuracy: 0.260739
Average cost in epoch 187: 0.819756
training accuracy: 0.671875     test accuracy: 0.242757
Average cost in epoch 188: 0.835051
training accuracy: 0.796875     test accuracy: 0.240759
Average cost in epoch 189: 0.847118
training accuracy: 0.718750     test accuracy: 0.256743

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 190: 0.802113
training accuracy: 0.687500     test accuracy: 0.249750
Average cost in epoch 191: 0.846851
training accuracy: 0.765625     test accuracy: 0.245754
Average cost in epoch 192: 0.836777
training accuracy: 0.734375     test accuracy: 0.254745
Average cost in epoch 193: 0.817018
training accuracy: 0.718750     test accuracy: 0.244755
Average cost in epoch 194: 0.842513
training accuracy: 0.734375     test accuracy: 0.250749

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Average cost in epoch 195: 0.784298
training accuracy: 0.750000     test accuracy: 0.247752
Average cost in epoch 196: 0.822317
training accuracy: 0.734375     test accuracy: 0.250749
Average cost in epoch 197: 0.775552
training accuracy: 0.828125     test accuracy: 0.246753
Average cost in epoch 198: 0.908392
training accuracy: 0.593750     test accuracy: 0.234765
Average cost in epoch 199: 0.799931
training accuracy: 0.687500     test accuracy: 0.239760

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_2.pkl

Locking... locked.
No job requests to schedule
INFO (theano.gof.compilelock): Waiting for existing lock by process '24954' (I am process '1057')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '1430' (I am process '1057')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '27482' (I am process '1057')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '27946' (I am process '1057')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '27708' (I am process '1057')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '13401' (I am process '1057')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23218' (I am process '1057')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 3, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_3.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 97.75
Starting training...
Average cost in epoch 0: 2.184746
training accuracy: 0.093750     test accuracy: 0.163836
Average cost in epoch 1: 1.849526
training accuracy: 0.125000     test accuracy: 0.166833
Average cost in epoch 2: 1.843199
training accuracy: 0.218750     test accuracy: 0.215784
Average cost in epoch 3: 1.804232
training accuracy: 0.218750     test accuracy: 0.209790
Average cost in epoch 4: 1.775049
training accuracy: 0.140625     test accuracy: 0.192807

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 5: 1.761291
training accuracy: 0.281250     test accuracy: 0.234765
lr decays to 0.009000
Average cost in epoch 6: 1.755170
training accuracy: 0.281250     test accuracy: 0.207792
Average cost in epoch 7: 1.755373
training accuracy: 0.156250     test accuracy: 0.234765
Average cost in epoch 8: 1.731854
training accuracy: 0.250000     test accuracy: 0.204795
Average cost in epoch 9: 1.712492
training accuracy: 0.234375     test accuracy: 0.226773

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 10: 1.696448
training accuracy: 0.265625     test accuracy: 0.256743
lr decays to 0.008100
Average cost in epoch 11: 1.679231
training accuracy: 0.265625     test accuracy: 0.246753
Average cost in epoch 12: 1.699363
training accuracy: 0.250000     test accuracy: 0.237762
Average cost in epoch 13: 1.651169
training accuracy: 0.234375     test accuracy: 0.236763
Average cost in epoch 14: 1.682571
training accuracy: 0.312500     test accuracy: 0.220779

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 15: 1.653434
training accuracy: 0.328125     test accuracy: 0.212787
lr decays to 0.007290
Average cost in epoch 16: 1.655842
training accuracy: 0.265625     test accuracy: 0.230769
Average cost in epoch 17: 1.648301
training accuracy: 0.312500     test accuracy: 0.231768
Average cost in epoch 18: 1.643335
training accuracy: 0.296875     test accuracy: 0.210789
Average cost in epoch 19: 1.621419
training accuracy: 0.203125     test accuracy: 0.222777

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 20: 1.613202
training accuracy: 0.281250     test accuracy: 0.228771
lr decays to 0.006561
Average cost in epoch 21: 1.573561
training accuracy: 0.390625     test accuracy: 0.208791
Average cost in epoch 22: 1.580723
training accuracy: 0.375000     test accuracy: 0.229770
Average cost in epoch 23: 1.575961
training accuracy: 0.390625     test accuracy: 0.229770
Average cost in epoch 24: 1.553287
training accuracy: 0.281250     test accuracy: 0.210789

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 25: 1.519099
training accuracy: 0.515625     test accuracy: 0.231768
lr decays to 0.005905
Average cost in epoch 26: 1.523919
training accuracy: 0.328125     test accuracy: 0.220779
Average cost in epoch 27: 1.506252
training accuracy: 0.453125     test accuracy: 0.239760
Average cost in epoch 28: 1.520603
training accuracy: 0.375000     test accuracy: 0.228771
Average cost in epoch 29: 1.458736
training accuracy: 0.468750     test accuracy: 0.242757

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 30: 1.466045
training accuracy: 0.359375     test accuracy: 0.229770
lr decays to 0.005314
Average cost in epoch 31: 1.467155
training accuracy: 0.531250     test accuracy: 0.231768
Average cost in epoch 32: 1.431780
training accuracy: 0.468750     test accuracy: 0.216783
Average cost in epoch 33: 1.422157
training accuracy: 0.406250     test accuracy: 0.204795
Average cost in epoch 34: 1.455572
training accuracy: 0.562500     test accuracy: 0.236763

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 35: 1.404225
training accuracy: 0.343750     test accuracy: 0.235764
lr decays to 0.004783
Average cost in epoch 36: 1.414452
training accuracy: 0.421875     test accuracy: 0.216783
Average cost in epoch 37: 1.399630
training accuracy: 0.406250     test accuracy: 0.219780
Average cost in epoch 38: 1.379494
training accuracy: 0.484375     test accuracy: 0.227772
Average cost in epoch 39: 1.403239
training accuracy: 0.359375     test accuracy: 0.227772

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 40: 1.346541
training accuracy: 0.484375     test accuracy: 0.224775
lr decays to 0.004305
Average cost in epoch 41: 1.368250
training accuracy: 0.390625     test accuracy: 0.226773
Average cost in epoch 42: 1.381346
training accuracy: 0.343750     test accuracy: 0.232767
Average cost in epoch 43: 1.359052
training accuracy: 0.359375     test accuracy: 0.227772
Average cost in epoch 44: 1.324408
training accuracy: 0.375000     test accuracy: 0.223776

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 45: 1.315968
training accuracy: 0.453125     test accuracy: 0.217782
lr decays to 0.003874
Average cost in epoch 46: 1.301868
training accuracy: 0.515625     test accuracy: 0.212787
Average cost in epoch 47: 1.313095
training accuracy: 0.625000     test accuracy: 0.231768
Average cost in epoch 48: 1.355670
training accuracy: 0.453125     test accuracy: 0.213786
Average cost in epoch 49: 1.321751
training accuracy: 0.515625     test accuracy: 0.225774

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 50: 1.315984
training accuracy: 0.515625     test accuracy: 0.197802
lr decays to 0.003487
Average cost in epoch 51: 1.297601
training accuracy: 0.500000     test accuracy: 0.215784
Average cost in epoch 52: 1.300823
training accuracy: 0.562500     test accuracy: 0.222777
Average cost in epoch 53: 1.295682
training accuracy: 0.375000     test accuracy: 0.222777
Average cost in epoch 54: 1.270008
training accuracy: 0.453125     test accuracy: 0.228771

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 55: 1.253235
training accuracy: 0.453125     test accuracy: 0.239760
lr decays to 0.003138
Average cost in epoch 56: 1.295255
training accuracy: 0.500000     test accuracy: 0.218781
Average cost in epoch 57: 1.229434
training accuracy: 0.515625     test accuracy: 0.226773
Average cost in epoch 58: 1.292862
training accuracy: 0.421875     test accuracy: 0.224775
Average cost in epoch 59: 1.206594
training accuracy: 0.500000     test accuracy: 0.232767

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 60: 1.216223
training accuracy: 0.562500     test accuracy: 0.240759
lr decays to 0.002824
Average cost in epoch 61: 1.231659
training accuracy: 0.453125     test accuracy: 0.232767
Average cost in epoch 62: 1.277560
training accuracy: 0.421875     test accuracy: 0.213786
Average cost in epoch 63: 1.209413
training accuracy: 0.562500     test accuracy: 0.230769
Average cost in epoch 64: 1.226614
training accuracy: 0.484375     test accuracy: 0.229770

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 65: 1.259431
training accuracy: 0.593750     test accuracy: 0.216783
lr decays to 0.002542
Average cost in epoch 66: 1.191438
training accuracy: 0.578125     test accuracy: 0.226773
Average cost in epoch 67: 1.190584
training accuracy: 0.500000     test accuracy: 0.218781
Average cost in epoch 68: 1.231483
training accuracy: 0.515625     test accuracy: 0.221778
Average cost in epoch 69: 1.211010
training accuracy: 0.609375     test accuracy: 0.233766

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 70: 1.218198
training accuracy: 0.500000     test accuracy: 0.221778
lr decays to 0.002288
Average cost in epoch 71: 1.190331
training accuracy: 0.625000     test accuracy: 0.229770
Average cost in epoch 72: 1.202627
training accuracy: 0.531250     test accuracy: 0.227772
Average cost in epoch 73: 1.185936
training accuracy: 0.468750     test accuracy: 0.214785
Average cost in epoch 74: 1.204270
training accuracy: 0.468750     test accuracy: 0.229770

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 75: 1.220076
training accuracy: 0.640625     test accuracy: 0.217782
lr decays to 0.002059
Average cost in epoch 76: 1.178889
training accuracy: 0.421875     test accuracy: 0.220779
Average cost in epoch 77: 1.193366
training accuracy: 0.546875     test accuracy: 0.232767
Average cost in epoch 78: 1.153887
training accuracy: 0.500000     test accuracy: 0.224775
Average cost in epoch 79: 1.175979
training accuracy: 0.515625     test accuracy: 0.224775

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 80: 1.193296
training accuracy: 0.500000     test accuracy: 0.225774
lr decays to 0.001853
Average cost in epoch 81: 1.201515
training accuracy: 0.531250     test accuracy: 0.228771
Average cost in epoch 82: 1.210922
training accuracy: 0.500000     test accuracy: 0.223776
Average cost in epoch 83: 1.162245
training accuracy: 0.562500     test accuracy: 0.220779
Average cost in epoch 84: 1.181192
training accuracy: 0.546875     test accuracy: 0.223776

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 85: 1.164274
training accuracy: 0.484375     test accuracy: 0.225774
lr decays to 0.001668
Average cost in epoch 86: 1.201218
training accuracy: 0.500000     test accuracy: 0.220779
Average cost in epoch 87: 1.150543
training accuracy: 0.546875     test accuracy: 0.221778
Average cost in epoch 88: 1.172573
training accuracy: 0.578125     test accuracy: 0.229770
Average cost in epoch 89: 1.166815
training accuracy: 0.593750     test accuracy: 0.219780

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 90: 1.169382
training accuracy: 0.531250     test accuracy: 0.227772
lr decays to 0.001501
Average cost in epoch 91: 1.185938
training accuracy: 0.500000     test accuracy: 0.216783
Average cost in epoch 92: 1.103780
training accuracy: 0.656250     test accuracy: 0.221778
Average cost in epoch 93: 1.152890
training accuracy: 0.625000     test accuracy: 0.213786
Average cost in epoch 94: 1.174448
training accuracy: 0.500000     test accuracy: 0.214785

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 95: 1.115499
training accuracy: 0.562500     test accuracy: 0.221778
lr decays to 0.001351
Average cost in epoch 96: 1.148922
training accuracy: 0.625000     test accuracy: 0.217782
Average cost in epoch 97: 1.136247
training accuracy: 0.609375     test accuracy: 0.219780
Average cost in epoch 98: 1.175269
training accuracy: 0.593750     test accuracy: 0.217782
Average cost in epoch 99: 1.123066
training accuracy: 0.375000     test accuracy: 0.223776

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 100: 1.099409
training accuracy: 0.593750     test accuracy: 0.225774
lr decays to 0.001216
Average cost in epoch 101: 1.115190
training accuracy: 0.500000     test accuracy: 0.222777
Average cost in epoch 102: 1.119293
training accuracy: 0.593750     test accuracy: 0.214785
Average cost in epoch 103: 1.132466
training accuracy: 0.609375     test accuracy: 0.218781
Average cost in epoch 104: 1.085467
training accuracy: 0.625000     test accuracy: 0.214785

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 105: 1.129128
training accuracy: 0.468750     test accuracy: 0.216783
Average cost in epoch 106: 1.117145
training accuracy: 0.578125     test accuracy: 0.220779
Average cost in epoch 107: 1.131912
training accuracy: 0.546875     test accuracy: 0.228771
Average cost in epoch 108: 1.127537
training accuracy: 0.531250     test accuracy: 0.224775
Average cost in epoch 109: 1.118353
training accuracy: 0.562500     test accuracy: 0.224775

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 110: 1.142742
training accuracy: 0.625000     test accuracy: 0.208791
Average cost in epoch 111: 1.094992
training accuracy: 0.546875     test accuracy: 0.220779
Average cost in epoch 112: 1.155653
training accuracy: 0.578125     test accuracy: 0.214785
Average cost in epoch 113: 1.109234
training accuracy: 0.453125     test accuracy: 0.219780
Average cost in epoch 114: 1.123386
training accuracy: 0.437500     test accuracy: 0.210789

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 115: 1.093927
training accuracy: 0.671875     test accuracy: 0.204795
Average cost in epoch 116: 1.108027
training accuracy: 0.609375     test accuracy: 0.217782
Average cost in epoch 117: 1.120050
training accuracy: 0.562500     test accuracy: 0.216783
Average cost in epoch 118: 1.126661
training accuracy: 0.625000     test accuracy: 0.219780
Average cost in epoch 119: 1.107476
training accuracy: 0.562500     test accuracy: 0.202797

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 120: 1.160736
training accuracy: 0.546875     test accuracy: 0.212787
Average cost in epoch 121: 1.092219
training accuracy: 0.468750     test accuracy: 0.216783
Average cost in epoch 122: 1.055341
training accuracy: 0.656250     test accuracy: 0.209790
Average cost in epoch 123: 1.122789
training accuracy: 0.625000     test accuracy: 0.214785
Average cost in epoch 124: 1.112274
training accuracy: 0.562500     test accuracy: 0.218781

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 125: 1.094283
training accuracy: 0.640625     test accuracy: 0.224775
Average cost in epoch 126: 1.146233
training accuracy: 0.531250     test accuracy: 0.210789
Average cost in epoch 127: 1.081314
training accuracy: 0.546875     test accuracy: 0.206793
Average cost in epoch 128: 1.129249
training accuracy: 0.500000     test accuracy: 0.214785
Average cost in epoch 129: 1.092786
training accuracy: 0.531250     test accuracy: 0.207792

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 130: 1.095330
training accuracy: 0.531250     test accuracy: 0.214785
Average cost in epoch 131: 1.089925
training accuracy: 0.625000     test accuracy: 0.213786
Average cost in epoch 132: 1.074653
training accuracy: 0.640625     test accuracy: 0.230769
Average cost in epoch 133: 1.079823
training accuracy: 0.671875     test accuracy: 0.231768
Average cost in epoch 134: 1.111831
training accuracy: 0.609375     test accuracy: 0.216783

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 135: 1.093937
training accuracy: 0.515625     test accuracy: 0.209790
Average cost in epoch 136: 1.077426
training accuracy: 0.578125     test accuracy: 0.212787
Average cost in epoch 137: 1.058778
training accuracy: 0.515625     test accuracy: 0.216783
Average cost in epoch 138: 1.112638
training accuracy: 0.593750     test accuracy: 0.207792
Average cost in epoch 139: 1.104522
training accuracy: 0.640625     test accuracy: 0.209790

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 140: 1.069151
training accuracy: 0.531250     test accuracy: 0.196803
Average cost in epoch 141: 1.110971
training accuracy: 0.500000     test accuracy: 0.218781
Average cost in epoch 142: 1.053258
training accuracy: 0.593750     test accuracy: 0.211788
Average cost in epoch 143: 1.100105
training accuracy: 0.562500     test accuracy: 0.211788
Average cost in epoch 144: 1.083920
training accuracy: 0.562500     test accuracy: 0.217782

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 145: 1.076405
training accuracy: 0.531250     test accuracy: 0.210789
Average cost in epoch 146: 1.077843
training accuracy: 0.531250     test accuracy: 0.207792
Average cost in epoch 147: 1.074160
training accuracy: 0.593750     test accuracy: 0.218781
Average cost in epoch 148: 1.110104
training accuracy: 0.640625     test accuracy: 0.217782
Average cost in epoch 149: 1.116190
training accuracy: 0.625000     test accuracy: 0.214785

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 150: 1.049645
training accuracy: 0.609375     test accuracy: 0.210789
Average cost in epoch 151: 1.120099
training accuracy: 0.562500     test accuracy: 0.210789
Average cost in epoch 152: 1.054061
training accuracy: 0.578125     test accuracy: 0.203796
Average cost in epoch 153: 1.051263
training accuracy: 0.531250     test accuracy: 0.204795
Average cost in epoch 154: 1.056580
training accuracy: 0.656250     test accuracy: 0.205794

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 155: 1.060062
training accuracy: 0.578125     test accuracy: 0.215784
Average cost in epoch 156: 1.015411
training accuracy: 0.453125     test accuracy: 0.204795
Average cost in epoch 157: 1.030232
training accuracy: 0.593750     test accuracy: 0.204795
Average cost in epoch 158: 1.113501
training accuracy: 0.609375     test accuracy: 0.206793
Average cost in epoch 159: 1.029471
training accuracy: 0.609375     test accuracy: 0.207792

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 160: 1.074182
training accuracy: 0.562500     test accuracy: 0.201798
Average cost in epoch 161: 1.065635
training accuracy: 0.562500     test accuracy: 0.204795
Average cost in epoch 162: 1.068083
training accuracy: 0.593750     test accuracy: 0.201798
Average cost in epoch 163: 1.077571
training accuracy: 0.578125     test accuracy: 0.190809
Average cost in epoch 164: 1.055778
training accuracy: 0.562500     test accuracy: 0.206793

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 165: 1.110322
training accuracy: 0.593750     test accuracy: 0.196803
Average cost in epoch 166: 1.086156
training accuracy: 0.546875     test accuracy: 0.212787
Average cost in epoch 167: 1.055041
training accuracy: 0.609375     test accuracy: 0.218781
Average cost in epoch 168: 1.059732
training accuracy: 0.562500     test accuracy: 0.209790
Average cost in epoch 169: 1.062806
training accuracy: 0.531250     test accuracy: 0.208791

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 170: 1.038428
training accuracy: 0.531250     test accuracy: 0.214785
Average cost in epoch 171: 1.055035
training accuracy: 0.593750     test accuracy: 0.226773
Average cost in epoch 172: 1.066307
training accuracy: 0.656250     test accuracy: 0.226773
Average cost in epoch 173: 1.073676
training accuracy: 0.500000     test accuracy: 0.218781
Average cost in epoch 174: 1.058298
training accuracy: 0.625000     test accuracy: 0.220779

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 175: 1.055022
training accuracy: 0.546875     test accuracy: 0.213786
Average cost in epoch 176: 1.018275
training accuracy: 0.656250     test accuracy: 0.214785
Average cost in epoch 177: 1.064756
training accuracy: 0.609375     test accuracy: 0.212787
Average cost in epoch 178: 1.063521
training accuracy: 0.718750     test accuracy: 0.210789
Average cost in epoch 179: 1.076518
training accuracy: 0.671875     test accuracy: 0.198801

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 180: 1.097454
training accuracy: 0.578125     test accuracy: 0.193806
Average cost in epoch 181: 1.002782
training accuracy: 0.640625     test accuracy: 0.203796
Average cost in epoch 182: 1.034302
training accuracy: 0.609375     test accuracy: 0.202797
Average cost in epoch 183: 1.066644
training accuracy: 0.640625     test accuracy: 0.211788
Average cost in epoch 184: 1.061483
training accuracy: 0.625000     test accuracy: 0.209790

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 185: 1.111074
training accuracy: 0.546875     test accuracy: 0.207792
Average cost in epoch 186: 1.031153
training accuracy: 0.578125     test accuracy: 0.211788
Average cost in epoch 187: 1.066701
training accuracy: 0.609375     test accuracy: 0.206793
Average cost in epoch 188: 1.047492
training accuracy: 0.562500     test accuracy: 0.222777
Average cost in epoch 189: 1.023904
training accuracy: 0.515625     test accuracy: 0.225774

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 190: 1.052113
training accuracy: 0.640625     test accuracy: 0.215784
Average cost in epoch 191: 1.002905
training accuracy: 0.515625     test accuracy: 0.215784
Average cost in epoch 192: 1.090098
training accuracy: 0.531250     test accuracy: 0.198801
Average cost in epoch 193: 1.061999
training accuracy: 0.625000     test accuracy: 0.199800
Average cost in epoch 194: 1.082541
training accuracy: 0.531250     test accuracy: 0.198801

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Average cost in epoch 195: 0.998002
training accuracy: 0.656250     test accuracy: 0.203796
Average cost in epoch 196: 1.043568
training accuracy: 0.484375     test accuracy: 0.199800
Average cost in epoch 197: 1.045756
training accuracy: 0.640625     test accuracy: 0.219780
Average cost in epoch 198: 1.041660
training accuracy: 0.546875     test accuracy: 0.206793
Average cost in epoch 199: 1.027030
training accuracy: 0.515625     test accuracy: 0.202797

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_3.pkl

Locking... locked.
No job requests to schedule
INFO (theano.gof.compilelock): Waiting for existing lock by process '24954' (I am process '1216')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '1430' (I am process '1216')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '27482' (I am process '1216')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '27946' (I am process '1216')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '13401' (I am process '1216')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23385' (I am process '1216')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23609' (I am process '1216')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '1057' (I am process '1216')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23828' (I am process '1216')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 4, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_4.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 91.12
Starting training...
Average cost in epoch 0: 2.036077
training accuracy: 0.250000     test accuracy: 0.152847
Average cost in epoch 1: 1.864203
training accuracy: 0.187500     test accuracy: 0.168831
Average cost in epoch 2: 1.814133
training accuracy: 0.156250     test accuracy: 0.180819
Average cost in epoch 3: 1.813373
training accuracy: 0.171875     test accuracy: 0.176823
Average cost in epoch 4: 1.807225
training accuracy: 0.234375     test accuracy: 0.172827

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 5: 1.780224
training accuracy: 0.218750     test accuracy: 0.183816
lr decays to 0.009000
Average cost in epoch 6: 1.750531
training accuracy: 0.203125     test accuracy: 0.203796
Average cost in epoch 7: 1.625067
training accuracy: 0.265625     test accuracy: 0.330669
Average cost in epoch 8: 1.550367
training accuracy: 0.390625     test accuracy: 0.397602
Average cost in epoch 9: 1.446019
training accuracy: 0.421875     test accuracy: 0.438561

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 10: 1.400076
training accuracy: 0.296875     test accuracy: 0.386613
lr decays to 0.008100
Average cost in epoch 11: 1.314489
training accuracy: 0.593750     test accuracy: 0.521479
Average cost in epoch 12: 1.291393
training accuracy: 0.562500     test accuracy: 0.525475
Average cost in epoch 13: 1.293966
training accuracy: 0.437500     test accuracy: 0.524476
Average cost in epoch 14: 1.250500
training accuracy: 0.484375     test accuracy: 0.538462

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 15: 1.146555
training accuracy: 0.515625     test accuracy: 0.535465
lr decays to 0.007290
Average cost in epoch 16: 1.152810
training accuracy: 0.500000     test accuracy: 0.539461
Average cost in epoch 17: 1.129278
training accuracy: 0.531250     test accuracy: 0.567433
Average cost in epoch 18: 1.127085
training accuracy: 0.625000     test accuracy: 0.563437
Average cost in epoch 19: 1.092991
training accuracy: 0.546875     test accuracy: 0.551449

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 20: 1.113541
training accuracy: 0.625000     test accuracy: 0.556444
lr decays to 0.006561
Average cost in epoch 21: 1.029173
training accuracy: 0.640625     test accuracy: 0.593407
Average cost in epoch 22: 1.080262
training accuracy: 0.531250     test accuracy: 0.588412
Average cost in epoch 23: 1.000096
training accuracy: 0.640625     test accuracy: 0.581419
Average cost in epoch 24: 0.982262
training accuracy: 0.531250     test accuracy: 0.572428

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 25: 0.987647
training accuracy: 0.562500     test accuracy: 0.581419
lr decays to 0.005905
Average cost in epoch 26: 0.975213
training accuracy: 0.718750     test accuracy: 0.598402
Average cost in epoch 27: 0.925574
training accuracy: 0.625000     test accuracy: 0.603397
Average cost in epoch 28: 0.928695
training accuracy: 0.546875     test accuracy: 0.606394
Average cost in epoch 29: 0.931590
training accuracy: 0.625000     test accuracy: 0.606394

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 30: 0.939454
training accuracy: 0.625000     test accuracy: 0.606394
lr decays to 0.005314
Average cost in epoch 31: 0.909759
training accuracy: 0.656250     test accuracy: 0.603397
Average cost in epoch 32: 0.894173
training accuracy: 0.609375     test accuracy: 0.610390
Average cost in epoch 33: 0.891006
training accuracy: 0.640625     test accuracy: 0.613387
Average cost in epoch 34: 0.869139
training accuracy: 0.609375     test accuracy: 0.613387

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 35: 0.848507
training accuracy: 0.578125     test accuracy: 0.622378
lr decays to 0.004783
Average cost in epoch 36: 0.837608
training accuracy: 0.578125     test accuracy: 0.618382
Average cost in epoch 37: 0.850150
training accuracy: 0.640625     test accuracy: 0.626374
Average cost in epoch 38: 0.833817
training accuracy: 0.656250     test accuracy: 0.623377
Average cost in epoch 39: 0.784394
training accuracy: 0.671875     test accuracy: 0.610390

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 40: 0.833751
training accuracy: 0.734375     test accuracy: 0.613387
lr decays to 0.004305
Average cost in epoch 41: 0.796015
training accuracy: 0.781250     test accuracy: 0.613387
Average cost in epoch 42: 0.817604
training accuracy: 0.718750     test accuracy: 0.631369
Average cost in epoch 43: 0.760175
training accuracy: 0.718750     test accuracy: 0.633367
Average cost in epoch 44: 0.751477
training accuracy: 0.531250     test accuracy: 0.637363

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 45: 0.761749
training accuracy: 0.671875     test accuracy: 0.629371
lr decays to 0.003874
Average cost in epoch 46: 0.737413
training accuracy: 0.734375     test accuracy: 0.624376
Average cost in epoch 47: 0.728515
training accuracy: 0.734375     test accuracy: 0.620380
Average cost in epoch 48: 0.738976
training accuracy: 0.734375     test accuracy: 0.633367
Average cost in epoch 49: 0.724252
training accuracy: 0.609375     test accuracy: 0.630370

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 50: 0.732434
training accuracy: 0.734375     test accuracy: 0.634366
lr decays to 0.003487
Average cost in epoch 51: 0.729413
training accuracy: 0.703125     test accuracy: 0.626374
Average cost in epoch 52: 0.673002
training accuracy: 0.687500     test accuracy: 0.637363
Average cost in epoch 53: 0.682436
training accuracy: 0.687500     test accuracy: 0.638362
Average cost in epoch 54: 0.684935
training accuracy: 0.781250     test accuracy: 0.646354

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 55: 0.642423
training accuracy: 0.734375     test accuracy: 0.650350
lr decays to 0.003138
Average cost in epoch 56: 0.676787
training accuracy: 0.796875     test accuracy: 0.632368
Average cost in epoch 57: 0.681214
training accuracy: 0.734375     test accuracy: 0.637363
Average cost in epoch 58: 0.642678
training accuracy: 0.750000     test accuracy: 0.654346
Average cost in epoch 59: 0.658213
training accuracy: 0.812500     test accuracy: 0.644356

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 60: 0.602413
training accuracy: 0.796875     test accuracy: 0.638362
lr decays to 0.002824
Average cost in epoch 61: 0.681902
training accuracy: 0.718750     test accuracy: 0.643357
Average cost in epoch 62: 0.604470
training accuracy: 0.703125     test accuracy: 0.632368
Average cost in epoch 63: 0.601623
training accuracy: 0.687500     test accuracy: 0.625375
Average cost in epoch 64: 0.633566
training accuracy: 0.750000     test accuracy: 0.645355

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 65: 0.640327
training accuracy: 0.796875     test accuracy: 0.639361
lr decays to 0.002542
Average cost in epoch 66: 0.608190
training accuracy: 0.734375     test accuracy: 0.636364
Average cost in epoch 67: 0.615139
training accuracy: 0.750000     test accuracy: 0.643357
Average cost in epoch 68: 0.621340
training accuracy: 0.718750     test accuracy: 0.632368
Average cost in epoch 69: 0.645503
training accuracy: 0.734375     test accuracy: 0.645355

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 70: 0.614523
training accuracy: 0.781250     test accuracy: 0.644356
lr decays to 0.002288
Average cost in epoch 71: 0.619543
training accuracy: 0.781250     test accuracy: 0.650350
Average cost in epoch 72: 0.573671
training accuracy: 0.734375     test accuracy: 0.650350
Average cost in epoch 73: 0.586846
training accuracy: 0.843750     test accuracy: 0.639361
Average cost in epoch 74: 0.575640
training accuracy: 0.859375     test accuracy: 0.646354

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 75: 0.583871
training accuracy: 0.828125     test accuracy: 0.657343
lr decays to 0.002059
Average cost in epoch 76: 0.543166
training accuracy: 0.765625     test accuracy: 0.656344
Average cost in epoch 77: 0.573013
training accuracy: 0.765625     test accuracy: 0.656344
Average cost in epoch 78: 0.548257
training accuracy: 0.734375     test accuracy: 0.653347
Average cost in epoch 79: 0.593985
training accuracy: 0.812500     test accuracy: 0.657343

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 80: 0.559456
training accuracy: 0.843750     test accuracy: 0.650350
lr decays to 0.001853
Average cost in epoch 81: 0.541857
training accuracy: 0.718750     test accuracy: 0.661339
Average cost in epoch 82: 0.555570
training accuracy: 0.843750     test accuracy: 0.651349
Average cost in epoch 83: 0.545583
training accuracy: 0.609375     test accuracy: 0.660340
Average cost in epoch 84: 0.550303
training accuracy: 0.781250     test accuracy: 0.654346

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 85: 0.549548
training accuracy: 0.625000     test accuracy: 0.651349
lr decays to 0.001668
Average cost in epoch 86: 0.552393
training accuracy: 0.828125     test accuracy: 0.651349
Average cost in epoch 87: 0.510246
training accuracy: 0.796875     test accuracy: 0.641359
Average cost in epoch 88: 0.515833
training accuracy: 0.765625     test accuracy: 0.645355
Average cost in epoch 89: 0.513242
training accuracy: 0.765625     test accuracy: 0.647353

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 90: 0.504431
training accuracy: 0.781250     test accuracy: 0.651349
lr decays to 0.001501
Average cost in epoch 91: 0.503646
training accuracy: 0.750000     test accuracy: 0.653347
Average cost in epoch 92: 0.504957
training accuracy: 0.843750     test accuracy: 0.647353
Average cost in epoch 93: 0.562547
training accuracy: 0.781250     test accuracy: 0.651349
Average cost in epoch 94: 0.503620
training accuracy: 0.781250     test accuracy: 0.650350

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 95: 0.499105
training accuracy: 0.859375     test accuracy: 0.655345
lr decays to 0.001351
Average cost in epoch 96: 0.510588
training accuracy: 0.812500     test accuracy: 0.656344
Average cost in epoch 97: 0.467873
training accuracy: 0.859375     test accuracy: 0.654346
Average cost in epoch 98: 0.559540
training accuracy: 0.875000     test accuracy: 0.649351
Average cost in epoch 99: 0.483530
training accuracy: 0.828125     test accuracy: 0.648352

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 100: 0.502506
training accuracy: 0.781250     test accuracy: 0.647353
lr decays to 0.001216
Average cost in epoch 101: 0.500207
training accuracy: 0.843750     test accuracy: 0.648352
Average cost in epoch 102: 0.477569
training accuracy: 0.843750     test accuracy: 0.656344
Average cost in epoch 103: 0.485950
training accuracy: 0.859375     test accuracy: 0.638362
Average cost in epoch 104: 0.461744
training accuracy: 0.781250     test accuracy: 0.639361

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 105: 0.517353
training accuracy: 0.859375     test accuracy: 0.645355
Average cost in epoch 106: 0.443212
training accuracy: 0.812500     test accuracy: 0.646354
Average cost in epoch 107: 0.496770
training accuracy: 0.828125     test accuracy: 0.650350
Average cost in epoch 108: 0.484799
training accuracy: 0.890625     test accuracy: 0.646354
Average cost in epoch 109: 0.505871
training accuracy: 0.765625     test accuracy: 0.649351

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 110: 0.499239
training accuracy: 0.828125     test accuracy: 0.647353
Average cost in epoch 111: 0.458606
training accuracy: 0.781250     test accuracy: 0.642358
Average cost in epoch 112: 0.452961
training accuracy: 0.812500     test accuracy: 0.650350
Average cost in epoch 113: 0.492392
training accuracy: 0.828125     test accuracy: 0.653347
Average cost in epoch 114: 0.425840
training accuracy: 0.828125     test accuracy: 0.647353

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 115: 0.456088
training accuracy: 0.828125     test accuracy: 0.650350
Average cost in epoch 116: 0.498529
training accuracy: 0.812500     test accuracy: 0.655345
Average cost in epoch 117: 0.462434
training accuracy: 0.875000     test accuracy: 0.655345
Average cost in epoch 118: 0.412654
training accuracy: 0.750000     test accuracy: 0.653347
Average cost in epoch 119: 0.456442
training accuracy: 0.750000     test accuracy: 0.650350

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 120: 0.463405
training accuracy: 0.875000     test accuracy: 0.651349
Average cost in epoch 121: 0.450942
training accuracy: 0.765625     test accuracy: 0.660340
Average cost in epoch 122: 0.470031
training accuracy: 0.859375     test accuracy: 0.650350
Average cost in epoch 123: 0.450227
training accuracy: 0.875000     test accuracy: 0.655345
Average cost in epoch 124: 0.451379
training accuracy: 0.781250     test accuracy: 0.656344

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 125: 0.426177
training accuracy: 0.812500     test accuracy: 0.657343
Average cost in epoch 126: 0.446631
training accuracy: 0.890625     test accuracy: 0.654346
Average cost in epoch 127: 0.410444
training accuracy: 0.843750     test accuracy: 0.654346
Average cost in epoch 128: 0.460815
training accuracy: 0.843750     test accuracy: 0.650350
Average cost in epoch 129: 0.459661
training accuracy: 0.781250     test accuracy: 0.657343

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 130: 0.472583
training accuracy: 0.796875     test accuracy: 0.647353
Average cost in epoch 131: 0.456236
training accuracy: 0.875000     test accuracy: 0.660340
Average cost in epoch 132: 0.417968
training accuracy: 0.859375     test accuracy: 0.651349
Average cost in epoch 133: 0.439225
training accuracy: 0.781250     test accuracy: 0.658342
Average cost in epoch 134: 0.446728
training accuracy: 0.843750     test accuracy: 0.655345

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 135: 0.406611
training accuracy: 0.765625     test accuracy: 0.661339
Average cost in epoch 136: 0.460356
training accuracy: 0.859375     test accuracy: 0.646354
Average cost in epoch 137: 0.440093
training accuracy: 0.921875     test accuracy: 0.652348
Average cost in epoch 138: 0.426934
training accuracy: 0.828125     test accuracy: 0.659341
Average cost in epoch 139: 0.426414
training accuracy: 0.843750     test accuracy: 0.650350

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 140: 0.464511
training accuracy: 0.812500     test accuracy: 0.652348
Average cost in epoch 141: 0.465188
training accuracy: 0.843750     test accuracy: 0.658342
Average cost in epoch 142: 0.467824
training accuracy: 0.796875     test accuracy: 0.659341
Average cost in epoch 143: 0.456950
training accuracy: 0.812500     test accuracy: 0.654346
Average cost in epoch 144: 0.409006
training accuracy: 0.890625     test accuracy: 0.657343

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 145: 0.425400
training accuracy: 0.859375     test accuracy: 0.664336
Average cost in epoch 146: 0.404858
training accuracy: 0.859375     test accuracy: 0.664336
Average cost in epoch 147: 0.467764
training accuracy: 0.859375     test accuracy: 0.660340
Average cost in epoch 148: 0.416475
training accuracy: 0.859375     test accuracy: 0.661339
Average cost in epoch 149: 0.437576
training accuracy: 0.796875     test accuracy: 0.653347

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 150: 0.416480
training accuracy: 0.859375     test accuracy: 0.652348
Average cost in epoch 151: 0.415299
training accuracy: 0.859375     test accuracy: 0.666334
Average cost in epoch 152: 0.393939
training accuracy: 0.890625     test accuracy: 0.662338
Average cost in epoch 153: 0.404437
training accuracy: 0.812500     test accuracy: 0.663337
Average cost in epoch 154: 0.433813
training accuracy: 0.906250     test accuracy: 0.667333

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 155: 0.383747
training accuracy: 0.796875     test accuracy: 0.665335
Average cost in epoch 156: 0.438408
training accuracy: 0.812500     test accuracy: 0.672328
Average cost in epoch 157: 0.416601
training accuracy: 0.859375     test accuracy: 0.664336
Average cost in epoch 158: 0.385489
training accuracy: 0.812500     test accuracy: 0.665335
Average cost in epoch 159: 0.413955
training accuracy: 0.812500     test accuracy: 0.661339

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 160: 0.413737
training accuracy: 0.875000     test accuracy: 0.657343
Average cost in epoch 161: 0.449693
training accuracy: 0.859375     test accuracy: 0.664336
Average cost in epoch 162: 0.381356
training accuracy: 0.796875     test accuracy: 0.664336
Average cost in epoch 163: 0.393519
training accuracy: 0.812500     test accuracy: 0.665335
Average cost in epoch 164: 0.415272
training accuracy: 0.921875     test accuracy: 0.666334

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 165: 0.437818
training accuracy: 0.890625     test accuracy: 0.664336
Average cost in epoch 166: 0.398759
training accuracy: 0.812500     test accuracy: 0.654346
Average cost in epoch 167: 0.383589
training accuracy: 0.875000     test accuracy: 0.666334
Average cost in epoch 168: 0.397455
training accuracy: 0.703125     test accuracy: 0.659341
Average cost in epoch 169: 0.432076
training accuracy: 0.890625     test accuracy: 0.668332

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 170: 0.421439
training accuracy: 0.781250     test accuracy: 0.657343
Average cost in epoch 171: 0.394299
training accuracy: 0.828125     test accuracy: 0.650350
Average cost in epoch 172: 0.442634
training accuracy: 0.828125     test accuracy: 0.653347
Average cost in epoch 173: 0.366859
training accuracy: 0.859375     test accuracy: 0.662338
Average cost in epoch 174: 0.372352
training accuracy: 0.796875     test accuracy: 0.657343

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 175: 0.426890
training accuracy: 0.796875     test accuracy: 0.663337
Average cost in epoch 176: 0.383444
training accuracy: 0.828125     test accuracy: 0.656344
Average cost in epoch 177: 0.387248
training accuracy: 0.765625     test accuracy: 0.655345
Average cost in epoch 178: 0.380098
training accuracy: 0.843750     test accuracy: 0.667333
Average cost in epoch 179: 0.371380
training accuracy: 0.875000     test accuracy: 0.658342

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 180: 0.362223
training accuracy: 0.906250     test accuracy: 0.668332
Average cost in epoch 181: 0.383944
training accuracy: 0.843750     test accuracy: 0.658342
Average cost in epoch 182: 0.427988
training accuracy: 0.875000     test accuracy: 0.668332
Average cost in epoch 183: 0.392769
training accuracy: 0.765625     test accuracy: 0.662338
Average cost in epoch 184: 0.375077
training accuracy: 0.859375     test accuracy: 0.668332

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 185: 0.404381
training accuracy: 0.890625     test accuracy: 0.647353
Average cost in epoch 186: 0.381784
training accuracy: 0.953125     test accuracy: 0.662338
Average cost in epoch 187: 0.402938
training accuracy: 0.875000     test accuracy: 0.661339
Average cost in epoch 188: 0.347624
training accuracy: 0.843750     test accuracy: 0.659341
Average cost in epoch 189: 0.391145
training accuracy: 0.906250     test accuracy: 0.667333

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 190: 0.379266
training accuracy: 0.875000     test accuracy: 0.659341
Average cost in epoch 191: 0.406484
training accuracy: 0.843750     test accuracy: 0.658342
Average cost in epoch 192: 0.375652
training accuracy: 0.859375     test accuracy: 0.654346
Average cost in epoch 193: 0.359796
training accuracy: 0.828125     test accuracy: 0.663337
Average cost in epoch 194: 0.385519
training accuracy: 0.796875     test accuracy: 0.661339

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Average cost in epoch 195: 0.364882
training accuracy: 0.812500     test accuracy: 0.661339
Average cost in epoch 196: 0.389085
training accuracy: 0.875000     test accuracy: 0.666334
Average cost in epoch 197: 0.394544
training accuracy: 0.953125     test accuracy: 0.659341
Average cost in epoch 198: 0.354440
training accuracy: 0.812500     test accuracy: 0.661339
Average cost in epoch 199: 0.343298
training accuracy: 0.875000     test accuracy: 0.655345

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_4.pkl

Locking... locked.
Executing '9220-yetian1' on deep8/1 as yetian1...
No machines free for job 9221-yetian1
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 5, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_5.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
INFO (theano.gof.compilelock): Waiting for existing lock by unknown process (I am process '1430')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '12962' (I am process '1430')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by unknown process (I am process '1430')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
Ending compiling...
Compiling time: 130.62
Starting training...
Average cost in epoch 0: 2.203788
training accuracy: 0.359375     test accuracy: 0.325674
Average cost in epoch 1: 1.460534
training accuracy: 0.359375     test accuracy: 0.326673
Average cost in epoch 2: 1.370584
training accuracy: 0.234375     test accuracy: 0.223776
Average cost in epoch 3: 1.365162
training accuracy: 0.375000     test accuracy: 0.324675
Average cost in epoch 4: 1.336896
training accuracy: 0.281250     test accuracy: 0.283716

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 5: 1.322241
training accuracy: 0.312500     test accuracy: 0.302697
lr decays to 0.009000
Average cost in epoch 6: 1.301069
training accuracy: 0.390625     test accuracy: 0.343656
Average cost in epoch 7: 1.284578
training accuracy: 0.359375     test accuracy: 0.302697
Average cost in epoch 8: 1.309268
training accuracy: 0.421875     test accuracy: 0.337662
Average cost in epoch 9: 1.277253
training accuracy: 0.328125     test accuracy: 0.372627

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 10: 1.218217
training accuracy: 0.312500     test accuracy: 0.375624
lr decays to 0.008100
Average cost in epoch 11: 1.184893
training accuracy: 0.421875     test accuracy: 0.381618
Average cost in epoch 12: 1.208731
training accuracy: 0.500000     test accuracy: 0.389610
Average cost in epoch 13: 1.150107
training accuracy: 0.468750     test accuracy: 0.382617
Average cost in epoch 14: 1.166791
training accuracy: 0.500000     test accuracy: 0.413586

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 15: 1.162139
training accuracy: 0.421875     test accuracy: 0.405594
lr decays to 0.007290
Average cost in epoch 16: 1.114074
training accuracy: 0.406250     test accuracy: 0.414585
Average cost in epoch 17: 1.132738
training accuracy: 0.468750     test accuracy: 0.413586
Average cost in epoch 18: 1.184625
training accuracy: 0.546875     test accuracy: 0.405594
Average cost in epoch 19: 1.106953
training accuracy: 0.406250     test accuracy: 0.429570

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 20: 1.109809
training accuracy: 0.390625     test accuracy: 0.413586
lr decays to 0.006561
Average cost in epoch 21: 1.127106
training accuracy: 0.484375     test accuracy: 0.390609
Average cost in epoch 22: 1.069113
training accuracy: 0.500000     test accuracy: 0.429570
Average cost in epoch 23: 1.075915
training accuracy: 0.578125     test accuracy: 0.448551
Average cost in epoch 24: 1.081589
training accuracy: 0.500000     test accuracy: 0.404595

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 25: 1.031299
training accuracy: 0.562500     test accuracy: 0.419580
lr decays to 0.005905
Average cost in epoch 26: 1.031816
training accuracy: 0.609375     test accuracy: 0.438561
Average cost in epoch 27: 1.007766
training accuracy: 0.578125     test accuracy: 0.444555
Average cost in epoch 28: 1.052245
training accuracy: 0.531250     test accuracy: 0.454545
Average cost in epoch 29: 1.059932
training accuracy: 0.593750     test accuracy: 0.446553

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 30: 0.966736
training accuracy: 0.515625     test accuracy: 0.456543
lr decays to 0.005314
Average cost in epoch 31: 0.973905
training accuracy: 0.531250     test accuracy: 0.453546
Average cost in epoch 32: 0.987222
training accuracy: 0.546875     test accuracy: 0.444555
Average cost in epoch 33: 0.961992
training accuracy: 0.562500     test accuracy: 0.417582
Average cost in epoch 34: 0.990377
training accuracy: 0.515625     test accuracy: 0.443556

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 35: 0.958654
training accuracy: 0.656250     test accuracy: 0.458541
lr decays to 0.004783
Average cost in epoch 36: 0.961077
training accuracy: 0.468750     test accuracy: 0.451548
Average cost in epoch 37: 0.951044
training accuracy: 0.546875     test accuracy: 0.440559
Average cost in epoch 38: 0.948511
training accuracy: 0.593750     test accuracy: 0.449550
Average cost in epoch 39: 0.936742
training accuracy: 0.562500     test accuracy: 0.453546

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 40: 0.947694
training accuracy: 0.640625     test accuracy: 0.437562
lr decays to 0.004305
Average cost in epoch 41: 0.949645
training accuracy: 0.687500     test accuracy: 0.464535
Average cost in epoch 42: 0.939180
training accuracy: 0.750000     test accuracy: 0.455544
Average cost in epoch 43: 0.897483
training accuracy: 0.515625     test accuracy: 0.467532
Average cost in epoch 44: 0.920021
training accuracy: 0.515625     test accuracy: 0.465534

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 45: 0.903948
training accuracy: 0.703125     test accuracy: 0.449550
lr decays to 0.003874
Average cost in epoch 46: 0.876628
training accuracy: 0.640625     test accuracy: 0.483516
Average cost in epoch 47: 0.887453
training accuracy: 0.546875     test accuracy: 0.453546
Average cost in epoch 48: 0.857510
training accuracy: 0.687500     test accuracy: 0.461538
Average cost in epoch 49: 0.882532
training accuracy: 0.687500     test accuracy: 0.483516

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 50: 0.877621
training accuracy: 0.562500     test accuracy: 0.464535
lr decays to 0.003487
Average cost in epoch 51: 0.867152
training accuracy: 0.640625     test accuracy: 0.488511
Average cost in epoch 52: 0.843991
training accuracy: 0.625000     test accuracy: 0.475524
Average cost in epoch 53: 0.885541
training accuracy: 0.640625     test accuracy: 0.469530
Average cost in epoch 54: 0.861610
training accuracy: 0.578125     test accuracy: 0.464535

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 55: 0.813149
training accuracy: 0.625000     test accuracy: 0.468531
lr decays to 0.003138
Average cost in epoch 56: 0.828363
training accuracy: 0.703125     test accuracy: 0.485514
Average cost in epoch 57: 0.844412
training accuracy: 0.609375     test accuracy: 0.472527
Average cost in epoch 58: 0.831752
training accuracy: 0.734375     test accuracy: 0.478521
Average cost in epoch 59: 0.867180
training accuracy: 0.687500     test accuracy: 0.459540

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 60: 0.828118
training accuracy: 0.640625     test accuracy: 0.476523
lr decays to 0.002824
Average cost in epoch 61: 0.802583
training accuracy: 0.640625     test accuracy: 0.467532
Average cost in epoch 62: 0.821424
training accuracy: 0.671875     test accuracy: 0.476523
Average cost in epoch 63: 0.807724
training accuracy: 0.640625     test accuracy: 0.493506
Average cost in epoch 64: 0.800863
training accuracy: 0.671875     test accuracy: 0.476523

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 65: 0.830809
training accuracy: 0.703125     test accuracy: 0.481518
lr decays to 0.002542
Average cost in epoch 66: 0.817503
training accuracy: 0.671875     test accuracy: 0.491508
Average cost in epoch 67: 0.757978
training accuracy: 0.593750     test accuracy: 0.492507
Average cost in epoch 68: 0.823349
training accuracy: 0.781250     test accuracy: 0.489510
Average cost in epoch 69: 0.735574
training accuracy: 0.656250     test accuracy: 0.489510

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 70: 0.791324
training accuracy: 0.656250     test accuracy: 0.493506
lr decays to 0.002288
Average cost in epoch 71: 0.780725
training accuracy: 0.703125     test accuracy: 0.502498
Average cost in epoch 72: 0.781765
training accuracy: 0.750000     test accuracy: 0.488511
Average cost in epoch 73: 0.776314
training accuracy: 0.656250     test accuracy: 0.498501
Average cost in epoch 74: 0.764272
training accuracy: 0.656250     test accuracy: 0.505495

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 75: 0.787317
training accuracy: 0.765625     test accuracy: 0.490509
lr decays to 0.002059
Average cost in epoch 76: 0.750271
training accuracy: 0.765625     test accuracy: 0.492507
Average cost in epoch 77: 0.764407
training accuracy: 0.781250     test accuracy: 0.475524
Average cost in epoch 78: 0.722973
training accuracy: 0.656250     test accuracy: 0.489510
Average cost in epoch 79: 0.750249
training accuracy: 0.703125     test accuracy: 0.500500

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 80: 0.785091
training accuracy: 0.703125     test accuracy: 0.484515
lr decays to 0.001853
Average cost in epoch 81: 0.710720
training accuracy: 0.656250     test accuracy: 0.480519
Average cost in epoch 82: 0.719360
training accuracy: 0.671875     test accuracy: 0.478521
Average cost in epoch 83: 0.723378
training accuracy: 0.734375     test accuracy: 0.500500
Average cost in epoch 84: 0.726976
training accuracy: 0.718750     test accuracy: 0.487512

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 85: 0.722652
training accuracy: 0.656250     test accuracy: 0.486513
lr decays to 0.001668
Average cost in epoch 86: 0.762578
training accuracy: 0.812500     test accuracy: 0.486513
Average cost in epoch 87: 0.727909
training accuracy: 0.796875     test accuracy: 0.479520
Average cost in epoch 88: 0.722574
training accuracy: 0.703125     test accuracy: 0.493506
Average cost in epoch 89: 0.711875
training accuracy: 0.765625     test accuracy: 0.480519

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 90: 0.732043
training accuracy: 0.734375     test accuracy: 0.487512
lr decays to 0.001501
Average cost in epoch 91: 0.711478
training accuracy: 0.718750     test accuracy: 0.495504
Average cost in epoch 92: 0.719833
training accuracy: 0.765625     test accuracy: 0.478521
Average cost in epoch 93: 0.686559
training accuracy: 0.765625     test accuracy: 0.484515
Average cost in epoch 94: 0.725606
training accuracy: 0.734375     test accuracy: 0.487512

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 95: 0.719776
training accuracy: 0.750000     test accuracy: 0.488511
lr decays to 0.001351
Average cost in epoch 96: 0.695249
training accuracy: 0.718750     test accuracy: 0.476523
Average cost in epoch 97: 0.689344
training accuracy: 0.796875     test accuracy: 0.485514
Average cost in epoch 98: 0.738832
training accuracy: 0.718750     test accuracy: 0.492507
Average cost in epoch 99: 0.705215
training accuracy: 0.765625     test accuracy: 0.485514

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 100: 0.681389
training accuracy: 0.734375     test accuracy: 0.494505
lr decays to 0.001216
Average cost in epoch 101: 0.687553
training accuracy: 0.734375     test accuracy: 0.490509
Average cost in epoch 102: 0.725086
training accuracy: 0.734375     test accuracy: 0.486513
Average cost in epoch 103: 0.703550
training accuracy: 0.812500     test accuracy: 0.495504
Average cost in epoch 104: 0.683741
training accuracy: 0.671875     test accuracy: 0.485514

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 105: 0.653801
training accuracy: 0.703125     test accuracy: 0.496503
Average cost in epoch 106: 0.698278
training accuracy: 0.828125     test accuracy: 0.487512
Average cost in epoch 107: 0.665214
training accuracy: 0.796875     test accuracy: 0.482517
Average cost in epoch 108: 0.700305
training accuracy: 0.734375     test accuracy: 0.497502
Average cost in epoch 109: 0.651168
training accuracy: 0.796875     test accuracy: 0.487512

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 110: 0.650225
training accuracy: 0.687500     test accuracy: 0.494505
Average cost in epoch 111: 0.677477
training accuracy: 0.796875     test accuracy: 0.495504
Average cost in epoch 112: 0.659126
training accuracy: 0.843750     test accuracy: 0.494505
Average cost in epoch 113: 0.607291
training accuracy: 0.640625     test accuracy: 0.496503
Average cost in epoch 114: 0.699331
training accuracy: 0.828125     test accuracy: 0.483516

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 115: 0.655362
training accuracy: 0.703125     test accuracy: 0.485514
Average cost in epoch 116: 0.687147
training accuracy: 0.812500     test accuracy: 0.496503
Average cost in epoch 117: 0.670517
training accuracy: 0.703125     test accuracy: 0.500500
Average cost in epoch 118: 0.656051
training accuracy: 0.734375     test accuracy: 0.479520
Average cost in epoch 119: 0.643555
training accuracy: 0.718750     test accuracy: 0.495504

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 120: 0.650293
training accuracy: 0.671875     test accuracy: 0.490509
Average cost in epoch 121: 0.676003
training accuracy: 0.734375     test accuracy: 0.500500
Average cost in epoch 122: 0.663992
training accuracy: 0.750000     test accuracy: 0.502498
Average cost in epoch 123: 0.673868
training accuracy: 0.687500     test accuracy: 0.508492
Average cost in epoch 124: 0.636511
training accuracy: 0.656250     test accuracy: 0.498501

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 125: 0.627827
training accuracy: 0.765625     test accuracy: 0.494505
Average cost in epoch 126: 0.695950
training accuracy: 0.671875     test accuracy: 0.489510
Average cost in epoch 127: 0.663602
training accuracy: 0.828125     test accuracy: 0.497502
Average cost in epoch 128: 0.632860
training accuracy: 0.750000     test accuracy: 0.496503
Average cost in epoch 129: 0.653078
training accuracy: 0.734375     test accuracy: 0.496503

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 130: 0.647947
training accuracy: 0.718750     test accuracy: 0.489510
Average cost in epoch 131: 0.689272
training accuracy: 0.781250     test accuracy: 0.498501
Average cost in epoch 132: 0.630973
training accuracy: 0.640625     test accuracy: 0.499500
Average cost in epoch 133: 0.614370
training accuracy: 0.765625     test accuracy: 0.493506
Average cost in epoch 134: 0.630255
training accuracy: 0.796875     test accuracy: 0.499500

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 135: 0.672026
training accuracy: 0.765625     test accuracy: 0.488511
Average cost in epoch 136: 0.654662
training accuracy: 0.765625     test accuracy: 0.479520
Average cost in epoch 137: 0.642394
training accuracy: 0.796875     test accuracy: 0.480519
Average cost in epoch 138: 0.633069
training accuracy: 0.812500     test accuracy: 0.479520
Average cost in epoch 139: 0.685818
training accuracy: 0.796875     test accuracy: 0.488511

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 140: 0.638903
training accuracy: 0.796875     test accuracy: 0.485514
Average cost in epoch 141: 0.646064
training accuracy: 0.859375     test accuracy: 0.482517
Average cost in epoch 142: 0.633775
training accuracy: 0.734375     test accuracy: 0.490509
Average cost in epoch 143: 0.640940
training accuracy: 0.734375     test accuracy: 0.498501
Average cost in epoch 144: 0.576361
training accuracy: 0.703125     test accuracy: 0.502498

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 145: 0.651430
training accuracy: 0.796875     test accuracy: 0.494505
Average cost in epoch 146: 0.621528
training accuracy: 0.812500     test accuracy: 0.486513
Average cost in epoch 147: 0.631049
training accuracy: 0.781250     test accuracy: 0.494505
Average cost in epoch 148: 0.617396
training accuracy: 0.718750     test accuracy: 0.501499
Average cost in epoch 149: 0.644376
training accuracy: 0.750000     test accuracy: 0.486513

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 150: 0.632914
training accuracy: 0.781250     test accuracy: 0.491508
Average cost in epoch 151: 0.645334
training accuracy: 0.781250     test accuracy: 0.481518
Average cost in epoch 152: 0.662494
training accuracy: 0.687500     test accuracy: 0.483516
Average cost in epoch 153: 0.614501
training accuracy: 0.703125     test accuracy: 0.487512
Average cost in epoch 154: 0.658954
training accuracy: 0.812500     test accuracy: 0.484515

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 155: 0.639009
training accuracy: 0.750000     test accuracy: 0.487512
Average cost in epoch 156: 0.605191
training accuracy: 0.718750     test accuracy: 0.478521
Average cost in epoch 157: 0.582446
training accuracy: 0.734375     test accuracy: 0.482517
Average cost in epoch 158: 0.662058
training accuracy: 0.734375     test accuracy: 0.492507
Average cost in epoch 159: 0.612045
training accuracy: 0.734375     test accuracy: 0.492507

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 160: 0.618252
training accuracy: 0.890625     test accuracy: 0.487512
Average cost in epoch 161: 0.622459
training accuracy: 0.765625     test accuracy: 0.495504
Average cost in epoch 162: 0.624297
training accuracy: 0.750000     test accuracy: 0.498501
Average cost in epoch 163: 0.604410
training accuracy: 0.734375     test accuracy: 0.476523
Average cost in epoch 164: 0.618073
training accuracy: 0.734375     test accuracy: 0.481518

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 165: 0.593482
training accuracy: 0.812500     test accuracy: 0.490509
Average cost in epoch 166: 0.595221
training accuracy: 0.828125     test accuracy: 0.487512
Average cost in epoch 167: 0.602496
training accuracy: 0.765625     test accuracy: 0.482517
Average cost in epoch 168: 0.605806
training accuracy: 0.765625     test accuracy: 0.482517
Average cost in epoch 169: 0.619779
training accuracy: 0.750000     test accuracy: 0.488511

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 170: 0.602393
training accuracy: 0.640625     test accuracy: 0.497502
Average cost in epoch 171: 0.621777
training accuracy: 0.781250     test accuracy: 0.499500
Average cost in epoch 172: 0.578404
training accuracy: 0.843750     test accuracy: 0.491508
Average cost in epoch 173: 0.582769
training accuracy: 0.843750     test accuracy: 0.490509
Average cost in epoch 174: 0.608624
training accuracy: 0.671875     test accuracy: 0.485514

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 175: 0.585906
training accuracy: 0.750000     test accuracy: 0.492507
Average cost in epoch 176: 0.594781
training accuracy: 0.734375     test accuracy: 0.491508
Average cost in epoch 177: 0.590538
training accuracy: 0.812500     test accuracy: 0.487512
Average cost in epoch 178: 0.584393
training accuracy: 0.812500     test accuracy: 0.494505
Average cost in epoch 179: 0.575668
training accuracy: 0.718750     test accuracy: 0.498501

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 180: 0.621840
training accuracy: 0.781250     test accuracy: 0.481518
Average cost in epoch 181: 0.576847
training accuracy: 0.687500     test accuracy: 0.487512
Average cost in epoch 182: 0.606597
training accuracy: 0.796875     test accuracy: 0.494505
Average cost in epoch 183: 0.583626
training accuracy: 0.781250     test accuracy: 0.489510
Average cost in epoch 184: 0.597010
training accuracy: 0.718750     test accuracy: 0.494505

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 185: 0.605706
training accuracy: 0.656250     test accuracy: 0.491508
Average cost in epoch 186: 0.601240
training accuracy: 0.765625     test accuracy: 0.486513
Average cost in epoch 187: 0.564913
training accuracy: 0.781250     test accuracy: 0.481518
Average cost in epoch 188: 0.557928
training accuracy: 0.765625     test accuracy: 0.486513
Average cost in epoch 189: 0.601034
training accuracy: 0.828125     test accuracy: 0.492507

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 190: 0.552903
training accuracy: 0.796875     test accuracy: 0.486513
Average cost in epoch 191: 0.603553
training accuracy: 0.734375     test accuracy: 0.478521
Average cost in epoch 192: 0.599475
training accuracy: 0.781250     test accuracy: 0.486513
Average cost in epoch 193: 0.561179
training accuracy: 0.734375     test accuracy: 0.500500
Average cost in epoch 194: 0.599477
training accuracy: 0.796875     test accuracy: 0.491508

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Average cost in epoch 195: 0.577817
training accuracy: 0.750000     test accuracy: 0.488511
Average cost in epoch 196: 0.604730
training accuracy: 0.812500     test accuracy: 0.486513
Average cost in epoch 197: 0.573340
training accuracy: 0.781250     test accuracy: 0.487512
Average cost in epoch 198: 0.563615
training accuracy: 0.687500     test accuracy: 0.481518
Average cost in epoch 199: 0.594214
training accuracy: 0.781250     test accuracy: 0.492507

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_5.pkl

Locking... locked.
No job requests to schedule
INFO (theano.gof.compilelock): Waiting for existing lock by process '27482' (I am process '12962')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '27946' (I am process '12962')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '27708' (I am process '12962')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '13401' (I am process '12962')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23218' (I am process '12962')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23609' (I am process '12962')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23828' (I am process '12962')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by unknown process (I am process '12962')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '1216' (I am process '12962')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '27319' (I am process '12962')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by unknown process (I am process '12962')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '25197' (I am process '12962')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '25197' (I am process '12962')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '25197' (I am process '12962')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 6, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_6.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 105.47
Starting training...
Average cost in epoch 0: 1.193949
training accuracy: 0.453125     test accuracy: 0.497502
Average cost in epoch 1: 0.742018
training accuracy: 0.437500     test accuracy: 0.502498
Average cost in epoch 2: 0.735962
training accuracy: 0.484375     test accuracy: 0.497502
Average cost in epoch 3: 0.720019
training accuracy: 0.437500     test accuracy: 0.497502
Average cost in epoch 4: 0.710853
training accuracy: 0.609375     test accuracy: 0.502498

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 5: 0.712033
training accuracy: 0.484375     test accuracy: 0.502498
lr decays to 0.009000
Average cost in epoch 6: 0.708992
training accuracy: 0.484375     test accuracy: 0.502498
Average cost in epoch 7: 0.707035
training accuracy: 0.468750     test accuracy: 0.502498
Average cost in epoch 8: 0.696504
training accuracy: 0.562500     test accuracy: 0.497502
Average cost in epoch 9: 0.699842
training accuracy: 0.406250     test accuracy: 0.502498

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 10: 0.700667
training accuracy: 0.375000     test accuracy: 0.502498
lr decays to 0.008100
Average cost in epoch 11: 0.699883
training accuracy: 0.515625     test accuracy: 0.497502
Average cost in epoch 12: 0.703481
training accuracy: 0.500000     test accuracy: 0.497502
Average cost in epoch 13: 0.706744
training accuracy: 0.484375     test accuracy: 0.497502
Average cost in epoch 14: 0.699826
training accuracy: 0.406250     test accuracy: 0.502498

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 15: 0.692401
training accuracy: 0.421875     test accuracy: 0.511489
lr decays to 0.007290
Average cost in epoch 16: 0.699114
training accuracy: 0.421875     test accuracy: 0.493506
Average cost in epoch 17: 0.687013
training accuracy: 0.593750     test accuracy: 0.502498
Average cost in epoch 18: 0.694332
training accuracy: 0.437500     test accuracy: 0.488511
Average cost in epoch 19: 0.693344
training accuracy: 0.609375     test accuracy: 0.514486

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 20: 0.688103
training accuracy: 0.515625     test accuracy: 0.500500
lr decays to 0.006561
Average cost in epoch 21: 0.690678
training accuracy: 0.531250     test accuracy: 0.482517
Average cost in epoch 22: 0.684035
training accuracy: 0.546875     test accuracy: 0.478521
Average cost in epoch 23: 0.680395
training accuracy: 0.546875     test accuracy: 0.496503
Average cost in epoch 24: 0.682293
training accuracy: 0.515625     test accuracy: 0.546454

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 25: 0.681412
training accuracy: 0.546875     test accuracy: 0.528472
lr decays to 0.005905
Average cost in epoch 26: 0.669645
training accuracy: 0.609375     test accuracy: 0.526474
Average cost in epoch 27: 0.685960
training accuracy: 0.500000     test accuracy: 0.508492
Average cost in epoch 28: 0.663264
training accuracy: 0.609375     test accuracy: 0.507493
Average cost in epoch 29: 0.665014
training accuracy: 0.531250     test accuracy: 0.512488

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 30: 0.649064
training accuracy: 0.562500     test accuracy: 0.536464
lr decays to 0.005314
Average cost in epoch 31: 0.651639
training accuracy: 0.687500     test accuracy: 0.519481
Average cost in epoch 32: 0.655688
training accuracy: 0.593750     test accuracy: 0.539461
Average cost in epoch 33: 0.646428
training accuracy: 0.656250     test accuracy: 0.517483
Average cost in epoch 34: 0.645230
training accuracy: 0.562500     test accuracy: 0.528472

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 35: 0.634487
training accuracy: 0.625000     test accuracy: 0.510490
lr decays to 0.004783
Average cost in epoch 36: 0.650831
training accuracy: 0.578125     test accuracy: 0.522478
Average cost in epoch 37: 0.623886
training accuracy: 0.625000     test accuracy: 0.519481
Average cost in epoch 38: 0.624071
training accuracy: 0.703125     test accuracy: 0.508492
Average cost in epoch 39: 0.626674
training accuracy: 0.640625     test accuracy: 0.515485

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 40: 0.616437
training accuracy: 0.609375     test accuracy: 0.521479
lr decays to 0.004305
Average cost in epoch 41: 0.629905
training accuracy: 0.609375     test accuracy: 0.516484
Average cost in epoch 42: 0.600421
training accuracy: 0.640625     test accuracy: 0.516484
Average cost in epoch 43: 0.602812
training accuracy: 0.609375     test accuracy: 0.523477
Average cost in epoch 44: 0.611130
training accuracy: 0.703125     test accuracy: 0.531469

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 45: 0.594125
training accuracy: 0.750000     test accuracy: 0.512488
lr decays to 0.003874
Average cost in epoch 46: 0.611907
training accuracy: 0.640625     test accuracy: 0.508492
Average cost in epoch 47: 0.611511
training accuracy: 0.656250     test accuracy: 0.512488
Average cost in epoch 48: 0.573261
training accuracy: 0.703125     test accuracy: 0.501499
Average cost in epoch 49: 0.565898
training accuracy: 0.718750     test accuracy: 0.513487

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 50: 0.560064
training accuracy: 0.718750     test accuracy: 0.519481
lr decays to 0.003487
Average cost in epoch 51: 0.566844
training accuracy: 0.703125     test accuracy: 0.508492
Average cost in epoch 52: 0.549955
training accuracy: 0.796875     test accuracy: 0.507493
Average cost in epoch 53: 0.572689
training accuracy: 0.718750     test accuracy: 0.507493
Average cost in epoch 54: 0.538864
training accuracy: 0.828125     test accuracy: 0.498501

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 55: 0.521869
training accuracy: 0.687500     test accuracy: 0.506494
lr decays to 0.003138
Average cost in epoch 56: 0.526599
training accuracy: 0.734375     test accuracy: 0.504496
Average cost in epoch 57: 0.535219
training accuracy: 0.796875     test accuracy: 0.503497
Average cost in epoch 58: 0.498245
training accuracy: 0.656250     test accuracy: 0.510490
Average cost in epoch 59: 0.474403
training accuracy: 0.828125     test accuracy: 0.515485

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 60: 0.519833
training accuracy: 0.843750     test accuracy: 0.514486
lr decays to 0.002824
Average cost in epoch 61: 0.516078
training accuracy: 0.765625     test accuracy: 0.505495
Average cost in epoch 62: 0.481921
training accuracy: 0.781250     test accuracy: 0.502498
Average cost in epoch 63: 0.467282
training accuracy: 0.671875     test accuracy: 0.494505
Average cost in epoch 64: 0.495086
training accuracy: 0.671875     test accuracy: 0.502498

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 65: 0.462688
training accuracy: 0.781250     test accuracy: 0.507493
lr decays to 0.002542
Average cost in epoch 66: 0.455328
training accuracy: 0.781250     test accuracy: 0.512488
Average cost in epoch 67: 0.482248
training accuracy: 0.781250     test accuracy: 0.494505
Average cost in epoch 68: 0.456589
training accuracy: 0.843750     test accuracy: 0.509491
Average cost in epoch 69: 0.470873
training accuracy: 0.796875     test accuracy: 0.518482

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 70: 0.452154
training accuracy: 0.843750     test accuracy: 0.511489
lr decays to 0.002288
Average cost in epoch 71: 0.451106
training accuracy: 0.828125     test accuracy: 0.519481
Average cost in epoch 72: 0.454240
training accuracy: 0.859375     test accuracy: 0.520480
Average cost in epoch 73: 0.429433
training accuracy: 0.812500     test accuracy: 0.518482
Average cost in epoch 74: 0.440410
training accuracy: 0.765625     test accuracy: 0.509491

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 75: 0.415519
training accuracy: 0.718750     test accuracy: 0.511489
lr decays to 0.002059
Average cost in epoch 76: 0.424539
training accuracy: 0.781250     test accuracy: 0.511489
Average cost in epoch 77: 0.441255
training accuracy: 0.796875     test accuracy: 0.507493
Average cost in epoch 78: 0.408740
training accuracy: 0.750000     test accuracy: 0.508492
Average cost in epoch 79: 0.447852
training accuracy: 0.828125     test accuracy: 0.499500

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 80: 0.420131
training accuracy: 0.828125     test accuracy: 0.515485
lr decays to 0.001853
Average cost in epoch 81: 0.381818
training accuracy: 0.859375     test accuracy: 0.515485
Average cost in epoch 82: 0.403847
training accuracy: 0.781250     test accuracy: 0.502498
Average cost in epoch 83: 0.400980
training accuracy: 0.828125     test accuracy: 0.502498
Average cost in epoch 84: 0.395113
training accuracy: 0.734375     test accuracy: 0.511489

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 85: 0.392958
training accuracy: 0.843750     test accuracy: 0.511489
lr decays to 0.001668
Average cost in epoch 86: 0.385095
training accuracy: 0.750000     test accuracy: 0.502498
Average cost in epoch 87: 0.377010
training accuracy: 0.781250     test accuracy: 0.507493
Average cost in epoch 88: 0.389574
training accuracy: 0.796875     test accuracy: 0.516484
Average cost in epoch 89: 0.372940
training accuracy: 0.765625     test accuracy: 0.509491

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 90: 0.402961
training accuracy: 0.843750     test accuracy: 0.509491
lr decays to 0.001501
Average cost in epoch 91: 0.359729
training accuracy: 0.812500     test accuracy: 0.499500
Average cost in epoch 92: 0.368560
training accuracy: 0.875000     test accuracy: 0.502498
Average cost in epoch 93: 0.368203
training accuracy: 0.890625     test accuracy: 0.503497
Average cost in epoch 94: 0.369682
training accuracy: 0.828125     test accuracy: 0.491508

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 95: 0.366276
training accuracy: 0.859375     test accuracy: 0.497502
lr decays to 0.001351
Average cost in epoch 96: 0.368875
training accuracy: 0.843750     test accuracy: 0.505495
Average cost in epoch 97: 0.341115
training accuracy: 0.890625     test accuracy: 0.499500
Average cost in epoch 98: 0.353911
training accuracy: 0.859375     test accuracy: 0.509491
Average cost in epoch 99: 0.347928
training accuracy: 0.906250     test accuracy: 0.506494

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 100: 0.334191
training accuracy: 0.843750     test accuracy: 0.509491
lr decays to 0.001216
Average cost in epoch 101: 0.317434
training accuracy: 0.828125     test accuracy: 0.510490
Average cost in epoch 102: 0.344704
training accuracy: 0.921875     test accuracy: 0.509491
Average cost in epoch 103: 0.340227
training accuracy: 0.812500     test accuracy: 0.494505
Average cost in epoch 104: 0.331587
training accuracy: 0.812500     test accuracy: 0.501499

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 105: 0.318123
training accuracy: 0.875000     test accuracy: 0.501499
Average cost in epoch 106: 0.317385
training accuracy: 0.875000     test accuracy: 0.497502
Average cost in epoch 107: 0.351757
training accuracy: 0.890625     test accuracy: 0.496503
Average cost in epoch 108: 0.319629
training accuracy: 0.843750     test accuracy: 0.500500
Average cost in epoch 109: 0.319562
training accuracy: 0.921875     test accuracy: 0.511489

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 110: 0.295055
training accuracy: 0.859375     test accuracy: 0.512488
Average cost in epoch 111: 0.343580
training accuracy: 0.843750     test accuracy: 0.504496
Average cost in epoch 112: 0.331914
training accuracy: 0.843750     test accuracy: 0.508492
Average cost in epoch 113: 0.312168
training accuracy: 0.812500     test accuracy: 0.500500
Average cost in epoch 114: 0.332487
training accuracy: 0.921875     test accuracy: 0.508492

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 115: 0.292129
training accuracy: 0.906250     test accuracy: 0.509491
Average cost in epoch 116: 0.327432
training accuracy: 0.937500     test accuracy: 0.513487
Average cost in epoch 117: 0.297423
training accuracy: 0.828125     test accuracy: 0.507493
Average cost in epoch 118: 0.303393
training accuracy: 0.906250     test accuracy: 0.511489
Average cost in epoch 119: 0.310913
training accuracy: 0.921875     test accuracy: 0.514486

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 120: 0.316615
training accuracy: 0.875000     test accuracy: 0.502498
Average cost in epoch 121: 0.288960
training accuracy: 0.890625     test accuracy: 0.515485
Average cost in epoch 122: 0.344550
training accuracy: 0.906250     test accuracy: 0.507493
Average cost in epoch 123: 0.295025
training accuracy: 0.921875     test accuracy: 0.521479
Average cost in epoch 124: 0.300938
training accuracy: 0.796875     test accuracy: 0.504496

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 125: 0.298218
training accuracy: 0.812500     test accuracy: 0.505495
Average cost in epoch 126: 0.317757
training accuracy: 0.921875     test accuracy: 0.514486
Average cost in epoch 127: 0.296378
training accuracy: 0.828125     test accuracy: 0.506494
Average cost in epoch 128: 0.292844
training accuracy: 0.890625     test accuracy: 0.505495
Average cost in epoch 129: 0.291916
training accuracy: 0.890625     test accuracy: 0.506494

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 130: 0.286441
training accuracy: 0.875000     test accuracy: 0.505495
Average cost in epoch 131: 0.292886
training accuracy: 0.890625     test accuracy: 0.512488
Average cost in epoch 132: 0.294315
training accuracy: 0.859375     test accuracy: 0.507493
Average cost in epoch 133: 0.281776
training accuracy: 0.875000     test accuracy: 0.506494
Average cost in epoch 134: 0.268117
training accuracy: 0.906250     test accuracy: 0.510490

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 135: 0.284461
training accuracy: 0.921875     test accuracy: 0.513487
Average cost in epoch 136: 0.267061
training accuracy: 0.921875     test accuracy: 0.515485
Average cost in epoch 137: 0.309747
training accuracy: 0.875000     test accuracy: 0.523477
Average cost in epoch 138: 0.302114
training accuracy: 0.890625     test accuracy: 0.514486
Average cost in epoch 139: 0.276454
training accuracy: 0.828125     test accuracy: 0.505495

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 140: 0.272017
training accuracy: 0.984375     test accuracy: 0.509491
Average cost in epoch 141: 0.295995
training accuracy: 0.953125     test accuracy: 0.503497
Average cost in epoch 142: 0.284809
training accuracy: 0.906250     test accuracy: 0.508492
Average cost in epoch 143: 0.286717
training accuracy: 0.984375     test accuracy: 0.511489
Average cost in epoch 144: 0.305461
training accuracy: 0.921875     test accuracy: 0.515485

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 145: 0.328791
training accuracy: 0.968750     test accuracy: 0.508492
Average cost in epoch 146: 0.277289
training accuracy: 0.921875     test accuracy: 0.512488
Average cost in epoch 147: 0.297279
training accuracy: 0.890625     test accuracy: 0.517483
Average cost in epoch 148: 0.266219
training accuracy: 0.921875     test accuracy: 0.515485
Average cost in epoch 149: 0.281061
training accuracy: 0.906250     test accuracy: 0.515485

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 150: 0.305390
training accuracy: 0.859375     test accuracy: 0.504496
Average cost in epoch 151: 0.255425
training accuracy: 0.843750     test accuracy: 0.499500
Average cost in epoch 152: 0.241290
training accuracy: 0.875000     test accuracy: 0.503497
Average cost in epoch 153: 0.268207
training accuracy: 0.953125     test accuracy: 0.502498
Average cost in epoch 154: 0.248769
training accuracy: 0.906250     test accuracy: 0.508492

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 155: 0.289855
training accuracy: 0.890625     test accuracy: 0.504496
Average cost in epoch 156: 0.261849
training accuracy: 0.875000     test accuracy: 0.509491
Average cost in epoch 157: 0.281893
training accuracy: 0.890625     test accuracy: 0.517483
Average cost in epoch 158: 0.243322
training accuracy: 0.890625     test accuracy: 0.515485
Average cost in epoch 159: 0.266902
training accuracy: 0.859375     test accuracy: 0.517483

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 160: 0.271754
training accuracy: 0.906250     test accuracy: 0.518482
Average cost in epoch 161: 0.271448
training accuracy: 0.875000     test accuracy: 0.509491
Average cost in epoch 162: 0.235012
training accuracy: 0.906250     test accuracy: 0.521479
Average cost in epoch 163: 0.247155
training accuracy: 0.859375     test accuracy: 0.510490
Average cost in epoch 164: 0.278057
training accuracy: 0.968750     test accuracy: 0.521479

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 165: 0.237220
training accuracy: 0.953125     test accuracy: 0.516484
Average cost in epoch 166: 0.258465
training accuracy: 0.812500     test accuracy: 0.516484
Average cost in epoch 167: 0.238824
training accuracy: 0.859375     test accuracy: 0.518482
Average cost in epoch 168: 0.279953
training accuracy: 0.953125     test accuracy: 0.516484
Average cost in epoch 169: 0.264328
training accuracy: 0.906250     test accuracy: 0.515485

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 170: 0.249949
training accuracy: 0.843750     test accuracy: 0.518482
Average cost in epoch 171: 0.271887
training accuracy: 0.906250     test accuracy: 0.520480
Average cost in epoch 172: 0.242961
training accuracy: 0.859375     test accuracy: 0.523477
Average cost in epoch 173: 0.227655
training accuracy: 0.937500     test accuracy: 0.521479
Average cost in epoch 174: 0.243803
training accuracy: 0.906250     test accuracy: 0.528472

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 175: 0.267208
training accuracy: 0.953125     test accuracy: 0.516484
Average cost in epoch 176: 0.255356
training accuracy: 0.953125     test accuracy: 0.524476
Average cost in epoch 177: 0.251529
training accuracy: 0.937500     test accuracy: 0.522478
Average cost in epoch 178: 0.239368
training accuracy: 0.906250     test accuracy: 0.519481
Average cost in epoch 179: 0.253794
training accuracy: 0.953125     test accuracy: 0.517483

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 180: 0.251387
training accuracy: 0.937500     test accuracy: 0.518482
Average cost in epoch 181: 0.233234
training accuracy: 0.937500     test accuracy: 0.511489
Average cost in epoch 182: 0.253504
training accuracy: 0.859375     test accuracy: 0.517483
Average cost in epoch 183: 0.238314
training accuracy: 0.937500     test accuracy: 0.510490
Average cost in epoch 184: 0.229551
training accuracy: 0.953125     test accuracy: 0.514486

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 185: 0.240262
training accuracy: 0.953125     test accuracy: 0.514486
Average cost in epoch 186: 0.236683
training accuracy: 0.890625     test accuracy: 0.526474
Average cost in epoch 187: 0.219329
training accuracy: 0.937500     test accuracy: 0.520480
Average cost in epoch 188: 0.223402
training accuracy: 0.921875     test accuracy: 0.512488
Average cost in epoch 189: 0.221027
training accuracy: 0.906250     test accuracy: 0.512488

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 190: 0.249663
training accuracy: 0.890625     test accuracy: 0.524476
Average cost in epoch 191: 0.242565
training accuracy: 0.921875     test accuracy: 0.519481
Average cost in epoch 192: 0.205586
training accuracy: 0.921875     test accuracy: 0.516484
Average cost in epoch 193: 0.233200
training accuracy: 0.921875     test accuracy: 0.520480
Average cost in epoch 194: 0.239314
training accuracy: 0.953125     test accuracy: 0.518482

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Average cost in epoch 195: 0.195528
training accuracy: 0.906250     test accuracy: 0.514486
Average cost in epoch 196: 0.223857
training accuracy: 0.921875     test accuracy: 0.523477
Average cost in epoch 197: 0.213428
training accuracy: 0.906250     test accuracy: 0.513487
Average cost in epoch 198: 0.192356
training accuracy: 0.890625     test accuracy: 0.513487
Average cost in epoch 199: 0.253113
training accuracy: 0.921875     test accuracy: 0.531469

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_6.pkl

Locking... locked.
No job requests to schedule
INFO (theano.gof.compilelock): Waiting for existing lock by process '27482' (I am process '13153')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '27946' (I am process '13153')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '27708' (I am process '13153')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '13401' (I am process '13153')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23218' (I am process '13153')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23609' (I am process '13153')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23828' (I am process '13153')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 7, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_7.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 92.34
Starting training...
Average cost in epoch 0: 1.418154
training accuracy: 0.484375     test accuracy: 0.487512
Average cost in epoch 1: 0.906127
training accuracy: 0.531250     test accuracy: 0.487512
Average cost in epoch 2: 0.837119
training accuracy: 0.687500     test accuracy: 0.655345
Average cost in epoch 3: 0.824714
training accuracy: 0.609375     test accuracy: 0.634366
Average cost in epoch 4: 0.805445
training accuracy: 0.515625     test accuracy: 0.641359

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 5: 0.770082
training accuracy: 0.593750     test accuracy: 0.707293
lr decays to 0.009000
Average cost in epoch 6: 0.686137
training accuracy: 0.703125     test accuracy: 0.752248
Average cost in epoch 7: 0.663280
training accuracy: 0.734375     test accuracy: 0.772228
Average cost in epoch 8: 0.717899
training accuracy: 0.750000     test accuracy: 0.761239
Average cost in epoch 9: 0.622386
training accuracy: 0.812500     test accuracy: 0.782218

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 10: 0.621681
training accuracy: 0.796875     test accuracy: 0.783217
lr decays to 0.008100
Average cost in epoch 11: 0.616772
training accuracy: 0.718750     test accuracy: 0.744256
Average cost in epoch 12: 0.596815
training accuracy: 0.703125     test accuracy: 0.773227
Average cost in epoch 13: 0.576829
training accuracy: 0.796875     test accuracy: 0.778222
Average cost in epoch 14: 0.623673
training accuracy: 0.859375     test accuracy: 0.775225

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 15: 0.612150
training accuracy: 0.843750     test accuracy: 0.781219
lr decays to 0.007290
Average cost in epoch 16: 0.582566
training accuracy: 0.859375     test accuracy: 0.782218
Average cost in epoch 17: 0.648258
training accuracy: 0.796875     test accuracy: 0.784216
Average cost in epoch 18: 0.571936
training accuracy: 0.781250     test accuracy: 0.780220
Average cost in epoch 19: 0.548888
training accuracy: 0.796875     test accuracy: 0.777223

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 20: 0.583035
training accuracy: 0.812500     test accuracy: 0.784216
lr decays to 0.006561
Average cost in epoch 21: 0.568786
training accuracy: 0.828125     test accuracy: 0.780220
Average cost in epoch 22: 0.584624
training accuracy: 0.859375     test accuracy: 0.779221
Average cost in epoch 23: 0.571749
training accuracy: 0.843750     test accuracy: 0.777223
Average cost in epoch 24: 0.551861
training accuracy: 0.765625     test accuracy: 0.778222

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 25: 0.549168
training accuracy: 0.828125     test accuracy: 0.779221
lr decays to 0.005905
Average cost in epoch 26: 0.553726
training accuracy: 0.734375     test accuracy: 0.772228
Average cost in epoch 27: 0.575915
training accuracy: 0.875000     test accuracy: 0.778222
Average cost in epoch 28: 0.518941
training accuracy: 0.718750     test accuracy: 0.777223
Average cost in epoch 29: 0.570641
training accuracy: 0.875000     test accuracy: 0.763237

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 30: 0.528333
training accuracy: 0.843750     test accuracy: 0.778222
lr decays to 0.005314
Average cost in epoch 31: 0.577446
training accuracy: 0.796875     test accuracy: 0.780220
Average cost in epoch 32: 0.531879
training accuracy: 0.781250     test accuracy: 0.766234
Average cost in epoch 33: 0.514334
training accuracy: 0.687500     test accuracy: 0.733267
Average cost in epoch 34: 0.591099
training accuracy: 0.734375     test accuracy: 0.765235

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 35: 0.555540
training accuracy: 0.828125     test accuracy: 0.774226
lr decays to 0.004783
Average cost in epoch 36: 0.495673
training accuracy: 0.765625     test accuracy: 0.772228
Average cost in epoch 37: 0.535409
training accuracy: 0.875000     test accuracy: 0.771229
Average cost in epoch 38: 0.476236
training accuracy: 0.781250     test accuracy: 0.774226
Average cost in epoch 39: 0.498621
training accuracy: 0.781250     test accuracy: 0.774226

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 40: 0.505958
training accuracy: 0.781250     test accuracy: 0.777223
lr decays to 0.004305
Average cost in epoch 41: 0.498607
training accuracy: 0.796875     test accuracy: 0.772228
Average cost in epoch 42: 0.505398
training accuracy: 0.750000     test accuracy: 0.772228
Average cost in epoch 43: 0.490937
training accuracy: 0.859375     test accuracy: 0.776224
Average cost in epoch 44: 0.507881
training accuracy: 0.828125     test accuracy: 0.770230

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 45: 0.513054
training accuracy: 0.875000     test accuracy: 0.765235
lr decays to 0.003874
Average cost in epoch 46: 0.501908
training accuracy: 0.859375     test accuracy: 0.770230
Average cost in epoch 47: 0.479331
training accuracy: 0.875000     test accuracy: 0.768232
Average cost in epoch 48: 0.502072
training accuracy: 0.781250     test accuracy: 0.768232
Average cost in epoch 49: 0.474828
training accuracy: 0.812500     test accuracy: 0.766234

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 50: 0.457287
training accuracy: 0.796875     test accuracy: 0.766234
lr decays to 0.003487
Average cost in epoch 51: 0.496018
training accuracy: 0.859375     test accuracy: 0.764236
Average cost in epoch 52: 0.461293
training accuracy: 0.859375     test accuracy: 0.766234
Average cost in epoch 53: 0.436255
training accuracy: 0.859375     test accuracy: 0.766234
Average cost in epoch 54: 0.495836
training accuracy: 0.796875     test accuracy: 0.764236

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 55: 0.414249
training accuracy: 0.828125     test accuracy: 0.759241
lr decays to 0.003138
Average cost in epoch 56: 0.486469
training accuracy: 0.843750     test accuracy: 0.757243
Average cost in epoch 57: 0.459013
training accuracy: 0.906250     test accuracy: 0.760240
Average cost in epoch 58: 0.482092
training accuracy: 0.796875     test accuracy: 0.761239
Average cost in epoch 59: 0.438030
training accuracy: 0.921875     test accuracy: 0.756244

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 60: 0.466448
training accuracy: 0.843750     test accuracy: 0.764236
lr decays to 0.002824
Average cost in epoch 61: 0.443915
training accuracy: 0.859375     test accuracy: 0.757243
Average cost in epoch 62: 0.448895
training accuracy: 0.812500     test accuracy: 0.758242
Average cost in epoch 63: 0.440702
training accuracy: 0.828125     test accuracy: 0.757243
Average cost in epoch 64: 0.436486
training accuracy: 0.859375     test accuracy: 0.754246

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 65: 0.423777
training accuracy: 0.859375     test accuracy: 0.762238
lr decays to 0.002542
Average cost in epoch 66: 0.428137
training accuracy: 0.906250     test accuracy: 0.754246
Average cost in epoch 67: 0.430464
training accuracy: 0.828125     test accuracy: 0.759241
Average cost in epoch 68: 0.445535
training accuracy: 0.750000     test accuracy: 0.764236
Average cost in epoch 69: 0.408661
training accuracy: 0.843750     test accuracy: 0.753247

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 70: 0.425590
training accuracy: 0.828125     test accuracy: 0.760240
lr decays to 0.002288
Average cost in epoch 71: 0.435560
training accuracy: 0.843750     test accuracy: 0.755245
Average cost in epoch 72: 0.383417
training accuracy: 0.828125     test accuracy: 0.753247
Average cost in epoch 73: 0.412999
training accuracy: 0.718750     test accuracy: 0.751249
Average cost in epoch 74: 0.363290
training accuracy: 0.875000     test accuracy: 0.753247

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 75: 0.415444
training accuracy: 0.890625     test accuracy: 0.752248
lr decays to 0.002059
Average cost in epoch 76: 0.398906
training accuracy: 0.765625     test accuracy: 0.751249
Average cost in epoch 77: 0.397840
training accuracy: 0.859375     test accuracy: 0.747253
Average cost in epoch 78: 0.373974
training accuracy: 0.796875     test accuracy: 0.753247
Average cost in epoch 79: 0.391671
training accuracy: 0.812500     test accuracy: 0.753247

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 80: 0.408505
training accuracy: 0.843750     test accuracy: 0.751249
lr decays to 0.001853
Average cost in epoch 81: 0.381636
training accuracy: 0.828125     test accuracy: 0.754246
Average cost in epoch 82: 0.387831
training accuracy: 0.859375     test accuracy: 0.754246
Average cost in epoch 83: 0.371437
training accuracy: 0.765625     test accuracy: 0.749251
Average cost in epoch 84: 0.388894
training accuracy: 0.875000     test accuracy: 0.754246

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 85: 0.359666
training accuracy: 0.906250     test accuracy: 0.752248
lr decays to 0.001668
Average cost in epoch 86: 0.362770
training accuracy: 0.890625     test accuracy: 0.749251
Average cost in epoch 87: 0.370238
training accuracy: 0.906250     test accuracy: 0.746254
Average cost in epoch 88: 0.365480
training accuracy: 0.875000     test accuracy: 0.742258
Average cost in epoch 89: 0.340505
training accuracy: 0.781250     test accuracy: 0.748252

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 90: 0.317305
training accuracy: 0.953125     test accuracy: 0.740260
lr decays to 0.001501
Average cost in epoch 91: 0.345365
training accuracy: 0.906250     test accuracy: 0.755245
Average cost in epoch 92: 0.339513
training accuracy: 0.921875     test accuracy: 0.746254
Average cost in epoch 93: 0.331389
training accuracy: 0.859375     test accuracy: 0.748252
Average cost in epoch 94: 0.331783
training accuracy: 0.843750     test accuracy: 0.750250

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 95: 0.328313
training accuracy: 0.890625     test accuracy: 0.742258
lr decays to 0.001351
Average cost in epoch 96: 0.320550
training accuracy: 0.875000     test accuracy: 0.745255
Average cost in epoch 97: 0.325269
training accuracy: 0.906250     test accuracy: 0.751249
Average cost in epoch 98: 0.362155
training accuracy: 0.875000     test accuracy: 0.760240
Average cost in epoch 99: 0.319690
training accuracy: 0.906250     test accuracy: 0.755245

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 100: 0.324689
training accuracy: 0.875000     test accuracy: 0.742258
lr decays to 0.001216
Average cost in epoch 101: 0.315266
training accuracy: 0.906250     test accuracy: 0.749251
Average cost in epoch 102: 0.317286
training accuracy: 0.859375     test accuracy: 0.743257
Average cost in epoch 103: 0.326659
training accuracy: 0.843750     test accuracy: 0.742258
Average cost in epoch 104: 0.269648
training accuracy: 0.906250     test accuracy: 0.742258

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 105: 0.323281
training accuracy: 0.890625     test accuracy: 0.736264
Average cost in epoch 106: 0.299422
training accuracy: 0.859375     test accuracy: 0.751249
Average cost in epoch 107: 0.284214
training accuracy: 0.843750     test accuracy: 0.748252
Average cost in epoch 108: 0.280635
training accuracy: 0.953125     test accuracy: 0.749251
Average cost in epoch 109: 0.324083
training accuracy: 0.890625     test accuracy: 0.746254

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 110: 0.288866
training accuracy: 0.890625     test accuracy: 0.747253
Average cost in epoch 111: 0.303363
training accuracy: 0.921875     test accuracy: 0.742258
Average cost in epoch 112: 0.329302
training accuracy: 0.890625     test accuracy: 0.739261
Average cost in epoch 113: 0.308492
training accuracy: 0.953125     test accuracy: 0.741259
Average cost in epoch 114: 0.290477
training accuracy: 0.890625     test accuracy: 0.743257

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 115: 0.285360
training accuracy: 0.828125     test accuracy: 0.740260
Average cost in epoch 116: 0.315707
training accuracy: 0.890625     test accuracy: 0.740260
Average cost in epoch 117: 0.303931
training accuracy: 0.937500     test accuracy: 0.745255
Average cost in epoch 118: 0.276434
training accuracy: 0.906250     test accuracy: 0.749251
Average cost in epoch 119: 0.287946
training accuracy: 0.906250     test accuracy: 0.746254

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 120: 0.311758
training accuracy: 0.843750     test accuracy: 0.744256
Average cost in epoch 121: 0.273993
training accuracy: 0.875000     test accuracy: 0.747253
Average cost in epoch 122: 0.305425
training accuracy: 0.875000     test accuracy: 0.739261
Average cost in epoch 123: 0.289325
training accuracy: 0.906250     test accuracy: 0.740260
Average cost in epoch 124: 0.314022
training accuracy: 0.875000     test accuracy: 0.742258

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 125: 0.306117
training accuracy: 0.906250     test accuracy: 0.752248
Average cost in epoch 126: 0.337304
training accuracy: 0.906250     test accuracy: 0.747253
Average cost in epoch 127: 0.327124
training accuracy: 0.859375     test accuracy: 0.746254
Average cost in epoch 128: 0.319435
training accuracy: 0.906250     test accuracy: 0.755245
Average cost in epoch 129: 0.296954
training accuracy: 0.843750     test accuracy: 0.756244

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 130: 0.284980
training accuracy: 0.859375     test accuracy: 0.754246
Average cost in epoch 131: 0.284208
training accuracy: 0.921875     test accuracy: 0.750250
Average cost in epoch 132: 0.289115
training accuracy: 0.921875     test accuracy: 0.751249
Average cost in epoch 133: 0.300778
training accuracy: 0.875000     test accuracy: 0.749251
Average cost in epoch 134: 0.270793
training accuracy: 0.906250     test accuracy: 0.751249

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 135: 0.291605
training accuracy: 0.859375     test accuracy: 0.752248
Average cost in epoch 136: 0.240658
training accuracy: 0.859375     test accuracy: 0.751249
Average cost in epoch 137: 0.266933
training accuracy: 0.875000     test accuracy: 0.749251
Average cost in epoch 138: 0.265229
training accuracy: 0.890625     test accuracy: 0.751249
Average cost in epoch 139: 0.276464
training accuracy: 0.875000     test accuracy: 0.754246

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 140: 0.286346
training accuracy: 0.968750     test accuracy: 0.749251
Average cost in epoch 141: 0.270377
training accuracy: 0.921875     test accuracy: 0.749251
Average cost in epoch 142: 0.290889
training accuracy: 0.875000     test accuracy: 0.747253
Average cost in epoch 143: 0.265380
training accuracy: 0.921875     test accuracy: 0.754246
Average cost in epoch 144: 0.302902
training accuracy: 0.921875     test accuracy: 0.757243

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 145: 0.254534
training accuracy: 0.906250     test accuracy: 0.750250
Average cost in epoch 146: 0.258663
training accuracy: 0.968750     test accuracy: 0.747253
Average cost in epoch 147: 0.270175
training accuracy: 0.906250     test accuracy: 0.743257
Average cost in epoch 148: 0.238463
training accuracy: 0.953125     test accuracy: 0.750250
Average cost in epoch 149: 0.263390
training accuracy: 0.921875     test accuracy: 0.744256

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 150: 0.257186
training accuracy: 0.890625     test accuracy: 0.751249
Average cost in epoch 151: 0.293058
training accuracy: 0.937500     test accuracy: 0.733267
Average cost in epoch 152: 0.269980
training accuracy: 0.921875     test accuracy: 0.753247
Average cost in epoch 153: 0.237821
training accuracy: 0.968750     test accuracy: 0.753247
Average cost in epoch 154: 0.283307
training accuracy: 0.859375     test accuracy: 0.746254

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 155: 0.260389
training accuracy: 0.890625     test accuracy: 0.744256
Average cost in epoch 156: 0.240176
training accuracy: 0.890625     test accuracy: 0.748252
Average cost in epoch 157: 0.256597
training accuracy: 0.890625     test accuracy: 0.745255
Average cost in epoch 158: 0.257966
training accuracy: 0.937500     test accuracy: 0.738262
Average cost in epoch 159: 0.257035
training accuracy: 0.890625     test accuracy: 0.732268

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 160: 0.246494
training accuracy: 0.953125     test accuracy: 0.738262
Average cost in epoch 161: 0.327125
training accuracy: 0.890625     test accuracy: 0.730270
Average cost in epoch 162: 0.273866
training accuracy: 0.921875     test accuracy: 0.744256
Average cost in epoch 163: 0.265859
training accuracy: 0.921875     test accuracy: 0.742258
Average cost in epoch 164: 0.258092
training accuracy: 0.937500     test accuracy: 0.745255

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 165: 0.233414
training accuracy: 0.890625     test accuracy: 0.742258
Average cost in epoch 166: 0.258853
training accuracy: 0.921875     test accuracy: 0.738262
Average cost in epoch 167: 0.254062
training accuracy: 0.890625     test accuracy: 0.734266
Average cost in epoch 168: 0.238319
training accuracy: 0.890625     test accuracy: 0.734266
Average cost in epoch 169: 0.242125
training accuracy: 0.937500     test accuracy: 0.744256

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 170: 0.225396
training accuracy: 0.890625     test accuracy: 0.740260
Average cost in epoch 171: 0.266193
training accuracy: 0.921875     test accuracy: 0.744256
Average cost in epoch 172: 0.262665
training accuracy: 0.921875     test accuracy: 0.743257
Average cost in epoch 173: 0.262042
training accuracy: 0.953125     test accuracy: 0.752248
Average cost in epoch 174: 0.245240
training accuracy: 0.953125     test accuracy: 0.745255

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 175: 0.250427
training accuracy: 0.937500     test accuracy: 0.735265
Average cost in epoch 176: 0.265302
training accuracy: 0.921875     test accuracy: 0.739261
Average cost in epoch 177: 0.231123
training accuracy: 0.921875     test accuracy: 0.735265
Average cost in epoch 178: 0.260017
training accuracy: 0.906250     test accuracy: 0.730270
Average cost in epoch 179: 0.254913
training accuracy: 0.968750     test accuracy: 0.740260

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 180: 0.268995
training accuracy: 0.968750     test accuracy: 0.741259
Average cost in epoch 181: 0.235039
training accuracy: 0.968750     test accuracy: 0.741259
Average cost in epoch 182: 0.266108
training accuracy: 0.906250     test accuracy: 0.729271
Average cost in epoch 183: 0.284575
training accuracy: 0.890625     test accuracy: 0.734266
Average cost in epoch 184: 0.257274
training accuracy: 0.953125     test accuracy: 0.734266

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 185: 0.240666
training accuracy: 0.906250     test accuracy: 0.746254
Average cost in epoch 186: 0.237180
training accuracy: 0.968750     test accuracy: 0.744256
Average cost in epoch 187: 0.249772
training accuracy: 0.953125     test accuracy: 0.732268
Average cost in epoch 188: 0.278267
training accuracy: 0.906250     test accuracy: 0.742258
Average cost in epoch 189: 0.260836
training accuracy: 0.984375     test accuracy: 0.741259

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 190: 0.202623
training accuracy: 0.906250     test accuracy: 0.733267
Average cost in epoch 191: 0.220958
training accuracy: 0.843750     test accuracy: 0.739261
Average cost in epoch 192: 0.227277
training accuracy: 0.921875     test accuracy: 0.744256
Average cost in epoch 193: 0.238068
training accuracy: 0.875000     test accuracy: 0.730270
Average cost in epoch 194: 0.239862
training accuracy: 0.937500     test accuracy: 0.731269

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Average cost in epoch 195: 0.257965
training accuracy: 0.828125     test accuracy: 0.737263
Average cost in epoch 196: 0.230029
training accuracy: 0.968750     test accuracy: 0.733267
Average cost in epoch 197: 0.219554
training accuracy: 0.890625     test accuracy: 0.734266
Average cost in epoch 198: 0.231200
training accuracy: 0.937500     test accuracy: 0.741259
Average cost in epoch 199: 0.200686
training accuracy: 0.890625     test accuracy: 0.740260

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_7.pkl

Locking... locked.
No job requests to schedule
INFO (theano.gof.compilelock): Waiting for existing lock by process '27482' (I am process '13401')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '27946' (I am process '13401')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 8, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_8.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 108.38
Starting training...
Average cost in epoch 0: 2.216720
training accuracy: 0.343750     test accuracy: 0.361638
Average cost in epoch 1: 1.745219
training accuracy: 0.281250     test accuracy: 0.368631
Average cost in epoch 2: 1.664353
training accuracy: 0.421875     test accuracy: 0.360639
Average cost in epoch 3: 1.649494
training accuracy: 0.390625     test accuracy: 0.355644
Average cost in epoch 4: 1.616077
training accuracy: 0.437500     test accuracy: 0.385614

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 5: 1.564036
training accuracy: 0.625000     test accuracy: 0.447552
lr decays to 0.009000
Average cost in epoch 6: 1.446578
training accuracy: 0.546875     test accuracy: 0.496503
Average cost in epoch 7: 1.416544
training accuracy: 0.500000     test accuracy: 0.499500
Average cost in epoch 8: 1.346791
training accuracy: 0.656250     test accuracy: 0.600400
Average cost in epoch 9: 1.226068
training accuracy: 0.578125     test accuracy: 0.621379

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 10: 1.206296
training accuracy: 0.671875     test accuracy: 0.650350
lr decays to 0.008100
Average cost in epoch 11: 1.108220
training accuracy: 0.750000     test accuracy: 0.693307
Average cost in epoch 12: 1.140597
training accuracy: 0.687500     test accuracy: 0.718282
Average cost in epoch 13: 1.034551
training accuracy: 0.750000     test accuracy: 0.714286
Average cost in epoch 14: 1.001145
training accuracy: 0.718750     test accuracy: 0.735265

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 15: 0.982996
training accuracy: 0.796875     test accuracy: 0.731269
lr decays to 0.007290
Average cost in epoch 16: 0.910633
training accuracy: 0.718750     test accuracy: 0.732268
Average cost in epoch 17: 0.945028
training accuracy: 0.859375     test accuracy: 0.730270
Average cost in epoch 18: 0.869057
training accuracy: 0.765625     test accuracy: 0.704296
Average cost in epoch 19: 0.905620
training accuracy: 0.718750     test accuracy: 0.740260

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 20: 0.838335
training accuracy: 0.828125     test accuracy: 0.718282
lr decays to 0.006561
Average cost in epoch 21: 0.822971
training accuracy: 0.750000     test accuracy: 0.724276
Average cost in epoch 22: 0.858282
training accuracy: 0.750000     test accuracy: 0.686314
Average cost in epoch 23: 0.895079
training accuracy: 0.765625     test accuracy: 0.725275
Average cost in epoch 24: 0.764136
training accuracy: 0.859375     test accuracy: 0.724276

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 25: 0.769210
training accuracy: 0.671875     test accuracy: 0.627373
lr decays to 0.005905
Average cost in epoch 26: 0.790599
training accuracy: 0.765625     test accuracy: 0.709291
Average cost in epoch 27: 0.806486
training accuracy: 0.765625     test accuracy: 0.721279
Average cost in epoch 28: 0.768212
training accuracy: 0.781250     test accuracy: 0.728272
Average cost in epoch 29: 0.746431
training accuracy: 0.812500     test accuracy: 0.723277

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 30: 0.735103
training accuracy: 0.796875     test accuracy: 0.725275
lr decays to 0.005314
Average cost in epoch 31: 0.786008
training accuracy: 0.765625     test accuracy: 0.729271
Average cost in epoch 32: 0.675083
training accuracy: 0.765625     test accuracy: 0.725275
Average cost in epoch 33: 0.747267
training accuracy: 0.765625     test accuracy: 0.732268
Average cost in epoch 34: 0.732803
training accuracy: 0.828125     test accuracy: 0.722278

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 35: 0.723834
training accuracy: 0.781250     test accuracy: 0.725275
lr decays to 0.004783
Average cost in epoch 36: 0.754652
training accuracy: 0.781250     test accuracy: 0.722278
Average cost in epoch 37: 0.669015
training accuracy: 0.828125     test accuracy: 0.732268
Average cost in epoch 38: 0.708959
training accuracy: 0.765625     test accuracy: 0.722278
Average cost in epoch 39: 0.660786
training accuracy: 0.796875     test accuracy: 0.704296

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 40: 0.664122
training accuracy: 0.750000     test accuracy: 0.731269
lr decays to 0.004305
Average cost in epoch 41: 0.634399
training accuracy: 0.796875     test accuracy: 0.721279
Average cost in epoch 42: 0.658303
training accuracy: 0.750000     test accuracy: 0.713287
Average cost in epoch 43: 0.667985
training accuracy: 0.843750     test accuracy: 0.723277
Average cost in epoch 44: 0.677392
training accuracy: 0.765625     test accuracy: 0.709291

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 45: 0.638182
training accuracy: 0.796875     test accuracy: 0.706294
lr decays to 0.003874
Average cost in epoch 46: 0.609959
training accuracy: 0.812500     test accuracy: 0.720280
Average cost in epoch 47: 0.641590
training accuracy: 0.843750     test accuracy: 0.724276
Average cost in epoch 48: 0.603726
training accuracy: 0.828125     test accuracy: 0.701299
Average cost in epoch 49: 0.636795
training accuracy: 0.796875     test accuracy: 0.720280

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 50: 0.608086
training accuracy: 0.843750     test accuracy: 0.712288
lr decays to 0.003487
Average cost in epoch 51: 0.613023
training accuracy: 0.781250     test accuracy: 0.713287
Average cost in epoch 52: 0.564332
training accuracy: 0.828125     test accuracy: 0.718282
Average cost in epoch 53: 0.576673
training accuracy: 0.781250     test accuracy: 0.712288
Average cost in epoch 54: 0.605010
training accuracy: 0.765625     test accuracy: 0.720280

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 55: 0.544039
training accuracy: 0.812500     test accuracy: 0.705295
lr decays to 0.003138
Average cost in epoch 56: 0.557067
training accuracy: 0.843750     test accuracy: 0.714286
Average cost in epoch 57: 0.599999
training accuracy: 0.875000     test accuracy: 0.696304
Average cost in epoch 58: 0.541846
training accuracy: 0.781250     test accuracy: 0.692308
Average cost in epoch 59: 0.596773
training accuracy: 0.875000     test accuracy: 0.716284

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 60: 0.532980
training accuracy: 0.812500     test accuracy: 0.709291
lr decays to 0.002824
Average cost in epoch 61: 0.546921
training accuracy: 0.828125     test accuracy: 0.700300
Average cost in epoch 62: 0.526517
training accuracy: 0.843750     test accuracy: 0.710290
Average cost in epoch 63: 0.539572
training accuracy: 0.828125     test accuracy: 0.703297
Average cost in epoch 64: 0.519894
training accuracy: 0.765625     test accuracy: 0.706294

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 65: 0.545745
training accuracy: 0.859375     test accuracy: 0.709291
lr decays to 0.002542
Average cost in epoch 66: 0.506922
training accuracy: 0.859375     test accuracy: 0.706294
Average cost in epoch 67: 0.481840
training accuracy: 0.781250     test accuracy: 0.703297
Average cost in epoch 68: 0.483484
training accuracy: 0.843750     test accuracy: 0.702298
Average cost in epoch 69: 0.504920
training accuracy: 0.828125     test accuracy: 0.708292

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 70: 0.470587
training accuracy: 0.828125     test accuracy: 0.688312
lr decays to 0.002288
Average cost in epoch 71: 0.521395
training accuracy: 0.843750     test accuracy: 0.705295
Average cost in epoch 72: 0.455789
training accuracy: 0.828125     test accuracy: 0.702298
Average cost in epoch 73: 0.486324
training accuracy: 0.875000     test accuracy: 0.713287
Average cost in epoch 74: 0.485665
training accuracy: 0.781250     test accuracy: 0.704296

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 75: 0.486238
training accuracy: 0.843750     test accuracy: 0.698302
lr decays to 0.002059
Average cost in epoch 76: 0.473894
training accuracy: 0.890625     test accuracy: 0.705295
Average cost in epoch 77: 0.467674
training accuracy: 0.843750     test accuracy: 0.682318
Average cost in epoch 78: 0.485202
training accuracy: 0.765625     test accuracy: 0.709291
Average cost in epoch 79: 0.436813
training accuracy: 0.890625     test accuracy: 0.703297

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 80: 0.491121
training accuracy: 0.843750     test accuracy: 0.699301
lr decays to 0.001853
Average cost in epoch 81: 0.468368
training accuracy: 0.875000     test accuracy: 0.700300
Average cost in epoch 82: 0.458030
training accuracy: 0.859375     test accuracy: 0.697303
Average cost in epoch 83: 0.471841
training accuracy: 0.812500     test accuracy: 0.700300
Average cost in epoch 84: 0.421409
training accuracy: 0.859375     test accuracy: 0.698302

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 85: 0.411727
training accuracy: 0.859375     test accuracy: 0.696304
lr decays to 0.001668
Average cost in epoch 86: 0.475097
training accuracy: 0.921875     test accuracy: 0.701299
Average cost in epoch 87: 0.409614
training accuracy: 0.843750     test accuracy: 0.700300
Average cost in epoch 88: 0.409953
training accuracy: 0.859375     test accuracy: 0.702298
Average cost in epoch 89: 0.456106
training accuracy: 0.890625     test accuracy: 0.700300

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 90: 0.433168
training accuracy: 0.812500     test accuracy: 0.699301
lr decays to 0.001501
Average cost in epoch 91: 0.433620
training accuracy: 0.843750     test accuracy: 0.702298
Average cost in epoch 92: 0.394861
training accuracy: 0.828125     test accuracy: 0.698302
Average cost in epoch 93: 0.435522
training accuracy: 0.890625     test accuracy: 0.701299
Average cost in epoch 94: 0.415625
training accuracy: 0.796875     test accuracy: 0.705295

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 95: 0.421757
training accuracy: 0.828125     test accuracy: 0.704296
lr decays to 0.001351
Average cost in epoch 96: 0.406425
training accuracy: 0.859375     test accuracy: 0.698302
Average cost in epoch 97: 0.426082
training accuracy: 0.921875     test accuracy: 0.700300
Average cost in epoch 98: 0.432657
training accuracy: 0.781250     test accuracy: 0.705295
Average cost in epoch 99: 0.375517
training accuracy: 0.906250     test accuracy: 0.711289

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 100: 0.437552
training accuracy: 0.906250     test accuracy: 0.700300
lr decays to 0.001216
Average cost in epoch 101: 0.411273
training accuracy: 0.843750     test accuracy: 0.697303
Average cost in epoch 102: 0.420427
training accuracy: 0.859375     test accuracy: 0.699301
Average cost in epoch 103: 0.357913
training accuracy: 0.812500     test accuracy: 0.705295
Average cost in epoch 104: 0.393165
training accuracy: 0.890625     test accuracy: 0.702298

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 105: 0.414023
training accuracy: 0.812500     test accuracy: 0.695305
Average cost in epoch 106: 0.381425
training accuracy: 0.843750     test accuracy: 0.700300
Average cost in epoch 107: 0.396740
training accuracy: 0.781250     test accuracy: 0.702298
Average cost in epoch 108: 0.403467
training accuracy: 0.796875     test accuracy: 0.703297
Average cost in epoch 109: 0.369607
training accuracy: 0.843750     test accuracy: 0.703297

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 110: 0.391663
training accuracy: 0.796875     test accuracy: 0.695305
Average cost in epoch 111: 0.388018
training accuracy: 0.890625     test accuracy: 0.702298
Average cost in epoch 112: 0.436965
training accuracy: 0.906250     test accuracy: 0.698302
Average cost in epoch 113: 0.337987
training accuracy: 0.875000     test accuracy: 0.704296
Average cost in epoch 114: 0.403902
training accuracy: 0.859375     test accuracy: 0.702298

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 115: 0.358507
training accuracy: 0.781250     test accuracy: 0.695305
Average cost in epoch 116: 0.377649
training accuracy: 0.859375     test accuracy: 0.702298
Average cost in epoch 117: 0.399345
training accuracy: 0.890625     test accuracy: 0.697303
Average cost in epoch 118: 0.400113
training accuracy: 0.906250     test accuracy: 0.695305
Average cost in epoch 119: 0.331696
training accuracy: 0.843750     test accuracy: 0.695305

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 120: 0.373562
training accuracy: 0.921875     test accuracy: 0.697303
Average cost in epoch 121: 0.341936
training accuracy: 0.906250     test accuracy: 0.698302
Average cost in epoch 122: 0.378934
training accuracy: 0.890625     test accuracy: 0.694306
Average cost in epoch 123: 0.373668
training accuracy: 0.890625     test accuracy: 0.696304
Average cost in epoch 124: 0.350501
training accuracy: 0.843750     test accuracy: 0.697303

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 125: 0.375476
training accuracy: 0.875000     test accuracy: 0.695305
Average cost in epoch 126: 0.388022
training accuracy: 0.953125     test accuracy: 0.697303
Average cost in epoch 127: 0.358257
training accuracy: 0.843750     test accuracy: 0.694306
Average cost in epoch 128: 0.397541
training accuracy: 0.859375     test accuracy: 0.697303
Average cost in epoch 129: 0.360573
training accuracy: 0.828125     test accuracy: 0.692308

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 130: 0.371196
training accuracy: 0.796875     test accuracy: 0.695305
Average cost in epoch 131: 0.345582
training accuracy: 0.890625     test accuracy: 0.683317
Average cost in epoch 132: 0.363217
training accuracy: 0.953125     test accuracy: 0.700300
Average cost in epoch 133: 0.351201
training accuracy: 0.781250     test accuracy: 0.694306
Average cost in epoch 134: 0.344661
training accuracy: 0.890625     test accuracy: 0.695305

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 135: 0.347457
training accuracy: 0.890625     test accuracy: 0.697303
Average cost in epoch 136: 0.363797
training accuracy: 0.968750     test accuracy: 0.693307
Average cost in epoch 137: 0.365542
training accuracy: 0.859375     test accuracy: 0.688312
Average cost in epoch 138: 0.339446
training accuracy: 0.906250     test accuracy: 0.694306
Average cost in epoch 139: 0.387560
training accuracy: 0.890625     test accuracy: 0.695305

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 140: 0.358708
training accuracy: 0.921875     test accuracy: 0.690310
Average cost in epoch 141: 0.344653
training accuracy: 0.859375     test accuracy: 0.698302
Average cost in epoch 142: 0.339858
training accuracy: 0.859375     test accuracy: 0.705295
Average cost in epoch 143: 0.345921
training accuracy: 0.890625     test accuracy: 0.693307
Average cost in epoch 144: 0.329365
training accuracy: 0.921875     test accuracy: 0.706294

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 145: 0.347148
training accuracy: 0.906250     test accuracy: 0.701299
Average cost in epoch 146: 0.360537
training accuracy: 0.828125     test accuracy: 0.690310
Average cost in epoch 147: 0.351992
training accuracy: 0.828125     test accuracy: 0.696304
Average cost in epoch 148: 0.326751
training accuracy: 0.921875     test accuracy: 0.689311
Average cost in epoch 149: 0.349861
training accuracy: 0.890625     test accuracy: 0.687313

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 150: 0.328119
training accuracy: 0.921875     test accuracy: 0.700300
Average cost in epoch 151: 0.326666
training accuracy: 0.875000     test accuracy: 0.686314
Average cost in epoch 152: 0.333943
training accuracy: 0.875000     test accuracy: 0.686314
Average cost in epoch 153: 0.344937
training accuracy: 0.890625     test accuracy: 0.694306
Average cost in epoch 154: 0.321993
training accuracy: 0.812500     test accuracy: 0.690310

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 155: 0.300111
training accuracy: 0.859375     test accuracy: 0.684316
Average cost in epoch 156: 0.337287
training accuracy: 0.843750     test accuracy: 0.690310
Average cost in epoch 157: 0.324651
training accuracy: 0.890625     test accuracy: 0.695305
Average cost in epoch 158: 0.308286
training accuracy: 0.859375     test accuracy: 0.699301
Average cost in epoch 159: 0.353947
training accuracy: 0.859375     test accuracy: 0.697303

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 160: 0.282977
training accuracy: 0.921875     test accuracy: 0.696304
Average cost in epoch 161: 0.327845
training accuracy: 0.906250     test accuracy: 0.695305
Average cost in epoch 162: 0.316687
training accuracy: 0.828125     test accuracy: 0.685315
Average cost in epoch 163: 0.321276
training accuracy: 0.890625     test accuracy: 0.697303
Average cost in epoch 164: 0.301526
training accuracy: 0.921875     test accuracy: 0.700300

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 165: 0.312772
training accuracy: 0.937500     test accuracy: 0.708292
Average cost in epoch 166: 0.315339
training accuracy: 0.906250     test accuracy: 0.690310
Average cost in epoch 167: 0.330606
training accuracy: 0.859375     test accuracy: 0.698302
Average cost in epoch 168: 0.329941
training accuracy: 0.875000     test accuracy: 0.697303
Average cost in epoch 169: 0.312814
training accuracy: 0.906250     test accuracy: 0.700300

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 170: 0.325021
training accuracy: 0.875000     test accuracy: 0.694306
Average cost in epoch 171: 0.313472
training accuracy: 0.890625     test accuracy: 0.695305
Average cost in epoch 172: 0.303796
training accuracy: 0.921875     test accuracy: 0.703297
Average cost in epoch 173: 0.326410
training accuracy: 0.781250     test accuracy: 0.706294
Average cost in epoch 174: 0.327501
training accuracy: 0.859375     test accuracy: 0.689311

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 175: 0.310012
training accuracy: 0.890625     test accuracy: 0.685315
Average cost in epoch 176: 0.322853
training accuracy: 0.828125     test accuracy: 0.698302
Average cost in epoch 177: 0.329353
training accuracy: 0.906250     test accuracy: 0.694306
Average cost in epoch 178: 0.278363
training accuracy: 0.937500     test accuracy: 0.681319
Average cost in epoch 179: 0.309529
training accuracy: 0.890625     test accuracy: 0.689311

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 180: 0.288820
training accuracy: 0.890625     test accuracy: 0.702298
Average cost in epoch 181: 0.282611
training accuracy: 0.968750     test accuracy: 0.685315
Average cost in epoch 182: 0.314129
training accuracy: 0.828125     test accuracy: 0.692308
Average cost in epoch 183: 0.305108
training accuracy: 0.875000     test accuracy: 0.694306
Average cost in epoch 184: 0.300283
training accuracy: 0.906250     test accuracy: 0.695305

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 185: 0.317526
training accuracy: 0.921875     test accuracy: 0.692308
Average cost in epoch 186: 0.307691
training accuracy: 0.843750     test accuracy: 0.689311
Average cost in epoch 187: 0.308478
training accuracy: 0.984375     test accuracy: 0.693307
Average cost in epoch 188: 0.292571
training accuracy: 0.890625     test accuracy: 0.696304
Average cost in epoch 189: 0.289982
training accuracy: 0.812500     test accuracy: 0.694306

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 190: 0.303828
training accuracy: 0.906250     test accuracy: 0.686314
Average cost in epoch 191: 0.265310
training accuracy: 0.875000     test accuracy: 0.705295
Average cost in epoch 192: 0.331621
training accuracy: 0.890625     test accuracy: 0.693307
Average cost in epoch 193: 0.294892
training accuracy: 0.921875     test accuracy: 0.696304
Average cost in epoch 194: 0.349249
training accuracy: 0.890625     test accuracy: 0.683317

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Average cost in epoch 195: 0.251618
training accuracy: 0.921875     test accuracy: 0.695305
Average cost in epoch 196: 0.289751
training accuracy: 0.875000     test accuracy: 0.694306
Average cost in epoch 197: 0.285457
training accuracy: 0.875000     test accuracy: 0.703297
Average cost in epoch 198: 0.252751
training accuracy: 0.906250     test accuracy: 0.702298
Average cost in epoch 199: 0.291667
training accuracy: 0.875000     test accuracy: 0.696304

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_8.pkl

Locking... locked.
No job requests to schedule
INFO (theano.gof.compilelock): Waiting for existing lock by process '27946' (I am process '27319')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '27708' (I am process '27319')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '13401' (I am process '27319')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23218' (I am process '27319')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23609' (I am process '27319')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '1057' (I am process '27319')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '13153' (I am process '27319')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '1216' (I am process '27319')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 9, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_9.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 89.72
Starting training...
Average cost in epoch 0: 1.119160
training accuracy: 0.640625     test accuracy: 0.638362
Average cost in epoch 1: 0.706946
training accuracy: 0.656250     test accuracy: 0.638362
Average cost in epoch 2: 0.693023
training accuracy: 0.609375     test accuracy: 0.638362
Average cost in epoch 3: 0.673032
training accuracy: 0.609375     test accuracy: 0.638362
Average cost in epoch 4: 0.686849
training accuracy: 0.656250     test accuracy: 0.638362

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 5: 0.685993
training accuracy: 0.468750     test accuracy: 0.361638
lr decays to 0.009000
Average cost in epoch 6: 0.664122
training accuracy: 0.546875     test accuracy: 0.638362
Average cost in epoch 7: 0.668538
training accuracy: 0.640625     test accuracy: 0.638362
Average cost in epoch 8: 0.681643
training accuracy: 0.546875     test accuracy: 0.417582
Average cost in epoch 9: 0.665674
training accuracy: 0.687500     test accuracy: 0.638362

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 10: 0.675131
training accuracy: 0.515625     test accuracy: 0.638362
lr decays to 0.008100
Average cost in epoch 11: 0.660707
training accuracy: 0.640625     test accuracy: 0.638362
Average cost in epoch 12: 0.655124
training accuracy: 0.656250     test accuracy: 0.638362
Average cost in epoch 13: 0.662763
training accuracy: 0.593750     test accuracy: 0.638362
Average cost in epoch 14: 0.643281
training accuracy: 0.578125     test accuracy: 0.644356

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 15: 0.645619
training accuracy: 0.718750     test accuracy: 0.624376
lr decays to 0.007290
Average cost in epoch 16: 0.629577
training accuracy: 0.656250     test accuracy: 0.638362
Average cost in epoch 17: 0.630762
training accuracy: 0.609375     test accuracy: 0.650350
Average cost in epoch 18: 0.620782
training accuracy: 0.609375     test accuracy: 0.633367
Average cost in epoch 19: 0.630979
training accuracy: 0.718750     test accuracy: 0.595405

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 20: 0.633791
training accuracy: 0.703125     test accuracy: 0.628372
lr decays to 0.006561
Average cost in epoch 21: 0.626585
training accuracy: 0.625000     test accuracy: 0.636364
Average cost in epoch 22: 0.614187
training accuracy: 0.687500     test accuracy: 0.615385
Average cost in epoch 23: 0.624377
training accuracy: 0.718750     test accuracy: 0.638362
Average cost in epoch 24: 0.634623
training accuracy: 0.718750     test accuracy: 0.631369

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 25: 0.611678
training accuracy: 0.609375     test accuracy: 0.625375
lr decays to 0.005905
Average cost in epoch 26: 0.598694
training accuracy: 0.671875     test accuracy: 0.641359
Average cost in epoch 27: 0.627844
training accuracy: 0.671875     test accuracy: 0.599401
Average cost in epoch 28: 0.625604
training accuracy: 0.640625     test accuracy: 0.631369
Average cost in epoch 29: 0.598245
training accuracy: 0.687500     test accuracy: 0.620380

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 30: 0.603878
training accuracy: 0.625000     test accuracy: 0.609391
lr decays to 0.005314
Average cost in epoch 31: 0.610502
training accuracy: 0.656250     test accuracy: 0.610390
Average cost in epoch 32: 0.600473
training accuracy: 0.640625     test accuracy: 0.635365
Average cost in epoch 33: 0.588534
training accuracy: 0.671875     test accuracy: 0.627373
Average cost in epoch 34: 0.612729
training accuracy: 0.734375     test accuracy: 0.620380

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 35: 0.598289
training accuracy: 0.734375     test accuracy: 0.633367
lr decays to 0.004783
Average cost in epoch 36: 0.585075
training accuracy: 0.640625     test accuracy: 0.612388
Average cost in epoch 37: 0.588918
training accuracy: 0.765625     test accuracy: 0.624376
Average cost in epoch 38: 0.600009
training accuracy: 0.625000     test accuracy: 0.596404
Average cost in epoch 39: 0.582255
training accuracy: 0.671875     test accuracy: 0.634366

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 40: 0.585110
training accuracy: 0.765625     test accuracy: 0.604396
lr decays to 0.004305
Average cost in epoch 41: 0.577410
training accuracy: 0.687500     test accuracy: 0.591409
Average cost in epoch 42: 0.576979
training accuracy: 0.718750     test accuracy: 0.614386
Average cost in epoch 43: 0.575358
training accuracy: 0.718750     test accuracy: 0.619381
Average cost in epoch 44: 0.589119
training accuracy: 0.750000     test accuracy: 0.605395

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 45: 0.564103
training accuracy: 0.750000     test accuracy: 0.607393
lr decays to 0.003874
Average cost in epoch 46: 0.569183
training accuracy: 0.671875     test accuracy: 0.609391
Average cost in epoch 47: 0.561955
training accuracy: 0.734375     test accuracy: 0.623377
Average cost in epoch 48: 0.581916
training accuracy: 0.687500     test accuracy: 0.578422
Average cost in epoch 49: 0.566817
training accuracy: 0.734375     test accuracy: 0.581419

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 50: 0.553430
training accuracy: 0.671875     test accuracy: 0.586414
lr decays to 0.003487
Average cost in epoch 51: 0.564766
training accuracy: 0.750000     test accuracy: 0.600400
Average cost in epoch 52: 0.548446
training accuracy: 0.703125     test accuracy: 0.607393
Average cost in epoch 53: 0.537394
training accuracy: 0.734375     test accuracy: 0.595405
Average cost in epoch 54: 0.545162
training accuracy: 0.781250     test accuracy: 0.618382

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 55: 0.531610
training accuracy: 0.734375     test accuracy: 0.584416
lr decays to 0.003138
Average cost in epoch 56: 0.539066
training accuracy: 0.765625     test accuracy: 0.618382
Average cost in epoch 57: 0.537948
training accuracy: 0.734375     test accuracy: 0.582418
Average cost in epoch 58: 0.564922
training accuracy: 0.828125     test accuracy: 0.596404
Average cost in epoch 59: 0.536805
training accuracy: 0.828125     test accuracy: 0.594406

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 60: 0.514463
training accuracy: 0.671875     test accuracy: 0.599401
lr decays to 0.002824
Average cost in epoch 61: 0.528062
training accuracy: 0.796875     test accuracy: 0.597403
Average cost in epoch 62: 0.517399
training accuracy: 0.765625     test accuracy: 0.621379
Average cost in epoch 63: 0.506859
training accuracy: 0.781250     test accuracy: 0.594406
Average cost in epoch 64: 0.508883
training accuracy: 0.781250     test accuracy: 0.592408

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 65: 0.512390
training accuracy: 0.812500     test accuracy: 0.601399
lr decays to 0.002542
Average cost in epoch 66: 0.518804
training accuracy: 0.796875     test accuracy: 0.614386
Average cost in epoch 67: 0.506390
training accuracy: 0.890625     test accuracy: 0.606394
Average cost in epoch 68: 0.494488
training accuracy: 0.734375     test accuracy: 0.580420
Average cost in epoch 69: 0.503796
training accuracy: 0.859375     test accuracy: 0.604396

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 70: 0.485279
training accuracy: 0.765625     test accuracy: 0.606394
lr decays to 0.002288
Average cost in epoch 71: 0.498474
training accuracy: 0.812500     test accuracy: 0.593407
Average cost in epoch 72: 0.477643
training accuracy: 0.796875     test accuracy: 0.603397
Average cost in epoch 73: 0.500403
training accuracy: 0.734375     test accuracy: 0.600400
Average cost in epoch 74: 0.472969
training accuracy: 0.828125     test accuracy: 0.592408

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 75: 0.518760
training accuracy: 0.796875     test accuracy: 0.595405
lr decays to 0.002059
Average cost in epoch 76: 0.484323
training accuracy: 0.812500     test accuracy: 0.605395
Average cost in epoch 77: 0.485265
training accuracy: 0.765625     test accuracy: 0.603397
Average cost in epoch 78: 0.436701
training accuracy: 0.734375     test accuracy: 0.598402
Average cost in epoch 79: 0.480175
training accuracy: 0.765625     test accuracy: 0.604396

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 80: 0.492153
training accuracy: 0.750000     test accuracy: 0.610390
lr decays to 0.001853
Average cost in epoch 81: 0.468682
training accuracy: 0.734375     test accuracy: 0.598402
Average cost in epoch 82: 0.437685
training accuracy: 0.718750     test accuracy: 0.603397
Average cost in epoch 83: 0.462440
training accuracy: 0.750000     test accuracy: 0.595405
Average cost in epoch 84: 0.460748
training accuracy: 0.828125     test accuracy: 0.610390

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 85: 0.463807
training accuracy: 0.734375     test accuracy: 0.606394
lr decays to 0.001668
Average cost in epoch 86: 0.435893
training accuracy: 0.765625     test accuracy: 0.606394
Average cost in epoch 87: 0.467256
training accuracy: 0.796875     test accuracy: 0.605395
Average cost in epoch 88: 0.450360
training accuracy: 0.718750     test accuracy: 0.614386
Average cost in epoch 89: 0.432123
training accuracy: 0.796875     test accuracy: 0.615385

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 90: 0.442189
training accuracy: 0.812500     test accuracy: 0.618382
lr decays to 0.001501
Average cost in epoch 91: 0.435302
training accuracy: 0.890625     test accuracy: 0.611389
Average cost in epoch 92: 0.455992
training accuracy: 0.796875     test accuracy: 0.614386
Average cost in epoch 93: 0.431522
training accuracy: 0.859375     test accuracy: 0.608392
Average cost in epoch 94: 0.448797
training accuracy: 0.703125     test accuracy: 0.603397

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 95: 0.428658
training accuracy: 0.812500     test accuracy: 0.611389
lr decays to 0.001351
Average cost in epoch 96: 0.443048
training accuracy: 0.781250     test accuracy: 0.612388
Average cost in epoch 97: 0.432821
training accuracy: 0.812500     test accuracy: 0.615385
Average cost in epoch 98: 0.421752
training accuracy: 0.890625     test accuracy: 0.609391
Average cost in epoch 99: 0.422676
training accuracy: 0.906250     test accuracy: 0.608392

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 100: 0.440500
training accuracy: 0.843750     test accuracy: 0.617383
lr decays to 0.001216
Average cost in epoch 101: 0.424335
training accuracy: 0.796875     test accuracy: 0.613387
Average cost in epoch 102: 0.428772
training accuracy: 0.828125     test accuracy: 0.612388
Average cost in epoch 103: 0.436242
training accuracy: 0.828125     test accuracy: 0.616384
Average cost in epoch 104: 0.424985
training accuracy: 0.859375     test accuracy: 0.612388

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 105: 0.395822
training accuracy: 0.796875     test accuracy: 0.621379
Average cost in epoch 106: 0.417253
training accuracy: 0.828125     test accuracy: 0.607393
Average cost in epoch 107: 0.399434
training accuracy: 0.812500     test accuracy: 0.610390
Average cost in epoch 108: 0.381840
training accuracy: 0.828125     test accuracy: 0.613387
Average cost in epoch 109: 0.410602
training accuracy: 0.796875     test accuracy: 0.611389

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 110: 0.425662
training accuracy: 0.765625     test accuracy: 0.608392
Average cost in epoch 111: 0.394057
training accuracy: 0.906250     test accuracy: 0.616384
Average cost in epoch 112: 0.397892
training accuracy: 0.890625     test accuracy: 0.613387
Average cost in epoch 113: 0.389259
training accuracy: 0.765625     test accuracy: 0.620380
Average cost in epoch 114: 0.418994
training accuracy: 0.781250     test accuracy: 0.619381

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 115: 0.362468
training accuracy: 0.812500     test accuracy: 0.620380
Average cost in epoch 116: 0.409635
training accuracy: 0.812500     test accuracy: 0.616384
Average cost in epoch 117: 0.381258
training accuracy: 0.812500     test accuracy: 0.617383
Average cost in epoch 118: 0.402149
training accuracy: 0.890625     test accuracy: 0.616384
Average cost in epoch 119: 0.378425
training accuracy: 0.812500     test accuracy: 0.621379

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 120: 0.407831
training accuracy: 0.843750     test accuracy: 0.618382
Average cost in epoch 121: 0.404863
training accuracy: 0.921875     test accuracy: 0.618382
Average cost in epoch 122: 0.386090
training accuracy: 0.812500     test accuracy: 0.609391
Average cost in epoch 123: 0.377460
training accuracy: 0.828125     test accuracy: 0.614386
Average cost in epoch 124: 0.383660
training accuracy: 0.875000     test accuracy: 0.626374

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 125: 0.380157
training accuracy: 0.796875     test accuracy: 0.611389
Average cost in epoch 126: 0.371722
training accuracy: 0.875000     test accuracy: 0.628372
Average cost in epoch 127: 0.373132
training accuracy: 0.859375     test accuracy: 0.625375
Average cost in epoch 128: 0.384282
training accuracy: 0.843750     test accuracy: 0.616384
Average cost in epoch 129: 0.365173
training accuracy: 0.875000     test accuracy: 0.626374

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 130: 0.365498
training accuracy: 0.843750     test accuracy: 0.612388
Average cost in epoch 131: 0.400716
training accuracy: 0.843750     test accuracy: 0.618382
Average cost in epoch 132: 0.378538
training accuracy: 0.875000     test accuracy: 0.615385
Average cost in epoch 133: 0.368780
training accuracy: 0.843750     test accuracy: 0.620380
Average cost in epoch 134: 0.368365
training accuracy: 0.875000     test accuracy: 0.623377

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 135: 0.357951
training accuracy: 0.843750     test accuracy: 0.625375
Average cost in epoch 136: 0.368010
training accuracy: 0.859375     test accuracy: 0.619381
Average cost in epoch 137: 0.354774
training accuracy: 0.796875     test accuracy: 0.626374
Average cost in epoch 138: 0.373980
training accuracy: 0.921875     test accuracy: 0.619381
Average cost in epoch 139: 0.376925
training accuracy: 0.875000     test accuracy: 0.620380

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 140: 0.378292
training accuracy: 0.859375     test accuracy: 0.623377
Average cost in epoch 141: 0.334173
training accuracy: 0.843750     test accuracy: 0.622378
Average cost in epoch 142: 0.367507
training accuracy: 0.890625     test accuracy: 0.614386
Average cost in epoch 143: 0.331912
training accuracy: 0.859375     test accuracy: 0.624376
Average cost in epoch 144: 0.378588
training accuracy: 0.781250     test accuracy: 0.618382

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 145: 0.347655
training accuracy: 0.921875     test accuracy: 0.615385
Average cost in epoch 146: 0.348950
training accuracy: 0.921875     test accuracy: 0.618382
Average cost in epoch 147: 0.316038
training accuracy: 0.796875     test accuracy: 0.613387
Average cost in epoch 148: 0.366526
training accuracy: 0.906250     test accuracy: 0.611389
Average cost in epoch 149: 0.358260
training accuracy: 0.859375     test accuracy: 0.610390

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 150: 0.336733
training accuracy: 0.906250     test accuracy: 0.614386
Average cost in epoch 151: 0.316145
training accuracy: 0.843750     test accuracy: 0.615385
Average cost in epoch 152: 0.361191
training accuracy: 0.890625     test accuracy: 0.615385
Average cost in epoch 153: 0.331066
training accuracy: 0.875000     test accuracy: 0.601399
Average cost in epoch 154: 0.353078
training accuracy: 0.859375     test accuracy: 0.613387

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 155: 0.348962
training accuracy: 0.828125     test accuracy: 0.608392
Average cost in epoch 156: 0.329055
training accuracy: 0.843750     test accuracy: 0.614386
Average cost in epoch 157: 0.348603
training accuracy: 0.859375     test accuracy: 0.612388
Average cost in epoch 158: 0.323925
training accuracy: 0.921875     test accuracy: 0.612388
Average cost in epoch 159: 0.342512
training accuracy: 0.890625     test accuracy: 0.611389

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 160: 0.326988
training accuracy: 0.843750     test accuracy: 0.617383
Average cost in epoch 161: 0.322438
training accuracy: 0.890625     test accuracy: 0.615385
Average cost in epoch 162: 0.368167
training accuracy: 0.890625     test accuracy: 0.625375
Average cost in epoch 163: 0.314086
training accuracy: 0.812500     test accuracy: 0.618382
Average cost in epoch 164: 0.349497
training accuracy: 0.890625     test accuracy: 0.617383

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 165: 0.310043
training accuracy: 0.875000     test accuracy: 0.611389
Average cost in epoch 166: 0.328616
training accuracy: 0.890625     test accuracy: 0.620380
Average cost in epoch 167: 0.325013
training accuracy: 0.796875     test accuracy: 0.607393
Average cost in epoch 168: 0.309272
training accuracy: 0.921875     test accuracy: 0.612388
Average cost in epoch 169: 0.303515
training accuracy: 0.875000     test accuracy: 0.602398

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 170: 0.338339
training accuracy: 0.843750     test accuracy: 0.609391
Average cost in epoch 171: 0.333340
training accuracy: 0.906250     test accuracy: 0.609391
Average cost in epoch 172: 0.302578
training accuracy: 0.906250     test accuracy: 0.608392
Average cost in epoch 173: 0.310667
training accuracy: 0.859375     test accuracy: 0.606394
Average cost in epoch 174: 0.309247
training accuracy: 0.875000     test accuracy: 0.607393

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 175: 0.337543
training accuracy: 0.781250     test accuracy: 0.616384
Average cost in epoch 176: 0.315995
training accuracy: 0.968750     test accuracy: 0.604396
Average cost in epoch 177: 0.324006
training accuracy: 0.906250     test accuracy: 0.608392
Average cost in epoch 178: 0.312916
training accuracy: 0.843750     test accuracy: 0.599401
Average cost in epoch 179: 0.295660
training accuracy: 0.937500     test accuracy: 0.613387

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 180: 0.306627
training accuracy: 0.875000     test accuracy: 0.594406
Average cost in epoch 181: 0.301345
training accuracy: 0.843750     test accuracy: 0.598402
Average cost in epoch 182: 0.289672
training accuracy: 0.875000     test accuracy: 0.605395
Average cost in epoch 183: 0.305228
training accuracy: 0.843750     test accuracy: 0.604396
Average cost in epoch 184: 0.308181
training accuracy: 0.890625     test accuracy: 0.605395

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 185: 0.294453
training accuracy: 0.875000     test accuracy: 0.603397
Average cost in epoch 186: 0.323533
training accuracy: 0.875000     test accuracy: 0.610390
Average cost in epoch 187: 0.278271
training accuracy: 0.906250     test accuracy: 0.603397
Average cost in epoch 188: 0.319107
training accuracy: 0.906250     test accuracy: 0.608392
Average cost in epoch 189: 0.339934
training accuracy: 0.984375     test accuracy: 0.615385

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 190: 0.315348
training accuracy: 0.890625     test accuracy: 0.610390
Average cost in epoch 191: 0.282134
training accuracy: 0.875000     test accuracy: 0.603397
Average cost in epoch 192: 0.313019
training accuracy: 0.875000     test accuracy: 0.611389
Average cost in epoch 193: 0.323766
training accuracy: 0.875000     test accuracy: 0.609391
Average cost in epoch 194: 0.296155
training accuracy: 0.875000     test accuracy: 0.603397

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Average cost in epoch 195: 0.302375
training accuracy: 0.890625     test accuracy: 0.617383
Average cost in epoch 196: 0.271600
training accuracy: 0.921875     test accuracy: 0.615385
Average cost in epoch 197: 0.288699
training accuracy: 0.875000     test accuracy: 0.614386
Average cost in epoch 198: 0.282444
training accuracy: 0.812500     test accuracy: 0.610390
Average cost in epoch 199: 0.261594
training accuracy: 0.937500     test accuracy: 0.594406

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_9.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 10, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_10.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 100.06
Starting training...
Average cost in epoch 0: 1.411103
training accuracy: 0.359375     test accuracy: 0.436563
Average cost in epoch 1: 1.036783
training accuracy: 0.468750     test accuracy: 0.436563
Average cost in epoch 2: 1.022360
training accuracy: 0.500000     test accuracy: 0.436563
Average cost in epoch 3: 1.014490
training accuracy: 0.468750     test accuracy: 0.412587
Average cost in epoch 4: 0.990804
training accuracy: 0.515625     test accuracy: 0.436563

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 5: 0.984845
training accuracy: 0.531250     test accuracy: 0.478521
lr decays to 0.009000
Average cost in epoch 6: 0.954035
training accuracy: 0.453125     test accuracy: 0.494505
Average cost in epoch 7: 0.934454
training accuracy: 0.500000     test accuracy: 0.436563
Average cost in epoch 8: 0.928079
training accuracy: 0.546875     test accuracy: 0.497502
Average cost in epoch 9: 0.932409
training accuracy: 0.328125     test accuracy: 0.497502

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 10: 0.916179
training accuracy: 0.453125     test accuracy: 0.493506
lr decays to 0.008100
Average cost in epoch 11: 0.925646
training accuracy: 0.546875     test accuracy: 0.493506
Average cost in epoch 12: 0.926659
training accuracy: 0.484375     test accuracy: 0.436563
Average cost in epoch 13: 0.900452
training accuracy: 0.531250     test accuracy: 0.481518
Average cost in epoch 14: 0.904505
training accuracy: 0.500000     test accuracy: 0.481518

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 15: 0.913726
training accuracy: 0.406250     test accuracy: 0.499500
lr decays to 0.007290
Average cost in epoch 16: 0.902083
training accuracy: 0.453125     test accuracy: 0.486513
Average cost in epoch 17: 0.890923
training accuracy: 0.453125     test accuracy: 0.490509
Average cost in epoch 18: 0.898338
training accuracy: 0.546875     test accuracy: 0.476523
Average cost in epoch 19: 0.888908
training accuracy: 0.515625     test accuracy: 0.502498

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 20: 0.886910
training accuracy: 0.546875     test accuracy: 0.443556
lr decays to 0.006561
Average cost in epoch 21: 0.891535
training accuracy: 0.484375     test accuracy: 0.478521
Average cost in epoch 22: 0.885508
training accuracy: 0.515625     test accuracy: 0.494505
Average cost in epoch 23: 0.890870
training accuracy: 0.609375     test accuracy: 0.469530
Average cost in epoch 24: 0.872062
training accuracy: 0.500000     test accuracy: 0.487512

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 25: 0.892107
training accuracy: 0.546875     test accuracy: 0.483516
lr decays to 0.005905
Average cost in epoch 26: 0.847663
training accuracy: 0.500000     test accuracy: 0.493506
Average cost in epoch 27: 0.872036
training accuracy: 0.468750     test accuracy: 0.489510
Average cost in epoch 28: 0.856996
training accuracy: 0.671875     test accuracy: 0.488511
Average cost in epoch 29: 0.843955
training accuracy: 0.500000     test accuracy: 0.495504

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 30: 0.872213
training accuracy: 0.468750     test accuracy: 0.470529
lr decays to 0.005314
Average cost in epoch 31: 0.845582
training accuracy: 0.468750     test accuracy: 0.494505
Average cost in epoch 32: 0.850772
training accuracy: 0.578125     test accuracy: 0.494505
Average cost in epoch 33: 0.852048
training accuracy: 0.671875     test accuracy: 0.495504
Average cost in epoch 34: 0.849187
training accuracy: 0.562500     test accuracy: 0.493506

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 35: 0.845454
training accuracy: 0.453125     test accuracy: 0.498501
lr decays to 0.004783
Average cost in epoch 36: 0.838931
training accuracy: 0.546875     test accuracy: 0.487512
Average cost in epoch 37: 0.827435
training accuracy: 0.484375     test accuracy: 0.478521
Average cost in epoch 38: 0.835896
training accuracy: 0.484375     test accuracy: 0.502498
Average cost in epoch 39: 0.824629
training accuracy: 0.562500     test accuracy: 0.479520

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 40: 0.858478
training accuracy: 0.609375     test accuracy: 0.471528
lr decays to 0.004305
Average cost in epoch 41: 0.829998
training accuracy: 0.546875     test accuracy: 0.482517
Average cost in epoch 42: 0.829882
training accuracy: 0.484375     test accuracy: 0.499500
Average cost in epoch 43: 0.816473
training accuracy: 0.562500     test accuracy: 0.488511
Average cost in epoch 44: 0.813480
training accuracy: 0.500000     test accuracy: 0.472527

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 45: 0.831426
training accuracy: 0.640625     test accuracy: 0.489510
lr decays to 0.003874
Average cost in epoch 46: 0.817338
training accuracy: 0.546875     test accuracy: 0.493506
Average cost in epoch 47: 0.807022
training accuracy: 0.578125     test accuracy: 0.488511
Average cost in epoch 48: 0.818026
training accuracy: 0.453125     test accuracy: 0.481518
Average cost in epoch 49: 0.818392
training accuracy: 0.578125     test accuracy: 0.464535

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 50: 0.809833
training accuracy: 0.593750     test accuracy: 0.481518
lr decays to 0.003487
Average cost in epoch 51: 0.817335
training accuracy: 0.718750     test accuracy: 0.474525
Average cost in epoch 52: 0.798313
training accuracy: 0.546875     test accuracy: 0.461538
Average cost in epoch 53: 0.809949
training accuracy: 0.562500     test accuracy: 0.491508
Average cost in epoch 54: 0.788667
training accuracy: 0.437500     test accuracy: 0.474525

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 55: 0.792682
training accuracy: 0.593750     test accuracy: 0.499500
lr decays to 0.003138
Average cost in epoch 56: 0.798363
training accuracy: 0.390625     test accuracy: 0.470529
Average cost in epoch 57: 0.808141
training accuracy: 0.453125     test accuracy: 0.489510
Average cost in epoch 58: 0.782663
training accuracy: 0.578125     test accuracy: 0.468531
Average cost in epoch 59: 0.773384
training accuracy: 0.609375     test accuracy: 0.480519

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 60: 0.800294
training accuracy: 0.593750     test accuracy: 0.463536
lr decays to 0.002824
Average cost in epoch 61: 0.781099
training accuracy: 0.515625     test accuracy: 0.486513
Average cost in epoch 62: 0.808454
training accuracy: 0.671875     test accuracy: 0.498501
Average cost in epoch 63: 0.771319
training accuracy: 0.578125     test accuracy: 0.477522
Average cost in epoch 64: 0.779238
training accuracy: 0.671875     test accuracy: 0.481518

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 65: 0.787664
training accuracy: 0.609375     test accuracy: 0.469530
lr decays to 0.002542
Average cost in epoch 66: 0.769776
training accuracy: 0.562500     test accuracy: 0.463536
Average cost in epoch 67: 0.779077
training accuracy: 0.562500     test accuracy: 0.486513
Average cost in epoch 68: 0.761248
training accuracy: 0.578125     test accuracy: 0.472527
Average cost in epoch 69: 0.777250
training accuracy: 0.515625     test accuracy: 0.483516

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 70: 0.754526
training accuracy: 0.640625     test accuracy: 0.478521
lr decays to 0.002288
Average cost in epoch 71: 0.766939
training accuracy: 0.578125     test accuracy: 0.476523
Average cost in epoch 72: 0.746115
training accuracy: 0.578125     test accuracy: 0.476523
Average cost in epoch 73: 0.758423
training accuracy: 0.531250     test accuracy: 0.473526
Average cost in epoch 74: 0.748387
training accuracy: 0.625000     test accuracy: 0.472527

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 75: 0.735815
training accuracy: 0.625000     test accuracy: 0.480519
lr decays to 0.002059
Average cost in epoch 76: 0.781189
training accuracy: 0.546875     test accuracy: 0.481518
Average cost in epoch 77: 0.755803
training accuracy: 0.531250     test accuracy: 0.484515
Average cost in epoch 78: 0.740531
training accuracy: 0.609375     test accuracy: 0.486513
Average cost in epoch 79: 0.749373
training accuracy: 0.578125     test accuracy: 0.473526

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 80: 0.734287
training accuracy: 0.609375     test accuracy: 0.468531
lr decays to 0.001853
Average cost in epoch 81: 0.728139
training accuracy: 0.515625     test accuracy: 0.476523
Average cost in epoch 82: 0.724892
training accuracy: 0.656250     test accuracy: 0.479520
Average cost in epoch 83: 0.731411
training accuracy: 0.578125     test accuracy: 0.464535
Average cost in epoch 84: 0.723264
training accuracy: 0.546875     test accuracy: 0.470529

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 85: 0.726489
training accuracy: 0.515625     test accuracy: 0.487512
lr decays to 0.001668
Average cost in epoch 86: 0.731020
training accuracy: 0.578125     test accuracy: 0.470529
Average cost in epoch 87: 0.729029
training accuracy: 0.671875     test accuracy: 0.468531
Average cost in epoch 88: 0.723421
training accuracy: 0.640625     test accuracy: 0.484515
Average cost in epoch 89: 0.712370
training accuracy: 0.500000     test accuracy: 0.471528

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 90: 0.724129
training accuracy: 0.515625     test accuracy: 0.469530
lr decays to 0.001501
Average cost in epoch 91: 0.696741
training accuracy: 0.671875     test accuracy: 0.485514
Average cost in epoch 92: 0.714969
training accuracy: 0.640625     test accuracy: 0.471528
Average cost in epoch 93: 0.725731
training accuracy: 0.640625     test accuracy: 0.479520
Average cost in epoch 94: 0.715642
training accuracy: 0.625000     test accuracy: 0.460539

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 95: 0.693099
training accuracy: 0.656250     test accuracy: 0.474525
lr decays to 0.001351
Average cost in epoch 96: 0.724428
training accuracy: 0.687500     test accuracy: 0.469530
Average cost in epoch 97: 0.703493
training accuracy: 0.593750     test accuracy: 0.474525
Average cost in epoch 98: 0.693067
training accuracy: 0.578125     test accuracy: 0.463536
Average cost in epoch 99: 0.700654
training accuracy: 0.609375     test accuracy: 0.464535

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 100: 0.705202
training accuracy: 0.671875     test accuracy: 0.474525
lr decays to 0.001216
Average cost in epoch 101: 0.697747
training accuracy: 0.656250     test accuracy: 0.478521
Average cost in epoch 102: 0.676808
training accuracy: 0.562500     test accuracy: 0.471528
Average cost in epoch 103: 0.699623
training accuracy: 0.703125     test accuracy: 0.476523
Average cost in epoch 104: 0.684763
training accuracy: 0.578125     test accuracy: 0.480519

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 105: 0.709314
training accuracy: 0.750000     test accuracy: 0.483516
Average cost in epoch 106: 0.696531
training accuracy: 0.671875     test accuracy: 0.479520
Average cost in epoch 107: 0.697404
training accuracy: 0.640625     test accuracy: 0.472527
Average cost in epoch 108: 0.700169
training accuracy: 0.500000     test accuracy: 0.475524
Average cost in epoch 109: 0.675878
training accuracy: 0.703125     test accuracy: 0.467532

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 110: 0.696096
training accuracy: 0.593750     test accuracy: 0.476523
Average cost in epoch 111: 0.654184
training accuracy: 0.687500     test accuracy: 0.463536
Average cost in epoch 112: 0.671023
training accuracy: 0.703125     test accuracy: 0.479520
Average cost in epoch 113: 0.693319
training accuracy: 0.687500     test accuracy: 0.472527
Average cost in epoch 114: 0.688745
training accuracy: 0.734375     test accuracy: 0.469530

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 115: 0.661124
training accuracy: 0.703125     test accuracy: 0.469530
Average cost in epoch 116: 0.689437
training accuracy: 0.671875     test accuracy: 0.465534
Average cost in epoch 117: 0.685858
training accuracy: 0.609375     test accuracy: 0.468531
Average cost in epoch 118: 0.695558
training accuracy: 0.734375     test accuracy: 0.476523
Average cost in epoch 119: 0.695673
training accuracy: 0.609375     test accuracy: 0.463536

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 120: 0.680917
training accuracy: 0.703125     test accuracy: 0.470529
Average cost in epoch 121: 0.694172
training accuracy: 0.609375     test accuracy: 0.471528
Average cost in epoch 122: 0.667763
training accuracy: 0.765625     test accuracy: 0.463536
Average cost in epoch 123: 0.660008
training accuracy: 0.562500     test accuracy: 0.463536
Average cost in epoch 124: 0.672196
training accuracy: 0.734375     test accuracy: 0.466533

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 125: 0.678245
training accuracy: 0.671875     test accuracy: 0.467532
Average cost in epoch 126: 0.651406
training accuracy: 0.656250     test accuracy: 0.479520
Average cost in epoch 127: 0.675872
training accuracy: 0.640625     test accuracy: 0.465534
Average cost in epoch 128: 0.664238
training accuracy: 0.625000     test accuracy: 0.470529
Average cost in epoch 129: 0.648051
training accuracy: 0.593750     test accuracy: 0.469530

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 130: 0.666900
training accuracy: 0.656250     test accuracy: 0.476523
Average cost in epoch 131: 0.655566
training accuracy: 0.687500     test accuracy: 0.457542
Average cost in epoch 132: 0.641716
training accuracy: 0.640625     test accuracy: 0.471528
Average cost in epoch 133: 0.672133
training accuracy: 0.671875     test accuracy: 0.473526
Average cost in epoch 134: 0.653475
training accuracy: 0.750000     test accuracy: 0.479520

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 135: 0.640603
training accuracy: 0.640625     test accuracy: 0.469530
Average cost in epoch 136: 0.661467
training accuracy: 0.531250     test accuracy: 0.467532
Average cost in epoch 137: 0.647677
training accuracy: 0.562500     test accuracy: 0.469530
Average cost in epoch 138: 0.661869
training accuracy: 0.656250     test accuracy: 0.475524
Average cost in epoch 139: 0.637942
training accuracy: 0.671875     test accuracy: 0.476523

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 140: 0.655923
training accuracy: 0.734375     test accuracy: 0.471528
Average cost in epoch 141: 0.648935
training accuracy: 0.703125     test accuracy: 0.469530
Average cost in epoch 142: 0.638623
training accuracy: 0.609375     test accuracy: 0.468531
Average cost in epoch 143: 0.625365
training accuracy: 0.640625     test accuracy: 0.464535
Average cost in epoch 144: 0.628142
training accuracy: 0.703125     test accuracy: 0.473526

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 145: 0.656091
training accuracy: 0.640625     test accuracy: 0.462537
Average cost in epoch 146: 0.621605
training accuracy: 0.593750     test accuracy: 0.467532
Average cost in epoch 147: 0.641700
training accuracy: 0.671875     test accuracy: 0.457542
Average cost in epoch 148: 0.657071
training accuracy: 0.671875     test accuracy: 0.468531
Average cost in epoch 149: 0.655087
training accuracy: 0.640625     test accuracy: 0.465534

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 150: 0.616280
training accuracy: 0.765625     test accuracy: 0.474525
Average cost in epoch 151: 0.656672
training accuracy: 0.703125     test accuracy: 0.471528
Average cost in epoch 152: 0.651233
training accuracy: 0.734375     test accuracy: 0.470529
Average cost in epoch 153: 0.634615
training accuracy: 0.703125     test accuracy: 0.467532
Average cost in epoch 154: 0.618418
training accuracy: 0.625000     test accuracy: 0.465534

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 155: 0.665146
training accuracy: 0.687500     test accuracy: 0.461538
Average cost in epoch 156: 0.624231
training accuracy: 0.765625     test accuracy: 0.469530
Average cost in epoch 157: 0.619177
training accuracy: 0.812500     test accuracy: 0.457542
Average cost in epoch 158: 0.630837
training accuracy: 0.687500     test accuracy: 0.456543
Average cost in epoch 159: 0.621005
training accuracy: 0.734375     test accuracy: 0.458541

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 160: 0.626749
training accuracy: 0.703125     test accuracy: 0.454545
Average cost in epoch 161: 0.602868
training accuracy: 0.609375     test accuracy: 0.463536
Average cost in epoch 162: 0.620209
training accuracy: 0.671875     test accuracy: 0.454545
Average cost in epoch 163: 0.630356
training accuracy: 0.656250     test accuracy: 0.457542
Average cost in epoch 164: 0.614158
training accuracy: 0.703125     test accuracy: 0.464535

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 165: 0.627498
training accuracy: 0.718750     test accuracy: 0.462537
Average cost in epoch 166: 0.586999
training accuracy: 0.734375     test accuracy: 0.455544
Average cost in epoch 167: 0.616457
training accuracy: 0.750000     test accuracy: 0.454545
Average cost in epoch 168: 0.608409
training accuracy: 0.750000     test accuracy: 0.462537
Average cost in epoch 169: 0.595322
training accuracy: 0.546875     test accuracy: 0.454545

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 170: 0.599611
training accuracy: 0.734375     test accuracy: 0.453546
Average cost in epoch 171: 0.597104
training accuracy: 0.734375     test accuracy: 0.460539
Average cost in epoch 172: 0.593354
training accuracy: 0.703125     test accuracy: 0.453546
Average cost in epoch 173: 0.609739
training accuracy: 0.765625     test accuracy: 0.446553
Average cost in epoch 174: 0.618250
training accuracy: 0.703125     test accuracy: 0.461538

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 175: 0.590309
training accuracy: 0.765625     test accuracy: 0.453546
Average cost in epoch 176: 0.590410
training accuracy: 0.843750     test accuracy: 0.451548
Average cost in epoch 177: 0.594473
training accuracy: 0.687500     test accuracy: 0.455544
Average cost in epoch 178: 0.600643
training accuracy: 0.812500     test accuracy: 0.459540
Average cost in epoch 179: 0.610924
training accuracy: 0.828125     test accuracy: 0.459540

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 180: 0.611988
training accuracy: 0.734375     test accuracy: 0.456543
Average cost in epoch 181: 0.606413
training accuracy: 0.718750     test accuracy: 0.453546
Average cost in epoch 182: 0.589153
training accuracy: 0.671875     test accuracy: 0.459540
Average cost in epoch 183: 0.580994
training accuracy: 0.703125     test accuracy: 0.453546
Average cost in epoch 184: 0.571692
training accuracy: 0.734375     test accuracy: 0.456543

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 185: 0.589058
training accuracy: 0.765625     test accuracy: 0.450549
Average cost in epoch 186: 0.584361
training accuracy: 0.687500     test accuracy: 0.453546
Average cost in epoch 187: 0.555775
training accuracy: 0.687500     test accuracy: 0.454545
Average cost in epoch 188: 0.597638
training accuracy: 0.781250     test accuracy: 0.456543
Average cost in epoch 189: 0.587630
training accuracy: 0.734375     test accuracy: 0.450549

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 190: 0.559673
training accuracy: 0.750000     test accuracy: 0.449550
Average cost in epoch 191: 0.582148
training accuracy: 0.687500     test accuracy: 0.446553
Average cost in epoch 192: 0.590592
training accuracy: 0.718750     test accuracy: 0.448551
Average cost in epoch 193: 0.577053
training accuracy: 0.687500     test accuracy: 0.454545
Average cost in epoch 194: 0.590067
training accuracy: 0.718750     test accuracy: 0.451548

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Average cost in epoch 195: 0.586439
training accuracy: 0.718750     test accuracy: 0.464535
Average cost in epoch 196: 0.540061
training accuracy: 0.703125     test accuracy: 0.458541
Average cost in epoch 197: 0.587716
training accuracy: 0.718750     test accuracy: 0.449550
Average cost in epoch 198: 0.596913
training accuracy: 0.796875     test accuracy: 0.444555
Average cost in epoch 199: 0.528716
training accuracy: 0.750000     test accuracy: 0.457542

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_10.pkl

Locking... locked.
Executing '9221-yetian1' on deep10/1 as yetian1...
No machines free for job 9222-yetian1
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 11, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_11.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 99.53
Starting training...
Average cost in epoch 0: 2.112642
training accuracy: 0.390625     test accuracy: 0.413586
Average cost in epoch 1: 1.490997
training accuracy: 0.546875     test accuracy: 0.667333
Average cost in epoch 2: 1.282801
training accuracy: 0.687500     test accuracy: 0.751249
Average cost in epoch 3: 1.264375
training accuracy: 0.656250     test accuracy: 0.751249
Average cost in epoch 4: 1.202584
training accuracy: 0.546875     test accuracy: 0.751249

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 5: 1.174740
training accuracy: 0.687500     test accuracy: 0.751249
lr decays to 0.009000
Average cost in epoch 6: 1.219310
training accuracy: 0.734375     test accuracy: 0.751249
Average cost in epoch 7: 1.162484
training accuracy: 0.718750     test accuracy: 0.751249
Average cost in epoch 8: 1.159552
training accuracy: 0.765625     test accuracy: 0.751249
Average cost in epoch 9: 1.223634
training accuracy: 0.750000     test accuracy: 0.751249

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 10: 1.112424
training accuracy: 0.750000     test accuracy: 0.751249
lr decays to 0.008100
Average cost in epoch 11: 1.156742
training accuracy: 0.781250     test accuracy: 0.741259
Average cost in epoch 12: 1.140564
training accuracy: 0.656250     test accuracy: 0.750250
Average cost in epoch 13: 1.131820
training accuracy: 0.703125     test accuracy: 0.748252
Average cost in epoch 14: 1.022307
training accuracy: 0.812500     test accuracy: 0.740260

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 15: 1.042808
training accuracy: 0.703125     test accuracy: 0.739261
lr decays to 0.007290
Average cost in epoch 16: 1.058111
training accuracy: 0.671875     test accuracy: 0.735265
Average cost in epoch 17: 1.044292
training accuracy: 0.671875     test accuracy: 0.732268
Average cost in epoch 18: 0.979313
training accuracy: 0.625000     test accuracy: 0.722278
Average cost in epoch 19: 0.968353
training accuracy: 0.656250     test accuracy: 0.727273

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 20: 0.970049
training accuracy: 0.687500     test accuracy: 0.723277
lr decays to 0.006561
Average cost in epoch 21: 0.942725
training accuracy: 0.703125     test accuracy: 0.713287
Average cost in epoch 22: 0.993407
training accuracy: 0.734375     test accuracy: 0.711289
Average cost in epoch 23: 0.892246
training accuracy: 0.718750     test accuracy: 0.709291
Average cost in epoch 24: 0.959362
training accuracy: 0.703125     test accuracy: 0.720280

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 25: 0.915147
training accuracy: 0.750000     test accuracy: 0.713287
lr decays to 0.005905
Average cost in epoch 26: 0.906323
training accuracy: 0.765625     test accuracy: 0.725275
Average cost in epoch 27: 0.866568
training accuracy: 0.718750     test accuracy: 0.722278
Average cost in epoch 28: 0.856006
training accuracy: 0.718750     test accuracy: 0.706294
Average cost in epoch 29: 0.858567
training accuracy: 0.656250     test accuracy: 0.712288

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 30: 0.865764
training accuracy: 0.718750     test accuracy: 0.715285
lr decays to 0.005314
Average cost in epoch 31: 0.822635
training accuracy: 0.765625     test accuracy: 0.709291
Average cost in epoch 32: 0.847954
training accuracy: 0.812500     test accuracy: 0.712288
Average cost in epoch 33: 0.776169
training accuracy: 0.718750     test accuracy: 0.715285
Average cost in epoch 34: 0.790460
training accuracy: 0.671875     test accuracy: 0.712288

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 35: 0.822272
training accuracy: 0.750000     test accuracy: 0.697303
lr decays to 0.004783
Average cost in epoch 36: 0.762744
training accuracy: 0.781250     test accuracy: 0.698302
Average cost in epoch 37: 0.779756
training accuracy: 0.734375     test accuracy: 0.702298
Average cost in epoch 38: 0.784502
training accuracy: 0.796875     test accuracy: 0.696304
Average cost in epoch 39: 0.674173
training accuracy: 0.812500     test accuracy: 0.703297

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 40: 0.733609
training accuracy: 0.781250     test accuracy: 0.702298
lr decays to 0.004305
Average cost in epoch 41: 0.775900
training accuracy: 0.671875     test accuracy: 0.703297
Average cost in epoch 42: 0.686864
training accuracy: 0.734375     test accuracy: 0.701299
Average cost in epoch 43: 0.728168
training accuracy: 0.781250     test accuracy: 0.690310
Average cost in epoch 44: 0.679944
training accuracy: 0.734375     test accuracy: 0.691309

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 45: 0.684620
training accuracy: 0.718750     test accuracy: 0.700300
lr decays to 0.003874
Average cost in epoch 46: 0.667131
training accuracy: 0.875000     test accuracy: 0.701299
Average cost in epoch 47: 0.699835
training accuracy: 0.781250     test accuracy: 0.694306
Average cost in epoch 48: 0.631800
training accuracy: 0.812500     test accuracy: 0.693307
Average cost in epoch 49: 0.614342
training accuracy: 0.765625     test accuracy: 0.697303

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 50: 0.640117
training accuracy: 0.718750     test accuracy: 0.710290
lr decays to 0.003487
Average cost in epoch 51: 0.636176
training accuracy: 0.906250     test accuracy: 0.695305
Average cost in epoch 52: 0.644688
training accuracy: 0.765625     test accuracy: 0.692308
Average cost in epoch 53: 0.630857
training accuracy: 0.875000     test accuracy: 0.708292
Average cost in epoch 54: 0.612957
training accuracy: 0.875000     test accuracy: 0.701299

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 55: 0.628586
training accuracy: 0.859375     test accuracy: 0.695305
lr decays to 0.003138
Average cost in epoch 56: 0.612541
training accuracy: 0.843750     test accuracy: 0.704296
Average cost in epoch 57: 0.582224
training accuracy: 0.796875     test accuracy: 0.680320
Average cost in epoch 58: 0.572759
training accuracy: 0.828125     test accuracy: 0.696304
Average cost in epoch 59: 0.556004
training accuracy: 0.875000     test accuracy: 0.696304

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 60: 0.552405
training accuracy: 0.781250     test accuracy: 0.687313
lr decays to 0.002824
Average cost in epoch 61: 0.555466
training accuracy: 0.750000     test accuracy: 0.703297
Average cost in epoch 62: 0.508189
training accuracy: 0.781250     test accuracy: 0.698302
Average cost in epoch 63: 0.538510
training accuracy: 0.750000     test accuracy: 0.689311
Average cost in epoch 64: 0.485971
training accuracy: 0.796875     test accuracy: 0.699301

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 65: 0.498533
training accuracy: 0.843750     test accuracy: 0.690310
lr decays to 0.002542
Average cost in epoch 66: 0.534523
training accuracy: 0.828125     test accuracy: 0.700300
Average cost in epoch 67: 0.517502
training accuracy: 0.828125     test accuracy: 0.704296
Average cost in epoch 68: 0.489916
training accuracy: 0.859375     test accuracy: 0.705295
Average cost in epoch 69: 0.524874
training accuracy: 0.859375     test accuracy: 0.693307

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 70: 0.494460
training accuracy: 0.796875     test accuracy: 0.694306
lr decays to 0.002288
Average cost in epoch 71: 0.525232
training accuracy: 0.843750     test accuracy: 0.694306
Average cost in epoch 72: 0.513683
training accuracy: 0.843750     test accuracy: 0.696304
Average cost in epoch 73: 0.510049
training accuracy: 0.796875     test accuracy: 0.705295
Average cost in epoch 74: 0.507664
training accuracy: 0.890625     test accuracy: 0.706294

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 75: 0.481444
training accuracy: 0.890625     test accuracy: 0.697303
lr decays to 0.002059
Average cost in epoch 76: 0.468893
training accuracy: 0.843750     test accuracy: 0.709291
Average cost in epoch 77: 0.469428
training accuracy: 0.906250     test accuracy: 0.695305
Average cost in epoch 78: 0.466320
training accuracy: 0.859375     test accuracy: 0.711289
Average cost in epoch 79: 0.488118
training accuracy: 0.875000     test accuracy: 0.701299

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 80: 0.436928
training accuracy: 0.812500     test accuracy: 0.699301
lr decays to 0.001853
Average cost in epoch 81: 0.422414
training accuracy: 0.796875     test accuracy: 0.696304
Average cost in epoch 82: 0.453169
training accuracy: 0.890625     test accuracy: 0.707293
Average cost in epoch 83: 0.443406
training accuracy: 0.890625     test accuracy: 0.684316
Average cost in epoch 84: 0.434083
training accuracy: 0.906250     test accuracy: 0.698302

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 85: 0.464018
training accuracy: 0.921875     test accuracy: 0.691309
lr decays to 0.001668
Average cost in epoch 86: 0.414978
training accuracy: 0.859375     test accuracy: 0.696304
Average cost in epoch 87: 0.398264
training accuracy: 0.843750     test accuracy: 0.703297
Average cost in epoch 88: 0.452376
training accuracy: 0.890625     test accuracy: 0.696304
Average cost in epoch 89: 0.386557
training accuracy: 0.859375     test accuracy: 0.695305

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 90: 0.392909
training accuracy: 0.906250     test accuracy: 0.695305
lr decays to 0.001501
Average cost in epoch 91: 0.391775
training accuracy: 0.828125     test accuracy: 0.698302
Average cost in epoch 92: 0.398678
training accuracy: 0.796875     test accuracy: 0.703297
Average cost in epoch 93: 0.400830
training accuracy: 0.843750     test accuracy: 0.703297
Average cost in epoch 94: 0.388449
training accuracy: 0.906250     test accuracy: 0.693307

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 95: 0.375111
training accuracy: 0.921875     test accuracy: 0.698302
lr decays to 0.001351
Average cost in epoch 96: 0.409331
training accuracy: 0.937500     test accuracy: 0.691309
Average cost in epoch 97: 0.436222
training accuracy: 0.953125     test accuracy: 0.694306
Average cost in epoch 98: 0.395553
training accuracy: 0.968750     test accuracy: 0.697303
Average cost in epoch 99: 0.401660
training accuracy: 0.828125     test accuracy: 0.698302

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 100: 0.393068
training accuracy: 0.921875     test accuracy: 0.703297
lr decays to 0.001216
Average cost in epoch 101: 0.394378
training accuracy: 0.953125     test accuracy: 0.697303
Average cost in epoch 102: 0.370312
training accuracy: 0.921875     test accuracy: 0.686314
Average cost in epoch 103: 0.385299
training accuracy: 0.921875     test accuracy: 0.699301
Average cost in epoch 104: 0.351048
training accuracy: 0.906250     test accuracy: 0.695305

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 105: 0.391847
training accuracy: 0.828125     test accuracy: 0.703297
Average cost in epoch 106: 0.388148
training accuracy: 0.906250     test accuracy: 0.700300
Average cost in epoch 107: 0.349688
training accuracy: 0.968750     test accuracy: 0.702298
Average cost in epoch 108: 0.346367
training accuracy: 0.937500     test accuracy: 0.704296
Average cost in epoch 109: 0.307346
training accuracy: 0.906250     test accuracy: 0.695305

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 110: 0.360763
training accuracy: 0.843750     test accuracy: 0.696304
Average cost in epoch 111: 0.344963
training accuracy: 0.859375     test accuracy: 0.693307
Average cost in epoch 112: 0.351412
training accuracy: 0.875000     test accuracy: 0.696304
Average cost in epoch 113: 0.323055
training accuracy: 0.953125     test accuracy: 0.693307
Average cost in epoch 114: 0.344106
training accuracy: 0.921875     test accuracy: 0.697303

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 115: 0.328445
training accuracy: 0.906250     test accuracy: 0.702298
Average cost in epoch 116: 0.336200
training accuracy: 0.890625     test accuracy: 0.701299
Average cost in epoch 117: 0.356346
training accuracy: 0.890625     test accuracy: 0.703297
Average cost in epoch 118: 0.312342
training accuracy: 0.953125     test accuracy: 0.697303
Average cost in epoch 119: 0.384073
training accuracy: 0.875000     test accuracy: 0.692308

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 120: 0.331868
training accuracy: 0.890625     test accuracy: 0.699301
Average cost in epoch 121: 0.323548
training accuracy: 0.875000     test accuracy: 0.691309
Average cost in epoch 122: 0.360749
training accuracy: 0.953125     test accuracy: 0.696304
Average cost in epoch 123: 0.296727
training accuracy: 0.828125     test accuracy: 0.701299
Average cost in epoch 124: 0.345681
training accuracy: 0.968750     test accuracy: 0.696304

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 125: 0.320729
training accuracy: 0.890625     test accuracy: 0.694306
Average cost in epoch 126: 0.319028
training accuracy: 0.906250     test accuracy: 0.703297
Average cost in epoch 127: 0.337267
training accuracy: 0.906250     test accuracy: 0.682318
Average cost in epoch 128: 0.327699
training accuracy: 0.906250     test accuracy: 0.690310
Average cost in epoch 129: 0.316547
training accuracy: 0.906250     test accuracy: 0.689311

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 130: 0.322331
training accuracy: 0.937500     test accuracy: 0.685315
Average cost in epoch 131: 0.306978
training accuracy: 0.890625     test accuracy: 0.698302
Average cost in epoch 132: 0.313647
training accuracy: 0.906250     test accuracy: 0.686314
Average cost in epoch 133: 0.293325
training accuracy: 0.921875     test accuracy: 0.692308
Average cost in epoch 134: 0.306888
training accuracy: 0.968750     test accuracy: 0.692308

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 135: 0.312572
training accuracy: 0.859375     test accuracy: 0.693307
Average cost in epoch 136: 0.306444
training accuracy: 0.968750     test accuracy: 0.692308
Average cost in epoch 137: 0.307705
training accuracy: 0.906250     test accuracy: 0.689311
Average cost in epoch 138: 0.313519
training accuracy: 0.937500     test accuracy: 0.687313
Average cost in epoch 139: 0.308159
training accuracy: 0.890625     test accuracy: 0.677323

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 140: 0.330390
training accuracy: 0.937500     test accuracy: 0.681319
Average cost in epoch 141: 0.312008
training accuracy: 0.906250     test accuracy: 0.685315
Average cost in epoch 142: 0.313438
training accuracy: 0.953125     test accuracy: 0.687313
Average cost in epoch 143: 0.306100
training accuracy: 0.953125     test accuracy: 0.686314
Average cost in epoch 144: 0.275267
training accuracy: 0.906250     test accuracy: 0.687313

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 145: 0.335219
training accuracy: 0.921875     test accuracy: 0.682318
Average cost in epoch 146: 0.313088
training accuracy: 0.828125     test accuracy: 0.679321
Average cost in epoch 147: 0.280449
training accuracy: 0.937500     test accuracy: 0.679321
Average cost in epoch 148: 0.275027
training accuracy: 0.953125     test accuracy: 0.683317
Average cost in epoch 149: 0.357219
training accuracy: 0.953125     test accuracy: 0.683317

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 150: 0.256581
training accuracy: 0.921875     test accuracy: 0.681319
Average cost in epoch 151: 0.280910
training accuracy: 0.921875     test accuracy: 0.682318
Average cost in epoch 152: 0.309641
training accuracy: 0.906250     test accuracy: 0.694306
Average cost in epoch 153: 0.243553
training accuracy: 0.921875     test accuracy: 0.682318
Average cost in epoch 154: 0.328084
training accuracy: 0.968750     test accuracy: 0.679321

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 155: 0.289478
training accuracy: 0.937500     test accuracy: 0.686314
Average cost in epoch 156: 0.257908
training accuracy: 0.875000     test accuracy: 0.681319
Average cost in epoch 157: 0.268181
training accuracy: 0.843750     test accuracy: 0.691309
Average cost in epoch 158: 0.309020
training accuracy: 0.937500     test accuracy: 0.680320
Average cost in epoch 159: 0.297293
training accuracy: 0.906250     test accuracy: 0.677323

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 160: 0.280734
training accuracy: 0.937500     test accuracy: 0.678322
Average cost in epoch 161: 0.278777
training accuracy: 0.937500     test accuracy: 0.671329
Average cost in epoch 162: 0.309225
training accuracy: 0.953125     test accuracy: 0.680320
Average cost in epoch 163: 0.248797
training accuracy: 0.937500     test accuracy: 0.667333
Average cost in epoch 164: 0.286230
training accuracy: 0.921875     test accuracy: 0.679321

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 165: 0.274914
training accuracy: 0.921875     test accuracy: 0.680320
Average cost in epoch 166: 0.278106
training accuracy: 0.921875     test accuracy: 0.671329
Average cost in epoch 167: 0.292304
training accuracy: 0.890625     test accuracy: 0.688312
Average cost in epoch 168: 0.291948
training accuracy: 0.875000     test accuracy: 0.684316
Average cost in epoch 169: 0.276433
training accuracy: 0.937500     test accuracy: 0.692308

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 170: 0.266521
training accuracy: 0.890625     test accuracy: 0.676324
Average cost in epoch 171: 0.276794
training accuracy: 0.937500     test accuracy: 0.686314
Average cost in epoch 172: 0.254974
training accuracy: 0.906250     test accuracy: 0.683317
Average cost in epoch 173: 0.258673
training accuracy: 0.890625     test accuracy: 0.678322
Average cost in epoch 174: 0.247313
training accuracy: 0.921875     test accuracy: 0.684316

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 175: 0.260429
training accuracy: 0.921875     test accuracy: 0.676324
Average cost in epoch 176: 0.278889
training accuracy: 0.937500     test accuracy: 0.686314
Average cost in epoch 177: 0.260062
training accuracy: 0.921875     test accuracy: 0.670330
Average cost in epoch 178: 0.292928
training accuracy: 0.937500     test accuracy: 0.687313
Average cost in epoch 179: 0.269455
training accuracy: 0.953125     test accuracy: 0.686314

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 180: 0.224472
training accuracy: 0.953125     test accuracy: 0.682318
Average cost in epoch 181: 0.219089
training accuracy: 0.921875     test accuracy: 0.682318
Average cost in epoch 182: 0.245946
training accuracy: 0.953125     test accuracy: 0.674326
Average cost in epoch 183: 0.247941
training accuracy: 0.953125     test accuracy: 0.681319
Average cost in epoch 184: 0.227030
training accuracy: 0.890625     test accuracy: 0.685315

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 185: 0.276446
training accuracy: 0.968750     test accuracy: 0.676324
Average cost in epoch 186: 0.270503
training accuracy: 0.859375     test accuracy: 0.672328
Average cost in epoch 187: 0.226011
training accuracy: 0.875000     test accuracy: 0.684316
Average cost in epoch 188: 0.269668
training accuracy: 0.906250     test accuracy: 0.687313
Average cost in epoch 189: 0.231960
training accuracy: 0.937500     test accuracy: 0.675325

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 190: 0.230283
training accuracy: 0.921875     test accuracy: 0.690310
Average cost in epoch 191: 0.224644
training accuracy: 0.921875     test accuracy: 0.677323
Average cost in epoch 192: 0.197054
training accuracy: 0.875000     test accuracy: 0.689311
Average cost in epoch 193: 0.254970
training accuracy: 0.937500     test accuracy: 0.686314
Average cost in epoch 194: 0.257317
training accuracy: 0.921875     test accuracy: 0.680320

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Average cost in epoch 195: 0.235605
training accuracy: 0.937500     test accuracy: 0.682318
Average cost in epoch 196: 0.217431
training accuracy: 0.953125     test accuracy: 0.683317
Average cost in epoch 197: 0.254571
training accuracy: 0.921875     test accuracy: 0.682318
Average cost in epoch 198: 0.216165
training accuracy: 0.921875     test accuracy: 0.675325
Average cost in epoch 199: 0.259198
training accuracy: 0.921875     test accuracy: 0.686314

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_11.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 12, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_12.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 91.60
Starting training...
Average cost in epoch 0: 1.957032
training accuracy: 0.515625     test accuracy: 0.750250
Average cost in epoch 1: 1.332911
training accuracy: 0.640625     test accuracy: 0.772228
Average cost in epoch 2: 1.218998
training accuracy: 0.781250     test accuracy: 0.772228
Average cost in epoch 3: 1.233077
training accuracy: 0.750000     test accuracy: 0.772228
Average cost in epoch 4: 1.202400
training accuracy: 0.593750     test accuracy: 0.772228

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 5: 1.154287
training accuracy: 0.734375     test accuracy: 0.772228
lr decays to 0.009000
Average cost in epoch 6: 1.153985
training accuracy: 0.640625     test accuracy: 0.747253
Average cost in epoch 7: 1.088019
training accuracy: 0.703125     test accuracy: 0.761239
Average cost in epoch 8: 1.055443
training accuracy: 0.562500     test accuracy: 0.735265
Average cost in epoch 9: 1.028835
training accuracy: 0.718750     test accuracy: 0.737263

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 10: 1.029977
training accuracy: 0.687500     test accuracy: 0.733267
lr decays to 0.008100
Average cost in epoch 11: 1.011443
training accuracy: 0.718750     test accuracy: 0.769231
Average cost in epoch 12: 0.953831
training accuracy: 0.687500     test accuracy: 0.754246
Average cost in epoch 13: 0.935764
training accuracy: 0.671875     test accuracy: 0.769231
Average cost in epoch 14: 0.956933
training accuracy: 0.609375     test accuracy: 0.733267

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 15: 0.969282
training accuracy: 0.734375     test accuracy: 0.714286
lr decays to 0.007290
Average cost in epoch 16: 0.903755
training accuracy: 0.687500     test accuracy: 0.747253
Average cost in epoch 17: 0.885013
training accuracy: 0.750000     test accuracy: 0.729271
Average cost in epoch 18: 0.900728
training accuracy: 0.718750     test accuracy: 0.716284
Average cost in epoch 19: 0.888621
training accuracy: 0.828125     test accuracy: 0.753247

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 20: 0.877444
training accuracy: 0.718750     test accuracy: 0.714286
lr decays to 0.006561
Average cost in epoch 21: 0.896034
training accuracy: 0.750000     test accuracy: 0.722278
Average cost in epoch 22: 0.814990
training accuracy: 0.625000     test accuracy: 0.720280
Average cost in epoch 23: 0.839234
training accuracy: 0.671875     test accuracy: 0.732268
Average cost in epoch 24: 0.791350
training accuracy: 0.671875     test accuracy: 0.701299

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 25: 0.814907
training accuracy: 0.687500     test accuracy: 0.705295
lr decays to 0.005905
Average cost in epoch 26: 0.774150
training accuracy: 0.687500     test accuracy: 0.681319
Average cost in epoch 27: 0.836116
training accuracy: 0.734375     test accuracy: 0.655345
Average cost in epoch 28: 0.695405
training accuracy: 0.781250     test accuracy: 0.708292
Average cost in epoch 29: 0.769085
training accuracy: 0.796875     test accuracy: 0.702298

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 30: 0.748571
training accuracy: 0.687500     test accuracy: 0.697303
lr decays to 0.005314
Average cost in epoch 31: 0.671855
training accuracy: 0.703125     test accuracy: 0.708292
Average cost in epoch 32: 0.770456
training accuracy: 0.781250     test accuracy: 0.689311
Average cost in epoch 33: 0.717774
training accuracy: 0.734375     test accuracy: 0.712288
Average cost in epoch 34: 0.690938
training accuracy: 0.703125     test accuracy: 0.687313

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 35: 0.713689
training accuracy: 0.671875     test accuracy: 0.689311
lr decays to 0.004783
Average cost in epoch 36: 0.638727
training accuracy: 0.781250     test accuracy: 0.681319
Average cost in epoch 37: 0.673921
training accuracy: 0.796875     test accuracy: 0.683317
Average cost in epoch 38: 0.650871
training accuracy: 0.734375     test accuracy: 0.654346
Average cost in epoch 39: 0.629845
training accuracy: 0.765625     test accuracy: 0.694306

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 40: 0.615932
training accuracy: 0.734375     test accuracy: 0.671329
lr decays to 0.004305
Average cost in epoch 41: 0.603719
training accuracy: 0.812500     test accuracy: 0.692308
Average cost in epoch 42: 0.566382
training accuracy: 0.765625     test accuracy: 0.700300
Average cost in epoch 43: 0.588564
training accuracy: 0.843750     test accuracy: 0.669331
Average cost in epoch 44: 0.599851
training accuracy: 0.828125     test accuracy: 0.662338

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 45: 0.577224
training accuracy: 0.812500     test accuracy: 0.689311
lr decays to 0.003874
Average cost in epoch 46: 0.564795
training accuracy: 0.765625     test accuracy: 0.676324
Average cost in epoch 47: 0.506094
training accuracy: 0.859375     test accuracy: 0.662338
Average cost in epoch 48: 0.534209
training accuracy: 0.890625     test accuracy: 0.674326
Average cost in epoch 49: 0.530549
training accuracy: 0.765625     test accuracy: 0.666334

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 50: 0.497507
training accuracy: 0.875000     test accuracy: 0.662338
lr decays to 0.003487
Average cost in epoch 51: 0.520657
training accuracy: 0.812500     test accuracy: 0.663337
Average cost in epoch 52: 0.510442
training accuracy: 0.875000     test accuracy: 0.664336
Average cost in epoch 53: 0.476286
training accuracy: 0.812500     test accuracy: 0.653347
Average cost in epoch 54: 0.516698
training accuracy: 0.890625     test accuracy: 0.670330

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 55: 0.420574
training accuracy: 0.828125     test accuracy: 0.655345
lr decays to 0.003138
Average cost in epoch 56: 0.496071
training accuracy: 0.828125     test accuracy: 0.665335
Average cost in epoch 57: 0.468130
training accuracy: 0.859375     test accuracy: 0.628372
Average cost in epoch 58: 0.472791
training accuracy: 0.890625     test accuracy: 0.644356
Average cost in epoch 59: 0.469570
training accuracy: 0.890625     test accuracy: 0.652348

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 60: 0.420821
training accuracy: 0.843750     test accuracy: 0.655345
lr decays to 0.002824
Average cost in epoch 61: 0.425839
training accuracy: 0.859375     test accuracy: 0.651349
Average cost in epoch 62: 0.424815
training accuracy: 0.906250     test accuracy: 0.657343
Average cost in epoch 63: 0.441483
training accuracy: 0.828125     test accuracy: 0.657343
Average cost in epoch 64: 0.379794
training accuracy: 0.812500     test accuracy: 0.638362

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 65: 0.420291
training accuracy: 0.812500     test accuracy: 0.652348
lr decays to 0.002542
Average cost in epoch 66: 0.377356
training accuracy: 0.921875     test accuracy: 0.648352
Average cost in epoch 67: 0.404374
training accuracy: 0.906250     test accuracy: 0.654346
Average cost in epoch 68: 0.415718
training accuracy: 0.906250     test accuracy: 0.651349
Average cost in epoch 69: 0.384109
training accuracy: 0.750000     test accuracy: 0.650350

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 70: 0.359533
training accuracy: 0.812500     test accuracy: 0.645355
lr decays to 0.002288
Average cost in epoch 71: 0.382034
training accuracy: 0.921875     test accuracy: 0.643357
Average cost in epoch 72: 0.353182
training accuracy: 0.828125     test accuracy: 0.652348
Average cost in epoch 73: 0.334629
training accuracy: 0.843750     test accuracy: 0.657343
Average cost in epoch 74: 0.390729
training accuracy: 0.890625     test accuracy: 0.650350

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 75: 0.371391
training accuracy: 0.890625     test accuracy: 0.656344
lr decays to 0.002059
Average cost in epoch 76: 0.306670
training accuracy: 0.921875     test accuracy: 0.632368
Average cost in epoch 77: 0.317639
training accuracy: 0.890625     test accuracy: 0.634366
Average cost in epoch 78: 0.334369
training accuracy: 0.859375     test accuracy: 0.641359
Average cost in epoch 79: 0.317961
training accuracy: 0.906250     test accuracy: 0.631369

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 80: 0.314266
training accuracy: 0.765625     test accuracy: 0.625375
lr decays to 0.001853
Average cost in epoch 81: 0.360045
training accuracy: 0.906250     test accuracy: 0.624376
Average cost in epoch 82: 0.289391
training accuracy: 0.921875     test accuracy: 0.625375
Average cost in epoch 83: 0.286561
training accuracy: 0.828125     test accuracy: 0.624376
Average cost in epoch 84: 0.300434
training accuracy: 0.906250     test accuracy: 0.622378

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 85: 0.274987
training accuracy: 0.890625     test accuracy: 0.627373
lr decays to 0.001668
Average cost in epoch 86: 0.298193
training accuracy: 0.906250     test accuracy: 0.608392
Average cost in epoch 87: 0.268037
training accuracy: 0.921875     test accuracy: 0.638362
Average cost in epoch 88: 0.280111
training accuracy: 0.937500     test accuracy: 0.627373
Average cost in epoch 89: 0.288909
training accuracy: 0.937500     test accuracy: 0.628372

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 90: 0.303646
training accuracy: 0.906250     test accuracy: 0.627373
lr decays to 0.001501
Average cost in epoch 91: 0.289654
training accuracy: 0.828125     test accuracy: 0.633367
Average cost in epoch 92: 0.291643
training accuracy: 0.921875     test accuracy: 0.626374
Average cost in epoch 93: 0.251100
training accuracy: 0.921875     test accuracy: 0.621379
Average cost in epoch 94: 0.262405
training accuracy: 0.890625     test accuracy: 0.620380

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 95: 0.259176
training accuracy: 0.890625     test accuracy: 0.621379
lr decays to 0.001351
Average cost in epoch 96: 0.249919
training accuracy: 0.921875     test accuracy: 0.616384
Average cost in epoch 97: 0.250978
training accuracy: 0.953125     test accuracy: 0.620380
Average cost in epoch 98: 0.281416
training accuracy: 0.921875     test accuracy: 0.627373
Average cost in epoch 99: 0.253278
training accuracy: 0.953125     test accuracy: 0.631369

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 100: 0.245655
training accuracy: 0.953125     test accuracy: 0.625375
lr decays to 0.001216
Average cost in epoch 101: 0.237453
training accuracy: 0.921875     test accuracy: 0.616384
Average cost in epoch 102: 0.259995
training accuracy: 0.953125     test accuracy: 0.630370
Average cost in epoch 103: 0.229303
training accuracy: 0.937500     test accuracy: 0.617383
Average cost in epoch 104: 0.271820
training accuracy: 0.937500     test accuracy: 0.614386

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 105: 0.267547
training accuracy: 0.937500     test accuracy: 0.628372
Average cost in epoch 106: 0.192809
training accuracy: 0.906250     test accuracy: 0.625375
Average cost in epoch 107: 0.230848
training accuracy: 0.953125     test accuracy: 0.614386
Average cost in epoch 108: 0.222811
training accuracy: 0.937500     test accuracy: 0.618382
Average cost in epoch 109: 0.196258
training accuracy: 0.921875     test accuracy: 0.616384

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 110: 0.247066
training accuracy: 0.875000     test accuracy: 0.624376
Average cost in epoch 111: 0.264322
training accuracy: 0.921875     test accuracy: 0.624376
Average cost in epoch 112: 0.212533
training accuracy: 0.968750     test accuracy: 0.619381
Average cost in epoch 113: 0.221004
training accuracy: 0.937500     test accuracy: 0.623377
Average cost in epoch 114: 0.216187
training accuracy: 0.906250     test accuracy: 0.598402

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 115: 0.223211
training accuracy: 0.953125     test accuracy: 0.616384
Average cost in epoch 116: 0.245078
training accuracy: 0.968750     test accuracy: 0.612388
Average cost in epoch 117: 0.196738
training accuracy: 0.859375     test accuracy: 0.614386
Average cost in epoch 118: 0.253852
training accuracy: 0.875000     test accuracy: 0.610390
Average cost in epoch 119: 0.202083
training accuracy: 0.921875     test accuracy: 0.627373

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 120: 0.228859
training accuracy: 0.921875     test accuracy: 0.634366
Average cost in epoch 121: 0.225848
training accuracy: 0.875000     test accuracy: 0.609391
Average cost in epoch 122: 0.192278
training accuracy: 0.875000     test accuracy: 0.635365
Average cost in epoch 123: 0.214682
training accuracy: 0.953125     test accuracy: 0.619381
Average cost in epoch 124: 0.218171
training accuracy: 0.953125     test accuracy: 0.640360

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 125: 0.217368
training accuracy: 0.953125     test accuracy: 0.627373
Average cost in epoch 126: 0.225970
training accuracy: 0.937500     test accuracy: 0.633367
Average cost in epoch 127: 0.223782
training accuracy: 0.984375     test accuracy: 0.623377
Average cost in epoch 128: 0.189366
training accuracy: 0.984375     test accuracy: 0.617383
Average cost in epoch 129: 0.213244
training accuracy: 0.906250     test accuracy: 0.613387

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 130: 0.208592
training accuracy: 0.968750     test accuracy: 0.614386
Average cost in epoch 131: 0.217609
training accuracy: 0.984375     test accuracy: 0.623377
Average cost in epoch 132: 0.185045
training accuracy: 0.937500     test accuracy: 0.617383
Average cost in epoch 133: 0.156773
training accuracy: 0.984375     test accuracy: 0.625375
Average cost in epoch 134: 0.209777
training accuracy: 0.968750     test accuracy: 0.618382

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 135: 0.196007
training accuracy: 0.937500     test accuracy: 0.628372
Average cost in epoch 136: 0.198682
training accuracy: 0.906250     test accuracy: 0.606394
Average cost in epoch 137: 0.182936
training accuracy: 0.968750     test accuracy: 0.622378
Average cost in epoch 138: 0.200385
training accuracy: 0.937500     test accuracy: 0.619381
Average cost in epoch 139: 0.209924
training accuracy: 0.921875     test accuracy: 0.629371

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 140: 0.193025
training accuracy: 0.968750     test accuracy: 0.622378
Average cost in epoch 141: 0.213642
training accuracy: 0.937500     test accuracy: 0.624376
Average cost in epoch 142: 0.183471
training accuracy: 0.937500     test accuracy: 0.606394
Average cost in epoch 143: 0.193580
training accuracy: 0.953125     test accuracy: 0.620380
Average cost in epoch 144: 0.190234
training accuracy: 0.984375     test accuracy: 0.618382

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 145: 0.201219
training accuracy: 0.984375     test accuracy: 0.633367
Average cost in epoch 146: 0.161361
training accuracy: 0.968750     test accuracy: 0.623377
Average cost in epoch 147: 0.223797
training accuracy: 0.921875     test accuracy: 0.629371
Average cost in epoch 148: 0.144354
training accuracy: 0.968750     test accuracy: 0.629371
Average cost in epoch 149: 0.210975
training accuracy: 0.937500     test accuracy: 0.619381

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 150: 0.172850
training accuracy: 0.953125     test accuracy: 0.627373
Average cost in epoch 151: 0.184988
training accuracy: 0.953125     test accuracy: 0.620380
Average cost in epoch 152: 0.167748
training accuracy: 0.906250     test accuracy: 0.618382
Average cost in epoch 153: 0.164104
training accuracy: 0.921875     test accuracy: 0.626374
Average cost in epoch 154: 0.190543
training accuracy: 0.937500     test accuracy: 0.616384

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 155: 0.149084
training accuracy: 0.953125     test accuracy: 0.618382
Average cost in epoch 156: 0.159797
training accuracy: 0.921875     test accuracy: 0.629371
Average cost in epoch 157: 0.159326
training accuracy: 0.984375     test accuracy: 0.610390
Average cost in epoch 158: 0.183336
training accuracy: 0.953125     test accuracy: 0.614386
Average cost in epoch 159: 0.175216
training accuracy: 1.000000     test accuracy: 0.604396

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 160: 0.165564
training accuracy: 0.953125     test accuracy: 0.606394
Average cost in epoch 161: 0.179629
training accuracy: 0.921875     test accuracy: 0.612388
Average cost in epoch 162: 0.177206
training accuracy: 0.906250     test accuracy: 0.613387
Average cost in epoch 163: 0.201152
training accuracy: 0.875000     test accuracy: 0.606394
Average cost in epoch 164: 0.160376
training accuracy: 0.953125     test accuracy: 0.611389

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 165: 0.192618
training accuracy: 0.937500     test accuracy: 0.611389
Average cost in epoch 166: 0.164672
training accuracy: 0.921875     test accuracy: 0.610390
Average cost in epoch 167: 0.165416
training accuracy: 0.937500     test accuracy: 0.611389
Average cost in epoch 168: 0.147965
training accuracy: 0.921875     test accuracy: 0.623377
Average cost in epoch 169: 0.169895
training accuracy: 0.937500     test accuracy: 0.621379

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 170: 0.142074
training accuracy: 0.968750     test accuracy: 0.623377
Average cost in epoch 171: 0.185172
training accuracy: 0.968750     test accuracy: 0.618382
Average cost in epoch 172: 0.176274
training accuracy: 0.953125     test accuracy: 0.618382
Average cost in epoch 173: 0.143099
training accuracy: 0.968750     test accuracy: 0.610390
Average cost in epoch 174: 0.142968
training accuracy: 0.906250     test accuracy: 0.621379

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 175: 0.149775
training accuracy: 0.921875     test accuracy: 0.625375
Average cost in epoch 176: 0.166048
training accuracy: 0.953125     test accuracy: 0.619381
Average cost in epoch 177: 0.158561
training accuracy: 0.968750     test accuracy: 0.621379
Average cost in epoch 178: 0.154448
training accuracy: 0.937500     test accuracy: 0.617383
Average cost in epoch 179: 0.148120
training accuracy: 0.921875     test accuracy: 0.618382

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 180: 0.130516
training accuracy: 0.921875     test accuracy: 0.625375
Average cost in epoch 181: 0.149482
training accuracy: 0.921875     test accuracy: 0.610390
Average cost in epoch 182: 0.137123
training accuracy: 0.968750     test accuracy: 0.619381
Average cost in epoch 183: 0.152724
training accuracy: 0.937500     test accuracy: 0.613387
Average cost in epoch 184: 0.133097
training accuracy: 0.953125     test accuracy: 0.620380

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 185: 0.169162
training accuracy: 0.890625     test accuracy: 0.619381
Average cost in epoch 186: 0.158041
training accuracy: 0.937500     test accuracy: 0.616384
Average cost in epoch 187: 0.191396
training accuracy: 0.984375     test accuracy: 0.616384
Average cost in epoch 188: 0.137241
training accuracy: 0.921875     test accuracy: 0.619381
Average cost in epoch 189: 0.122878
training accuracy: 0.953125     test accuracy: 0.614386

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 190: 0.147955
training accuracy: 0.984375     test accuracy: 0.613387
Average cost in epoch 191: 0.132081
training accuracy: 0.953125     test accuracy: 0.619381
Average cost in epoch 192: 0.126460
training accuracy: 0.953125     test accuracy: 0.618382
Average cost in epoch 193: 0.124695
training accuracy: 0.953125     test accuracy: 0.619381
Average cost in epoch 194: 0.135528
training accuracy: 0.984375     test accuracy: 0.621379

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Average cost in epoch 195: 0.159099
training accuracy: 0.953125     test accuracy: 0.627373
Average cost in epoch 196: 0.121298
training accuracy: 0.937500     test accuracy: 0.616384
Average cost in epoch 197: 0.108359
training accuracy: 0.921875     test accuracy: 0.626374
Average cost in epoch 198: 0.143302
training accuracy: 0.921875     test accuracy: 0.635365
Average cost in epoch 199: 0.136683
training accuracy: 1.000000     test accuracy: 0.620380

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_12.pkl

Locking... Timeout!
Please inspect system with 'dq-status' 'dq-free' etc.
INFO (theano.gof.compilelock): Waiting for existing lock by process '13401' (I am process '23218')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 13, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_13.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 98.28
Starting training...
Average cost in epoch 0: 1.721084
training accuracy: 0.875000     test accuracy: 0.944056
Average cost in epoch 1: 0.550119
training accuracy: 0.890625     test accuracy: 0.944056
Average cost in epoch 2: 0.468745
training accuracy: 0.937500     test accuracy: 0.944056
Average cost in epoch 3: 0.455718
training accuracy: 0.921875     test accuracy: 0.944056
Average cost in epoch 4: 0.418775
training accuracy: 0.953125     test accuracy: 0.944056

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 5: 0.435048
training accuracy: 0.984375     test accuracy: 0.944056
lr decays to 0.009000
Average cost in epoch 6: 0.445733
training accuracy: 0.953125     test accuracy: 0.944056
Average cost in epoch 7: 0.414816
training accuracy: 0.953125     test accuracy: 0.944056
Average cost in epoch 8: 0.424216
training accuracy: 0.921875     test accuracy: 0.944056
Average cost in epoch 9: 0.423923
training accuracy: 0.875000     test accuracy: 0.924076

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 10: 0.437572
training accuracy: 0.937500     test accuracy: 0.938062
lr decays to 0.008100
Average cost in epoch 11: 0.382098
training accuracy: 0.890625     test accuracy: 0.944056
Average cost in epoch 12: 0.377635
training accuracy: 0.921875     test accuracy: 0.944056
Average cost in epoch 13: 0.357373
training accuracy: 0.968750     test accuracy: 0.939061
Average cost in epoch 14: 0.322773
training accuracy: 0.953125     test accuracy: 0.944056

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 15: 0.374307
training accuracy: 0.937500     test accuracy: 0.944056
lr decays to 0.007290
Average cost in epoch 16: 0.303515
training accuracy: 0.875000     test accuracy: 0.940060
Average cost in epoch 17: 0.305563
training accuracy: 0.937500     test accuracy: 0.941059
Average cost in epoch 18: 0.316869
training accuracy: 0.843750     test accuracy: 0.924076
Average cost in epoch 19: 0.303780
training accuracy: 0.937500     test accuracy: 0.942058

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 20: 0.327730
training accuracy: 0.921875     test accuracy: 0.942058
lr decays to 0.006561
Average cost in epoch 21: 0.259671
training accuracy: 0.968750     test accuracy: 0.932068
Average cost in epoch 22: 0.269066
training accuracy: 0.906250     test accuracy: 0.934066
Average cost in epoch 23: 0.282336
training accuracy: 0.953125     test accuracy: 0.928072
Average cost in epoch 24: 0.254449
training accuracy: 0.937500     test accuracy: 0.938062

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 25: 0.265475
training accuracy: 0.968750     test accuracy: 0.940060
lr decays to 0.005905
Average cost in epoch 26: 0.253101
training accuracy: 0.921875     test accuracy: 0.933067
Average cost in epoch 27: 0.269342
training accuracy: 0.953125     test accuracy: 0.934066
Average cost in epoch 28: 0.241235
training accuracy: 0.984375     test accuracy: 0.937063
Average cost in epoch 29: 0.248735
training accuracy: 0.828125     test accuracy: 0.924076

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 30: 0.221309
training accuracy: 0.937500     test accuracy: 0.938062
lr decays to 0.005314
Average cost in epoch 31: 0.212883
training accuracy: 0.953125     test accuracy: 0.934066
Average cost in epoch 32: 0.216416
training accuracy: 0.968750     test accuracy: 0.925075
Average cost in epoch 33: 0.227187
training accuracy: 0.937500     test accuracy: 0.927073
Average cost in epoch 34: 0.195357
training accuracy: 0.906250     test accuracy: 0.932068

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 35: 0.234363
training accuracy: 0.968750     test accuracy: 0.921079
lr decays to 0.004783
Average cost in epoch 36: 0.230005
training accuracy: 0.953125     test accuracy: 0.927073
Average cost in epoch 37: 0.189166
training accuracy: 0.937500     test accuracy: 0.927073
Average cost in epoch 38: 0.209109
training accuracy: 0.937500     test accuracy: 0.937063
Average cost in epoch 39: 0.200713
training accuracy: 0.953125     test accuracy: 0.923077

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 40: 0.205204
training accuracy: 0.953125     test accuracy: 0.931069
lr decays to 0.004305
Average cost in epoch 41: 0.183046
training accuracy: 0.890625     test accuracy: 0.930070
Average cost in epoch 42: 0.189675
training accuracy: 0.968750     test accuracy: 0.923077
Average cost in epoch 43: 0.167321
training accuracy: 0.968750     test accuracy: 0.924076
Average cost in epoch 44: 0.163671
training accuracy: 0.937500     test accuracy: 0.929071

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 45: 0.151499
training accuracy: 0.984375     test accuracy: 0.928072
lr decays to 0.003874
Average cost in epoch 46: 0.170111
training accuracy: 0.984375     test accuracy: 0.923077
Average cost in epoch 47: 0.169138
training accuracy: 0.937500     test accuracy: 0.921079
Average cost in epoch 48: 0.158301
training accuracy: 0.953125     test accuracy: 0.925075
Average cost in epoch 49: 0.132331
training accuracy: 0.937500     test accuracy: 0.924076

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 50: 0.161789
training accuracy: 0.984375     test accuracy: 0.929071
lr decays to 0.003487
Average cost in epoch 51: 0.132963
training accuracy: 0.984375     test accuracy: 0.929071
Average cost in epoch 52: 0.158948
training accuracy: 0.953125     test accuracy: 0.926074
Average cost in epoch 53: 0.122097
training accuracy: 0.921875     test accuracy: 0.918082
Average cost in epoch 54: 0.101826
training accuracy: 0.984375     test accuracy: 0.923077

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 55: 0.136156
training accuracy: 0.968750     test accuracy: 0.928072
lr decays to 0.003138
Average cost in epoch 56: 0.137094
training accuracy: 0.953125     test accuracy: 0.928072
Average cost in epoch 57: 0.128632
training accuracy: 0.968750     test accuracy: 0.925075
Average cost in epoch 58: 0.131043
training accuracy: 0.921875     test accuracy: 0.925075
Average cost in epoch 59: 0.093082
training accuracy: 0.953125     test accuracy: 0.926074

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 60: 0.105945
training accuracy: 0.984375     test accuracy: 0.930070
lr decays to 0.002824
Average cost in epoch 61: 0.153139
training accuracy: 0.984375     test accuracy: 0.926074
Average cost in epoch 62: 0.113322
training accuracy: 0.953125     test accuracy: 0.925075
Average cost in epoch 63: 0.121169
training accuracy: 0.953125     test accuracy: 0.928072
Average cost in epoch 64: 0.067338
training accuracy: 0.968750     test accuracy: 0.933067

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 65: 0.118288
training accuracy: 0.953125     test accuracy: 0.929071
lr decays to 0.002542
Average cost in epoch 66: 0.099015
training accuracy: 0.968750     test accuracy: 0.930070
Average cost in epoch 67: 0.071594
training accuracy: 0.968750     test accuracy: 0.931069
Average cost in epoch 68: 0.142892
training accuracy: 0.968750     test accuracy: 0.928072
Average cost in epoch 69: 0.094145
training accuracy: 0.953125     test accuracy: 0.927073

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 70: 0.106203
training accuracy: 0.984375     test accuracy: 0.928072
lr decays to 0.002288
Average cost in epoch 71: 0.093135
training accuracy: 0.968750     test accuracy: 0.929071
Average cost in epoch 72: 0.060597
training accuracy: 0.968750     test accuracy: 0.930070
Average cost in epoch 73: 0.089616
training accuracy: 0.968750     test accuracy: 0.926074
Average cost in epoch 74: 0.114790
training accuracy: 1.000000     test accuracy: 0.930070

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 75: 0.070986
training accuracy: 1.000000     test accuracy: 0.933067
lr decays to 0.002059
Average cost in epoch 76: 0.119144
training accuracy: 0.968750     test accuracy: 0.927073
Average cost in epoch 77: 0.075371
training accuracy: 1.000000     test accuracy: 0.929071
Average cost in epoch 78: 0.078351
training accuracy: 0.937500     test accuracy: 0.931069
Average cost in epoch 79: 0.068787
training accuracy: 0.968750     test accuracy: 0.929071

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 80: 0.075736
training accuracy: 0.968750     test accuracy: 0.927073
lr decays to 0.001853
Average cost in epoch 81: 0.084158
training accuracy: 0.968750     test accuracy: 0.933067
Average cost in epoch 82: 0.055297
training accuracy: 0.953125     test accuracy: 0.932068
Average cost in epoch 83: 0.092811
training accuracy: 1.000000     test accuracy: 0.930070
Average cost in epoch 84: 0.074298
training accuracy: 0.968750     test accuracy: 0.932068

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 85: 0.078375
training accuracy: 0.984375     test accuracy: 0.929071
lr decays to 0.001668
Average cost in epoch 86: 0.081375
training accuracy: 0.968750     test accuracy: 0.932068
Average cost in epoch 87: 0.057061
training accuracy: 1.000000     test accuracy: 0.931069
Average cost in epoch 88: 0.051870
training accuracy: 0.906250     test accuracy: 0.930070
Average cost in epoch 89: 0.089259
training accuracy: 1.000000     test accuracy: 0.932068

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 90: 0.087393
training accuracy: 0.968750     test accuracy: 0.934066
lr decays to 0.001501
Average cost in epoch 91: 0.065355
training accuracy: 0.953125     test accuracy: 0.935065
Average cost in epoch 92: 0.067719
training accuracy: 1.000000     test accuracy: 0.929071
Average cost in epoch 93: 0.096214
training accuracy: 0.968750     test accuracy: 0.927073
Average cost in epoch 94: 0.038274
training accuracy: 0.953125     test accuracy: 0.932068

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 95: 0.047992
training accuracy: 1.000000     test accuracy: 0.929071
lr decays to 0.001351
Average cost in epoch 96: 0.076474
training accuracy: 0.984375     test accuracy: 0.930070
Average cost in epoch 97: 0.056466
training accuracy: 0.984375     test accuracy: 0.927073
Average cost in epoch 98: 0.062481
training accuracy: 0.968750     test accuracy: 0.928072
Average cost in epoch 99: 0.058388
training accuracy: 1.000000     test accuracy: 0.930070

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 100: 0.055252
training accuracy: 0.921875     test accuracy: 0.930070
lr decays to 0.001216
Average cost in epoch 101: 0.058597
training accuracy: 0.984375     test accuracy: 0.931069
Average cost in epoch 102: 0.056072
training accuracy: 0.984375     test accuracy: 0.930070
Average cost in epoch 103: 0.064501
training accuracy: 0.984375     test accuracy: 0.926074
Average cost in epoch 104: 0.066979
training accuracy: 0.984375     test accuracy: 0.925075

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 105: 0.065628
training accuracy: 0.968750     test accuracy: 0.924076
Average cost in epoch 106: 0.046574
training accuracy: 1.000000     test accuracy: 0.930070
Average cost in epoch 107: 0.043677
training accuracy: 1.000000     test accuracy: 0.929071
Average cost in epoch 108: 0.064339
training accuracy: 1.000000     test accuracy: 0.925075
Average cost in epoch 109: 0.063042
training accuracy: 0.984375     test accuracy: 0.928072

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 110: 0.029706
training accuracy: 1.000000     test accuracy: 0.926074
Average cost in epoch 111: 0.037666
training accuracy: 0.953125     test accuracy: 0.927073
Average cost in epoch 112: 0.071940
training accuracy: 0.953125     test accuracy: 0.928072
Average cost in epoch 113: 0.044305
training accuracy: 0.968750     test accuracy: 0.923077
Average cost in epoch 114: 0.041685
training accuracy: 0.984375     test accuracy: 0.926074

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 115: 0.033633
training accuracy: 0.968750     test accuracy: 0.924076
Average cost in epoch 116: 0.051124
training accuracy: 1.000000     test accuracy: 0.926074
Average cost in epoch 117: 0.041851
training accuracy: 0.953125     test accuracy: 0.927073
Average cost in epoch 118: 0.063160
training accuracy: 0.984375     test accuracy: 0.924076
Average cost in epoch 119: 0.031199
training accuracy: 0.984375     test accuracy: 0.923077

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 120: 0.054395
training accuracy: 1.000000     test accuracy: 0.931069
Average cost in epoch 121: 0.039967
training accuracy: 0.984375     test accuracy: 0.927073
Average cost in epoch 122: 0.049600
training accuracy: 0.968750     test accuracy: 0.926074
Average cost in epoch 123: 0.036488
training accuracy: 0.953125     test accuracy: 0.926074
Average cost in epoch 124: 0.048441
training accuracy: 1.000000     test accuracy: 0.930070

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 125: 0.029321
training accuracy: 0.984375     test accuracy: 0.928072
Average cost in epoch 126: 0.027726
training accuracy: 1.000000     test accuracy: 0.928072
Average cost in epoch 127: 0.036110
training accuracy: 0.968750     test accuracy: 0.928072
Average cost in epoch 128: 0.050111
training accuracy: 1.000000     test accuracy: 0.924076
Average cost in epoch 129: 0.038330
training accuracy: 0.984375     test accuracy: 0.924076

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 130: 0.046524
training accuracy: 0.984375     test accuracy: 0.925075
Average cost in epoch 131: 0.050822
training accuracy: 1.000000     test accuracy: 0.927073
Average cost in epoch 132: 0.043154
training accuracy: 1.000000     test accuracy: 0.926074
Average cost in epoch 133: 0.053116
training accuracy: 1.000000     test accuracy: 0.924076
Average cost in epoch 134: 0.034405
training accuracy: 0.984375     test accuracy: 0.929071

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 135: 0.038336
training accuracy: 0.968750     test accuracy: 0.922078
Average cost in epoch 136: 0.029971
training accuracy: 0.968750     test accuracy: 0.932068
Average cost in epoch 137: 0.035546
training accuracy: 1.000000     test accuracy: 0.926074
Average cost in epoch 138: 0.039468
training accuracy: 1.000000     test accuracy: 0.931069
Average cost in epoch 139: 0.039828
training accuracy: 0.968750     test accuracy: 0.928072

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 140: 0.043782
training accuracy: 1.000000     test accuracy: 0.929071
Average cost in epoch 141: 0.041509
training accuracy: 1.000000     test accuracy: 0.929071
Average cost in epoch 142: 0.044398
training accuracy: 1.000000     test accuracy: 0.925075
Average cost in epoch 143: 0.049154
training accuracy: 0.984375     test accuracy: 0.931069
Average cost in epoch 144: 0.033246
training accuracy: 0.984375     test accuracy: 0.926074

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 145: 0.036858
training accuracy: 0.984375     test accuracy: 0.928072
Average cost in epoch 146: 0.040046
training accuracy: 1.000000     test accuracy: 0.929071
Average cost in epoch 147: 0.027841
training accuracy: 1.000000     test accuracy: 0.928072
Average cost in epoch 148: 0.017618
training accuracy: 1.000000     test accuracy: 0.931069
Average cost in epoch 149: 0.038252
training accuracy: 0.984375     test accuracy: 0.929071

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 150: 0.037324
training accuracy: 1.000000     test accuracy: 0.933067
Average cost in epoch 151: 0.035575
training accuracy: 1.000000     test accuracy: 0.931069
Average cost in epoch 152: 0.046288
training accuracy: 1.000000     test accuracy: 0.928072
Average cost in epoch 153: 0.029199
training accuracy: 1.000000     test accuracy: 0.921079
Average cost in epoch 154: 0.032449
training accuracy: 1.000000     test accuracy: 0.924076

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 155: 0.025727
training accuracy: 1.000000     test accuracy: 0.920080
Average cost in epoch 156: 0.026574
training accuracy: 0.984375     test accuracy: 0.928072
Average cost in epoch 157: 0.039823
training accuracy: 0.984375     test accuracy: 0.920080
Average cost in epoch 158: 0.021160
training accuracy: 1.000000     test accuracy: 0.930070
Average cost in epoch 159: 0.023065
training accuracy: 1.000000     test accuracy: 0.924076

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 160: 0.026971
training accuracy: 0.984375     test accuracy: 0.928072
Average cost in epoch 161: 0.021265
training accuracy: 0.968750     test accuracy: 0.929071
Average cost in epoch 162: 0.044885
training accuracy: 0.984375     test accuracy: 0.924076
Average cost in epoch 163: 0.036734
training accuracy: 1.000000     test accuracy: 0.922078
Average cost in epoch 164: 0.030729
training accuracy: 1.000000     test accuracy: 0.923077

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 165: 0.016564
training accuracy: 0.984375     test accuracy: 0.924076
Average cost in epoch 166: 0.029286
training accuracy: 0.984375     test accuracy: 0.928072
Average cost in epoch 167: 0.021885
training accuracy: 0.968750     test accuracy: 0.925075
Average cost in epoch 168: 0.030334
training accuracy: 1.000000     test accuracy: 0.926074
Average cost in epoch 169: 0.026231
training accuracy: 0.984375     test accuracy: 0.929071

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 170: 0.031228
training accuracy: 1.000000     test accuracy: 0.931069
Average cost in epoch 171: 0.039275
training accuracy: 0.984375     test accuracy: 0.925075
Average cost in epoch 172: 0.027921
training accuracy: 1.000000     test accuracy: 0.922078
Average cost in epoch 173: 0.034852
training accuracy: 0.984375     test accuracy: 0.924076
Average cost in epoch 174: 0.031815
training accuracy: 0.968750     test accuracy: 0.927073

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 175: 0.020728
training accuracy: 0.984375     test accuracy: 0.927073
Average cost in epoch 176: 0.028390
training accuracy: 0.984375     test accuracy: 0.925075
Average cost in epoch 177: 0.021292
training accuracy: 1.000000     test accuracy: 0.923077
Average cost in epoch 178: 0.022369
training accuracy: 0.984375     test accuracy: 0.923077
Average cost in epoch 179: 0.022507
training accuracy: 0.984375     test accuracy: 0.925075

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 180: 0.031870
training accuracy: 1.000000     test accuracy: 0.923077
Average cost in epoch 181: 0.022502
training accuracy: 1.000000     test accuracy: 0.922078
Average cost in epoch 182: 0.029466
training accuracy: 1.000000     test accuracy: 0.927073
Average cost in epoch 183: 0.044237
training accuracy: 1.000000     test accuracy: 0.917083
Average cost in epoch 184: 0.026894
training accuracy: 1.000000     test accuracy: 0.922078

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 185: 0.016088
training accuracy: 1.000000     test accuracy: 0.926074
Average cost in epoch 186: 0.028973
training accuracy: 0.984375     test accuracy: 0.927073
Average cost in epoch 187: 0.018009
training accuracy: 0.968750     test accuracy: 0.925075
Average cost in epoch 188: 0.039203
training accuracy: 1.000000     test accuracy: 0.928072
Average cost in epoch 189: 0.016532
training accuracy: 0.984375     test accuracy: 0.922078

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 190: 0.032178
training accuracy: 1.000000     test accuracy: 0.923077
Average cost in epoch 191: 0.028069
training accuracy: 1.000000     test accuracy: 0.923077
Average cost in epoch 192: 0.026930
training accuracy: 0.984375     test accuracy: 0.919081
Average cost in epoch 193: 0.022879
training accuracy: 0.984375     test accuracy: 0.921079
Average cost in epoch 194: 0.027761
training accuracy: 1.000000     test accuracy: 0.919081

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Average cost in epoch 195: 0.031300
training accuracy: 0.984375     test accuracy: 0.928072
Average cost in epoch 196: 0.019030
training accuracy: 0.984375     test accuracy: 0.924076
Average cost in epoch 197: 0.021908
training accuracy: 1.000000     test accuracy: 0.922078
Average cost in epoch 198: 0.016919
training accuracy: 1.000000     test accuracy: 0.927073
Average cost in epoch 199: 0.037870
training accuracy: 1.000000     test accuracy: 0.925075

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_13.pkl

Locking... Timeout!
Please inspect system with 'dq-status' 'dq-free' etc.
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 14, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_14.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 96.80
Starting training...
Average cost in epoch 0: 2.178063
training accuracy: 0.218750     test accuracy: 0.161838
Average cost in epoch 1: 1.877652
training accuracy: 0.156250     test accuracy: 0.176823
Average cost in epoch 2: 1.829521
training accuracy: 0.109375     test accuracy: 0.199800
Average cost in epoch 3: 1.821157
training accuracy: 0.140625     test accuracy: 0.205794
Average cost in epoch 4: 1.805145
training accuracy: 0.218750     test accuracy: 0.187812

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 5: 1.775499
training accuracy: 0.281250     test accuracy: 0.226773
lr decays to 0.009000
Average cost in epoch 6: 1.752767
training accuracy: 0.250000     test accuracy: 0.206793
Average cost in epoch 7: 1.731871
training accuracy: 0.359375     test accuracy: 0.221778
Average cost in epoch 8: 1.741251
training accuracy: 0.218750     test accuracy: 0.251748
Average cost in epoch 9: 1.704040
training accuracy: 0.281250     test accuracy: 0.204795

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 10: 1.726433
training accuracy: 0.343750     test accuracy: 0.245754
lr decays to 0.008100
Average cost in epoch 11: 1.690755
training accuracy: 0.218750     test accuracy: 0.271728
Average cost in epoch 12: 1.696837
training accuracy: 0.328125     test accuracy: 0.263736
Average cost in epoch 13: 1.663494
training accuracy: 0.312500     test accuracy: 0.243756
Average cost in epoch 14: 1.676948
training accuracy: 0.312500     test accuracy: 0.246753

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 15: 1.681122
training accuracy: 0.328125     test accuracy: 0.290709
lr decays to 0.007290
Average cost in epoch 16: 1.643294
training accuracy: 0.250000     test accuracy: 0.297702
Average cost in epoch 17: 1.615779
training accuracy: 0.312500     test accuracy: 0.277722
Average cost in epoch 18: 1.625367
training accuracy: 0.312500     test accuracy: 0.268731
Average cost in epoch 19: 1.624065
training accuracy: 0.437500     test accuracy: 0.308691

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 20: 1.632398
training accuracy: 0.296875     test accuracy: 0.315684
lr decays to 0.006561
Average cost in epoch 21: 1.602869
training accuracy: 0.343750     test accuracy: 0.298701
Average cost in epoch 22: 1.566090
training accuracy: 0.359375     test accuracy: 0.308691
Average cost in epoch 23: 1.570647
training accuracy: 0.359375     test accuracy: 0.331668
Average cost in epoch 24: 1.569161
training accuracy: 0.437500     test accuracy: 0.317682

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 25: 1.532119
training accuracy: 0.281250     test accuracy: 0.320679
lr decays to 0.005905
Average cost in epoch 26: 1.559937
training accuracy: 0.359375     test accuracy: 0.334665
Average cost in epoch 27: 1.554125
training accuracy: 0.468750     test accuracy: 0.329670
Average cost in epoch 28: 1.494852
training accuracy: 0.406250     test accuracy: 0.327672
Average cost in epoch 29: 1.519280
training accuracy: 0.359375     test accuracy: 0.337662

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 30: 1.507767
training accuracy: 0.406250     test accuracy: 0.328671
lr decays to 0.005314
Average cost in epoch 31: 1.479746
training accuracy: 0.421875     test accuracy: 0.339660
Average cost in epoch 32: 1.481971
training accuracy: 0.390625     test accuracy: 0.306693
Average cost in epoch 33: 1.466695
training accuracy: 0.437500     test accuracy: 0.336663
Average cost in epoch 34: 1.496292
training accuracy: 0.453125     test accuracy: 0.342657

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 35: 1.427677
training accuracy: 0.484375     test accuracy: 0.314685
lr decays to 0.004783
Average cost in epoch 36: 1.426596
training accuracy: 0.437500     test accuracy: 0.342657
Average cost in epoch 37: 1.438237
training accuracy: 0.453125     test accuracy: 0.330669
Average cost in epoch 38: 1.430678
training accuracy: 0.406250     test accuracy: 0.327672
Average cost in epoch 39: 1.445801
training accuracy: 0.437500     test accuracy: 0.343656

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 40: 1.463749
training accuracy: 0.343750     test accuracy: 0.345654
lr decays to 0.004305
Average cost in epoch 41: 1.448682
training accuracy: 0.312500     test accuracy: 0.337662
Average cost in epoch 42: 1.434541
training accuracy: 0.406250     test accuracy: 0.337662
Average cost in epoch 43: 1.420378
training accuracy: 0.468750     test accuracy: 0.327672
Average cost in epoch 44: 1.416928
training accuracy: 0.468750     test accuracy: 0.345654

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 45: 1.425254
training accuracy: 0.437500     test accuracy: 0.334665
lr decays to 0.003874
Average cost in epoch 46: 1.369852
training accuracy: 0.453125     test accuracy: 0.339660
Average cost in epoch 47: 1.412992
training accuracy: 0.390625     test accuracy: 0.344655
Average cost in epoch 48: 1.333098
training accuracy: 0.578125     test accuracy: 0.349650
Average cost in epoch 49: 1.324763
training accuracy: 0.500000     test accuracy: 0.344655

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 50: 1.331736
training accuracy: 0.468750     test accuracy: 0.341658
lr decays to 0.003487
Average cost in epoch 51: 1.327214
training accuracy: 0.500000     test accuracy: 0.339660
Average cost in epoch 52: 1.318420
training accuracy: 0.453125     test accuracy: 0.323676
Average cost in epoch 53: 1.324069
training accuracy: 0.531250     test accuracy: 0.340659
Average cost in epoch 54: 1.356051
training accuracy: 0.500000     test accuracy: 0.336663

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 55: 1.357880
training accuracy: 0.562500     test accuracy: 0.340659
lr decays to 0.003138
Average cost in epoch 56: 1.285083
training accuracy: 0.484375     test accuracy: 0.338661
Average cost in epoch 57: 1.342318
training accuracy: 0.468750     test accuracy: 0.329670
Average cost in epoch 58: 1.283947
training accuracy: 0.562500     test accuracy: 0.340659
Average cost in epoch 59: 1.290905
training accuracy: 0.578125     test accuracy: 0.349650

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 60: 1.281811
training accuracy: 0.593750     test accuracy: 0.349650
lr decays to 0.002824
Average cost in epoch 61: 1.275846
training accuracy: 0.468750     test accuracy: 0.334665
Average cost in epoch 62: 1.261875
training accuracy: 0.531250     test accuracy: 0.355644
Average cost in epoch 63: 1.277095
training accuracy: 0.406250     test accuracy: 0.344655
Average cost in epoch 64: 1.272608
training accuracy: 0.531250     test accuracy: 0.337662

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 65: 1.236235
training accuracy: 0.500000     test accuracy: 0.340659
lr decays to 0.002542
Average cost in epoch 66: 1.182120
training accuracy: 0.515625     test accuracy: 0.344655
Average cost in epoch 67: 1.228636
training accuracy: 0.390625     test accuracy: 0.323676
Average cost in epoch 68: 1.308911
training accuracy: 0.515625     test accuracy: 0.341658
Average cost in epoch 69: 1.212409
training accuracy: 0.546875     test accuracy: 0.338661

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 70: 1.198933
training accuracy: 0.546875     test accuracy: 0.330669
lr decays to 0.002288
Average cost in epoch 71: 1.221552
training accuracy: 0.578125     test accuracy: 0.346653
Average cost in epoch 72: 1.215654
training accuracy: 0.531250     test accuracy: 0.358641
Average cost in epoch 73: 1.172333
training accuracy: 0.468750     test accuracy: 0.355644
Average cost in epoch 74: 1.254767
training accuracy: 0.609375     test accuracy: 0.341658

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 75: 1.149024
training accuracy: 0.593750     test accuracy: 0.344655
lr decays to 0.002059
Average cost in epoch 76: 1.189310
training accuracy: 0.515625     test accuracy: 0.338661
Average cost in epoch 77: 1.168152
training accuracy: 0.562500     test accuracy: 0.345654
Average cost in epoch 78: 1.167913
training accuracy: 0.593750     test accuracy: 0.343656
Average cost in epoch 79: 1.188207
training accuracy: 0.562500     test accuracy: 0.352647

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 80: 1.192000
training accuracy: 0.546875     test accuracy: 0.352647
lr decays to 0.001853
Average cost in epoch 81: 1.151927
training accuracy: 0.531250     test accuracy: 0.345654
Average cost in epoch 82: 1.173364
training accuracy: 0.531250     test accuracy: 0.346653
Average cost in epoch 83: 1.154068
training accuracy: 0.578125     test accuracy: 0.350649
Average cost in epoch 84: 1.138936
training accuracy: 0.484375     test accuracy: 0.338661

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 85: 1.128626
training accuracy: 0.531250     test accuracy: 0.349650
lr decays to 0.001668
Average cost in epoch 86: 1.121198
training accuracy: 0.593750     test accuracy: 0.355644
Average cost in epoch 87: 1.140572
training accuracy: 0.578125     test accuracy: 0.335664
Average cost in epoch 88: 1.140581
training accuracy: 0.546875     test accuracy: 0.352647
Average cost in epoch 89: 1.133541
training accuracy: 0.531250     test accuracy: 0.348651

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 90: 1.109551
training accuracy: 0.515625     test accuracy: 0.356643
lr decays to 0.001501
Average cost in epoch 91: 1.124426
training accuracy: 0.640625     test accuracy: 0.352647
Average cost in epoch 92: 1.098969
training accuracy: 0.515625     test accuracy: 0.334665
Average cost in epoch 93: 1.081123
training accuracy: 0.546875     test accuracy: 0.347652
Average cost in epoch 94: 1.111060
training accuracy: 0.609375     test accuracy: 0.345654

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 95: 1.103235
training accuracy: 0.578125     test accuracy: 0.348651
lr decays to 0.001351
Average cost in epoch 96: 1.092181
training accuracy: 0.484375     test accuracy: 0.348651
Average cost in epoch 97: 1.081127
training accuracy: 0.562500     test accuracy: 0.347652
Average cost in epoch 98: 1.076433
training accuracy: 0.609375     test accuracy: 0.355644
Average cost in epoch 99: 1.121980
training accuracy: 0.531250     test accuracy: 0.347652

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 100: 1.071925
training accuracy: 0.546875     test accuracy: 0.355644
lr decays to 0.001216
Average cost in epoch 101: 1.122750
training accuracy: 0.640625     test accuracy: 0.347652
Average cost in epoch 102: 1.046280
training accuracy: 0.593750     test accuracy: 0.336663
Average cost in epoch 103: 1.109157
training accuracy: 0.578125     test accuracy: 0.342657
Average cost in epoch 104: 1.078073
training accuracy: 0.578125     test accuracy: 0.339660

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 105: 1.079293
training accuracy: 0.484375     test accuracy: 0.347652
Average cost in epoch 106: 1.015595
training accuracy: 0.734375     test accuracy: 0.337662
Average cost in epoch 107: 1.055853
training accuracy: 0.500000     test accuracy: 0.331668
Average cost in epoch 108: 1.054333
training accuracy: 0.625000     test accuracy: 0.340659
Average cost in epoch 109: 1.084289
training accuracy: 0.562500     test accuracy: 0.350649

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 110: 1.044154
training accuracy: 0.640625     test accuracy: 0.342657
Average cost in epoch 111: 1.042659
training accuracy: 0.593750     test accuracy: 0.345654
Average cost in epoch 112: 1.021175
training accuracy: 0.640625     test accuracy: 0.342657
Average cost in epoch 113: 1.023899
training accuracy: 0.609375     test accuracy: 0.355644
Average cost in epoch 114: 1.029605
training accuracy: 0.718750     test accuracy: 0.350649

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 115: 1.017582
training accuracy: 0.609375     test accuracy: 0.335664
Average cost in epoch 116: 1.022023
training accuracy: 0.562500     test accuracy: 0.334665
Average cost in epoch 117: 1.033546
training accuracy: 0.625000     test accuracy: 0.342657
Average cost in epoch 118: 1.048331
training accuracy: 0.546875     test accuracy: 0.346653
Average cost in epoch 119: 1.008257
training accuracy: 0.609375     test accuracy: 0.348651

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 120: 1.015117
training accuracy: 0.515625     test accuracy: 0.347652
Average cost in epoch 121: 1.018634
training accuracy: 0.625000     test accuracy: 0.339660
Average cost in epoch 122: 1.026693
training accuracy: 0.656250     test accuracy: 0.335664
Average cost in epoch 123: 0.993892
training accuracy: 0.593750     test accuracy: 0.328671
Average cost in epoch 124: 1.055695
training accuracy: 0.640625     test accuracy: 0.339660

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 125: 1.007727
training accuracy: 0.578125     test accuracy: 0.347652
Average cost in epoch 126: 1.033209
training accuracy: 0.703125     test accuracy: 0.341658
Average cost in epoch 127: 1.018632
training accuracy: 0.515625     test accuracy: 0.349650
Average cost in epoch 128: 1.040741
training accuracy: 0.640625     test accuracy: 0.341658
Average cost in epoch 129: 1.001881
training accuracy: 0.640625     test accuracy: 0.341658

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 130: 1.024111
training accuracy: 0.671875     test accuracy: 0.331668
Average cost in epoch 131: 1.013458
training accuracy: 0.656250     test accuracy: 0.341658
Average cost in epoch 132: 1.001562
training accuracy: 0.593750     test accuracy: 0.332667
Average cost in epoch 133: 1.010697
training accuracy: 0.656250     test accuracy: 0.342657
Average cost in epoch 134: 1.014139
training accuracy: 0.734375     test accuracy: 0.336663

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 135: 0.983631
training accuracy: 0.625000     test accuracy: 0.341658
Average cost in epoch 136: 1.005307
training accuracy: 0.531250     test accuracy: 0.334665
Average cost in epoch 137: 0.995889
training accuracy: 0.593750     test accuracy: 0.343656
Average cost in epoch 138: 1.000606
training accuracy: 0.484375     test accuracy: 0.333666
Average cost in epoch 139: 0.974401
training accuracy: 0.687500     test accuracy: 0.333666

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 140: 0.979843
training accuracy: 0.515625     test accuracy: 0.345654
Average cost in epoch 141: 0.969969
training accuracy: 0.671875     test accuracy: 0.319680
Average cost in epoch 142: 0.988981
training accuracy: 0.625000     test accuracy: 0.337662
Average cost in epoch 143: 0.971481
training accuracy: 0.750000     test accuracy: 0.339660
Average cost in epoch 144: 0.981607
training accuracy: 0.640625     test accuracy: 0.343656

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 145: 0.976659
training accuracy: 0.671875     test accuracy: 0.338661
Average cost in epoch 146: 1.003488
training accuracy: 0.562500     test accuracy: 0.328671
Average cost in epoch 147: 0.995600
training accuracy: 0.640625     test accuracy: 0.320679
Average cost in epoch 148: 0.989351
training accuracy: 0.531250     test accuracy: 0.329670
Average cost in epoch 149: 0.951685
training accuracy: 0.578125     test accuracy: 0.322677

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 150: 0.999624
training accuracy: 0.703125     test accuracy: 0.328671
Average cost in epoch 151: 0.951521
training accuracy: 0.609375     test accuracy: 0.337662
Average cost in epoch 152: 1.002258
training accuracy: 0.578125     test accuracy: 0.346653
Average cost in epoch 153: 0.965930
training accuracy: 0.625000     test accuracy: 0.332667
Average cost in epoch 154: 0.985274
training accuracy: 0.718750     test accuracy: 0.326673

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 155: 0.960953
training accuracy: 0.609375     test accuracy: 0.326673
Average cost in epoch 156: 0.950998
training accuracy: 0.609375     test accuracy: 0.339660
Average cost in epoch 157: 0.958961
training accuracy: 0.531250     test accuracy: 0.346653
Average cost in epoch 158: 0.882667
training accuracy: 0.671875     test accuracy: 0.337662
Average cost in epoch 159: 1.015591
training accuracy: 0.609375     test accuracy: 0.335664

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 160: 0.993094
training accuracy: 0.640625     test accuracy: 0.336663
Average cost in epoch 161: 0.945180
training accuracy: 0.687500     test accuracy: 0.336663
Average cost in epoch 162: 0.925212
training accuracy: 0.593750     test accuracy: 0.339660
Average cost in epoch 163: 0.928786
training accuracy: 0.578125     test accuracy: 0.341658
Average cost in epoch 164: 0.928068
training accuracy: 0.593750     test accuracy: 0.335664

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 165: 0.950945
training accuracy: 0.656250     test accuracy: 0.329670
Average cost in epoch 166: 0.938041
training accuracy: 0.609375     test accuracy: 0.328671
Average cost in epoch 167: 0.947483
training accuracy: 0.671875     test accuracy: 0.335664
Average cost in epoch 168: 0.949717
training accuracy: 0.593750     test accuracy: 0.330669
Average cost in epoch 169: 0.922436
training accuracy: 0.609375     test accuracy: 0.337662

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 170: 0.887850
training accuracy: 0.640625     test accuracy: 0.326673
Average cost in epoch 171: 0.936606
training accuracy: 0.687500     test accuracy: 0.323676
Average cost in epoch 172: 0.931343
training accuracy: 0.718750     test accuracy: 0.337662
Average cost in epoch 173: 0.938529
training accuracy: 0.687500     test accuracy: 0.332667
Average cost in epoch 174: 0.949447
training accuracy: 0.656250     test accuracy: 0.335664

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 175: 0.934281
training accuracy: 0.625000     test accuracy: 0.331668
Average cost in epoch 176: 0.899378
training accuracy: 0.687500     test accuracy: 0.325674
Average cost in epoch 177: 0.936905
training accuracy: 0.734375     test accuracy: 0.339660
Average cost in epoch 178: 0.918898
training accuracy: 0.640625     test accuracy: 0.319680
Average cost in epoch 179: 0.914503
training accuracy: 0.687500     test accuracy: 0.329670

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 180: 0.946993
training accuracy: 0.593750     test accuracy: 0.333666
Average cost in epoch 181: 0.918326
training accuracy: 0.671875     test accuracy: 0.331668
Average cost in epoch 182: 0.924667
training accuracy: 0.640625     test accuracy: 0.325674
Average cost in epoch 183: 0.956278
training accuracy: 0.656250     test accuracy: 0.332667
Average cost in epoch 184: 0.844510
training accuracy: 0.718750     test accuracy: 0.325674

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 185: 0.898628
training accuracy: 0.671875     test accuracy: 0.334665
Average cost in epoch 186: 0.901958
training accuracy: 0.640625     test accuracy: 0.321678
Average cost in epoch 187: 0.911093
training accuracy: 0.640625     test accuracy: 0.329670
Average cost in epoch 188: 0.897419
training accuracy: 0.859375     test accuracy: 0.314685
Average cost in epoch 189: 0.899681
training accuracy: 0.546875     test accuracy: 0.336663

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 190: 0.843106
training accuracy: 0.765625     test accuracy: 0.321678
Average cost in epoch 191: 0.950964
training accuracy: 0.671875     test accuracy: 0.330669
Average cost in epoch 192: 0.853775
training accuracy: 0.578125     test accuracy: 0.326673
Average cost in epoch 193: 0.885964
training accuracy: 0.718750     test accuracy: 0.340659
Average cost in epoch 194: 0.870439
training accuracy: 0.640625     test accuracy: 0.334665

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Average cost in epoch 195: 0.843875
training accuracy: 0.687500     test accuracy: 0.325674
Average cost in epoch 196: 0.878965
training accuracy: 0.546875     test accuracy: 0.324675
Average cost in epoch 197: 0.889567
training accuracy: 0.671875     test accuracy: 0.335664
Average cost in epoch 198: 0.934998
training accuracy: 0.656250     test accuracy: 0.331668
Average cost in epoch 199: 0.887621
training accuracy: 0.765625     test accuracy: 0.331668

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_14.pkl

Locking... locked.
No job requests to schedule
INFO (theano.gof.compilelock): Waiting for existing lock by process '23385' (I am process '23609')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 15, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_15.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 90.26
Starting training...
Average cost in epoch 0: 1.786604
training accuracy: 0.250000     test accuracy: 0.212787
Average cost in epoch 1: 1.411299
training accuracy: 0.234375     test accuracy: 0.238761
Average cost in epoch 2: 1.436417
training accuracy: 0.421875     test accuracy: 0.212787
Average cost in epoch 3: 1.415740
training accuracy: 0.234375     test accuracy: 0.336663
Average cost in epoch 4: 1.404280
training accuracy: 0.328125     test accuracy: 0.212787

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 5: 1.403446
training accuracy: 0.187500     test accuracy: 0.219780
lr decays to 0.009000
Average cost in epoch 6: 1.388489
training accuracy: 0.281250     test accuracy: 0.202797
Average cost in epoch 7: 1.377759
training accuracy: 0.281250     test accuracy: 0.223776
Average cost in epoch 8: 1.386601
training accuracy: 0.265625     test accuracy: 0.289710
Average cost in epoch 9: 1.388433
training accuracy: 0.250000     test accuracy: 0.235764

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 10: 1.368419
training accuracy: 0.265625     test accuracy: 0.226773
lr decays to 0.008100
Average cost in epoch 11: 1.374086
training accuracy: 0.265625     test accuracy: 0.254745
Average cost in epoch 12: 1.357939
training accuracy: 0.421875     test accuracy: 0.261738
Average cost in epoch 13: 1.347629
training accuracy: 0.484375     test accuracy: 0.297702
Average cost in epoch 14: 1.325936
training accuracy: 0.390625     test accuracy: 0.346653

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 15: 1.290396
training accuracy: 0.390625     test accuracy: 0.268731
lr decays to 0.007290
Average cost in epoch 16: 1.298017
training accuracy: 0.390625     test accuracy: 0.292707
Average cost in epoch 17: 1.270952
training accuracy: 0.406250     test accuracy: 0.311688
Average cost in epoch 18: 1.273163
training accuracy: 0.453125     test accuracy: 0.324675
Average cost in epoch 19: 1.234847
training accuracy: 0.562500     test accuracy: 0.405594

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 20: 1.207621
training accuracy: 0.390625     test accuracy: 0.368631
lr decays to 0.006561
Average cost in epoch 21: 1.229036
training accuracy: 0.406250     test accuracy: 0.347652
Average cost in epoch 22: 1.185913
training accuracy: 0.453125     test accuracy: 0.386613
Average cost in epoch 23: 1.184506
training accuracy: 0.531250     test accuracy: 0.383616
Average cost in epoch 24: 1.177195
training accuracy: 0.656250     test accuracy: 0.401598

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 25: 1.148516
training accuracy: 0.546875     test accuracy: 0.409590
lr decays to 0.005905
Average cost in epoch 26: 1.150537
training accuracy: 0.609375     test accuracy: 0.396603
Average cost in epoch 27: 1.104877
training accuracy: 0.593750     test accuracy: 0.437562
Average cost in epoch 28: 1.132701
training accuracy: 0.468750     test accuracy: 0.432567
Average cost in epoch 29: 1.082863
training accuracy: 0.546875     test accuracy: 0.428571

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 30: 1.079123
training accuracy: 0.421875     test accuracy: 0.423576
lr decays to 0.005314
Average cost in epoch 31: 1.079178
training accuracy: 0.468750     test accuracy: 0.447552
Average cost in epoch 32: 1.073227
training accuracy: 0.640625     test accuracy: 0.417582
Average cost in epoch 33: 1.039482
training accuracy: 0.562500     test accuracy: 0.413586
Average cost in epoch 34: 1.026010
training accuracy: 0.453125     test accuracy: 0.446553

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 35: 1.046765
training accuracy: 0.578125     test accuracy: 0.399600
lr decays to 0.004783
Average cost in epoch 36: 0.985197
training accuracy: 0.531250     test accuracy: 0.432567
Average cost in epoch 37: 0.991720
training accuracy: 0.562500     test accuracy: 0.443556
Average cost in epoch 38: 1.012609
training accuracy: 0.562500     test accuracy: 0.429570
Average cost in epoch 39: 0.998001
training accuracy: 0.609375     test accuracy: 0.396603

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 40: 0.965644
training accuracy: 0.625000     test accuracy: 0.424575
lr decays to 0.004305
Average cost in epoch 41: 0.936909
training accuracy: 0.593750     test accuracy: 0.389610
Average cost in epoch 42: 0.959760
training accuracy: 0.500000     test accuracy: 0.390609
Average cost in epoch 43: 0.958649
training accuracy: 0.578125     test accuracy: 0.415584
Average cost in epoch 44: 0.938148
training accuracy: 0.671875     test accuracy: 0.411588

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 45: 0.954117
training accuracy: 0.671875     test accuracy: 0.422577
lr decays to 0.003874
Average cost in epoch 46: 0.935541
training accuracy: 0.640625     test accuracy: 0.442557
Average cost in epoch 47: 0.932399
training accuracy: 0.671875     test accuracy: 0.460539
Average cost in epoch 48: 0.910575
training accuracy: 0.750000     test accuracy: 0.418581
Average cost in epoch 49: 0.919429
training accuracy: 0.625000     test accuracy: 0.405594

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 50: 0.913352
training accuracy: 0.703125     test accuracy: 0.426573
lr decays to 0.003487
Average cost in epoch 51: 0.878194
training accuracy: 0.656250     test accuracy: 0.433566
Average cost in epoch 52: 0.873637
training accuracy: 0.625000     test accuracy: 0.425574
Average cost in epoch 53: 0.891666
training accuracy: 0.656250     test accuracy: 0.418581
Average cost in epoch 54: 0.875903
training accuracy: 0.750000     test accuracy: 0.430569

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 55: 0.863189
training accuracy: 0.640625     test accuracy: 0.411588
lr decays to 0.003138
Average cost in epoch 56: 0.856552
training accuracy: 0.625000     test accuracy: 0.401598
Average cost in epoch 57: 0.874370
training accuracy: 0.687500     test accuracy: 0.431568
Average cost in epoch 58: 0.869697
training accuracy: 0.625000     test accuracy: 0.452547
Average cost in epoch 59: 0.860720
training accuracy: 0.562500     test accuracy: 0.439560

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 60: 0.871959
training accuracy: 0.578125     test accuracy: 0.396603
lr decays to 0.002824
Average cost in epoch 61: 0.868774
training accuracy: 0.671875     test accuracy: 0.447552
Average cost in epoch 62: 0.830620
training accuracy: 0.625000     test accuracy: 0.417582
Average cost in epoch 63: 0.818841
training accuracy: 0.703125     test accuracy: 0.434565
Average cost in epoch 64: 0.885143
training accuracy: 0.750000     test accuracy: 0.439560

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 65: 0.844720
training accuracy: 0.765625     test accuracy: 0.433566
lr decays to 0.002542
Average cost in epoch 66: 0.835389
training accuracy: 0.687500     test accuracy: 0.430569
Average cost in epoch 67: 0.844333
training accuracy: 0.640625     test accuracy: 0.440559
Average cost in epoch 68: 0.812590
training accuracy: 0.625000     test accuracy: 0.429570
Average cost in epoch 69: 0.847286
training accuracy: 0.703125     test accuracy: 0.423576

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 70: 0.860194
training accuracy: 0.640625     test accuracy: 0.433566
lr decays to 0.002288
Average cost in epoch 71: 0.819978
training accuracy: 0.750000     test accuracy: 0.423576
Average cost in epoch 72: 0.807149
training accuracy: 0.656250     test accuracy: 0.429570
Average cost in epoch 73: 0.860050
training accuracy: 0.703125     test accuracy: 0.433566
Average cost in epoch 74: 0.799291
training accuracy: 0.609375     test accuracy: 0.409590

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 75: 0.828036
training accuracy: 0.671875     test accuracy: 0.419580
lr decays to 0.002059
Average cost in epoch 76: 0.796531
training accuracy: 0.750000     test accuracy: 0.441558
Average cost in epoch 77: 0.809537
training accuracy: 0.640625     test accuracy: 0.433566
Average cost in epoch 78: 0.809074
training accuracy: 0.734375     test accuracy: 0.416583
Average cost in epoch 79: 0.808238
training accuracy: 0.656250     test accuracy: 0.433566

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 80: 0.795164
training accuracy: 0.718750     test accuracy: 0.430569
lr decays to 0.001853
Average cost in epoch 81: 0.814239
training accuracy: 0.750000     test accuracy: 0.453546
Average cost in epoch 82: 0.814442
training accuracy: 0.718750     test accuracy: 0.428571
Average cost in epoch 83: 0.753262
training accuracy: 0.703125     test accuracy: 0.446553
Average cost in epoch 84: 0.825083
training accuracy: 0.640625     test accuracy: 0.445554

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 85: 0.814361
training accuracy: 0.687500     test accuracy: 0.444555
lr decays to 0.001668
Average cost in epoch 86: 0.800157
training accuracy: 0.640625     test accuracy: 0.441558
Average cost in epoch 87: 0.771098
training accuracy: 0.609375     test accuracy: 0.438561
Average cost in epoch 88: 0.759746
training accuracy: 0.656250     test accuracy: 0.433566
Average cost in epoch 89: 0.754782
training accuracy: 0.734375     test accuracy: 0.430569

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 90: 0.824674
training accuracy: 0.703125     test accuracy: 0.443556
lr decays to 0.001501
Average cost in epoch 91: 0.769703
training accuracy: 0.656250     test accuracy: 0.444555
Average cost in epoch 92: 0.772824
training accuracy: 0.671875     test accuracy: 0.448551
Average cost in epoch 93: 0.757368
training accuracy: 0.656250     test accuracy: 0.443556
Average cost in epoch 94: 0.803001
training accuracy: 0.593750     test accuracy: 0.458541

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 95: 0.772099
training accuracy: 0.703125     test accuracy: 0.442557
lr decays to 0.001351
Average cost in epoch 96: 0.770933
training accuracy: 0.687500     test accuracy: 0.434565
Average cost in epoch 97: 0.799912
training accuracy: 0.718750     test accuracy: 0.423576
Average cost in epoch 98: 0.755381
training accuracy: 0.718750     test accuracy: 0.439560
Average cost in epoch 99: 0.748736
training accuracy: 0.843750     test accuracy: 0.460539

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 100: 0.770123
training accuracy: 0.703125     test accuracy: 0.424575
lr decays to 0.001216
Average cost in epoch 101: 0.773191
training accuracy: 0.671875     test accuracy: 0.438561
Average cost in epoch 102: 0.787100
training accuracy: 0.734375     test accuracy: 0.442557
Average cost in epoch 103: 0.731873
training accuracy: 0.718750     test accuracy: 0.447552
Average cost in epoch 104: 0.788087
training accuracy: 0.671875     test accuracy: 0.437562

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 105: 0.767974
training accuracy: 0.593750     test accuracy: 0.450549
Average cost in epoch 106: 0.760201
training accuracy: 0.593750     test accuracy: 0.446553
Average cost in epoch 107: 0.749648
training accuracy: 0.750000     test accuracy: 0.440559
Average cost in epoch 108: 0.776839
training accuracy: 0.640625     test accuracy: 0.445554
Average cost in epoch 109: 0.744137
training accuracy: 0.703125     test accuracy: 0.447552

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 110: 0.753808
training accuracy: 0.671875     test accuracy: 0.444555
Average cost in epoch 111: 0.755112
training accuracy: 0.671875     test accuracy: 0.438561
Average cost in epoch 112: 0.752230
training accuracy: 0.781250     test accuracy: 0.447552
Average cost in epoch 113: 0.760849
training accuracy: 0.718750     test accuracy: 0.445554
Average cost in epoch 114: 0.733183
training accuracy: 0.625000     test accuracy: 0.427572

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 115: 0.761741
training accuracy: 0.625000     test accuracy: 0.441558
Average cost in epoch 116: 0.713069
training accuracy: 0.609375     test accuracy: 0.438561
Average cost in epoch 117: 0.748012
training accuracy: 0.671875     test accuracy: 0.439560
Average cost in epoch 118: 0.767847
training accuracy: 0.671875     test accuracy: 0.442557
Average cost in epoch 119: 0.738461
training accuracy: 0.765625     test accuracy: 0.433566

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 120: 0.735866
training accuracy: 0.687500     test accuracy: 0.441558
Average cost in epoch 121: 0.753469
training accuracy: 0.750000     test accuracy: 0.434565
Average cost in epoch 122: 0.736109
training accuracy: 0.734375     test accuracy: 0.433566
Average cost in epoch 123: 0.781121
training accuracy: 0.718750     test accuracy: 0.444555
Average cost in epoch 124: 0.713091
training accuracy: 0.656250     test accuracy: 0.450549

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 125: 0.784496
training accuracy: 0.750000     test accuracy: 0.441558
Average cost in epoch 126: 0.756811
training accuracy: 0.703125     test accuracy: 0.433566
Average cost in epoch 127: 0.743968
training accuracy: 0.734375     test accuracy: 0.454545
Average cost in epoch 128: 0.765880
training accuracy: 0.750000     test accuracy: 0.443556
Average cost in epoch 129: 0.748608
training accuracy: 0.656250     test accuracy: 0.451548

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 130: 0.731177
training accuracy: 0.656250     test accuracy: 0.454545
Average cost in epoch 131: 0.753453
training accuracy: 0.687500     test accuracy: 0.448551
Average cost in epoch 132: 0.760130
training accuracy: 0.718750     test accuracy: 0.466533
Average cost in epoch 133: 0.743027
training accuracy: 0.703125     test accuracy: 0.445554
Average cost in epoch 134: 0.750657
training accuracy: 0.625000     test accuracy: 0.451548

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 135: 0.715897
training accuracy: 0.671875     test accuracy: 0.446553
Average cost in epoch 136: 0.731271
training accuracy: 0.656250     test accuracy: 0.440559
Average cost in epoch 137: 0.742677
training accuracy: 0.687500     test accuracy: 0.443556
Average cost in epoch 138: 0.769109
training accuracy: 0.718750     test accuracy: 0.444555
Average cost in epoch 139: 0.716463
training accuracy: 0.703125     test accuracy: 0.447552

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 140: 0.745510
training accuracy: 0.781250     test accuracy: 0.431568
Average cost in epoch 141: 0.742587
training accuracy: 0.750000     test accuracy: 0.441558
Average cost in epoch 142: 0.751399
training accuracy: 0.718750     test accuracy: 0.450549
Average cost in epoch 143: 0.717269
training accuracy: 0.734375     test accuracy: 0.450549
Average cost in epoch 144: 0.742859
training accuracy: 0.703125     test accuracy: 0.442557

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 145: 0.730114
training accuracy: 0.750000     test accuracy: 0.444555
Average cost in epoch 146: 0.737554
training accuracy: 0.734375     test accuracy: 0.440559
Average cost in epoch 147: 0.700708
training accuracy: 0.656250     test accuracy: 0.455544
Average cost in epoch 148: 0.704310
training accuracy: 0.578125     test accuracy: 0.455544
Average cost in epoch 149: 0.685995
training accuracy: 0.625000     test accuracy: 0.463536

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 150: 0.735371
training accuracy: 0.734375     test accuracy: 0.450549
Average cost in epoch 151: 0.737977
training accuracy: 0.578125     test accuracy: 0.442557
Average cost in epoch 152: 0.723499
training accuracy: 0.609375     test accuracy: 0.438561
Average cost in epoch 153: 0.734012
training accuracy: 0.843750     test accuracy: 0.442557
Average cost in epoch 154: 0.707673
training accuracy: 0.640625     test accuracy: 0.457542

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 155: 0.749507
training accuracy: 0.750000     test accuracy: 0.444555
Average cost in epoch 156: 0.728598
training accuracy: 0.718750     test accuracy: 0.456543
Average cost in epoch 157: 0.741217
training accuracy: 0.609375     test accuracy: 0.431568
Average cost in epoch 158: 0.744511
training accuracy: 0.687500     test accuracy: 0.439560
Average cost in epoch 159: 0.749321
training accuracy: 0.703125     test accuracy: 0.458541

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 160: 0.712682
training accuracy: 0.671875     test accuracy: 0.437562
Average cost in epoch 161: 0.721573
training accuracy: 0.656250     test accuracy: 0.449550
Average cost in epoch 162: 0.711670
training accuracy: 0.765625     test accuracy: 0.439560
Average cost in epoch 163: 0.699985
training accuracy: 0.765625     test accuracy: 0.430569
Average cost in epoch 164: 0.746992
training accuracy: 0.734375     test accuracy: 0.456543

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 165: 0.744937
training accuracy: 0.671875     test accuracy: 0.440559
Average cost in epoch 166: 0.761239
training accuracy: 0.687500     test accuracy: 0.448551
Average cost in epoch 167: 0.708755
training accuracy: 0.750000     test accuracy: 0.455544
Average cost in epoch 168: 0.716582
training accuracy: 0.671875     test accuracy: 0.455544
Average cost in epoch 169: 0.712848
training accuracy: 0.671875     test accuracy: 0.453546

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 170: 0.728463
training accuracy: 0.750000     test accuracy: 0.460539
Average cost in epoch 171: 0.725465
training accuracy: 0.687500     test accuracy: 0.454545
Average cost in epoch 172: 0.708773
training accuracy: 0.718750     test accuracy: 0.461538
Average cost in epoch 173: 0.710124
training accuracy: 0.687500     test accuracy: 0.458541
Average cost in epoch 174: 0.705377
training accuracy: 0.765625     test accuracy: 0.460539

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 175: 0.728678
training accuracy: 0.703125     test accuracy: 0.456543
Average cost in epoch 176: 0.722373
training accuracy: 0.687500     test accuracy: 0.456543
Average cost in epoch 177: 0.711566
training accuracy: 0.796875     test accuracy: 0.456543
Average cost in epoch 178: 0.712155
training accuracy: 0.687500     test accuracy: 0.452547
Average cost in epoch 179: 0.696968
training accuracy: 0.765625     test accuracy: 0.452547

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 180: 0.738664
training accuracy: 0.656250     test accuracy: 0.454545
Average cost in epoch 181: 0.717364
training accuracy: 0.750000     test accuracy: 0.441558
Average cost in epoch 182: 0.710073
training accuracy: 0.796875     test accuracy: 0.435564
Average cost in epoch 183: 0.727164
training accuracy: 0.828125     test accuracy: 0.443556
Average cost in epoch 184: 0.719301
training accuracy: 0.718750     test accuracy: 0.451548

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 185: 0.721753
training accuracy: 0.718750     test accuracy: 0.435564
Average cost in epoch 186: 0.694408
training accuracy: 0.656250     test accuracy: 0.460539
Average cost in epoch 187: 0.672420
training accuracy: 0.687500     test accuracy: 0.461538
Average cost in epoch 188: 0.749127
training accuracy: 0.734375     test accuracy: 0.441558
Average cost in epoch 189: 0.711306
training accuracy: 0.734375     test accuracy: 0.432567

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 190: 0.715275
training accuracy: 0.656250     test accuracy: 0.455544
Average cost in epoch 191: 0.736873
training accuracy: 0.671875     test accuracy: 0.440559
Average cost in epoch 192: 0.671174
training accuracy: 0.765625     test accuracy: 0.453546
Average cost in epoch 193: 0.711294
training accuracy: 0.687500     test accuracy: 0.438561
Average cost in epoch 194: 0.719601
training accuracy: 0.671875     test accuracy: 0.450549

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Average cost in epoch 195: 0.699392
training accuracy: 0.578125     test accuracy: 0.446553
Average cost in epoch 196: 0.689526
training accuracy: 0.750000     test accuracy: 0.451548
Average cost in epoch 197: 0.709120
training accuracy: 0.671875     test accuracy: 0.452547
Average cost in epoch 198: 0.704961
training accuracy: 0.812500     test accuracy: 0.456543
Average cost in epoch 199: 0.699454
training accuracy: 0.656250     test accuracy: 0.451548

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_15.pkl

Locking... locked.
No job requests to schedule
INFO (theano.gof.compilelock): Waiting for existing lock by process '23218' (I am process '23828')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23609' (I am process '23828')
INFO (theano.gof.compilelock): To manually release the lock, delete /deep/u/yetian1/.theano/compiledir_Linux-2.6-el6.x86_64-x86_64-with-centos-6.6-Final-x86_64-2.7.11-64/lock_dir
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 3007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 16, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_16.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 90.73
Starting training...
Average cost in epoch 0: 1.692573
training accuracy: 0.281250     test accuracy: 0.255744
Average cost in epoch 1: 1.421311
training accuracy: 0.421875     test accuracy: 0.309690
Average cost in epoch 2: 1.379507
training accuracy: 0.296875     test accuracy: 0.236763
Average cost in epoch 3: 1.347521
training accuracy: 0.437500     test accuracy: 0.435564
Average cost in epoch 4: 1.329394
training accuracy: 0.531250     test accuracy: 0.433566

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 5: 1.286340
training accuracy: 0.593750     test accuracy: 0.430569
lr decays to 0.009000
Average cost in epoch 6: 1.254040
training accuracy: 0.593750     test accuracy: 0.473526
Average cost in epoch 7: 1.252625
training accuracy: 0.609375     test accuracy: 0.472527
Average cost in epoch 8: 1.191237
training accuracy: 0.437500     test accuracy: 0.484515
Average cost in epoch 9: 1.158571
training accuracy: 0.562500     test accuracy: 0.492507

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 10: 1.189659
training accuracy: 0.421875     test accuracy: 0.488511
lr decays to 0.008100
Average cost in epoch 11: 1.153654
training accuracy: 0.500000     test accuracy: 0.458541
Average cost in epoch 12: 1.114684
training accuracy: 0.453125     test accuracy: 0.496503
Average cost in epoch 13: 1.117612
training accuracy: 0.593750     test accuracy: 0.503497
Average cost in epoch 14: 1.112868
training accuracy: 0.593750     test accuracy: 0.485514

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 15: 1.082348
training accuracy: 0.468750     test accuracy: 0.500500
lr decays to 0.007290
Average cost in epoch 16: 1.072871
training accuracy: 0.453125     test accuracy: 0.495504
Average cost in epoch 17: 1.026400
training accuracy: 0.515625     test accuracy: 0.499500
Average cost in epoch 18: 1.034494
training accuracy: 0.484375     test accuracy: 0.505495
Average cost in epoch 19: 1.063255
training accuracy: 0.484375     test accuracy: 0.503497

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 20: 1.027429
training accuracy: 0.500000     test accuracy: 0.465534
lr decays to 0.006561
Average cost in epoch 21: 1.021908
training accuracy: 0.484375     test accuracy: 0.493506
Average cost in epoch 22: 1.013372
training accuracy: 0.515625     test accuracy: 0.473526
Average cost in epoch 23: 1.002192
training accuracy: 0.531250     test accuracy: 0.489510
Average cost in epoch 24: 0.999326
training accuracy: 0.468750     test accuracy: 0.500500

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 25: 0.975122
training accuracy: 0.578125     test accuracy: 0.495504
lr decays to 0.005905
Average cost in epoch 26: 0.993405
training accuracy: 0.515625     test accuracy: 0.475524
Average cost in epoch 27: 1.011374
training accuracy: 0.484375     test accuracy: 0.490509
Average cost in epoch 28: 0.965965
training accuracy: 0.468750     test accuracy: 0.477522
Average cost in epoch 29: 0.939404
training accuracy: 0.515625     test accuracy: 0.481518

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 30: 0.926631
training accuracy: 0.593750     test accuracy: 0.499500
lr decays to 0.005314
Average cost in epoch 31: 0.951159
training accuracy: 0.578125     test accuracy: 0.494505
Average cost in epoch 32: 0.964710
training accuracy: 0.625000     test accuracy: 0.485514
Average cost in epoch 33: 0.934357
training accuracy: 0.531250     test accuracy: 0.485514
Average cost in epoch 34: 0.895142
training accuracy: 0.546875     test accuracy: 0.480519

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 35: 0.918156
training accuracy: 0.593750     test accuracy: 0.464535
lr decays to 0.004783
Average cost in epoch 36: 0.915252
training accuracy: 0.500000     test accuracy: 0.483516
Average cost in epoch 37: 0.941165
training accuracy: 0.625000     test accuracy: 0.487512
Average cost in epoch 38: 0.894747
training accuracy: 0.531250     test accuracy: 0.488511
Average cost in epoch 39: 0.909075
training accuracy: 0.531250     test accuracy: 0.480519

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 40: 0.879770
training accuracy: 0.656250     test accuracy: 0.484515
lr decays to 0.004305
Average cost in epoch 41: 0.905825
training accuracy: 0.687500     test accuracy: 0.484515
Average cost in epoch 42: 0.887273
training accuracy: 0.640625     test accuracy: 0.484515
Average cost in epoch 43: 0.863778
training accuracy: 0.609375     test accuracy: 0.488511
Average cost in epoch 44: 0.851845
training accuracy: 0.593750     test accuracy: 0.495504

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 45: 0.816797
training accuracy: 0.640625     test accuracy: 0.485514
lr decays to 0.003874
Average cost in epoch 46: 0.869117
training accuracy: 0.703125     test accuracy: 0.491508
Average cost in epoch 47: 0.843216
training accuracy: 0.671875     test accuracy: 0.487512
Average cost in epoch 48: 0.830347
training accuracy: 0.796875     test accuracy: 0.489510
Average cost in epoch 49: 0.856330
training accuracy: 0.640625     test accuracy: 0.498501

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 50: 0.840866
training accuracy: 0.578125     test accuracy: 0.479520
lr decays to 0.003487
Average cost in epoch 51: 0.806726
training accuracy: 0.703125     test accuracy: 0.482517
Average cost in epoch 52: 0.820904
training accuracy: 0.640625     test accuracy: 0.491508
Average cost in epoch 53: 0.794678
training accuracy: 0.562500     test accuracy: 0.480519
Average cost in epoch 54: 0.789480
training accuracy: 0.718750     test accuracy: 0.474525

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 55: 0.783761
training accuracy: 0.562500     test accuracy: 0.475524
lr decays to 0.003138
Average cost in epoch 56: 0.740053
training accuracy: 0.656250     test accuracy: 0.475524
Average cost in epoch 57: 0.773932
training accuracy: 0.718750     test accuracy: 0.475524
Average cost in epoch 58: 0.780215
training accuracy: 0.625000     test accuracy: 0.485514
Average cost in epoch 59: 0.771027
training accuracy: 0.734375     test accuracy: 0.480519

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 60: 0.771011
training accuracy: 0.640625     test accuracy: 0.478521
lr decays to 0.002824
Average cost in epoch 61: 0.751778
training accuracy: 0.734375     test accuracy: 0.489510
Average cost in epoch 62: 0.756296
training accuracy: 0.609375     test accuracy: 0.489510
Average cost in epoch 63: 0.748724
training accuracy: 0.750000     test accuracy: 0.472527
Average cost in epoch 64: 0.684728
training accuracy: 0.625000     test accuracy: 0.473526

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 65: 0.758232
training accuracy: 0.656250     test accuracy: 0.488511
lr decays to 0.002542
Average cost in epoch 66: 0.715084
training accuracy: 0.531250     test accuracy: 0.481518
Average cost in epoch 67: 0.710792
training accuracy: 0.750000     test accuracy: 0.485514
Average cost in epoch 68: 0.698655
training accuracy: 0.687500     test accuracy: 0.475524
Average cost in epoch 69: 0.712910
training accuracy: 0.609375     test accuracy: 0.478521

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 70: 0.702127
training accuracy: 0.687500     test accuracy: 0.479520
lr decays to 0.002288
Average cost in epoch 71: 0.732542
training accuracy: 0.625000     test accuracy: 0.489510
Average cost in epoch 72: 0.651096
training accuracy: 0.703125     test accuracy: 0.468531
Average cost in epoch 73: 0.712744
training accuracy: 0.656250     test accuracy: 0.476523
Average cost in epoch 74: 0.674617
training accuracy: 0.703125     test accuracy: 0.480519

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 75: 0.712417
training accuracy: 0.625000     test accuracy: 0.485514
lr decays to 0.002059
Average cost in epoch 76: 0.686758
training accuracy: 0.781250     test accuracy: 0.485514
Average cost in epoch 77: 0.659246
training accuracy: 0.687500     test accuracy: 0.482517
Average cost in epoch 78: 0.669861
training accuracy: 0.718750     test accuracy: 0.472527
Average cost in epoch 79: 0.672313
training accuracy: 0.765625     test accuracy: 0.480519

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 80: 0.655904
training accuracy: 0.812500     test accuracy: 0.480519
lr decays to 0.001853
Average cost in epoch 81: 0.673884
training accuracy: 0.687500     test accuracy: 0.478521
Average cost in epoch 82: 0.640407
training accuracy: 0.671875     test accuracy: 0.483516
Average cost in epoch 83: 0.668884
training accuracy: 0.718750     test accuracy: 0.477522
Average cost in epoch 84: 0.640483
training accuracy: 0.671875     test accuracy: 0.477522

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 85: 0.615233
training accuracy: 0.687500     test accuracy: 0.478521
lr decays to 0.001668
Average cost in epoch 86: 0.632114
training accuracy: 0.625000     test accuracy: 0.477522
Average cost in epoch 87: 0.609884
training accuracy: 0.625000     test accuracy: 0.473526
Average cost in epoch 88: 0.626847
training accuracy: 0.781250     test accuracy: 0.476523
Average cost in epoch 89: 0.611116
training accuracy: 0.750000     test accuracy: 0.468531

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 90: 0.610362
training accuracy: 0.718750     test accuracy: 0.477522
lr decays to 0.001501
Average cost in epoch 91: 0.592565
training accuracy: 0.734375     test accuracy: 0.481518
Average cost in epoch 92: 0.592407
training accuracy: 0.687500     test accuracy: 0.484515
Average cost in epoch 93: 0.596030
training accuracy: 0.765625     test accuracy: 0.480519
Average cost in epoch 94: 0.596162
training accuracy: 0.703125     test accuracy: 0.486513

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 95: 0.600147
training accuracy: 0.796875     test accuracy: 0.491508
lr decays to 0.001351
Average cost in epoch 96: 0.604345
training accuracy: 0.765625     test accuracy: 0.474525
Average cost in epoch 97: 0.616957
training accuracy: 0.718750     test accuracy: 0.470529
Average cost in epoch 98: 0.608501
training accuracy: 0.796875     test accuracy: 0.487512
Average cost in epoch 99: 0.570090
training accuracy: 0.796875     test accuracy: 0.469530

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 100: 0.566399
training accuracy: 0.625000     test accuracy: 0.478521
lr decays to 0.001216
Average cost in epoch 101: 0.543156
training accuracy: 0.765625     test accuracy: 0.471528
Average cost in epoch 102: 0.580932
training accuracy: 0.734375     test accuracy: 0.476523
Average cost in epoch 103: 0.522479
training accuracy: 0.828125     test accuracy: 0.471528
Average cost in epoch 104: 0.552721
training accuracy: 0.750000     test accuracy: 0.482517

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 105: 0.561572
training accuracy: 0.765625     test accuracy: 0.475524
Average cost in epoch 106: 0.558744
training accuracy: 0.812500     test accuracy: 0.473526
Average cost in epoch 107: 0.559724
training accuracy: 0.765625     test accuracy: 0.468531
Average cost in epoch 108: 0.546236
training accuracy: 0.859375     test accuracy: 0.469530
Average cost in epoch 109: 0.539679
training accuracy: 0.703125     test accuracy: 0.477522

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 110: 0.555317
training accuracy: 0.843750     test accuracy: 0.464535
Average cost in epoch 111: 0.516288
training accuracy: 0.734375     test accuracy: 0.471528
Average cost in epoch 112: 0.518766
training accuracy: 0.765625     test accuracy: 0.471528
Average cost in epoch 113: 0.544658
training accuracy: 0.734375     test accuracy: 0.479520
Average cost in epoch 114: 0.552875
training accuracy: 0.718750     test accuracy: 0.476523

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 115: 0.514732
training accuracy: 0.843750     test accuracy: 0.478521
Average cost in epoch 116: 0.518024
training accuracy: 0.781250     test accuracy: 0.467532
Average cost in epoch 117: 0.552552
training accuracy: 0.734375     test accuracy: 0.470529
Average cost in epoch 118: 0.521629
training accuracy: 0.687500     test accuracy: 0.482517
Average cost in epoch 119: 0.526552
training accuracy: 0.765625     test accuracy: 0.474525

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 120: 0.523022
training accuracy: 0.765625     test accuracy: 0.477522
Average cost in epoch 121: 0.498512
training accuracy: 0.843750     test accuracy: 0.472527
Average cost in epoch 122: 0.558789
training accuracy: 0.828125     test accuracy: 0.467532
Average cost in epoch 123: 0.499621
training accuracy: 0.734375     test accuracy: 0.463536
Average cost in epoch 124: 0.497362
training accuracy: 0.828125     test accuracy: 0.468531

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 125: 0.506011
training accuracy: 0.781250     test accuracy: 0.472527
Average cost in epoch 126: 0.537459
training accuracy: 0.703125     test accuracy: 0.459540
Average cost in epoch 127: 0.472122
training accuracy: 0.765625     test accuracy: 0.469530
Average cost in epoch 128: 0.490762
training accuracy: 0.875000     test accuracy: 0.471528
Average cost in epoch 129: 0.537547
training accuracy: 0.750000     test accuracy: 0.461538

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 130: 0.512784
training accuracy: 0.812500     test accuracy: 0.468531
Average cost in epoch 131: 0.502314
training accuracy: 0.750000     test accuracy: 0.462537
Average cost in epoch 132: 0.502170
training accuracy: 0.843750     test accuracy: 0.466533
Average cost in epoch 133: 0.490731
training accuracy: 0.828125     test accuracy: 0.458541
Average cost in epoch 134: 0.462138
training accuracy: 0.750000     test accuracy: 0.469530

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 135: 0.508500
training accuracy: 0.812500     test accuracy: 0.465534
Average cost in epoch 136: 0.487783
training accuracy: 0.781250     test accuracy: 0.467532
Average cost in epoch 137: 0.530011
training accuracy: 0.859375     test accuracy: 0.466533
Average cost in epoch 138: 0.501379
training accuracy: 0.828125     test accuracy: 0.465534
Average cost in epoch 139: 0.522415
training accuracy: 0.843750     test accuracy: 0.476523

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 140: 0.504375
training accuracy: 0.843750     test accuracy: 0.471528
Average cost in epoch 141: 0.478833
training accuracy: 0.796875     test accuracy: 0.466533
Average cost in epoch 142: 0.476692
training accuracy: 0.703125     test accuracy: 0.474525
Average cost in epoch 143: 0.465998
training accuracy: 0.687500     test accuracy: 0.465534
Average cost in epoch 144: 0.458284
training accuracy: 0.812500     test accuracy: 0.461538

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 145: 0.481251
training accuracy: 0.843750     test accuracy: 0.468531
Average cost in epoch 146: 0.469987
training accuracy: 0.812500     test accuracy: 0.478521
Average cost in epoch 147: 0.506827
training accuracy: 0.796875     test accuracy: 0.469530
Average cost in epoch 148: 0.472457
training accuracy: 0.796875     test accuracy: 0.469530
Average cost in epoch 149: 0.467387
training accuracy: 0.796875     test accuracy: 0.479520

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 150: 0.505589
training accuracy: 0.828125     test accuracy: 0.467532
Average cost in epoch 151: 0.457840
training accuracy: 0.796875     test accuracy: 0.469530
Average cost in epoch 152: 0.494601
training accuracy: 0.828125     test accuracy: 0.469530
Average cost in epoch 153: 0.441743
training accuracy: 0.734375     test accuracy: 0.470529
Average cost in epoch 154: 0.473016
training accuracy: 0.750000     test accuracy: 0.474525

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 155: 0.461081
training accuracy: 0.812500     test accuracy: 0.469530
Average cost in epoch 156: 0.468948
training accuracy: 0.843750     test accuracy: 0.457542
Average cost in epoch 157: 0.435884
training accuracy: 0.812500     test accuracy: 0.463536
Average cost in epoch 158: 0.440256
training accuracy: 0.718750     test accuracy: 0.461538
Average cost in epoch 159: 0.426879
training accuracy: 0.796875     test accuracy: 0.459540

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 160: 0.465542
training accuracy: 0.843750     test accuracy: 0.466533
Average cost in epoch 161: 0.445652
training accuracy: 0.765625     test accuracy: 0.470529
Average cost in epoch 162: 0.472406
training accuracy: 0.859375     test accuracy: 0.468531
Average cost in epoch 163: 0.432975
training accuracy: 0.750000     test accuracy: 0.462537
Average cost in epoch 164: 0.398464
training accuracy: 0.890625     test accuracy: 0.465534

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 165: 0.463470
training accuracy: 0.875000     test accuracy: 0.462537
Average cost in epoch 166: 0.427169
training accuracy: 0.828125     test accuracy: 0.464535
Average cost in epoch 167: 0.445022
training accuracy: 0.859375     test accuracy: 0.464535
Average cost in epoch 168: 0.443005
training accuracy: 0.765625     test accuracy: 0.466533
Average cost in epoch 169: 0.387731
training accuracy: 0.781250     test accuracy: 0.460539

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 170: 0.451010
training accuracy: 0.843750     test accuracy: 0.461538
Average cost in epoch 171: 0.446649
training accuracy: 0.875000     test accuracy: 0.451548
Average cost in epoch 172: 0.437423
training accuracy: 0.765625     test accuracy: 0.456543
Average cost in epoch 173: 0.395065
training accuracy: 0.828125     test accuracy: 0.460539
Average cost in epoch 174: 0.429455
training accuracy: 0.781250     test accuracy: 0.458541

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 175: 0.413141
training accuracy: 0.812500     test accuracy: 0.449550
Average cost in epoch 176: 0.430309
training accuracy: 0.796875     test accuracy: 0.460539
Average cost in epoch 177: 0.409864
training accuracy: 0.875000     test accuracy: 0.456543
Average cost in epoch 178: 0.421534
training accuracy: 0.828125     test accuracy: 0.458541
Average cost in epoch 179: 0.438577
training accuracy: 0.875000     test accuracy: 0.464535

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 180: 0.402073
training accuracy: 0.812500     test accuracy: 0.458541
Average cost in epoch 181: 0.391288
training accuracy: 0.859375     test accuracy: 0.462537
Average cost in epoch 182: 0.377025
training accuracy: 0.890625     test accuracy: 0.469530
Average cost in epoch 183: 0.411289
training accuracy: 0.812500     test accuracy: 0.467532
Average cost in epoch 184: 0.390661
training accuracy: 0.859375     test accuracy: 0.473526

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 185: 0.445949
training accuracy: 0.796875     test accuracy: 0.458541
Average cost in epoch 186: 0.378605
training accuracy: 0.765625     test accuracy: 0.459540
Average cost in epoch 187: 0.428903
training accuracy: 0.890625     test accuracy: 0.469530
Average cost in epoch 188: 0.418891
training accuracy: 0.890625     test accuracy: 0.459540
Average cost in epoch 189: 0.395761
training accuracy: 0.890625     test accuracy: 0.458541

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 190: 0.438865
training accuracy: 0.875000     test accuracy: 0.462537
Average cost in epoch 191: 0.411202
training accuracy: 0.890625     test accuracy: 0.444555
Average cost in epoch 192: 0.366646
training accuracy: 0.859375     test accuracy: 0.465534
Average cost in epoch 193: 0.391455
training accuracy: 0.828125     test accuracy: 0.470529
Average cost in epoch 194: 0.381630
training accuracy: 0.781250     test accuracy: 0.467532

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Average cost in epoch 195: 0.379885
training accuracy: 0.828125     test accuracy: 0.461538
Average cost in epoch 196: 0.394604
training accuracy: 0.859375     test accuracy: 0.463536
Average cost in epoch 197: 0.426487
training accuracy: 0.828125     test accuracy: 0.462537
Average cost in epoch 198: 0.378315
training accuracy: 0.796875     test accuracy: 0.465534
Average cost in epoch 199: 0.351936
training accuracy: 0.875000     test accuracy: 0.471528

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_16.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 4007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 17, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_17.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
INFO (theano.gof.compilelock): Waiting for existing lock by process '22632' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '22632' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22517')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
Ending compiling...
Compiling time: 273.05
Starting training...
Average cost in epoch 0: 1.108200
training accuracy: 0.500000     test accuracy: 0.520480
Average cost in epoch 1: 0.758471
training accuracy: 0.562500     test accuracy: 0.520480
Average cost in epoch 2: 0.725496
training accuracy: 0.578125     test accuracy: 0.520480
Average cost in epoch 3: 0.727338
training accuracy: 0.593750     test accuracy: 0.520480
Average cost in epoch 4: 0.710667
training accuracy: 0.468750     test accuracy: 0.479520

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 5: 0.709395
training accuracy: 0.562500     test accuracy: 0.520480
lr decays to 0.009000
Average cost in epoch 6: 0.705406
training accuracy: 0.500000     test accuracy: 0.479520
Average cost in epoch 7: 0.708846
training accuracy: 0.484375     test accuracy: 0.520480
Average cost in epoch 8: 0.705848
training accuracy: 0.390625     test accuracy: 0.479520
Average cost in epoch 9: 0.706411
training accuracy: 0.531250     test accuracy: 0.479520

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 10: 0.705715
training accuracy: 0.500000     test accuracy: 0.479520
lr decays to 0.008100
Average cost in epoch 11: 0.699249
training accuracy: 0.546875     test accuracy: 0.524476
Average cost in epoch 12: 0.694155
training accuracy: 0.578125     test accuracy: 0.505495
Average cost in epoch 13: 0.696946
training accuracy: 0.421875     test accuracy: 0.514486
Average cost in epoch 14: 0.706433
training accuracy: 0.531250     test accuracy: 0.524476

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 15: 0.693624
training accuracy: 0.625000     test accuracy: 0.507493
lr decays to 0.007290
Average cost in epoch 16: 0.689930
training accuracy: 0.562500     test accuracy: 0.520480
Average cost in epoch 17: 0.699016
training accuracy: 0.531250     test accuracy: 0.477522
Average cost in epoch 18: 0.694500
training accuracy: 0.515625     test accuracy: 0.477522
Average cost in epoch 19: 0.694247
training accuracy: 0.515625     test accuracy: 0.524476

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 20: 0.687951
training accuracy: 0.562500     test accuracy: 0.484515
lr decays to 0.006561
Average cost in epoch 21: 0.694879
training accuracy: 0.593750     test accuracy: 0.482517
Average cost in epoch 22: 0.694068
training accuracy: 0.640625     test accuracy: 0.515485
Average cost in epoch 23: 0.691086
training accuracy: 0.562500     test accuracy: 0.526474
Average cost in epoch 24: 0.688377
training accuracy: 0.453125     test accuracy: 0.522478

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 25: 0.693238
training accuracy: 0.437500     test accuracy: 0.484515
lr decays to 0.005905
Average cost in epoch 26: 0.689290
training accuracy: 0.609375     test accuracy: 0.524476
Average cost in epoch 27: 0.692248
training accuracy: 0.515625     test accuracy: 0.519481
Average cost in epoch 28: 0.691460
training accuracy: 0.640625     test accuracy: 0.480519
Average cost in epoch 29: 0.687961
training accuracy: 0.609375     test accuracy: 0.490509

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 30: 0.684302
training accuracy: 0.546875     test accuracy: 0.506494
lr decays to 0.005314
Average cost in epoch 31: 0.687515
training accuracy: 0.515625     test accuracy: 0.515485
Average cost in epoch 32: 0.678242
training accuracy: 0.656250     test accuracy: 0.484515
Average cost in epoch 33: 0.685749
training accuracy: 0.562500     test accuracy: 0.489510
Average cost in epoch 34: 0.681268
training accuracy: 0.578125     test accuracy: 0.502498

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 35: 0.675338
training accuracy: 0.546875     test accuracy: 0.468531
lr decays to 0.004783
Average cost in epoch 36: 0.678259
training accuracy: 0.640625     test accuracy: 0.473526
Average cost in epoch 37: 0.665121
training accuracy: 0.578125     test accuracy: 0.500500
Average cost in epoch 38: 0.674348
training accuracy: 0.562500     test accuracy: 0.512488
Average cost in epoch 39: 0.668099
training accuracy: 0.515625     test accuracy: 0.510490

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 40: 0.677859
training accuracy: 0.671875     test accuracy: 0.509491
lr decays to 0.004305
Average cost in epoch 41: 0.662988
training accuracy: 0.562500     test accuracy: 0.522478
Average cost in epoch 42: 0.666601
training accuracy: 0.609375     test accuracy: 0.512488
Average cost in epoch 43: 0.665714
training accuracy: 0.500000     test accuracy: 0.504496
Average cost in epoch 44: 0.666007
training accuracy: 0.671875     test accuracy: 0.487512

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 45: 0.657983
training accuracy: 0.593750     test accuracy: 0.486513
lr decays to 0.003874
Average cost in epoch 46: 0.656569
training accuracy: 0.656250     test accuracy: 0.488511
Average cost in epoch 47: 0.651148
training accuracy: 0.531250     test accuracy: 0.497502
Average cost in epoch 48: 0.654759
training accuracy: 0.562500     test accuracy: 0.488511
Average cost in epoch 49: 0.654557
training accuracy: 0.562500     test accuracy: 0.506494

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 50: 0.653798
training accuracy: 0.765625     test accuracy: 0.493506
lr decays to 0.003487
Average cost in epoch 51: 0.641744
training accuracy: 0.625000     test accuracy: 0.482517
Average cost in epoch 52: 0.644467
training accuracy: 0.671875     test accuracy: 0.491508
Average cost in epoch 53: 0.643497
training accuracy: 0.687500     test accuracy: 0.489510
Average cost in epoch 54: 0.652371
training accuracy: 0.765625     test accuracy: 0.500500

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 55: 0.649930
training accuracy: 0.593750     test accuracy: 0.491508
lr decays to 0.003138
Average cost in epoch 56: 0.629755
training accuracy: 0.593750     test accuracy: 0.479520
Average cost in epoch 57: 0.648297
training accuracy: 0.593750     test accuracy: 0.477522
Average cost in epoch 58: 0.651051
training accuracy: 0.593750     test accuracy: 0.498501
Average cost in epoch 59: 0.641999
training accuracy: 0.718750     test accuracy: 0.483516

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 60: 0.643317
training accuracy: 0.687500     test accuracy: 0.482517
lr decays to 0.002824
Average cost in epoch 61: 0.645071
training accuracy: 0.609375     test accuracy: 0.494505
Average cost in epoch 62: 0.634658
training accuracy: 0.562500     test accuracy: 0.483516
Average cost in epoch 63: 0.645994
training accuracy: 0.640625     test accuracy: 0.482517
Average cost in epoch 64: 0.623478
training accuracy: 0.609375     test accuracy: 0.509491

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 65: 0.621710
training accuracy: 0.531250     test accuracy: 0.493506
lr decays to 0.002542
Average cost in epoch 66: 0.642315
training accuracy: 0.656250     test accuracy: 0.501499
Average cost in epoch 67: 0.626736
training accuracy: 0.640625     test accuracy: 0.506494
Average cost in epoch 68: 0.623197
training accuracy: 0.703125     test accuracy: 0.486513
Average cost in epoch 69: 0.631464
training accuracy: 0.671875     test accuracy: 0.493506

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 70: 0.635508
training accuracy: 0.640625     test accuracy: 0.490509
lr decays to 0.002288
Average cost in epoch 71: 0.629792
training accuracy: 0.671875     test accuracy: 0.469530
Average cost in epoch 72: 0.635239
training accuracy: 0.671875     test accuracy: 0.484515
Average cost in epoch 73: 0.629770
training accuracy: 0.609375     test accuracy: 0.474525
Average cost in epoch 74: 0.623696
training accuracy: 0.671875     test accuracy: 0.490509

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 75: 0.624309
training accuracy: 0.609375     test accuracy: 0.466533
lr decays to 0.002059
Average cost in epoch 76: 0.628592
training accuracy: 0.656250     test accuracy: 0.467532
Average cost in epoch 77: 0.618744
training accuracy: 0.687500     test accuracy: 0.477522
Average cost in epoch 78: 0.623802
training accuracy: 0.656250     test accuracy: 0.480519
Average cost in epoch 79: 0.616786
training accuracy: 0.640625     test accuracy: 0.483516

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 80: 0.629521
training accuracy: 0.609375     test accuracy: 0.472527
lr decays to 0.001853
Average cost in epoch 81: 0.614244
training accuracy: 0.734375     test accuracy: 0.463536
Average cost in epoch 82: 0.625147
training accuracy: 0.640625     test accuracy: 0.471528
Average cost in epoch 83: 0.626271
training accuracy: 0.750000     test accuracy: 0.475524
Average cost in epoch 84: 0.605540
training accuracy: 0.765625     test accuracy: 0.471528

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 85: 0.623140
training accuracy: 0.609375     test accuracy: 0.474525
lr decays to 0.001668
Average cost in epoch 86: 0.623933
training accuracy: 0.703125     test accuracy: 0.478521
Average cost in epoch 87: 0.611346
training accuracy: 0.750000     test accuracy: 0.475524
Average cost in epoch 88: 0.607699
training accuracy: 0.687500     test accuracy: 0.480519
Average cost in epoch 89: 0.617255
training accuracy: 0.625000     test accuracy: 0.481518

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 90: 0.613951
training accuracy: 0.625000     test accuracy: 0.481518
lr decays to 0.001501
Average cost in epoch 91: 0.608924
training accuracy: 0.812500     test accuracy: 0.490509
Average cost in epoch 92: 0.617903
training accuracy: 0.750000     test accuracy: 0.478521
Average cost in epoch 93: 0.602768
training accuracy: 0.625000     test accuracy: 0.461538
Average cost in epoch 94: 0.621853
training accuracy: 0.656250     test accuracy: 0.473526

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 95: 0.609580
training accuracy: 0.765625     test accuracy: 0.477522
lr decays to 0.001351
Average cost in epoch 96: 0.614931
training accuracy: 0.671875     test accuracy: 0.469530
Average cost in epoch 97: 0.613541
training accuracy: 0.656250     test accuracy: 0.478521
Average cost in epoch 98: 0.591163
training accuracy: 0.750000     test accuracy: 0.468531
Average cost in epoch 99: 0.623137
training accuracy: 0.687500     test accuracy: 0.474525

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 100: 0.604481
training accuracy: 0.765625     test accuracy: 0.475524
lr decays to 0.001216
Average cost in epoch 101: 0.616797
training accuracy: 0.812500     test accuracy: 0.477522
Average cost in epoch 102: 0.620323
training accuracy: 0.703125     test accuracy: 0.466533
Average cost in epoch 103: 0.605020
training accuracy: 0.656250     test accuracy: 0.474525
Average cost in epoch 104: 0.610419
training accuracy: 0.609375     test accuracy: 0.467532

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 105: 0.614362
training accuracy: 0.625000     test accuracy: 0.485514
Average cost in epoch 106: 0.592701
training accuracy: 0.718750     test accuracy: 0.468531
Average cost in epoch 107: 0.600066
training accuracy: 0.703125     test accuracy: 0.475524
Average cost in epoch 108: 0.606169
training accuracy: 0.625000     test accuracy: 0.479520
Average cost in epoch 109: 0.619812
training accuracy: 0.656250     test accuracy: 0.468531

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 110: 0.592538
training accuracy: 0.640625     test accuracy: 0.471528
Average cost in epoch 111: 0.614735
training accuracy: 0.656250     test accuracy: 0.470529
Average cost in epoch 112: 0.600060
training accuracy: 0.703125     test accuracy: 0.464535
Average cost in epoch 113: 0.592738
training accuracy: 0.671875     test accuracy: 0.462537
Average cost in epoch 114: 0.604130
training accuracy: 0.640625     test accuracy: 0.469530

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 115: 0.602347
training accuracy: 0.640625     test accuracy: 0.465534
Average cost in epoch 116: 0.607679
training accuracy: 0.687500     test accuracy: 0.479520
Average cost in epoch 117: 0.598523
training accuracy: 0.578125     test accuracy: 0.480519
Average cost in epoch 118: 0.617882
training accuracy: 0.703125     test accuracy: 0.474525
Average cost in epoch 119: 0.600462
training accuracy: 0.718750     test accuracy: 0.465534

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 120: 0.605479
training accuracy: 0.609375     test accuracy: 0.480519
Average cost in epoch 121: 0.608341
training accuracy: 0.687500     test accuracy: 0.459540
Average cost in epoch 122: 0.598195
training accuracy: 0.718750     test accuracy: 0.474525
Average cost in epoch 123: 0.605028
training accuracy: 0.640625     test accuracy: 0.465534
Average cost in epoch 124: 0.610789
training accuracy: 0.578125     test accuracy: 0.481518

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 125: 0.605945
training accuracy: 0.671875     test accuracy: 0.473526
Average cost in epoch 126: 0.596108
training accuracy: 0.734375     test accuracy: 0.467532
Average cost in epoch 127: 0.597713
training accuracy: 0.734375     test accuracy: 0.474525
Average cost in epoch 128: 0.602662
training accuracy: 0.671875     test accuracy: 0.466533
Average cost in epoch 129: 0.603851
training accuracy: 0.640625     test accuracy: 0.473526

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 130: 0.597453
training accuracy: 0.593750     test accuracy: 0.466533
Average cost in epoch 131: 0.589312
training accuracy: 0.750000     test accuracy: 0.473526
Average cost in epoch 132: 0.608557
training accuracy: 0.703125     test accuracy: 0.477522
Average cost in epoch 133: 0.603541
training accuracy: 0.656250     test accuracy: 0.473526
Average cost in epoch 134: 0.585148
training accuracy: 0.656250     test accuracy: 0.472527

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 135: 0.611712
training accuracy: 0.750000     test accuracy: 0.482517
Average cost in epoch 136: 0.596175
training accuracy: 0.781250     test accuracy: 0.468531
Average cost in epoch 137: 0.593132
training accuracy: 0.640625     test accuracy: 0.475524
Average cost in epoch 138: 0.599558
training accuracy: 0.687500     test accuracy: 0.470529
Average cost in epoch 139: 0.601321
training accuracy: 0.750000     test accuracy: 0.476523

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 140: 0.589558
training accuracy: 0.640625     test accuracy: 0.484515
Average cost in epoch 141: 0.592552
training accuracy: 0.765625     test accuracy: 0.479520
Average cost in epoch 142: 0.601240
training accuracy: 0.703125     test accuracy: 0.467532
Average cost in epoch 143: 0.597049
training accuracy: 0.734375     test accuracy: 0.482517
Average cost in epoch 144: 0.607796
training accuracy: 0.718750     test accuracy: 0.465534

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 145: 0.588696
training accuracy: 0.656250     test accuracy: 0.454545
Average cost in epoch 146: 0.610566
training accuracy: 0.718750     test accuracy: 0.467532
Average cost in epoch 147: 0.580608
training accuracy: 0.796875     test accuracy: 0.465534
Average cost in epoch 148: 0.593289
training accuracy: 0.687500     test accuracy: 0.469530
Average cost in epoch 149: 0.583435
training accuracy: 0.640625     test accuracy: 0.469530

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 150: 0.596931
training accuracy: 0.703125     test accuracy: 0.478521
Average cost in epoch 151: 0.612183
training accuracy: 0.703125     test accuracy: 0.480519
Average cost in epoch 152: 0.593917
training accuracy: 0.640625     test accuracy: 0.474525
Average cost in epoch 153: 0.604953
training accuracy: 0.781250     test accuracy: 0.466533
Average cost in epoch 154: 0.593193
training accuracy: 0.671875     test accuracy: 0.473526

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 155: 0.588639
training accuracy: 0.671875     test accuracy: 0.461538
Average cost in epoch 156: 0.584746
training accuracy: 0.687500     test accuracy: 0.466533
Average cost in epoch 157: 0.601449
training accuracy: 0.671875     test accuracy: 0.484515
Average cost in epoch 158: 0.596619
training accuracy: 0.687500     test accuracy: 0.465534
Average cost in epoch 159: 0.591849
training accuracy: 0.750000     test accuracy: 0.454545

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 160: 0.577301
training accuracy: 0.796875     test accuracy: 0.464535
Average cost in epoch 161: 0.585099
training accuracy: 0.703125     test accuracy: 0.465534
Average cost in epoch 162: 0.597784
training accuracy: 0.750000     test accuracy: 0.465534
Average cost in epoch 163: 0.594094
training accuracy: 0.640625     test accuracy: 0.469530
Average cost in epoch 164: 0.567499
training accuracy: 0.609375     test accuracy: 0.458541

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 165: 0.585987
training accuracy: 0.750000     test accuracy: 0.472527
Average cost in epoch 166: 0.596297
training accuracy: 0.718750     test accuracy: 0.461538
Average cost in epoch 167: 0.578602
training accuracy: 0.703125     test accuracy: 0.472527
Average cost in epoch 168: 0.584901
training accuracy: 0.625000     test accuracy: 0.471528
Average cost in epoch 169: 0.578806
training accuracy: 0.671875     test accuracy: 0.466533

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 170: 0.586154
training accuracy: 0.718750     test accuracy: 0.479520
Average cost in epoch 171: 0.599286
training accuracy: 0.718750     test accuracy: 0.468531
Average cost in epoch 172: 0.569793
training accuracy: 0.671875     test accuracy: 0.465534
Average cost in epoch 173: 0.591015
training accuracy: 0.703125     test accuracy: 0.469530
Average cost in epoch 174: 0.582759
training accuracy: 0.718750     test accuracy: 0.464535

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 175: 0.589972
training accuracy: 0.656250     test accuracy: 0.465534
Average cost in epoch 176: 0.577700
training accuracy: 0.734375     test accuracy: 0.466533
Average cost in epoch 177: 0.600632
training accuracy: 0.796875     test accuracy: 0.470529
Average cost in epoch 178: 0.582871
training accuracy: 0.703125     test accuracy: 0.467532
Average cost in epoch 179: 0.570979
training accuracy: 0.718750     test accuracy: 0.463536

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 180: 0.596211
training accuracy: 0.640625     test accuracy: 0.465534
Average cost in epoch 181: 0.585605
training accuracy: 0.640625     test accuracy: 0.459540
Average cost in epoch 182: 0.589330
training accuracy: 0.640625     test accuracy: 0.472527
Average cost in epoch 183: 0.565960
training accuracy: 0.734375     test accuracy: 0.473526
Average cost in epoch 184: 0.573049
training accuracy: 0.734375     test accuracy: 0.468531

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 185: 0.620330
training accuracy: 0.687500     test accuracy: 0.477522
Average cost in epoch 186: 0.567740
training accuracy: 0.687500     test accuracy: 0.482517
Average cost in epoch 187: 0.580306
training accuracy: 0.671875     test accuracy: 0.468531
Average cost in epoch 188: 0.568393
training accuracy: 0.796875     test accuracy: 0.479520
Average cost in epoch 189: 0.581565
training accuracy: 0.687500     test accuracy: 0.473526

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 190: 0.591759
training accuracy: 0.703125     test accuracy: 0.467532
Average cost in epoch 191: 0.587693
training accuracy: 0.781250     test accuracy: 0.460539
Average cost in epoch 192: 0.573684
training accuracy: 0.796875     test accuracy: 0.473526
Average cost in epoch 193: 0.582051
training accuracy: 0.703125     test accuracy: 0.466533
Average cost in epoch 194: 0.580555
training accuracy: 0.671875     test accuracy: 0.482517

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Average cost in epoch 195: 0.583534
training accuracy: 0.734375     test accuracy: 0.480519
Average cost in epoch 196: 0.575311
training accuracy: 0.734375     test accuracy: 0.461538
Average cost in epoch 197: 0.574272
training accuracy: 0.625000     test accuracy: 0.468531
Average cost in epoch 198: 0.568303
training accuracy: 0.750000     test accuracy: 0.459540
Average cost in epoch 199: 0.583381
training accuracy: 0.625000     test accuracy: 0.469530

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_17.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 4007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 18, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_18.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22632')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
Ending compiling...
Compiling time: 245.34
Starting training...
Average cost in epoch 0: 1.081566
training accuracy: 0.531250     test accuracy: 0.468531
Average cost in epoch 1: 0.753045
training accuracy: 0.625000     test accuracy: 0.531469
Average cost in epoch 2: 0.708647
training accuracy: 0.468750     test accuracy: 0.468531
Average cost in epoch 3: 0.719018
training accuracy: 0.515625     test accuracy: 0.468531
Average cost in epoch 4: 0.707033
training accuracy: 0.546875     test accuracy: 0.531469

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 5: 0.706635
training accuracy: 0.546875     test accuracy: 0.468531
lr decays to 0.009000
Average cost in epoch 6: 0.707053
training accuracy: 0.515625     test accuracy: 0.532468
Average cost in epoch 7: 0.697000
training accuracy: 0.593750     test accuracy: 0.532468
Average cost in epoch 8: 0.588203
training accuracy: 0.781250     test accuracy: 0.877123
Average cost in epoch 9: 0.357643
training accuracy: 0.921875     test accuracy: 0.897103

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 10: 0.257401
training accuracy: 0.875000     test accuracy: 0.921079
lr decays to 0.008100
Average cost in epoch 11: 0.212486
training accuracy: 0.937500     test accuracy: 0.912088
Average cost in epoch 12: 0.237834
training accuracy: 0.968750     test accuracy: 0.907093
Average cost in epoch 13: 0.186520
training accuracy: 0.875000     test accuracy: 0.894106
Average cost in epoch 14: 0.188245
training accuracy: 0.843750     test accuracy: 0.915085

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 15: 0.178406
training accuracy: 0.906250     test accuracy: 0.904096
lr decays to 0.007290
Average cost in epoch 16: 0.146122
training accuracy: 0.828125     test accuracy: 0.898102
Average cost in epoch 17: 0.177840
training accuracy: 0.921875     test accuracy: 0.899101
Average cost in epoch 18: 0.161929
training accuracy: 0.890625     test accuracy: 0.898102
Average cost in epoch 19: 0.151519
training accuracy: 0.968750     test accuracy: 0.899101

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 20: 0.134467
training accuracy: 0.875000     test accuracy: 0.899101
lr decays to 0.006561
Average cost in epoch 21: 0.134188
training accuracy: 0.906250     test accuracy: 0.900100
Average cost in epoch 22: 0.132563
training accuracy: 0.937500     test accuracy: 0.917083
Average cost in epoch 23: 0.151831
training accuracy: 0.984375     test accuracy: 0.902098
Average cost in epoch 24: 0.137428
training accuracy: 0.984375     test accuracy: 0.905095

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 25: 0.136676
training accuracy: 0.890625     test accuracy: 0.907093
lr decays to 0.005905
Average cost in epoch 26: 0.124352
training accuracy: 0.890625     test accuracy: 0.904096
Average cost in epoch 27: 0.149127
training accuracy: 0.953125     test accuracy: 0.916084
Average cost in epoch 28: 0.133021
training accuracy: 0.937500     test accuracy: 0.903097
Average cost in epoch 29: 0.132079
training accuracy: 0.937500     test accuracy: 0.899101

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 30: 0.133052
training accuracy: 0.921875     test accuracy: 0.911089
lr decays to 0.005314
Average cost in epoch 31: 0.115381
training accuracy: 0.921875     test accuracy: 0.898102
Average cost in epoch 32: 0.133774
training accuracy: 0.921875     test accuracy: 0.894106
Average cost in epoch 33: 0.137808
training accuracy: 0.984375     test accuracy: 0.911089
Average cost in epoch 34: 0.128185
training accuracy: 0.953125     test accuracy: 0.897103

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 35: 0.133043
training accuracy: 0.828125     test accuracy: 0.899101
lr decays to 0.004783
Average cost in epoch 36: 0.121384
training accuracy: 0.890625     test accuracy: 0.897103
Average cost in epoch 37: 0.116075
training accuracy: 0.968750     test accuracy: 0.896104
Average cost in epoch 38: 0.125549
training accuracy: 0.921875     test accuracy: 0.896104
Average cost in epoch 39: 0.107725
training accuracy: 0.875000     test accuracy: 0.901099

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 40: 0.119077
training accuracy: 0.953125     test accuracy: 0.895105
lr decays to 0.004305
Average cost in epoch 41: 0.127607
training accuracy: 0.968750     test accuracy: 0.902098
Average cost in epoch 42: 0.114754
training accuracy: 0.937500     test accuracy: 0.894106
Average cost in epoch 43: 0.132626
training accuracy: 0.937500     test accuracy: 0.898102
Average cost in epoch 44: 0.114401
training accuracy: 0.921875     test accuracy: 0.907093

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 45: 0.117519
training accuracy: 0.937500     test accuracy: 0.892108
lr decays to 0.003874
Average cost in epoch 46: 0.107452
training accuracy: 0.875000     test accuracy: 0.912088
Average cost in epoch 47: 0.110530
training accuracy: 0.906250     test accuracy: 0.905095
Average cost in epoch 48: 0.124978
training accuracy: 0.921875     test accuracy: 0.899101
Average cost in epoch 49: 0.120089
training accuracy: 0.921875     test accuracy: 0.915085

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 50: 0.105452
training accuracy: 0.921875     test accuracy: 0.904096
lr decays to 0.003487
Average cost in epoch 51: 0.127336
training accuracy: 0.890625     test accuracy: 0.903097
Average cost in epoch 52: 0.099050
training accuracy: 0.890625     test accuracy: 0.894106
Average cost in epoch 53: 0.112979
training accuracy: 0.953125     test accuracy: 0.903097
Average cost in epoch 54: 0.113295
training accuracy: 0.968750     test accuracy: 0.897103

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 55: 0.104946
training accuracy: 0.890625     test accuracy: 0.896104
lr decays to 0.003138
Average cost in epoch 56: 0.098864
training accuracy: 0.984375     test accuracy: 0.901099
Average cost in epoch 57: 0.103284
training accuracy: 0.906250     test accuracy: 0.895105
Average cost in epoch 58: 0.120057
training accuracy: 0.953125     test accuracy: 0.906094
Average cost in epoch 59: 0.111082
training accuracy: 0.937500     test accuracy: 0.904096

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 60: 0.110387
training accuracy: 0.906250     test accuracy: 0.905095
lr decays to 0.002824
Average cost in epoch 61: 0.110290
training accuracy: 0.921875     test accuracy: 0.907093
Average cost in epoch 62: 0.109262
training accuracy: 0.953125     test accuracy: 0.900100
Average cost in epoch 63: 0.108089
training accuracy: 0.984375     test accuracy: 0.889111
Average cost in epoch 64: 0.097153
training accuracy: 0.953125     test accuracy: 0.897103

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 65: 0.106833
training accuracy: 0.906250     test accuracy: 0.904096
lr decays to 0.002542
Average cost in epoch 66: 0.094258
training accuracy: 0.968750     test accuracy: 0.899101
Average cost in epoch 67: 0.120231
training accuracy: 0.984375     test accuracy: 0.903097
Average cost in epoch 68: 0.104508
training accuracy: 0.937500     test accuracy: 0.899101
Average cost in epoch 69: 0.094697
training accuracy: 0.937500     test accuracy: 0.901099

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 70: 0.104438
training accuracy: 0.906250     test accuracy: 0.902098
lr decays to 0.002288
Average cost in epoch 71: 0.097277
training accuracy: 0.968750     test accuracy: 0.904096
Average cost in epoch 72: 0.113496
training accuracy: 0.968750     test accuracy: 0.907093
Average cost in epoch 73: 0.091790
training accuracy: 0.921875     test accuracy: 0.895105
Average cost in epoch 74: 0.088557
training accuracy: 0.968750     test accuracy: 0.904096

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 75: 0.098709
training accuracy: 0.906250     test accuracy: 0.905095
lr decays to 0.002059
Average cost in epoch 76: 0.087023
training accuracy: 0.953125     test accuracy: 0.909091
Average cost in epoch 77: 0.096015
training accuracy: 0.968750     test accuracy: 0.909091
Average cost in epoch 78: 0.096199
training accuracy: 0.921875     test accuracy: 0.909091
Average cost in epoch 79: 0.094466
training accuracy: 0.968750     test accuracy: 0.904096

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 80: 0.088406
training accuracy: 0.968750     test accuracy: 0.916084
lr decays to 0.001853
Average cost in epoch 81: 0.095591
training accuracy: 0.968750     test accuracy: 0.905095
Average cost in epoch 82: 0.081101
training accuracy: 0.953125     test accuracy: 0.907093
Average cost in epoch 83: 0.083053
training accuracy: 0.968750     test accuracy: 0.909091
Average cost in epoch 84: 0.089381
training accuracy: 0.968750     test accuracy: 0.912088

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 85: 0.088317
training accuracy: 0.953125     test accuracy: 0.906094
lr decays to 0.001668
Average cost in epoch 86: 0.091130
training accuracy: 0.953125     test accuracy: 0.906094
Average cost in epoch 87: 0.088008
training accuracy: 0.968750     test accuracy: 0.917083
Average cost in epoch 88: 0.081309
training accuracy: 0.937500     test accuracy: 0.916084
Average cost in epoch 89: 0.083916
training accuracy: 0.937500     test accuracy: 0.903097

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 90: 0.089553
training accuracy: 0.984375     test accuracy: 0.907093
lr decays to 0.001501
Average cost in epoch 91: 0.091120
training accuracy: 0.937500     test accuracy: 0.908092
Average cost in epoch 92: 0.079039
training accuracy: 0.968750     test accuracy: 0.905095
Average cost in epoch 93: 0.087218
training accuracy: 0.953125     test accuracy: 0.906094
Average cost in epoch 94: 0.080251
training accuracy: 0.937500     test accuracy: 0.909091

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 95: 0.080360
training accuracy: 0.984375     test accuracy: 0.913087
lr decays to 0.001351
Average cost in epoch 96: 0.085838
training accuracy: 0.921875     test accuracy: 0.909091
Average cost in epoch 97: 0.084710
training accuracy: 0.984375     test accuracy: 0.914086
Average cost in epoch 98: 0.094980
training accuracy: 0.953125     test accuracy: 0.913087
Average cost in epoch 99: 0.068380
training accuracy: 0.968750     test accuracy: 0.907093

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 100: 0.090430
training accuracy: 1.000000     test accuracy: 0.903097
lr decays to 0.001216
Average cost in epoch 101: 0.085615
training accuracy: 0.984375     test accuracy: 0.902098
Average cost in epoch 102: 0.075496
training accuracy: 0.968750     test accuracy: 0.910090
Average cost in epoch 103: 0.084526
training accuracy: 0.953125     test accuracy: 0.908092
Average cost in epoch 104: 0.074510
training accuracy: 0.921875     test accuracy: 0.906094

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 105: 0.072232
training accuracy: 0.937500     test accuracy: 0.908092
Average cost in epoch 106: 0.091299
training accuracy: 0.937500     test accuracy: 0.912088
Average cost in epoch 107: 0.070943
training accuracy: 0.984375     test accuracy: 0.913087
Average cost in epoch 108: 0.084230
training accuracy: 1.000000     test accuracy: 0.907093
Average cost in epoch 109: 0.078014
training accuracy: 1.000000     test accuracy: 0.909091

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 110: 0.087938
training accuracy: 0.968750     test accuracy: 0.902098
Average cost in epoch 111: 0.082996
training accuracy: 0.953125     test accuracy: 0.908092
Average cost in epoch 112: 0.076178
training accuracy: 0.968750     test accuracy: 0.908092
Average cost in epoch 113: 0.088402
training accuracy: 0.984375     test accuracy: 0.909091
Average cost in epoch 114: 0.077790
training accuracy: 0.953125     test accuracy: 0.916084

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 115: 0.076862
training accuracy: 0.968750     test accuracy: 0.916084
Average cost in epoch 116: 0.082479
training accuracy: 0.953125     test accuracy: 0.907093
Average cost in epoch 117: 0.082389
training accuracy: 0.953125     test accuracy: 0.906094
Average cost in epoch 118: 0.072744
training accuracy: 0.968750     test accuracy: 0.906094
Average cost in epoch 119: 0.088229
training accuracy: 0.984375     test accuracy: 0.909091

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 120: 0.090302
training accuracy: 0.906250     test accuracy: 0.908092
Average cost in epoch 121: 0.072569
training accuracy: 0.937500     test accuracy: 0.908092
Average cost in epoch 122: 0.079608
training accuracy: 0.953125     test accuracy: 0.913087
Average cost in epoch 123: 0.067722
training accuracy: 0.921875     test accuracy: 0.911089
Average cost in epoch 124: 0.078133
training accuracy: 0.984375     test accuracy: 0.912088

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 125: 0.067806
training accuracy: 0.953125     test accuracy: 0.909091
Average cost in epoch 126: 0.082103
training accuracy: 0.937500     test accuracy: 0.899101
Average cost in epoch 127: 0.071060
training accuracy: 0.968750     test accuracy: 0.910090
Average cost in epoch 128: 0.071835
training accuracy: 0.984375     test accuracy: 0.915085
Average cost in epoch 129: 0.075057
training accuracy: 0.968750     test accuracy: 0.913087

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 130: 0.071855
training accuracy: 1.000000     test accuracy: 0.906094
Average cost in epoch 131: 0.072884
training accuracy: 0.968750     test accuracy: 0.915085
Average cost in epoch 132: 0.078112
training accuracy: 0.968750     test accuracy: 0.912088
Average cost in epoch 133: 0.082155
training accuracy: 0.968750     test accuracy: 0.919081
Average cost in epoch 134: 0.078600
training accuracy: 0.953125     test accuracy: 0.915085

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 135: 0.071139
training accuracy: 0.937500     test accuracy: 0.910090
Average cost in epoch 136: 0.076755
training accuracy: 0.984375     test accuracy: 0.916084
Average cost in epoch 137: 0.075554
training accuracy: 0.937500     test accuracy: 0.912088
Average cost in epoch 138: 0.070879
training accuracy: 0.984375     test accuracy: 0.909091
Average cost in epoch 139: 0.079333
training accuracy: 0.906250     test accuracy: 0.907093

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 140: 0.079671
training accuracy: 0.937500     test accuracy: 0.896104
Average cost in epoch 141: 0.078106
training accuracy: 1.000000     test accuracy: 0.920080
Average cost in epoch 142: 0.075432
training accuracy: 0.953125     test accuracy: 0.911089
Average cost in epoch 143: 0.079551
training accuracy: 0.968750     test accuracy: 0.910090
Average cost in epoch 144: 0.084668
training accuracy: 1.000000     test accuracy: 0.913087

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 145: 0.072498
training accuracy: 1.000000     test accuracy: 0.911089
Average cost in epoch 146: 0.085652
training accuracy: 0.968750     test accuracy: 0.910090
Average cost in epoch 147: 0.069551
training accuracy: 0.968750     test accuracy: 0.915085
Average cost in epoch 148: 0.079073
training accuracy: 0.968750     test accuracy: 0.914086
Average cost in epoch 149: 0.075973
training accuracy: 0.968750     test accuracy: 0.915085

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 150: 0.072959
training accuracy: 0.906250     test accuracy: 0.906094
Average cost in epoch 151: 0.079615
training accuracy: 0.953125     test accuracy: 0.915085
Average cost in epoch 152: 0.073735
training accuracy: 1.000000     test accuracy: 0.919081
Average cost in epoch 153: 0.058886
training accuracy: 0.984375     test accuracy: 0.912088
Average cost in epoch 154: 0.079732
training accuracy: 0.906250     test accuracy: 0.914086

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 155: 0.080735
training accuracy: 1.000000     test accuracy: 0.907093
Average cost in epoch 156: 0.064494
training accuracy: 0.968750     test accuracy: 0.913087
Average cost in epoch 157: 0.077010
training accuracy: 0.953125     test accuracy: 0.913087
Average cost in epoch 158: 0.081616
training accuracy: 0.984375     test accuracy: 0.914086
Average cost in epoch 159: 0.070870
training accuracy: 1.000000     test accuracy: 0.912088

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 160: 0.072836
training accuracy: 0.968750     test accuracy: 0.914086
Average cost in epoch 161: 0.069394
training accuracy: 0.953125     test accuracy: 0.910090
Average cost in epoch 162: 0.069533
training accuracy: 0.953125     test accuracy: 0.907093
Average cost in epoch 163: 0.073745
training accuracy: 0.984375     test accuracy: 0.907093
Average cost in epoch 164: 0.078216
training accuracy: 0.968750     test accuracy: 0.911089

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 165: 0.087395
training accuracy: 1.000000     test accuracy: 0.911089
Average cost in epoch 166: 0.084609
training accuracy: 0.968750     test accuracy: 0.911089
Average cost in epoch 167: 0.071838
training accuracy: 0.984375     test accuracy: 0.915085
Average cost in epoch 168: 0.067577
training accuracy: 0.968750     test accuracy: 0.908092
Average cost in epoch 169: 0.077247
training accuracy: 0.984375     test accuracy: 0.909091

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 170: 0.084498
training accuracy: 0.984375     test accuracy: 0.908092
Average cost in epoch 171: 0.074588
training accuracy: 0.968750     test accuracy: 0.912088
Average cost in epoch 172: 0.068117
training accuracy: 0.968750     test accuracy: 0.907093
Average cost in epoch 173: 0.067502
training accuracy: 0.984375     test accuracy: 0.909091
Average cost in epoch 174: 0.072381
training accuracy: 0.968750     test accuracy: 0.910090

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 175: 0.075661
training accuracy: 1.000000     test accuracy: 0.911089
Average cost in epoch 176: 0.079179
training accuracy: 0.937500     test accuracy: 0.913087
Average cost in epoch 177: 0.078037
training accuracy: 0.953125     test accuracy: 0.912088
Average cost in epoch 178: 0.072092
training accuracy: 0.984375     test accuracy: 0.910090
Average cost in epoch 179: 0.083436
training accuracy: 0.937500     test accuracy: 0.914086

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 180: 0.060454
training accuracy: 1.000000     test accuracy: 0.910090
Average cost in epoch 181: 0.080665
training accuracy: 0.968750     test accuracy: 0.907093
Average cost in epoch 182: 0.077811
training accuracy: 0.953125     test accuracy: 0.910090
Average cost in epoch 183: 0.083841
training accuracy: 0.968750     test accuracy: 0.904096
Average cost in epoch 184: 0.072251
training accuracy: 0.937500     test accuracy: 0.907093

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 185: 0.067431
training accuracy: 0.984375     test accuracy: 0.909091
Average cost in epoch 186: 0.069234
training accuracy: 0.937500     test accuracy: 0.910090
Average cost in epoch 187: 0.090687
training accuracy: 0.937500     test accuracy: 0.909091
Average cost in epoch 188: 0.074990
training accuracy: 1.000000     test accuracy: 0.907093
Average cost in epoch 189: 0.064660
training accuracy: 0.984375     test accuracy: 0.906094

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 190: 0.072729
training accuracy: 0.968750     test accuracy: 0.913087
Average cost in epoch 191: 0.071725
training accuracy: 0.953125     test accuracy: 0.909091
Average cost in epoch 192: 0.063578
training accuracy: 0.984375     test accuracy: 0.908092
Average cost in epoch 193: 0.086582
training accuracy: 0.984375     test accuracy: 0.891109
Average cost in epoch 194: 0.073794
training accuracy: 0.984375     test accuracy: 0.899101

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Average cost in epoch 195: 0.076745
training accuracy: 0.984375     test accuracy: 0.906094
Average cost in epoch 196: 0.074111
training accuracy: 0.953125     test accuracy: 0.911089
Average cost in epoch 197: 0.061527
training accuracy: 0.937500     test accuracy: 0.913087
Average cost in epoch 198: 0.078156
training accuracy: 0.953125     test accuracy: 0.904096
Average cost in epoch 199: 0.070574
training accuracy: 0.953125     test accuracy: 0.906094

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_18.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 4007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 19, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_19.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22863')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22863')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22863')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22863')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22863')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22863')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22863')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22863')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22863')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22863')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22863')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22863')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22863')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22863')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22863')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
INFO (theano.gof.compilelock): Waiting for existing lock by process '23057' (I am process '22863')
INFO (theano.gof.compilelock): To manually release the lock, delete /net/10.79.12.62/deep/u/yetian1/.theano/compiledir_Linux-3.13--generic-x86_64-with-debian-jessie-sid-x86_64-2.7.11-64/lock_dir
Ending compiling...
Compiling time: 254.45
Starting training...
Average cost in epoch 0: 2.805472
training accuracy: 0.093750     test accuracy: 0.080919
Average cost in epoch 1: 2.560162
training accuracy: 0.078125     test accuracy: 0.082917
Average cost in epoch 2: 2.541972
training accuracy: 0.078125     test accuracy: 0.087912
Average cost in epoch 3: 2.531715
training accuracy: 0.109375     test accuracy: 0.094905
Average cost in epoch 4: 2.516543
training accuracy: 0.171875     test accuracy: 0.070929

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 5: 2.503529
training accuracy: 0.125000     test accuracy: 0.089910
lr decays to 0.009000
Average cost in epoch 6: 2.510343
training accuracy: 0.171875     test accuracy: 0.076923
Average cost in epoch 7: 2.494743
training accuracy: 0.093750     test accuracy: 0.074925
Average cost in epoch 8: 2.488646
training accuracy: 0.140625     test accuracy: 0.072927
Average cost in epoch 9: 2.480439
training accuracy: 0.156250     test accuracy: 0.090909

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 10: 2.481613
training accuracy: 0.062500     test accuracy: 0.084915
lr decays to 0.008100
Average cost in epoch 11: 2.467806
training accuracy: 0.109375     test accuracy: 0.083916
Average cost in epoch 12: 2.465909
training accuracy: 0.140625     test accuracy: 0.091908
Average cost in epoch 13: 2.460905
training accuracy: 0.140625     test accuracy: 0.089910
Average cost in epoch 14: 2.433807
training accuracy: 0.125000     test accuracy: 0.096903

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 15: 2.459618
training accuracy: 0.109375     test accuracy: 0.096903
lr decays to 0.007290
Average cost in epoch 16: 2.449210
training accuracy: 0.171875     test accuracy: 0.083916
Average cost in epoch 17: 2.450323
training accuracy: 0.109375     test accuracy: 0.097902
Average cost in epoch 18: 2.429005
training accuracy: 0.140625     test accuracy: 0.095904
Average cost in epoch 19: 2.433307
training accuracy: 0.187500     test accuracy: 0.093906

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 20: 2.433126
training accuracy: 0.125000     test accuracy: 0.097902
lr decays to 0.006561
Average cost in epoch 21: 2.423895
training accuracy: 0.140625     test accuracy: 0.113886
Average cost in epoch 22: 2.431336
training accuracy: 0.140625     test accuracy: 0.094905
Average cost in epoch 23: 2.394367
training accuracy: 0.125000     test accuracy: 0.093906
Average cost in epoch 24: 2.390710
training accuracy: 0.093750     test accuracy: 0.086913

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 25: 2.386609
training accuracy: 0.156250     test accuracy: 0.092907
lr decays to 0.005905
Average cost in epoch 26: 2.389290
training accuracy: 0.093750     test accuracy: 0.084915
Average cost in epoch 27: 2.374652
training accuracy: 0.125000     test accuracy: 0.088911
Average cost in epoch 28: 2.364948
training accuracy: 0.171875     test accuracy: 0.098901
Average cost in epoch 29: 2.370494
training accuracy: 0.171875     test accuracy: 0.094905

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 30: 2.387941
training accuracy: 0.203125     test accuracy: 0.102897
lr decays to 0.005314
Average cost in epoch 31: 2.378315
training accuracy: 0.187500     test accuracy: 0.094905
Average cost in epoch 32: 2.351971
training accuracy: 0.265625     test accuracy: 0.091908
Average cost in epoch 33: 2.328713
training accuracy: 0.187500     test accuracy: 0.096903
Average cost in epoch 34: 2.332693
training accuracy: 0.265625     test accuracy: 0.095904

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 35: 2.326522
training accuracy: 0.156250     test accuracy: 0.083916
lr decays to 0.004783
Average cost in epoch 36: 2.328673
training accuracy: 0.156250     test accuracy: 0.086913
Average cost in epoch 37: 2.308998
training accuracy: 0.125000     test accuracy: 0.096903
Average cost in epoch 38: 2.298612
training accuracy: 0.203125     test accuracy: 0.098901
Average cost in epoch 39: 2.279735
training accuracy: 0.312500     test accuracy: 0.089910

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 40: 2.276511
training accuracy: 0.312500     test accuracy: 0.099900
lr decays to 0.004305
Average cost in epoch 41: 2.290063
training accuracy: 0.171875     test accuracy: 0.084915
Average cost in epoch 42: 2.267226
training accuracy: 0.203125     test accuracy: 0.101898
Average cost in epoch 43: 2.290482
training accuracy: 0.218750     test accuracy: 0.082917
Average cost in epoch 44: 2.289258
training accuracy: 0.250000     test accuracy: 0.087912

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 45: 2.237324
training accuracy: 0.203125     test accuracy: 0.086913
lr decays to 0.003874
Average cost in epoch 46: 2.232680
training accuracy: 0.265625     test accuracy: 0.094905
Average cost in epoch 47: 2.233122
training accuracy: 0.265625     test accuracy: 0.095904
Average cost in epoch 48: 2.255683
training accuracy: 0.250000     test accuracy: 0.085914
Average cost in epoch 49: 2.202583
training accuracy: 0.234375     test accuracy: 0.087912

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 50: 2.214613
training accuracy: 0.281250     test accuracy: 0.090909
lr decays to 0.003487
Average cost in epoch 51: 2.170847
training accuracy: 0.187500     test accuracy: 0.087912
Average cost in epoch 52: 2.196745
training accuracy: 0.234375     test accuracy: 0.099900
Average cost in epoch 53: 2.178469
training accuracy: 0.203125     test accuracy: 0.087912
Average cost in epoch 54: 2.200096
training accuracy: 0.234375     test accuracy: 0.093906

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 55: 2.208133
training accuracy: 0.234375     test accuracy: 0.094905
lr decays to 0.003138
Average cost in epoch 56: 2.174660
training accuracy: 0.203125     test accuracy: 0.088911
Average cost in epoch 57: 2.138170
training accuracy: 0.328125     test accuracy: 0.082917
Average cost in epoch 58: 2.167786
training accuracy: 0.218750     test accuracy: 0.092907
Average cost in epoch 59: 2.149281
training accuracy: 0.250000     test accuracy: 0.095904

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 60: 2.137297
training accuracy: 0.203125     test accuracy: 0.085914
lr decays to 0.002824
Average cost in epoch 61: 2.090554
training accuracy: 0.234375     test accuracy: 0.084915
Average cost in epoch 62: 2.145766
training accuracy: 0.140625     test accuracy: 0.089910
Average cost in epoch 63: 2.099294
training accuracy: 0.312500     test accuracy: 0.088911
Average cost in epoch 64: 2.079884
training accuracy: 0.187500     test accuracy: 0.088911

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 65: 2.106748
training accuracy: 0.390625     test accuracy: 0.086913
lr decays to 0.002542
Average cost in epoch 66: 2.050841
training accuracy: 0.218750     test accuracy: 0.093906
Average cost in epoch 67: 2.090410
training accuracy: 0.390625     test accuracy: 0.092907
Average cost in epoch 68: 2.083408
training accuracy: 0.359375     test accuracy: 0.085914
Average cost in epoch 69: 2.083816
training accuracy: 0.234375     test accuracy: 0.091908

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 70: 2.068556
training accuracy: 0.281250     test accuracy: 0.091908
lr decays to 0.002288
Average cost in epoch 71: 2.058968
training accuracy: 0.250000     test accuracy: 0.092907
Average cost in epoch 72: 1.990376
training accuracy: 0.296875     test accuracy: 0.088911
Average cost in epoch 73: 2.075058
training accuracy: 0.218750     test accuracy: 0.084915
Average cost in epoch 74: 2.007332
training accuracy: 0.281250     test accuracy: 0.100899

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 75: 2.064332
training accuracy: 0.234375     test accuracy: 0.091908
lr decays to 0.002059
Average cost in epoch 76: 1.996173
training accuracy: 0.296875     test accuracy: 0.087912
Average cost in epoch 77: 2.000874
training accuracy: 0.328125     test accuracy: 0.096903
Average cost in epoch 78: 2.018418
training accuracy: 0.328125     test accuracy: 0.102897
Average cost in epoch 79: 1.991560
training accuracy: 0.281250     test accuracy: 0.088911

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 80: 1.961235
training accuracy: 0.375000     test accuracy: 0.086913
lr decays to 0.001853
Average cost in epoch 81: 1.972196
training accuracy: 0.218750     test accuracy: 0.100899
Average cost in epoch 82: 2.002298
training accuracy: 0.343750     test accuracy: 0.094905
Average cost in epoch 83: 2.001386
training accuracy: 0.375000     test accuracy: 0.086913
Average cost in epoch 84: 1.941941
training accuracy: 0.312500     test accuracy: 0.085914

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 85: 1.957207
training accuracy: 0.296875     test accuracy: 0.086913
lr decays to 0.001668
Average cost in epoch 86: 1.949717
training accuracy: 0.421875     test accuracy: 0.090909
Average cost in epoch 87: 1.999520
training accuracy: 0.218750     test accuracy: 0.086913
Average cost in epoch 88: 2.013129
training accuracy: 0.359375     test accuracy: 0.088911
Average cost in epoch 89: 1.951262
training accuracy: 0.296875     test accuracy: 0.095904

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 90: 1.964595
training accuracy: 0.281250     test accuracy: 0.094905
lr decays to 0.001501
Average cost in epoch 91: 1.953232
training accuracy: 0.359375     test accuracy: 0.096903
Average cost in epoch 92: 1.971310
training accuracy: 0.281250     test accuracy: 0.091908
Average cost in epoch 93: 1.981754
training accuracy: 0.312500     test accuracy: 0.088911
Average cost in epoch 94: 1.940750
training accuracy: 0.234375     test accuracy: 0.085914

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 95: 1.894904
training accuracy: 0.328125     test accuracy: 0.095904
lr decays to 0.001351
Average cost in epoch 96: 1.939668
training accuracy: 0.328125     test accuracy: 0.094905
Average cost in epoch 97: 1.934108
training accuracy: 0.296875     test accuracy: 0.094905
Average cost in epoch 98: 1.910450
training accuracy: 0.406250     test accuracy: 0.103896
Average cost in epoch 99: 1.934241
training accuracy: 0.359375     test accuracy: 0.092907

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 100: 1.931930
training accuracy: 0.375000     test accuracy: 0.099900
lr decays to 0.001216
Average cost in epoch 101: 1.947461
training accuracy: 0.406250     test accuracy: 0.094905
Average cost in epoch 102: 1.910162
training accuracy: 0.375000     test accuracy: 0.090909
Average cost in epoch 103: 1.909033
training accuracy: 0.328125     test accuracy: 0.090909
Average cost in epoch 104: 1.915580
training accuracy: 0.421875     test accuracy: 0.089910

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 105: 1.876027
training accuracy: 0.421875     test accuracy: 0.093906
Average cost in epoch 106: 1.885595
training accuracy: 0.484375     test accuracy: 0.095904
Average cost in epoch 107: 1.878756
training accuracy: 0.359375     test accuracy: 0.098901
Average cost in epoch 108: 1.822604
training accuracy: 0.312500     test accuracy: 0.100899
Average cost in epoch 109: 1.864259
training accuracy: 0.359375     test accuracy: 0.093906

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 110: 1.909538
training accuracy: 0.375000     test accuracy: 0.105894
Average cost in epoch 111: 1.856781
training accuracy: 0.312500     test accuracy: 0.102897
Average cost in epoch 112: 1.897597
training accuracy: 0.406250     test accuracy: 0.093906
Average cost in epoch 113: 1.867415
training accuracy: 0.406250     test accuracy: 0.099900
Average cost in epoch 114: 1.877091
training accuracy: 0.312500     test accuracy: 0.094905

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 115: 1.897975
training accuracy: 0.468750     test accuracy: 0.087912
Average cost in epoch 116: 1.908889
training accuracy: 0.203125     test accuracy: 0.092907
Average cost in epoch 117: 1.875362
training accuracy: 0.390625     test accuracy: 0.095904
Average cost in epoch 118: 1.890988
training accuracy: 0.312500     test accuracy: 0.101898
Average cost in epoch 119: 1.835742
training accuracy: 0.312500     test accuracy: 0.097902

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 120: 1.883860
training accuracy: 0.359375     test accuracy: 0.100899
Average cost in epoch 121: 1.843938
training accuracy: 0.375000     test accuracy: 0.094905
Average cost in epoch 122: 1.833386
training accuracy: 0.453125     test accuracy: 0.100899
Average cost in epoch 123: 1.894714
training accuracy: 0.343750     test accuracy: 0.096903
Average cost in epoch 124: 1.864891
training accuracy: 0.375000     test accuracy: 0.098901

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 125: 1.818451
training accuracy: 0.421875     test accuracy: 0.089910
Average cost in epoch 126: 1.822042
training accuracy: 0.375000     test accuracy: 0.098901
Average cost in epoch 127: 1.842593
training accuracy: 0.390625     test accuracy: 0.097902
Average cost in epoch 128: 1.817628
training accuracy: 0.328125     test accuracy: 0.091908
Average cost in epoch 129: 1.813106
training accuracy: 0.296875     test accuracy: 0.088911

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 130: 1.784710
training accuracy: 0.406250     test accuracy: 0.094905
Average cost in epoch 131: 1.774056
training accuracy: 0.328125     test accuracy: 0.096903
Average cost in epoch 132: 1.814246
training accuracy: 0.359375     test accuracy: 0.097902
Average cost in epoch 133: 1.796708
training accuracy: 0.343750     test accuracy: 0.095904
Average cost in epoch 134: 1.771047
training accuracy: 0.390625     test accuracy: 0.096903

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 135: 1.820052
training accuracy: 0.359375     test accuracy: 0.093906
Average cost in epoch 136: 1.793299
training accuracy: 0.390625     test accuracy: 0.094905
Average cost in epoch 137: 1.789869
training accuracy: 0.343750     test accuracy: 0.082917
Average cost in epoch 138: 1.806853
training accuracy: 0.406250     test accuracy: 0.095904
Average cost in epoch 139: 1.842427
training accuracy: 0.453125     test accuracy: 0.087912

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 140: 1.796574
training accuracy: 0.250000     test accuracy: 0.091908
Average cost in epoch 141: 1.792175
training accuracy: 0.359375     test accuracy: 0.100899
Average cost in epoch 142: 1.802758
training accuracy: 0.375000     test accuracy: 0.093906
Average cost in epoch 143: 1.782285
training accuracy: 0.390625     test accuracy: 0.097902
Average cost in epoch 144: 1.766224
training accuracy: 0.468750     test accuracy: 0.100899

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 145: 1.754143
training accuracy: 0.359375     test accuracy: 0.088911
Average cost in epoch 146: 1.761342
training accuracy: 0.234375     test accuracy: 0.097902
Average cost in epoch 147: 1.789418
training accuracy: 0.281250     test accuracy: 0.098901
Average cost in epoch 148: 1.755416
training accuracy: 0.359375     test accuracy: 0.096903
Average cost in epoch 149: 1.797090
training accuracy: 0.390625     test accuracy: 0.101898

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 150: 1.749864
training accuracy: 0.421875     test accuracy: 0.096903
Average cost in epoch 151: 1.772917
training accuracy: 0.312500     test accuracy: 0.098901
Average cost in epoch 152: 1.762420
training accuracy: 0.468750     test accuracy: 0.094905
Average cost in epoch 153: 1.779057
training accuracy: 0.406250     test accuracy: 0.091908
Average cost in epoch 154: 1.768734
training accuracy: 0.328125     test accuracy: 0.090909

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 155: 1.784683
training accuracy: 0.359375     test accuracy: 0.097902
Average cost in epoch 156: 1.715608
training accuracy: 0.421875     test accuracy: 0.090909
Average cost in epoch 157: 1.759193
training accuracy: 0.468750     test accuracy: 0.091908
Average cost in epoch 158: 1.781263
training accuracy: 0.359375     test accuracy: 0.096903
Average cost in epoch 159: 1.726425
training accuracy: 0.453125     test accuracy: 0.094905

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 160: 1.733408
training accuracy: 0.312500     test accuracy: 0.092907
Average cost in epoch 161: 1.780095
training accuracy: 0.437500     test accuracy: 0.097902
Average cost in epoch 162: 1.754627
training accuracy: 0.390625     test accuracy: 0.096903
Average cost in epoch 163: 1.768567
training accuracy: 0.421875     test accuracy: 0.094905
Average cost in epoch 164: 1.727013
training accuracy: 0.375000     test accuracy: 0.091908

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 165: 1.741909
training accuracy: 0.390625     test accuracy: 0.082917
Average cost in epoch 166: 1.756907
training accuracy: 0.421875     test accuracy: 0.085914
Average cost in epoch 167: 1.748225
training accuracy: 0.406250     test accuracy: 0.089910
Average cost in epoch 168: 1.754229
training accuracy: 0.390625     test accuracy: 0.094905
Average cost in epoch 169: 1.728776
training accuracy: 0.484375     test accuracy: 0.093906

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 170: 1.720748
training accuracy: 0.343750     test accuracy: 0.090909
Average cost in epoch 171: 1.719814
training accuracy: 0.531250     test accuracy: 0.092907
Average cost in epoch 172: 1.688895
training accuracy: 0.421875     test accuracy: 0.093906
Average cost in epoch 173: 1.700540
training accuracy: 0.421875     test accuracy: 0.095904
Average cost in epoch 174: 1.685216
training accuracy: 0.421875     test accuracy: 0.092907

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 175: 1.738888
training accuracy: 0.437500     test accuracy: 0.087912
Average cost in epoch 176: 1.705747
training accuracy: 0.265625     test accuracy: 0.097902
Average cost in epoch 177: 1.695255
training accuracy: 0.359375     test accuracy: 0.091908
Average cost in epoch 178: 1.676803
training accuracy: 0.296875     test accuracy: 0.088911
Average cost in epoch 179: 1.691324
training accuracy: 0.359375     test accuracy: 0.093906

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 180: 1.736672
training accuracy: 0.437500     test accuracy: 0.091908
Average cost in epoch 181: 1.747498
training accuracy: 0.484375     test accuracy: 0.091908
Average cost in epoch 182: 1.708594
training accuracy: 0.359375     test accuracy: 0.098901
Average cost in epoch 183: 1.670862
training accuracy: 0.437500     test accuracy: 0.097902
Average cost in epoch 184: 1.691203
training accuracy: 0.375000     test accuracy: 0.090909

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 185: 1.672606
training accuracy: 0.406250     test accuracy: 0.090909
Average cost in epoch 186: 1.698321
training accuracy: 0.375000     test accuracy: 0.091908
Average cost in epoch 187: 1.699320
training accuracy: 0.421875     test accuracy: 0.089910
Average cost in epoch 188: 1.758949
training accuracy: 0.531250     test accuracy: 0.090909
Average cost in epoch 189: 1.699816
training accuracy: 0.343750     test accuracy: 0.090909

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 190: 1.671005
training accuracy: 0.375000     test accuracy: 0.090909
Average cost in epoch 191: 1.687628
training accuracy: 0.531250     test accuracy: 0.086913
Average cost in epoch 192: 1.694772
training accuracy: 0.312500     test accuracy: 0.092907
Average cost in epoch 193: 1.693312
training accuracy: 0.421875     test accuracy: 0.098901
Average cost in epoch 194: 1.736923
training accuracy: 0.343750     test accuracy: 0.099900

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Average cost in epoch 195: 1.647068
training accuracy: 0.468750     test accuracy: 0.095904
Average cost in epoch 196: 1.695655
training accuracy: 0.390625     test accuracy: 0.093906
Average cost in epoch 197: 1.624435
training accuracy: 0.296875     test accuracy: 0.092907
Average cost in epoch 198: 1.648998
training accuracy: 0.328125     test accuracy: 0.097902
Average cost in epoch 199: 1.714375
training accuracy: 0.421875     test accuracy: 0.094905

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_19.pkl

Locking... locked.
No job requests to schedule
/afs/cs.stanford.edu/u/yetian1/.local/lib/python2.7/site-packages/theano/sandbox/cuda/nvcc_compiler.py:224: UserWarning: You have the cuda library directory in your lib_dirs. This has been known to cause problems and should not be done.
  warnings.warn("You have the cuda library directory in your "
Using gpu device 0: GeForce GTX 680 (CNMeM is disabled, CuDNN 4007)
options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "pyramid-attention-lstm.json", 
        "dump_epoch": 5, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 20, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 64, 
        "max_epoch": 200, 
        "learning_rate": 0.01, 
        "decay": 0.9, 
        "load_params": false, 
        "load_name": "pyramid-attention-lstm.pkl", 
        "dump_params": true, 
        "weight_path": "weights/pyramid-attention-lstm", 
        "reg_weight": 0.0002, 
        "dump_name": "pyramid-attention-lstm_20.pkl", 
        "batch_size_test": null, 
        "decay_period": 5, 
        "dropout": true, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "sentence_level_att": true, 
        "num_hid_2": 32, 
        "num_hid": 32, 
        "g_size": 64, 
        "m_size": 64, 
        "context_length": 16, 
        "sentence_length": 16, 
        "model_name": "pyramid-attention-lstm"
    }
}
Starting compiling...
Ending compiling...
Compiling time: 235.77
Starting training...
Average cost in epoch 0: 1.873255
training accuracy: 0.531250     test accuracy: 0.492507
Average cost in epoch 1: 0.796103
training accuracy: 0.734375     test accuracy: 0.848152
Average cost in epoch 2: 0.371245
training accuracy: 0.890625     test accuracy: 0.909091
Average cost in epoch 3: 0.264195
training accuracy: 0.859375     test accuracy: 0.909091
Average cost in epoch 4: 0.255293
training accuracy: 0.859375     test accuracy: 0.911089

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 5: 0.209607
training accuracy: 0.890625     test accuracy: 0.911089
lr decays to 0.009000
Average cost in epoch 6: 0.184543
training accuracy: 0.875000     test accuracy: 0.909091
Average cost in epoch 7: 0.215308
training accuracy: 0.953125     test accuracy: 0.914086
Average cost in epoch 8: 0.183601
training accuracy: 0.937500     test accuracy: 0.909091
Average cost in epoch 9: 0.178035
training accuracy: 0.828125     test accuracy: 0.911089

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 10: 0.163969
training accuracy: 0.906250     test accuracy: 0.912088
lr decays to 0.008100
Average cost in epoch 11: 0.155770
training accuracy: 0.843750     test accuracy: 0.914086
Average cost in epoch 12: 0.144275
training accuracy: 0.968750     test accuracy: 0.940060
Average cost in epoch 13: 0.140963
training accuracy: 0.968750     test accuracy: 0.947053
Average cost in epoch 14: 0.135625
training accuracy: 0.890625     test accuracy: 0.954046

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 15: 0.117903
training accuracy: 0.953125     test accuracy: 0.949051
lr decays to 0.007290
Average cost in epoch 16: 0.105181
training accuracy: 0.953125     test accuracy: 0.952048
Average cost in epoch 17: 0.123079
training accuracy: 0.984375     test accuracy: 0.951049
Average cost in epoch 18: 0.107609
training accuracy: 0.968750     test accuracy: 0.958042
Average cost in epoch 19: 0.100175
training accuracy: 0.984375     test accuracy: 0.952048

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 20: 0.089786
training accuracy: 0.968750     test accuracy: 0.952048
lr decays to 0.006561
Average cost in epoch 21: 0.075605
training accuracy: 0.984375     test accuracy: 0.958042
Average cost in epoch 22: 0.086406
training accuracy: 0.984375     test accuracy: 0.968032
Average cost in epoch 23: 0.049382
training accuracy: 1.000000     test accuracy: 0.973027
Average cost in epoch 24: 0.071146
training accuracy: 0.968750     test accuracy: 0.964036

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 25: 0.055108
training accuracy: 0.984375     test accuracy: 0.969031
lr decays to 0.005905
Average cost in epoch 26: 0.065144
training accuracy: 1.000000     test accuracy: 0.967033
Average cost in epoch 27: 0.028709
training accuracy: 1.000000     test accuracy: 0.970030
Average cost in epoch 28: 0.041151
training accuracy: 0.937500     test accuracy: 0.967033
Average cost in epoch 29: 0.055855
training accuracy: 0.984375     test accuracy: 0.973027

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 30: 0.031709
training accuracy: 0.984375     test accuracy: 0.968032
lr decays to 0.005314
Average cost in epoch 31: 0.028949
training accuracy: 1.000000     test accuracy: 0.976024
Average cost in epoch 32: 0.035865
training accuracy: 0.984375     test accuracy: 0.970030
Average cost in epoch 33: 0.035993
training accuracy: 1.000000     test accuracy: 0.963037
Average cost in epoch 34: 0.018927
training accuracy: 0.968750     test accuracy: 0.959041

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 35: 0.050138
training accuracy: 1.000000     test accuracy: 0.964036
lr decays to 0.004783
Average cost in epoch 36: 0.028193
training accuracy: 1.000000     test accuracy: 0.970030
Average cost in epoch 37: 0.014102
training accuracy: 1.000000     test accuracy: 0.966034
Average cost in epoch 38: 0.011408
training accuracy: 1.000000     test accuracy: 0.966034
Average cost in epoch 39: 0.009518
training accuracy: 0.984375     test accuracy: 0.965035

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 40: 0.016334
training accuracy: 0.984375     test accuracy: 0.960040
lr decays to 0.004305
Average cost in epoch 41: 0.020464
training accuracy: 0.968750     test accuracy: 0.962038
Average cost in epoch 42: 0.021736
training accuracy: 1.000000     test accuracy: 0.960040
Average cost in epoch 43: 0.030113
training accuracy: 0.984375     test accuracy: 0.963037
Average cost in epoch 44: 0.019719
training accuracy: 1.000000     test accuracy: 0.965035

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 45: 0.004285
training accuracy: 1.000000     test accuracy: 0.967033
lr decays to 0.003874
Average cost in epoch 46: 0.005032
training accuracy: 1.000000     test accuracy: 0.965035
Average cost in epoch 47: 0.004426
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 48: 0.005075
training accuracy: 1.000000     test accuracy: 0.965035
Average cost in epoch 49: 0.003145
training accuracy: 1.000000     test accuracy: 0.963037

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 50: 0.001499
training accuracy: 1.000000     test accuracy: 0.963037
lr decays to 0.003487
Average cost in epoch 51: 0.003295
training accuracy: 1.000000     test accuracy: 0.964036
Average cost in epoch 52: 0.002790
training accuracy: 1.000000     test accuracy: 0.971029
Average cost in epoch 53: 0.001490
training accuracy: 1.000000     test accuracy: 0.968032
Average cost in epoch 54: 0.018265
training accuracy: 1.000000     test accuracy: 0.968032

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 55: 0.016916
training accuracy: 1.000000     test accuracy: 0.967033
lr decays to 0.003138
Average cost in epoch 56: 0.006642
training accuracy: 1.000000     test accuracy: 0.969031
Average cost in epoch 57: 0.002702
training accuracy: 1.000000     test accuracy: 0.971029
Average cost in epoch 58: 0.001531
training accuracy: 1.000000     test accuracy: 0.966034
Average cost in epoch 59: 0.003951
training accuracy: 1.000000     test accuracy: 0.968032

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 60: 0.021622
training accuracy: 1.000000     test accuracy: 0.966034
lr decays to 0.002824
Average cost in epoch 61: 0.003129
training accuracy: 1.000000     test accuracy: 0.969031
Average cost in epoch 62: 0.002381
training accuracy: 1.000000     test accuracy: 0.969031
Average cost in epoch 63: 0.002963
training accuracy: 1.000000     test accuracy: 0.970030
Average cost in epoch 64: 0.001918
training accuracy: 1.000000     test accuracy: 0.970030

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 65: 0.004927
training accuracy: 1.000000     test accuracy: 0.969031
lr decays to 0.002542
Average cost in epoch 66: 0.001068
training accuracy: 1.000000     test accuracy: 0.970030
Average cost in epoch 67: 0.005752
training accuracy: 1.000000     test accuracy: 0.968032
Average cost in epoch 68: 0.001042
training accuracy: 1.000000     test accuracy: 0.967033
Average cost in epoch 69: 0.001237
training accuracy: 1.000000     test accuracy: 0.973027

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 70: 0.001233
training accuracy: 1.000000     test accuracy: 0.973027
lr decays to 0.002288
Average cost in epoch 71: 0.005713
training accuracy: 1.000000     test accuracy: 0.968032
Average cost in epoch 72: 0.001450
training accuracy: 1.000000     test accuracy: 0.968032
Average cost in epoch 73: 0.000835
training accuracy: 1.000000     test accuracy: 0.967033
Average cost in epoch 74: 0.000691
training accuracy: 1.000000     test accuracy: 0.970030

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 75: 0.001021
training accuracy: 1.000000     test accuracy: 0.970030
lr decays to 0.002059
Average cost in epoch 76: 0.001231
training accuracy: 1.000000     test accuracy: 0.966034
Average cost in epoch 77: 0.000468
training accuracy: 1.000000     test accuracy: 0.970030
Average cost in epoch 78: 0.001678
training accuracy: 1.000000     test accuracy: 0.970030
Average cost in epoch 79: 0.000498
training accuracy: 1.000000     test accuracy: 0.969031

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 80: 0.000345
training accuracy: 1.000000     test accuracy: 0.968032
lr decays to 0.001853
Average cost in epoch 81: 0.000547
training accuracy: 1.000000     test accuracy: 0.969031
Average cost in epoch 82: 0.003208
training accuracy: 1.000000     test accuracy: 0.963037
Average cost in epoch 83: 0.000401
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 84: 0.000716
training accuracy: 1.000000     test accuracy: 0.963037

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 85: 0.000683
training accuracy: 1.000000     test accuracy: 0.962038
lr decays to 0.001668
Average cost in epoch 86: 0.000694
training accuracy: 1.000000     test accuracy: 0.961039
Average cost in epoch 87: 0.006940
training accuracy: 1.000000     test accuracy: 0.966034
Average cost in epoch 88: 0.000584
training accuracy: 1.000000     test accuracy: 0.967033
Average cost in epoch 89: 0.000340
training accuracy: 1.000000     test accuracy: 0.967033

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 90: 0.000422
training accuracy: 1.000000     test accuracy: 0.966034
lr decays to 0.001501
Average cost in epoch 91: 0.000454
training accuracy: 1.000000     test accuracy: 0.968032
Average cost in epoch 92: 0.001978
training accuracy: 1.000000     test accuracy: 0.966034
Average cost in epoch 93: 0.000400
training accuracy: 1.000000     test accuracy: 0.967033
Average cost in epoch 94: 0.000280
training accuracy: 1.000000     test accuracy: 0.967033

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 95: 0.001626
training accuracy: 1.000000     test accuracy: 0.966034
lr decays to 0.001351
Average cost in epoch 96: 0.001124
training accuracy: 1.000000     test accuracy: 0.967033
Average cost in epoch 97: 0.001839
training accuracy: 1.000000     test accuracy: 0.966034
Average cost in epoch 98: 0.001110
training accuracy: 1.000000     test accuracy: 0.964036
Average cost in epoch 99: 0.000296
training accuracy: 1.000000     test accuracy: 0.966034

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 100: 0.000719
training accuracy: 1.000000     test accuracy: 0.961039
lr decays to 0.001216
Average cost in epoch 101: 0.000570
training accuracy: 1.000000     test accuracy: 0.967033
Average cost in epoch 102: 0.001378
training accuracy: 1.000000     test accuracy: 0.966034
Average cost in epoch 103: 0.000118
training accuracy: 1.000000     test accuracy: 0.965035
Average cost in epoch 104: 0.001529
training accuracy: 1.000000     test accuracy: 0.963037

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 105: 0.000275
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 106: 0.000353
training accuracy: 1.000000     test accuracy: 0.963037
Average cost in epoch 107: 0.000283
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 108: 0.000704
training accuracy: 1.000000     test accuracy: 0.963037
Average cost in epoch 109: 0.000233
training accuracy: 1.000000     test accuracy: 0.963037

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 110: 0.000392
training accuracy: 1.000000     test accuracy: 0.960040
Average cost in epoch 111: 0.006338
training accuracy: 1.000000     test accuracy: 0.960040
Average cost in epoch 112: 0.000180
training accuracy: 1.000000     test accuracy: 0.961039
Average cost in epoch 113: 0.000213
training accuracy: 1.000000     test accuracy: 0.961039
Average cost in epoch 114: 0.000648
training accuracy: 1.000000     test accuracy: 0.961039

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 115: 0.000169
training accuracy: 1.000000     test accuracy: 0.961039
Average cost in epoch 116: 0.000244
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 117: 0.002673
training accuracy: 1.000000     test accuracy: 0.957043
Average cost in epoch 118: 0.000205
training accuracy: 1.000000     test accuracy: 0.958042
Average cost in epoch 119: 0.000442
training accuracy: 1.000000     test accuracy: 0.960040

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 120: 0.000252
training accuracy: 1.000000     test accuracy: 0.959041
Average cost in epoch 121: 0.000451
training accuracy: 1.000000     test accuracy: 0.960040
Average cost in epoch 122: 0.000140
training accuracy: 1.000000     test accuracy: 0.960040
Average cost in epoch 123: 0.000289
training accuracy: 1.000000     test accuracy: 0.961039
Average cost in epoch 124: 0.000360
training accuracy: 1.000000     test accuracy: 0.963037

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 125: 0.000164
training accuracy: 1.000000     test accuracy: 0.961039
Average cost in epoch 126: 0.000226
training accuracy: 1.000000     test accuracy: 0.961039
Average cost in epoch 127: 0.000108
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 128: 0.002411
training accuracy: 1.000000     test accuracy: 0.965035
Average cost in epoch 129: 0.000141
training accuracy: 1.000000     test accuracy: 0.963037

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 130: 0.000731
training accuracy: 1.000000     test accuracy: 0.963037
Average cost in epoch 131: 0.000150
training accuracy: 1.000000     test accuracy: 0.964036
Average cost in epoch 132: 0.000138
training accuracy: 1.000000     test accuracy: 0.963037
Average cost in epoch 133: 0.000311
training accuracy: 1.000000     test accuracy: 0.963037
Average cost in epoch 134: 0.000071
training accuracy: 1.000000     test accuracy: 0.962038

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 135: 0.000191
training accuracy: 1.000000     test accuracy: 0.959041
Average cost in epoch 136: 0.000418
training accuracy: 1.000000     test accuracy: 0.958042
Average cost in epoch 137: 0.000071
training accuracy: 1.000000     test accuracy: 0.958042
Average cost in epoch 138: 0.000183
training accuracy: 1.000000     test accuracy: 0.958042
Average cost in epoch 139: 0.000108
training accuracy: 1.000000     test accuracy: 0.958042

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 140: 0.011370
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 141: 0.000340
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 142: 0.000523
training accuracy: 1.000000     test accuracy: 0.962038

Average cost in epoch 143: 0.001991
training accuracy: 1.000000     test accuracy: 0.963037
Average cost in epoch 144: 0.000175
training accuracy: 1.000000     test accuracy: 0.964036

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 145: 0.000174
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 146: 0.000104
training accuracy: 1.000000     test accuracy: 0.963037
Average cost in epoch 147: 0.000341
training accuracy: 1.000000     test accuracy: 0.963037
Average cost in epoch 148: 0.000571
training accuracy: 1.000000     test accuracy: 0.961039
Average cost in epoch 149: 0.000178
training accuracy: 1.000000     test accuracy: 0.961039

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 150: 0.000666
training accuracy: 1.000000     test accuracy: 0.961039
Average cost in epoch 151: 0.000080
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 152: 0.000070
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 153: 0.000098
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 154: 0.000078
training accuracy: 1.000000     test accuracy: 0.963037

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 155: 0.000085
training accuracy: 1.000000     test accuracy: 0.963037
Average cost in epoch 156: 0.000226
training accuracy: 1.000000     test accuracy: 0.964036
Average cost in epoch 157: 0.000207
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 158: 0.000184
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 159: 0.002192
training accuracy: 1.000000     test accuracy: 0.967033

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 160: 0.000173
training accuracy: 1.000000     test accuracy: 0.967033
Average cost in epoch 161: 0.000063
training accuracy: 1.000000     test accuracy: 0.967033
Average cost in epoch 162: 0.000088
training accuracy: 1.000000     test accuracy: 0.965035
Average cost in epoch 163: 0.000064
training accuracy: 1.000000     test accuracy: 0.967033
Average cost in epoch 164: 0.000046
training accuracy: 1.000000     test accuracy: 0.965035

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 165: 0.000320
training accuracy: 1.000000     test accuracy: 0.965035
Average cost in epoch 166: 0.000456
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 167: 0.000063
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 168: 0.000100
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 169: 0.000154
training accuracy: 1.000000     test accuracy: 0.964036

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 170: 0.000469
training accuracy: 1.000000     test accuracy: 0.965035
Average cost in epoch 171: 0.000184
training accuracy: 1.000000     test accuracy: 0.963037
Average cost in epoch 172: 0.000067
training accuracy: 1.000000     test accuracy: 0.965035
Average cost in epoch 173: 0.000115
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 174: 0.000045
training accuracy: 1.000000     test accuracy: 0.962038

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 175: 0.000113
training accuracy: 1.000000     test accuracy: 0.965035
Average cost in epoch 176: 0.000065
training accuracy: 1.000000     test accuracy: 0.964036
Average cost in epoch 177: 0.000052
training accuracy: 1.000000     test accuracy: 0.963037
Average cost in epoch 178: 0.000041
training accuracy: 1.000000     test accuracy: 0.965035
Average cost in epoch 179: 0.000283
training accuracy: 1.000000     test accuracy: 0.961039

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 180: 0.000104
training accuracy: 1.000000     test accuracy: 0.966034
Average cost in epoch 181: 0.000344
training accuracy: 1.000000     test accuracy: 0.964036
Average cost in epoch 182: 0.000094
training accuracy: 1.000000     test accuracy: 0.967033
Average cost in epoch 183: 0.002191
training accuracy: 1.000000     test accuracy: 0.964036
Average cost in epoch 184: 0.001633
training accuracy: 1.000000     test accuracy: 0.963037

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 185: 0.001196
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 186: 0.000047
training accuracy: 1.000000     test accuracy: 0.964036
Average cost in epoch 187: 0.000368
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 188: 0.000088
training accuracy: 1.000000     test accuracy: 0.961039
Average cost in epoch 189: 0.000078
training accuracy: 1.000000     test accuracy: 0.961039

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 190: 0.001470
training accuracy: 1.000000     test accuracy: 0.961039
Average cost in epoch 191: 0.000264
training accuracy: 1.000000     test accuracy: 0.960040
Average cost in epoch 192: 0.000188
training accuracy: 1.000000     test accuracy: 0.962038
Average cost in epoch 193: 0.000031
training accuracy: 1.000000     test accuracy: 0.961039
Average cost in epoch 194: 0.000119
training accuracy: 1.000000     test accuracy: 0.964036

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Average cost in epoch 195: 0.000165
training accuracy: 1.000000     test accuracy: 0.964036
Average cost in epoch 196: 0.000071
training accuracy: 1.000000     test accuracy: 0.965035
Average cost in epoch 197: 0.002896
training accuracy: 1.000000     test accuracy: 0.963037
Average cost in epoch 198: 0.000113
training accuracy: 1.000000     test accuracy: 0.963037
Average cost in epoch 199: 0.000025
training accuracy: 1.000000     test accuracy: 0.964036

dump to weights/pyramid-attention-lstm/pyramid-attention-lstm_20.pkl

Locking... locked.
No job requests to schedule
