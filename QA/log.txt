options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 1, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_1.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 1.81
Starting training...
Average cost in epoch 0: 1.944737
training accuracy: 0.250000	test accuracy: 0.191808
Average cost in epoch 1: 1.338012
training accuracy: 0.843750	test accuracy: 0.820180
Average cost in epoch 2: 0.321114
training accuracy: 0.968750	test accuracy: 0.956044
Average cost in epoch 3: 0.120809
training accuracy: 0.968750	test accuracy: 0.946054
Average cost in epoch 4: 0.058648
training accuracy: 1.000000	test accuracy: 0.984016
Average cost in epoch 5: 0.053192
training accuracy: 1.000000	test accuracy: 0.978022
Average cost in epoch 6: 0.062278
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 7: 0.004418
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 8: 0.000957
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 9: 0.000566
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 10: 0.000267
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 11: 0.000128
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 12: 0.000058
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 13: 0.000025
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 14: 0.000011
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 15: 0.000004
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 16: 0.000002
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 17: 0.000001
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 18: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 19: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 20: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 21: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 22: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 23: 0.329763
training accuracy: 1.000000	test accuracy: 0.977023
Average cost in epoch 24: 0.079908
training accuracy: 1.000000	test accuracy: 0.986014
Average cost in epoch 25: 0.058001
training accuracy: 1.000000	test accuracy: 0.978022
lr decays to 0.005000
Average cost in epoch 26: 0.005350
training accuracy: 1.000000	test accuracy: 0.982018
Average cost in epoch 27: 0.000340
training accuracy: 1.000000	test accuracy: 0.984016
Average cost in epoch 28: 0.000073
training accuracy: 1.000000	test accuracy: 0.985015
Average cost in epoch 29: 0.000042
training accuracy: 1.000000	test accuracy: 0.985015
Average cost in epoch 30: 0.000024
training accuracy: 1.000000	test accuracy: 0.986014
Average cost in epoch 31: 0.000014
training accuracy: 1.000000	test accuracy: 0.986014
Average cost in epoch 32: 0.000010
training accuracy: 1.000000	test accuracy: 0.992008
Average cost in epoch 33: 0.000003
training accuracy: 1.000000	test accuracy: 0.992008
Average cost in epoch 34: 0.000002
training accuracy: 1.000000	test accuracy: 0.992008
Average cost in epoch 35: 0.000001
training accuracy: 1.000000	test accuracy: 0.993007
Average cost in epoch 36: 0.000001
training accuracy: 1.000000	test accuracy: 0.993007
Average cost in epoch 37: 0.000000
training accuracy: 1.000000	test accuracy: 0.993007
Average cost in epoch 38: 0.000000
training accuracy: 1.000000	test accuracy: 0.993007
Average cost in epoch 39: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 40: 0.000000
training accuracy: 1.000000	test accuracy: 0.993007
Average cost in epoch 41: 0.000000
training accuracy: 1.000000	test accuracy: 0.993007
Average cost in epoch 42: 0.000000
training accuracy: 1.000000	test accuracy: 0.993007
Average cost in epoch 43: 0.000000
training accuracy: 1.000000	test accuracy: 0.993007
Average cost in epoch 44: 0.014815
training accuracy: 1.000000	test accuracy: 0.989011
Average cost in epoch 45: 0.014214
training accuracy: 1.000000	test accuracy: 0.992008
Average cost in epoch 46: 0.000132
training accuracy: 1.000000	test accuracy: 0.991009
Average cost in epoch 47: 0.000005
training accuracy: 1.000000	test accuracy: 0.991009
Average cost in epoch 48: 0.000002
training accuracy: 1.000000	test accuracy: 0.991009
Average cost in epoch 49: 0.000002
training accuracy: 1.000000	test accuracy: 0.991009
Average cost in epoch 50: 0.000001
training accuracy: 1.000000	test accuracy: 0.991009
lr decays to 0.002500
Average cost in epoch 51: 0.000001
training accuracy: 1.000000	test accuracy: 0.991009
Average cost in epoch 52: 0.000001
training accuracy: 1.000000	test accuracy: 0.992008
Average cost in epoch 53: 0.000000
training accuracy: 1.000000	test accuracy: 0.993007
Average cost in epoch 54: 0.000000
training accuracy: 1.000000	test accuracy: 0.993007
Average cost in epoch 55: 0.000000
training accuracy: 1.000000	test accuracy: 0.993007
Average cost in epoch 56: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 57: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 58: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 59: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 60: 0.000000
training accuracy: 1.000000	test accuracy: 0.993007
Average cost in epoch 61: 0.000000
training accuracy: 1.000000	test accuracy: 0.993007
Average cost in epoch 62: 0.000000
training accuracy: 1.000000	test accuracy: 0.993007
Average cost in epoch 63: 0.000000
training accuracy: 1.000000	test accuracy: 0.993007
Average cost in epoch 64: 0.000000
training accuracy: 1.000000	test accuracy: 0.993007
Average cost in epoch 65: 0.000000
training accuracy: 1.000000	test accuracy: 0.992008
Average cost in epoch 66: 0.000000
training accuracy: 1.000000	test accuracy: 0.992008
Average cost in epoch 67: 0.000000
training accuracy: 1.000000	test accuracy: 0.992008
Average cost in epoch 68: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 69: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 70: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 71: 0.000000
training accuracy: 1.000000	test accuracy: 0.992008
Average cost in epoch 72: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 73: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 74: 0.000000
training accuracy: 1.000000	test accuracy: 0.992008
Average cost in epoch 75: 0.000000
training accuracy: 1.000000	test accuracy: 0.992008
lr decays to 0.001250
Average cost in epoch 76: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 77: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 78: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 79: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 80: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 81: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 82: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 83: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 84: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 85: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 86: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 87: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 88: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 89: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 90: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 91: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 92: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 93: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 94: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 95: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 96: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 97: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 98: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 99: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004

dump to weights/memn2n/memn2n_1.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 2, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_2.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 1.80
Starting training...
Average cost in epoch 0: 2.054935
training accuracy: 0.218750	test accuracy: 0.193806
Average cost in epoch 1: 1.767014
training accuracy: 0.312500	test accuracy: 0.237762
Average cost in epoch 2: 1.653530
training accuracy: 0.375000	test accuracy: 0.221778
Average cost in epoch 3: 1.493052
training accuracy: 0.531250	test accuracy: 0.262737
Average cost in epoch 4: 1.383779
training accuracy: 0.375000	test accuracy: 0.278721
Average cost in epoch 5: 1.280886
training accuracy: 0.531250	test accuracy: 0.295704
Average cost in epoch 6: 1.178499
training accuracy: 0.593750	test accuracy: 0.284715
Average cost in epoch 7: 1.094329
training accuracy: 0.687500	test accuracy: 0.289710
Average cost in epoch 8: 1.021816
training accuracy: 0.718750	test accuracy: 0.281718
Average cost in epoch 9: 0.962201
training accuracy: 0.625000	test accuracy: 0.284715
Average cost in epoch 10: 0.875218
training accuracy: 0.656250	test accuracy: 0.278721
Average cost in epoch 11: 0.839607
training accuracy: 0.656250	test accuracy: 0.304695
Average cost in epoch 12: 0.817755
training accuracy: 0.562500	test accuracy: 0.284715
Average cost in epoch 13: 0.721202
training accuracy: 0.750000	test accuracy: 0.282717
Average cost in epoch 14: 0.769097
training accuracy: 0.781250	test accuracy: 0.275724
Average cost in epoch 15: 0.690650
training accuracy: 0.750000	test accuracy: 0.303696
Average cost in epoch 16: 0.654222
training accuracy: 0.750000	test accuracy: 0.294705
Average cost in epoch 17: 0.675899
training accuracy: 0.750000	test accuracy: 0.278721
Average cost in epoch 18: 0.623414
training accuracy: 0.781250	test accuracy: 0.311688
Average cost in epoch 19: 0.599168
training accuracy: 0.843750	test accuracy: 0.307692
Average cost in epoch 20: 0.607049
training accuracy: 0.906250	test accuracy: 0.281718
Average cost in epoch 21: 0.574168
training accuracy: 0.812500	test accuracy: 0.283716
Average cost in epoch 22: 0.509344
training accuracy: 0.906250	test accuracy: 0.280719
Average cost in epoch 23: 0.551046
training accuracy: 0.812500	test accuracy: 0.302697
Average cost in epoch 24: 0.573282
training accuracy: 0.906250	test accuracy: 0.285714
Average cost in epoch 25: 0.482304
training accuracy: 0.906250	test accuracy: 0.290709
lr decays to 0.005000
Average cost in epoch 26: 0.337196
training accuracy: 0.906250	test accuracy: 0.285714
Average cost in epoch 27: 0.305052
training accuracy: 0.843750	test accuracy: 0.286713
Average cost in epoch 28: 0.295072
training accuracy: 0.718750	test accuracy: 0.284715
Average cost in epoch 29: 0.281996
training accuracy: 0.906250	test accuracy: 0.298701
Average cost in epoch 30: 0.285055
training accuracy: 0.875000	test accuracy: 0.300699
Average cost in epoch 31: 0.229096
training accuracy: 0.906250	test accuracy: 0.306693
Average cost in epoch 32: 0.274327
training accuracy: 0.937500	test accuracy: 0.296703
Average cost in epoch 33: 0.235620
training accuracy: 0.968750	test accuracy: 0.283716
Average cost in epoch 34: 0.228075
training accuracy: 0.937500	test accuracy: 0.302697
Average cost in epoch 35: 0.232496
training accuracy: 0.937500	test accuracy: 0.284715
Average cost in epoch 36: 0.201984
training accuracy: 0.937500	test accuracy: 0.284715
Average cost in epoch 37: 0.222238
training accuracy: 0.968750	test accuracy: 0.299700
Average cost in epoch 38: 0.206944
training accuracy: 0.937500	test accuracy: 0.292707
Average cost in epoch 39: 0.192019
training accuracy: 0.937500	test accuracy: 0.302697
Average cost in epoch 40: 0.189525
training accuracy: 0.937500	test accuracy: 0.286713
Average cost in epoch 41: 0.181689
training accuracy: 0.906250	test accuracy: 0.297702
Average cost in epoch 42: 0.179449
training accuracy: 1.000000	test accuracy: 0.279720
Average cost in epoch 43: 0.161319
training accuracy: 0.968750	test accuracy: 0.288711
Average cost in epoch 44: 0.167531
training accuracy: 0.968750	test accuracy: 0.285714
Average cost in epoch 45: 0.177639
training accuracy: 0.968750	test accuracy: 0.293706
Average cost in epoch 46: 0.170377
training accuracy: 0.937500	test accuracy: 0.288711
Average cost in epoch 47: 0.166183
training accuracy: 0.937500	test accuracy: 0.298701
Average cost in epoch 48: 0.195304
training accuracy: 1.000000	test accuracy: 0.289710
Average cost in epoch 49: 0.129413
training accuracy: 0.906250	test accuracy: 0.274725
Average cost in epoch 50: 0.131529
training accuracy: 0.937500	test accuracy: 0.277722
lr decays to 0.002500
Average cost in epoch 51: 0.102130
training accuracy: 1.000000	test accuracy: 0.281718
Average cost in epoch 52: 0.093272
training accuracy: 1.000000	test accuracy: 0.292707
Average cost in epoch 53: 0.085360
training accuracy: 1.000000	test accuracy: 0.294705
Average cost in epoch 54: 0.079789
training accuracy: 0.968750	test accuracy: 0.290709
Average cost in epoch 55: 0.086797
training accuracy: 0.906250	test accuracy: 0.298701
Average cost in epoch 56: 0.080824
training accuracy: 0.968750	test accuracy: 0.285714
Average cost in epoch 57: 0.067860
training accuracy: 1.000000	test accuracy: 0.294705
Average cost in epoch 58: 0.080427
training accuracy: 0.968750	test accuracy: 0.292707
Average cost in epoch 59: 0.063703
training accuracy: 1.000000	test accuracy: 0.288711
Average cost in epoch 60: 0.080664
training accuracy: 0.968750	test accuracy: 0.302697
Average cost in epoch 61: 0.061974
training accuracy: 0.968750	test accuracy: 0.297702
Average cost in epoch 62: 0.058107
training accuracy: 0.937500	test accuracy: 0.303696
Average cost in epoch 63: 0.062718
training accuracy: 0.968750	test accuracy: 0.291708
Average cost in epoch 64: 0.072083
training accuracy: 0.937500	test accuracy: 0.297702
Average cost in epoch 65: 0.054496
training accuracy: 1.000000	test accuracy: 0.286713
Average cost in epoch 66: 0.046067
training accuracy: 0.937500	test accuracy: 0.292707
Average cost in epoch 67: 0.060726
training accuracy: 0.968750	test accuracy: 0.299700
Average cost in epoch 68: 0.051411
training accuracy: 0.968750	test accuracy: 0.281718
Average cost in epoch 69: 0.070327
training accuracy: 0.968750	test accuracy: 0.285714
Average cost in epoch 70: 0.059384
training accuracy: 0.968750	test accuracy: 0.291708
Average cost in epoch 71: 0.039829
training accuracy: 0.968750	test accuracy: 0.292707
Average cost in epoch 72: 0.050494
training accuracy: 0.968750	test accuracy: 0.281718
Average cost in epoch 73: 0.061995
training accuracy: 0.937500	test accuracy: 0.281718
Average cost in epoch 74: 0.051754
training accuracy: 1.000000	test accuracy: 0.298701
Average cost in epoch 75: 0.049808
training accuracy: 1.000000	test accuracy: 0.292707
lr decays to 0.001250
Average cost in epoch 76: 0.036297
training accuracy: 1.000000	test accuracy: 0.287712
Average cost in epoch 77: 0.028198
training accuracy: 0.937500	test accuracy: 0.290709
Average cost in epoch 78: 0.039595
training accuracy: 0.968750	test accuracy: 0.290709
Average cost in epoch 79: 0.033577
training accuracy: 1.000000	test accuracy: 0.294705
Average cost in epoch 80: 0.029171
training accuracy: 1.000000	test accuracy: 0.303696
Average cost in epoch 81: 0.035015
training accuracy: 0.968750	test accuracy: 0.289710
Average cost in epoch 82: 0.033561
training accuracy: 1.000000	test accuracy: 0.290709
Average cost in epoch 83: 0.027504
training accuracy: 1.000000	test accuracy: 0.305694
Average cost in epoch 84: 0.030050
training accuracy: 0.968750	test accuracy: 0.295704
Average cost in epoch 85: 0.032694
training accuracy: 1.000000	test accuracy: 0.293706
Average cost in epoch 86: 0.030205
training accuracy: 1.000000	test accuracy: 0.292707
Average cost in epoch 87: 0.029090
training accuracy: 1.000000	test accuracy: 0.296703
Average cost in epoch 88: 0.029306
training accuracy: 1.000000	test accuracy: 0.298701
Average cost in epoch 89: 0.028421
training accuracy: 1.000000	test accuracy: 0.293706
Average cost in epoch 90: 0.032284
training accuracy: 0.968750	test accuracy: 0.302697
Average cost in epoch 91: 0.024497
training accuracy: 1.000000	test accuracy: 0.287712
Average cost in epoch 92: 0.031540
training accuracy: 1.000000	test accuracy: 0.302697
Average cost in epoch 93: 0.029084
training accuracy: 1.000000	test accuracy: 0.299700
Average cost in epoch 94: 0.030357
training accuracy: 1.000000	test accuracy: 0.293706
Average cost in epoch 95: 0.029792
training accuracy: 1.000000	test accuracy: 0.302697
Average cost in epoch 96: 0.022561
training accuracy: 1.000000	test accuracy: 0.283716
Average cost in epoch 97: 0.026214
training accuracy: 1.000000	test accuracy: 0.294705
Average cost in epoch 98: 0.034405
training accuracy: 0.937500	test accuracy: 0.292707
Average cost in epoch 99: 0.020416
training accuracy: 1.000000	test accuracy: 0.296703

dump to weights/memn2n/memn2n_2.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 3, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_3.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 1.80
Starting training...
Average cost in epoch 0: 2.033330
training accuracy: 0.312500	test accuracy: 0.172827
Average cost in epoch 1: 1.747043
training accuracy: 0.250000	test accuracy: 0.212787
Average cost in epoch 2: 1.663498
training accuracy: 0.375000	test accuracy: 0.186813
Average cost in epoch 3: 1.552685
training accuracy: 0.312500	test accuracy: 0.194805
Average cost in epoch 4: 1.411918
training accuracy: 0.437500	test accuracy: 0.194805
Average cost in epoch 5: 1.286641
training accuracy: 0.312500	test accuracy: 0.199800
Average cost in epoch 6: 1.182022
training accuracy: 0.562500	test accuracy: 0.225774
Average cost in epoch 7: 1.086738
training accuracy: 0.562500	test accuracy: 0.218781
Average cost in epoch 8: 1.046625
training accuracy: 0.843750	test accuracy: 0.217782
Average cost in epoch 9: 0.927098
training accuracy: 0.906250	test accuracy: 0.225774
Average cost in epoch 10: 0.857737
training accuracy: 0.718750	test accuracy: 0.226773
Average cost in epoch 11: 0.831611
training accuracy: 0.906250	test accuracy: 0.209790
Average cost in epoch 12: 0.796052
training accuracy: 0.875000	test accuracy: 0.190809
Average cost in epoch 13: 0.741124
training accuracy: 0.812500	test accuracy: 0.210789
Average cost in epoch 14: 0.722611
training accuracy: 0.750000	test accuracy: 0.204795
Average cost in epoch 15: 0.672580
training accuracy: 0.750000	test accuracy: 0.232767
Average cost in epoch 16: 0.633463
training accuracy: 0.718750	test accuracy: 0.215784
Average cost in epoch 17: 0.593079
training accuracy: 0.812500	test accuracy: 0.217782
Average cost in epoch 18: 0.585178
training accuracy: 0.812500	test accuracy: 0.225774
Average cost in epoch 19: 0.580554
training accuracy: 0.906250	test accuracy: 0.210789
Average cost in epoch 20: 0.533887
training accuracy: 0.843750	test accuracy: 0.204795
Average cost in epoch 21: 0.554005
training accuracy: 0.750000	test accuracy: 0.227772
Average cost in epoch 22: 0.526241
training accuracy: 0.843750	test accuracy: 0.238761
Average cost in epoch 23: 0.501866
training accuracy: 0.687500	test accuracy: 0.233766
Average cost in epoch 24: 0.444982
training accuracy: 0.875000	test accuracy: 0.228771
Average cost in epoch 25: 0.514809
training accuracy: 0.875000	test accuracy: 0.234765
lr decays to 0.005000
Average cost in epoch 26: 0.348134
training accuracy: 0.968750	test accuracy: 0.228771
Average cost in epoch 27: 0.273545
training accuracy: 0.937500	test accuracy: 0.226773
Average cost in epoch 28: 0.264063
training accuracy: 0.937500	test accuracy: 0.231768
Average cost in epoch 29: 0.254576
training accuracy: 0.937500	test accuracy: 0.239760
Average cost in epoch 30: 0.243500
training accuracy: 0.906250	test accuracy: 0.223776
Average cost in epoch 31: 0.207675
training accuracy: 0.937500	test accuracy: 0.218781
Average cost in epoch 32: 0.182303
training accuracy: 0.843750	test accuracy: 0.216783
Average cost in epoch 33: 0.212520
training accuracy: 0.968750	test accuracy: 0.231768
Average cost in epoch 34: 0.214024
training accuracy: 0.968750	test accuracy: 0.230769
Average cost in epoch 35: 0.179704
training accuracy: 0.937500	test accuracy: 0.225774
Average cost in epoch 36: 0.175252
training accuracy: 0.937500	test accuracy: 0.212787
Average cost in epoch 37: 0.208211
training accuracy: 0.937500	test accuracy: 0.238761
Average cost in epoch 38: 0.169978
training accuracy: 1.000000	test accuracy: 0.219780
Average cost in epoch 39: 0.165075
training accuracy: 0.937500	test accuracy: 0.221778
Average cost in epoch 40: 0.149880
training accuracy: 0.937500	test accuracy: 0.225774
Average cost in epoch 41: 0.150440
training accuracy: 1.000000	test accuracy: 0.201798
Average cost in epoch 42: 0.156265
training accuracy: 0.906250	test accuracy: 0.200799
Average cost in epoch 43: 0.178613
training accuracy: 0.968750	test accuracy: 0.224775
Average cost in epoch 44: 0.133836
training accuracy: 0.968750	test accuracy: 0.233766
Average cost in epoch 45: 0.138051
training accuracy: 0.937500	test accuracy: 0.239760
Average cost in epoch 46: 0.138676
training accuracy: 0.968750	test accuracy: 0.235764
Average cost in epoch 47: 0.125563
training accuracy: 1.000000	test accuracy: 0.223776
Average cost in epoch 48: 0.122277
training accuracy: 0.968750	test accuracy: 0.228771
Average cost in epoch 49: 0.122817
training accuracy: 0.968750	test accuracy: 0.209790
Average cost in epoch 50: 0.161511
training accuracy: 0.937500	test accuracy: 0.214785
lr decays to 0.002500
Average cost in epoch 51: 0.085487
training accuracy: 1.000000	test accuracy: 0.211788
Average cost in epoch 52: 0.066823
training accuracy: 0.968750	test accuracy: 0.213786
Average cost in epoch 53: 0.074263
training accuracy: 1.000000	test accuracy: 0.211788
Average cost in epoch 54: 0.071937
training accuracy: 0.968750	test accuracy: 0.215784
Average cost in epoch 55: 0.070060
training accuracy: 1.000000	test accuracy: 0.208791
Average cost in epoch 56: 0.080545
training accuracy: 0.937500	test accuracy: 0.214785
Average cost in epoch 57: 0.065708
training accuracy: 0.968750	test accuracy: 0.211788
Average cost in epoch 58: 0.065373
training accuracy: 1.000000	test accuracy: 0.211788
Average cost in epoch 59: 0.062608
training accuracy: 0.937500	test accuracy: 0.204795
Average cost in epoch 60: 0.076538
training accuracy: 1.000000	test accuracy: 0.214785
Average cost in epoch 61: 0.065486
training accuracy: 0.937500	test accuracy: 0.202797
Average cost in epoch 62: 0.052804
training accuracy: 1.000000	test accuracy: 0.203796
Average cost in epoch 63: 0.075948
training accuracy: 1.000000	test accuracy: 0.223776
Average cost in epoch 64: 0.055973
training accuracy: 0.968750	test accuracy: 0.217782
Average cost in epoch 65: 0.056763
training accuracy: 0.968750	test accuracy: 0.227772
Average cost in epoch 66: 0.057176
training accuracy: 0.968750	test accuracy: 0.219780
Average cost in epoch 67: 0.061489
training accuracy: 1.000000	test accuracy: 0.214785
Average cost in epoch 68: 0.072737
training accuracy: 0.968750	test accuracy: 0.204795
Average cost in epoch 69: 0.061531
training accuracy: 0.968750	test accuracy: 0.207792
Average cost in epoch 70: 0.063483
training accuracy: 0.968750	test accuracy: 0.221778
Average cost in epoch 71: 0.059237
training accuracy: 1.000000	test accuracy: 0.212787
Average cost in epoch 72: 0.046683
training accuracy: 0.937500	test accuracy: 0.206793
Average cost in epoch 73: 0.054722
training accuracy: 0.968750	test accuracy: 0.216783
Average cost in epoch 74: 0.077718
training accuracy: 1.000000	test accuracy: 0.217782
Average cost in epoch 75: 0.052340
training accuracy: 0.968750	test accuracy: 0.221778
lr decays to 0.001250
Average cost in epoch 76: 0.040897
training accuracy: 0.937500	test accuracy: 0.218781
Average cost in epoch 77: 0.052898
training accuracy: 1.000000	test accuracy: 0.215784
Average cost in epoch 78: 0.038306
training accuracy: 1.000000	test accuracy: 0.224775
Average cost in epoch 79: 0.055181
training accuracy: 1.000000	test accuracy: 0.221778
Average cost in epoch 80: 0.042641
training accuracy: 0.968750	test accuracy: 0.218781
Average cost in epoch 81: 0.041475
training accuracy: 1.000000	test accuracy: 0.218781
Average cost in epoch 82: 0.041766
training accuracy: 1.000000	test accuracy: 0.203796
Average cost in epoch 83: 0.039656
training accuracy: 0.937500	test accuracy: 0.211788
Average cost in epoch 84: 0.045885
training accuracy: 0.968750	test accuracy: 0.224775
Average cost in epoch 85: 0.041275
training accuracy: 1.000000	test accuracy: 0.216783
Average cost in epoch 86: 0.046015
training accuracy: 1.000000	test accuracy: 0.220779
Average cost in epoch 87: 0.048145
training accuracy: 1.000000	test accuracy: 0.212787
Average cost in epoch 88: 0.043870
training accuracy: 0.968750	test accuracy: 0.218781
Average cost in epoch 89: 0.040014
training accuracy: 1.000000	test accuracy: 0.210789
Average cost in epoch 90: 0.041928
training accuracy: 1.000000	test accuracy: 0.213786
Average cost in epoch 91: 0.035442
training accuracy: 1.000000	test accuracy: 0.222777
Average cost in epoch 92: 0.048438
training accuracy: 0.968750	test accuracy: 0.211788
Average cost in epoch 93: 0.037811
training accuracy: 0.937500	test accuracy: 0.220779
Average cost in epoch 94: 0.031949
training accuracy: 0.937500	test accuracy: 0.212787
Average cost in epoch 95: 0.039572
training accuracy: 1.000000	test accuracy: 0.213786
Average cost in epoch 96: 0.040692
training accuracy: 0.968750	test accuracy: 0.217782
Average cost in epoch 97: 0.044490
training accuracy: 0.968750	test accuracy: 0.213786
Average cost in epoch 98: 0.041881
training accuracy: 1.000000	test accuracy: 0.215784
Average cost in epoch 99: 0.038714
training accuracy: 1.000000	test accuracy: 0.218781

dump to weights/memn2n/memn2n_3.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 4, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_4.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 1.80
Starting training...
Average cost in epoch 0: 1.820193
training accuracy: 0.500000	test accuracy: 0.431568
Average cost in epoch 1: 1.335824
training accuracy: 0.656250	test accuracy: 0.610390
Average cost in epoch 2: 1.039441
training accuracy: 0.687500	test accuracy: 0.616384
Average cost in epoch 3: 0.843374
training accuracy: 0.718750	test accuracy: 0.664336
Average cost in epoch 4: 0.740693
training accuracy: 0.875000	test accuracy: 0.667333
Average cost in epoch 5: 0.688378
training accuracy: 0.750000	test accuracy: 0.674326
Average cost in epoch 6: 0.647548
training accuracy: 0.687500	test accuracy: 0.661339
Average cost in epoch 7: 0.642202
training accuracy: 0.781250	test accuracy: 0.668332
Average cost in epoch 8: 0.636679
training accuracy: 0.500000	test accuracy: 0.644356
Average cost in epoch 9: 0.591958
training accuracy: 0.718750	test accuracy: 0.687313
Average cost in epoch 10: 0.613473
training accuracy: 0.906250	test accuracy: 0.685315
Average cost in epoch 11: 0.596270
training accuracy: 0.656250	test accuracy: 0.662338
Average cost in epoch 12: 0.581183
training accuracy: 0.687500	test accuracy: 0.672328
Average cost in epoch 13: 0.578116
training accuracy: 0.718750	test accuracy: 0.690310
Average cost in epoch 14: 0.545467
training accuracy: 0.843750	test accuracy: 0.662338
Average cost in epoch 15: 0.564816
training accuracy: 0.750000	test accuracy: 0.661339
Average cost in epoch 16: 0.555300
training accuracy: 0.812500	test accuracy: 0.675325
Average cost in epoch 17: 0.560122
training accuracy: 0.875000	test accuracy: 0.671329
Average cost in epoch 18: 0.577803
training accuracy: 0.718750	test accuracy: 0.669331
Average cost in epoch 19: 0.551664
training accuracy: 0.781250	test accuracy: 0.676324
Average cost in epoch 20: 0.540890
training accuracy: 0.781250	test accuracy: 0.680320
Average cost in epoch 21: 0.549727
training accuracy: 0.812500	test accuracy: 0.658342
Average cost in epoch 22: 0.521018
training accuracy: 0.843750	test accuracy: 0.665335
Average cost in epoch 23: 0.553388
training accuracy: 0.656250	test accuracy: 0.680320
Average cost in epoch 24: 0.530887
training accuracy: 0.781250	test accuracy: 0.653347
Average cost in epoch 25: 0.538326
training accuracy: 0.687500	test accuracy: 0.662338
lr decays to 0.005000
Average cost in epoch 26: 0.432738
training accuracy: 0.750000	test accuracy: 0.662338
Average cost in epoch 27: 0.428314
training accuracy: 0.812500	test accuracy: 0.674326
Average cost in epoch 28: 0.375511
training accuracy: 0.750000	test accuracy: 0.674326
Average cost in epoch 29: 0.406315
training accuracy: 0.781250	test accuracy: 0.668332
Average cost in epoch 30: 0.397963
training accuracy: 0.718750	test accuracy: 0.658342
Average cost in epoch 31: 0.380728
training accuracy: 0.687500	test accuracy: 0.673327
Average cost in epoch 32: 0.397901
training accuracy: 0.687500	test accuracy: 0.660340
Average cost in epoch 33: 0.375825
training accuracy: 0.812500	test accuracy: 0.658342
Average cost in epoch 34: 0.367497
training accuracy: 0.718750	test accuracy: 0.674326
Average cost in epoch 35: 0.359178
training accuracy: 0.781250	test accuracy: 0.671329
Average cost in epoch 36: 0.367643
training accuracy: 0.875000	test accuracy: 0.677323
Average cost in epoch 37: 0.379342
training accuracy: 0.843750	test accuracy: 0.665335
Average cost in epoch 38: 0.360808
training accuracy: 0.875000	test accuracy: 0.667333
Average cost in epoch 39: 0.353160
training accuracy: 0.812500	test accuracy: 0.669331
Average cost in epoch 40: 0.360773
training accuracy: 0.781250	test accuracy: 0.671329
Average cost in epoch 41: 0.354813
training accuracy: 0.937500	test accuracy: 0.663337
Average cost in epoch 42: 0.344165
training accuracy: 0.781250	test accuracy: 0.685315
Average cost in epoch 43: 0.353137
training accuracy: 0.812500	test accuracy: 0.668332
Average cost in epoch 44: 0.344530
training accuracy: 0.906250	test accuracy: 0.658342
Average cost in epoch 45: 0.337514
training accuracy: 0.812500	test accuracy: 0.675325
Average cost in epoch 46: 0.322248
training accuracy: 0.968750	test accuracy: 0.665335
Average cost in epoch 47: 0.358228
training accuracy: 0.718750	test accuracy: 0.674326
Average cost in epoch 48: 0.339744
training accuracy: 0.812500	test accuracy: 0.665335
Average cost in epoch 49: 0.321504
training accuracy: 0.906250	test accuracy: 0.668332
Average cost in epoch 50: 0.318102
training accuracy: 0.843750	test accuracy: 0.666334
lr decays to 0.002500
Average cost in epoch 51: 0.299430
training accuracy: 0.843750	test accuracy: 0.672328
Average cost in epoch 52: 0.271928
training accuracy: 0.968750	test accuracy: 0.665335
Average cost in epoch 53: 0.280200
training accuracy: 0.906250	test accuracy: 0.675325
Average cost in epoch 54: 0.278495
training accuracy: 0.906250	test accuracy: 0.670330
Average cost in epoch 55: 0.265227
training accuracy: 0.906250	test accuracy: 0.669331
Average cost in epoch 56: 0.275960
training accuracy: 0.937500	test accuracy: 0.661339
Average cost in epoch 57: 0.261507
training accuracy: 0.812500	test accuracy: 0.669331
Average cost in epoch 58: 0.251561
training accuracy: 0.906250	test accuracy: 0.665335
Average cost in epoch 59: 0.258171
training accuracy: 0.906250	test accuracy: 0.666334
Average cost in epoch 60: 0.266967
training accuracy: 0.843750	test accuracy: 0.666334
Average cost in epoch 61: 0.233735
training accuracy: 0.906250	test accuracy: 0.666334
Average cost in epoch 62: 0.265400
training accuracy: 0.781250	test accuracy: 0.657343
Average cost in epoch 63: 0.243025
training accuracy: 0.906250	test accuracy: 0.674326
Average cost in epoch 64: 0.235949
training accuracy: 0.968750	test accuracy: 0.670330
Average cost in epoch 65: 0.268452
training accuracy: 0.875000	test accuracy: 0.676324
Average cost in epoch 66: 0.244196
training accuracy: 0.937500	test accuracy: 0.671329
Average cost in epoch 67: 0.257519
training accuracy: 0.937500	test accuracy: 0.671329
Average cost in epoch 68: 0.222194
training accuracy: 0.937500	test accuracy: 0.678322
Average cost in epoch 69: 0.254032
training accuracy: 0.875000	test accuracy: 0.666334
Average cost in epoch 70: 0.220684
training accuracy: 0.750000	test accuracy: 0.676324
Average cost in epoch 71: 0.244847
training accuracy: 0.875000	test accuracy: 0.671329
Average cost in epoch 72: 0.253434
training accuracy: 0.968750	test accuracy: 0.673327
Average cost in epoch 73: 0.220865
training accuracy: 0.812500	test accuracy: 0.673327
Average cost in epoch 74: 0.233008
training accuracy: 0.875000	test accuracy: 0.681319
Average cost in epoch 75: 0.232626
training accuracy: 0.875000	test accuracy: 0.673327
lr decays to 0.001250
Average cost in epoch 76: 0.196732
training accuracy: 0.875000	test accuracy: 0.672328
Average cost in epoch 77: 0.218112
training accuracy: 0.937500	test accuracy: 0.670330
Average cost in epoch 78: 0.180982
training accuracy: 0.937500	test accuracy: 0.671329
Average cost in epoch 79: 0.216592
training accuracy: 0.906250	test accuracy: 0.670330
Average cost in epoch 80: 0.200384
training accuracy: 0.906250	test accuracy: 0.663337
Average cost in epoch 81: 0.184232
training accuracy: 0.843750	test accuracy: 0.673327
Average cost in epoch 82: 0.210407
training accuracy: 0.968750	test accuracy: 0.670330
Average cost in epoch 83: 0.204060
training accuracy: 0.906250	test accuracy: 0.674326
Average cost in epoch 84: 0.194777
training accuracy: 0.968750	test accuracy: 0.670330
Average cost in epoch 85: 0.195085
training accuracy: 0.906250	test accuracy: 0.669331
Average cost in epoch 86: 0.192378
training accuracy: 0.843750	test accuracy: 0.670330
Average cost in epoch 87: 0.193829
training accuracy: 0.875000	test accuracy: 0.675325
Average cost in epoch 88: 0.191443
training accuracy: 0.906250	test accuracy: 0.670330
Average cost in epoch 89: 0.191190
training accuracy: 0.937500	test accuracy: 0.673327
Average cost in epoch 90: 0.190127
training accuracy: 0.906250	test accuracy: 0.663337
Average cost in epoch 91: 0.187839
training accuracy: 0.968750	test accuracy: 0.672328
Average cost in epoch 92: 0.190504
training accuracy: 0.843750	test accuracy: 0.672328
Average cost in epoch 93: 0.187876
training accuracy: 0.937500	test accuracy: 0.671329
Average cost in epoch 94: 0.193809
training accuracy: 0.875000	test accuracy: 0.678322
Average cost in epoch 95: 0.183027
training accuracy: 1.000000	test accuracy: 0.672328
Average cost in epoch 96: 0.198378
training accuracy: 0.875000	test accuracy: 0.670330
Average cost in epoch 97: 0.172578
training accuracy: 0.968750	test accuracy: 0.670330
Average cost in epoch 98: 0.185618
training accuracy: 0.906250	test accuracy: 0.675325
Average cost in epoch 99: 0.179164
training accuracy: 0.906250	test accuracy: 0.666334

dump to weights/memn2n/memn2n_4.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 5, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_5.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 1.80
Starting training...
Average cost in epoch 0: 1.536047
training accuracy: 0.343750	test accuracy: 0.419580
Average cost in epoch 1: 0.951223
training accuracy: 0.812500	test accuracy: 0.602398
Average cost in epoch 2: 0.711196
training accuracy: 0.843750	test accuracy: 0.686314
Average cost in epoch 3: 0.583418
training accuracy: 0.843750	test accuracy: 0.698302
Average cost in epoch 4: 0.456432
training accuracy: 0.843750	test accuracy: 0.716284
Average cost in epoch 5: 0.413749
training accuracy: 0.812500	test accuracy: 0.732268
Average cost in epoch 6: 0.394435
training accuracy: 0.906250	test accuracy: 0.726274
Average cost in epoch 7: 0.331755
training accuracy: 0.843750	test accuracy: 0.736264
Average cost in epoch 8: 0.326231
training accuracy: 0.906250	test accuracy: 0.729271
Average cost in epoch 9: 0.313759
training accuracy: 1.000000	test accuracy: 0.714286
Average cost in epoch 10: 0.279189
training accuracy: 0.968750	test accuracy: 0.722278
Average cost in epoch 11: 0.281970
training accuracy: 0.968750	test accuracy: 0.724276
Average cost in epoch 12: 0.258722
training accuracy: 0.937500	test accuracy: 0.686314
Average cost in epoch 13: 0.201543
training accuracy: 0.906250	test accuracy: 0.724276
Average cost in epoch 14: 0.234512
training accuracy: 0.906250	test accuracy: 0.714286
Average cost in epoch 15: 0.211828
training accuracy: 0.906250	test accuracy: 0.715285
Average cost in epoch 16: 0.213459
training accuracy: 0.937500	test accuracy: 0.680320
Average cost in epoch 17: 0.183267
training accuracy: 0.937500	test accuracy: 0.707293
Average cost in epoch 18: 0.213642
training accuracy: 0.906250	test accuracy: 0.711289
Average cost in epoch 19: 0.137057
training accuracy: 1.000000	test accuracy: 0.709291
Average cost in epoch 20: 0.152702
training accuracy: 0.937500	test accuracy: 0.706294
Average cost in epoch 21: 0.137865
training accuracy: 1.000000	test accuracy: 0.701299
Average cost in epoch 22: 0.211199
training accuracy: 0.937500	test accuracy: 0.704296
Average cost in epoch 23: 0.135740
training accuracy: 0.937500	test accuracy: 0.693307
Average cost in epoch 24: 0.101154
training accuracy: 0.906250	test accuracy: 0.712288
Average cost in epoch 25: 0.142481
training accuracy: 0.968750	test accuracy: 0.709291
lr decays to 0.005000
Average cost in epoch 26: 0.107982
training accuracy: 0.968750	test accuracy: 0.713287
Average cost in epoch 27: 0.067269
training accuracy: 0.968750	test accuracy: 0.706294
Average cost in epoch 28: 0.075816
training accuracy: 1.000000	test accuracy: 0.705295
Average cost in epoch 29: 0.072810
training accuracy: 0.937500	test accuracy: 0.704296
Average cost in epoch 30: 0.061981
training accuracy: 0.968750	test accuracy: 0.695305
Average cost in epoch 31: 0.059461
training accuracy: 1.000000	test accuracy: 0.721279
Average cost in epoch 32: 0.049329
training accuracy: 0.968750	test accuracy: 0.692308
Average cost in epoch 33: 0.062479
training accuracy: 0.968750	test accuracy: 0.705295
Average cost in epoch 34: 0.046060
training accuracy: 1.000000	test accuracy: 0.706294
Average cost in epoch 35: 0.051691
training accuracy: 0.968750	test accuracy: 0.700300
Average cost in epoch 36: 0.054052
training accuracy: 1.000000	test accuracy: 0.703297
Average cost in epoch 37: 0.056505
training accuracy: 1.000000	test accuracy: 0.699301
Average cost in epoch 38: 0.042860
training accuracy: 0.906250	test accuracy: 0.707293
Average cost in epoch 39: 0.042853
training accuracy: 0.968750	test accuracy: 0.691309
Average cost in epoch 40: 0.047968
training accuracy: 0.968750	test accuracy: 0.699301
Average cost in epoch 41: 0.045132
training accuracy: 0.937500	test accuracy: 0.710290
Average cost in epoch 42: 0.041584
training accuracy: 1.000000	test accuracy: 0.697303
Average cost in epoch 43: 0.039905
training accuracy: 0.968750	test accuracy: 0.707293
Average cost in epoch 44: 0.034098
training accuracy: 0.968750	test accuracy: 0.694306
Average cost in epoch 45: 0.044028
training accuracy: 1.000000	test accuracy: 0.692308
Average cost in epoch 46: 0.042388
training accuracy: 1.000000	test accuracy: 0.706294
Average cost in epoch 47: 0.038407
training accuracy: 1.000000	test accuracy: 0.699301
Average cost in epoch 48: 0.041145
training accuracy: 1.000000	test accuracy: 0.704296
Average cost in epoch 49: 0.037451
training accuracy: 1.000000	test accuracy: 0.686314
Average cost in epoch 50: 0.036768
training accuracy: 1.000000	test accuracy: 0.697303
lr decays to 0.002500
Average cost in epoch 51: 0.034552
training accuracy: 0.968750	test accuracy: 0.688312
Average cost in epoch 52: 0.020686
training accuracy: 1.000000	test accuracy: 0.696304
Average cost in epoch 53: 0.020854
training accuracy: 1.000000	test accuracy: 0.695305
Average cost in epoch 54: 0.025358
training accuracy: 1.000000	test accuracy: 0.702298
Average cost in epoch 55: 0.028285
training accuracy: 1.000000	test accuracy: 0.696304
Average cost in epoch 56: 0.024112
training accuracy: 1.000000	test accuracy: 0.693307
Average cost in epoch 57: 0.027603
training accuracy: 1.000000	test accuracy: 0.699301
Average cost in epoch 58: 0.028279
training accuracy: 1.000000	test accuracy: 0.698302
Average cost in epoch 59: 0.018291
training accuracy: 0.968750	test accuracy: 0.689311
Average cost in epoch 60: 0.023698
training accuracy: 1.000000	test accuracy: 0.693307
Average cost in epoch 61: 0.024218
training accuracy: 1.000000	test accuracy: 0.692308
Average cost in epoch 62: 0.022661
training accuracy: 1.000000	test accuracy: 0.692308
Average cost in epoch 63: 0.030150
training accuracy: 0.968750	test accuracy: 0.686314
Average cost in epoch 64: 0.019539
training accuracy: 0.968750	test accuracy: 0.695305
Average cost in epoch 65: 0.031377
training accuracy: 0.968750	test accuracy: 0.692308
Average cost in epoch 66: 0.018778
training accuracy: 1.000000	test accuracy: 0.689311
Average cost in epoch 67: 0.027397
training accuracy: 0.968750	test accuracy: 0.690310
Average cost in epoch 68: 0.016351
training accuracy: 1.000000	test accuracy: 0.692308
Average cost in epoch 69: 0.026013
training accuracy: 1.000000	test accuracy: 0.688312
Average cost in epoch 70: 0.028976
training accuracy: 1.000000	test accuracy: 0.695305
Average cost in epoch 71: 0.020431
training accuracy: 0.968750	test accuracy: 0.695305
Average cost in epoch 72: 0.027833
training accuracy: 1.000000	test accuracy: 0.683317
Average cost in epoch 73: 0.027365
training accuracy: 1.000000	test accuracy: 0.691309
Average cost in epoch 74: 0.022444
training accuracy: 1.000000	test accuracy: 0.687313
Average cost in epoch 75: 0.021278
training accuracy: 1.000000	test accuracy: 0.696304
lr decays to 0.001250
Average cost in epoch 76: 0.025233
training accuracy: 1.000000	test accuracy: 0.691309
Average cost in epoch 77: 0.019503
training accuracy: 1.000000	test accuracy: 0.688312
Average cost in epoch 78: 0.013227
training accuracy: 1.000000	test accuracy: 0.686314
Average cost in epoch 79: 0.021908
training accuracy: 0.968750	test accuracy: 0.689311
Average cost in epoch 80: 0.010283
training accuracy: 1.000000	test accuracy: 0.693307
Average cost in epoch 81: 0.023745
training accuracy: 0.906250	test accuracy: 0.691309
Average cost in epoch 82: 0.018008
training accuracy: 0.968750	test accuracy: 0.691309
Average cost in epoch 83: 0.016948
training accuracy: 0.968750	test accuracy: 0.689311
Average cost in epoch 84: 0.016274
training accuracy: 1.000000	test accuracy: 0.690310
Average cost in epoch 85: 0.017504
training accuracy: 1.000000	test accuracy: 0.687313
Average cost in epoch 86: 0.018664
training accuracy: 0.968750	test accuracy: 0.687313
Average cost in epoch 87: 0.017359
training accuracy: 0.968750	test accuracy: 0.691309
Average cost in epoch 88: 0.015642
training accuracy: 1.000000	test accuracy: 0.693307
Average cost in epoch 89: 0.018938
training accuracy: 1.000000	test accuracy: 0.696304
Average cost in epoch 90: 0.017338
training accuracy: 1.000000	test accuracy: 0.695305
Average cost in epoch 91: 0.018554
training accuracy: 1.000000	test accuracy: 0.694306
Average cost in epoch 92: 0.018940
training accuracy: 1.000000	test accuracy: 0.685315
Average cost in epoch 93: 0.017154
training accuracy: 1.000000	test accuracy: 0.691309
Average cost in epoch 94: 0.015427
training accuracy: 0.937500	test accuracy: 0.691309
Average cost in epoch 95: 0.013684
training accuracy: 1.000000	test accuracy: 0.687313
Average cost in epoch 96: 0.019515
training accuracy: 1.000000	test accuracy: 0.684316
Average cost in epoch 97: 0.017554
training accuracy: 1.000000	test accuracy: 0.691309
Average cost in epoch 98: 0.018269
training accuracy: 1.000000	test accuracy: 0.682318
Average cost in epoch 99: 0.014562
training accuracy: 1.000000	test accuracy: 0.689311

dump to weights/memn2n/memn2n_5.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 6, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_6.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 1.83
Starting training...
Average cost in epoch 0: 0.881078
training accuracy: 0.625000	test accuracy: 0.498501
Average cost in epoch 1: 0.714066
training accuracy: 0.531250	test accuracy: 0.502498
Average cost in epoch 2: 0.711574
training accuracy: 0.562500	test accuracy: 0.497502
Average cost in epoch 3: 0.693443
training accuracy: 0.500000	test accuracy: 0.488511
Average cost in epoch 4: 0.695608
training accuracy: 0.625000	test accuracy: 0.510490
Average cost in epoch 5: 0.676689
training accuracy: 0.656250	test accuracy: 0.503497
Average cost in epoch 6: 0.662844
training accuracy: 0.718750	test accuracy: 0.523477
Average cost in epoch 7: 0.648518
training accuracy: 0.718750	test accuracy: 0.518482
Average cost in epoch 8: 0.612664
training accuracy: 0.687500	test accuracy: 0.538462
Average cost in epoch 9: 0.564222
training accuracy: 0.750000	test accuracy: 0.535465
Average cost in epoch 10: 0.528064
training accuracy: 0.593750	test accuracy: 0.585415
Average cost in epoch 11: 0.462679
training accuracy: 0.906250	test accuracy: 0.627373
Average cost in epoch 12: 0.389438
training accuracy: 0.843750	test accuracy: 0.673327
Average cost in epoch 13: 0.356212
training accuracy: 0.687500	test accuracy: 0.670330
Average cost in epoch 14: 0.314659
training accuracy: 0.968750	test accuracy: 0.709291
Average cost in epoch 15: 0.254748
training accuracy: 0.968750	test accuracy: 0.721279
Average cost in epoch 16: 0.237274
training accuracy: 0.937500	test accuracy: 0.736264
Average cost in epoch 17: 0.162646
training accuracy: 0.906250	test accuracy: 0.755245
Average cost in epoch 18: 0.208404
training accuracy: 0.843750	test accuracy: 0.763237
Average cost in epoch 19: 0.136125
training accuracy: 0.968750	test accuracy: 0.765235
Average cost in epoch 20: 0.136778
training accuracy: 1.000000	test accuracy: 0.791209
Average cost in epoch 21: 0.103999
training accuracy: 1.000000	test accuracy: 0.800200
Average cost in epoch 22: 0.119669
training accuracy: 1.000000	test accuracy: 0.794206
Average cost in epoch 23: 0.105310
training accuracy: 0.906250	test accuracy: 0.811189
Average cost in epoch 24: 0.079393
training accuracy: 0.906250	test accuracy: 0.747253
Average cost in epoch 25: 0.073635
training accuracy: 1.000000	test accuracy: 0.788212
lr decays to 0.005000
Average cost in epoch 26: 0.045741
training accuracy: 1.000000	test accuracy: 0.798202
Average cost in epoch 27: 0.031239
training accuracy: 0.968750	test accuracy: 0.798202
Average cost in epoch 28: 0.010604
training accuracy: 1.000000	test accuracy: 0.812188
Average cost in epoch 29: 0.023648
training accuracy: 1.000000	test accuracy: 0.807193
Average cost in epoch 30: 0.024187
training accuracy: 1.000000	test accuracy: 0.810190
Average cost in epoch 31: 0.029682
training accuracy: 0.968750	test accuracy: 0.821179
Average cost in epoch 32: 0.017671
training accuracy: 0.968750	test accuracy: 0.809191
Average cost in epoch 33: 0.009064
training accuracy: 1.000000	test accuracy: 0.810190
Average cost in epoch 34: 0.032034
training accuracy: 1.000000	test accuracy: 0.810190
Average cost in epoch 35: 0.011034
training accuracy: 1.000000	test accuracy: 0.804196
Average cost in epoch 36: 0.029568
training accuracy: 1.000000	test accuracy: 0.796204
Average cost in epoch 37: 0.012335
training accuracy: 0.968750	test accuracy: 0.801199
Average cost in epoch 38: 0.020036
training accuracy: 1.000000	test accuracy: 0.806194
Average cost in epoch 39: 0.012681
training accuracy: 1.000000	test accuracy: 0.798202
Average cost in epoch 40: 0.027504
training accuracy: 1.000000	test accuracy: 0.814186
Average cost in epoch 41: 0.006030
training accuracy: 1.000000	test accuracy: 0.785215
Average cost in epoch 42: 0.010387
training accuracy: 1.000000	test accuracy: 0.815185
Average cost in epoch 43: 0.014685
training accuracy: 1.000000	test accuracy: 0.815185
Average cost in epoch 44: 0.016475
training accuracy: 1.000000	test accuracy: 0.811189
Average cost in epoch 45: 0.007977
training accuracy: 1.000000	test accuracy: 0.825175
Average cost in epoch 46: 0.010203
training accuracy: 1.000000	test accuracy: 0.797203
Average cost in epoch 47: 0.015117
training accuracy: 1.000000	test accuracy: 0.802198
Average cost in epoch 48: 0.027960
training accuracy: 1.000000	test accuracy: 0.769231
Average cost in epoch 49: 0.016560
training accuracy: 1.000000	test accuracy: 0.812188
Average cost in epoch 50: 0.009110
training accuracy: 1.000000	test accuracy: 0.803197
lr decays to 0.002500
Average cost in epoch 51: 0.005199
training accuracy: 1.000000	test accuracy: 0.815185
Average cost in epoch 52: 0.009556
training accuracy: 1.000000	test accuracy: 0.806194
Average cost in epoch 53: 0.003426
training accuracy: 1.000000	test accuracy: 0.816184
Average cost in epoch 54: 0.004084
training accuracy: 1.000000	test accuracy: 0.804196
Average cost in epoch 55: 0.008873
training accuracy: 1.000000	test accuracy: 0.813187
Average cost in epoch 56: 0.003514
training accuracy: 1.000000	test accuracy: 0.799201
Average cost in epoch 57: 0.003150
training accuracy: 1.000000	test accuracy: 0.811189
Average cost in epoch 58: 0.004876
training accuracy: 1.000000	test accuracy: 0.808192
Average cost in epoch 59: 0.001777
training accuracy: 1.000000	test accuracy: 0.800200
Average cost in epoch 60: 0.006988
training accuracy: 1.000000	test accuracy: 0.792208
Average cost in epoch 61: 0.000811
training accuracy: 1.000000	test accuracy: 0.803197
Average cost in epoch 62: 0.000498
training accuracy: 1.000000	test accuracy: 0.800200
Average cost in epoch 63: 0.000489
training accuracy: 1.000000	test accuracy: 0.799201
Average cost in epoch 64: 0.000271
training accuracy: 1.000000	test accuracy: 0.801199
Average cost in epoch 65: 0.000566
training accuracy: 1.000000	test accuracy: 0.792208
Average cost in epoch 66: 0.000375
training accuracy: 1.000000	test accuracy: 0.797203
Average cost in epoch 67: 0.000372
training accuracy: 1.000000	test accuracy: 0.798202
Average cost in epoch 68: 0.002202
training accuracy: 1.000000	test accuracy: 0.792208
Average cost in epoch 69: 0.000199
training accuracy: 1.000000	test accuracy: 0.797203
Average cost in epoch 70: 0.000070
training accuracy: 1.000000	test accuracy: 0.800200
Average cost in epoch 71: 0.000090
training accuracy: 1.000000	test accuracy: 0.795205
Average cost in epoch 72: 0.000027
training accuracy: 1.000000	test accuracy: 0.800200
Average cost in epoch 73: 0.000052
training accuracy: 1.000000	test accuracy: 0.799201
Average cost in epoch 74: 0.000033
training accuracy: 1.000000	test accuracy: 0.800200
Average cost in epoch 75: 0.000069
training accuracy: 1.000000	test accuracy: 0.800200
lr decays to 0.001250
Average cost in epoch 76: 0.000021
training accuracy: 1.000000	test accuracy: 0.803197
Average cost in epoch 77: 0.000014
training accuracy: 1.000000	test accuracy: 0.798202
Average cost in epoch 78: 0.000010
training accuracy: 1.000000	test accuracy: 0.802198
Average cost in epoch 79: 0.000008
training accuracy: 1.000000	test accuracy: 0.799201
Average cost in epoch 80: 0.000006
training accuracy: 1.000000	test accuracy: 0.800200
Average cost in epoch 81: 0.000003
training accuracy: 1.000000	test accuracy: 0.798202
Average cost in epoch 82: 0.000004
training accuracy: 1.000000	test accuracy: 0.803197
Average cost in epoch 83: 0.000004
training accuracy: 1.000000	test accuracy: 0.801199
Average cost in epoch 84: 0.000002
training accuracy: 1.000000	test accuracy: 0.801199
Average cost in epoch 85: 0.000002
training accuracy: 1.000000	test accuracy: 0.801199
Average cost in epoch 86: 0.000003
training accuracy: 1.000000	test accuracy: 0.802198
Average cost in epoch 87: 0.000001
training accuracy: 1.000000	test accuracy: 0.798202
Average cost in epoch 88: 0.000001
training accuracy: 1.000000	test accuracy: 0.799201
Average cost in epoch 89: 0.000000
training accuracy: 1.000000	test accuracy: 0.798202
Average cost in epoch 90: 0.000000
training accuracy: 1.000000	test accuracy: 0.804196
Average cost in epoch 91: 0.000000
training accuracy: 1.000000	test accuracy: 0.805195
Average cost in epoch 92: 0.000000
training accuracy: 1.000000	test accuracy: 0.803197
Average cost in epoch 93: 0.000000
training accuracy: 1.000000	test accuracy: 0.805195
Average cost in epoch 94: 0.000000
training accuracy: 1.000000	test accuracy: 0.803197
Average cost in epoch 95: 0.000000
training accuracy: 1.000000	test accuracy: 0.807193
Average cost in epoch 96: 0.000000
training accuracy: 1.000000	test accuracy: 0.800200
Average cost in epoch 97: 0.000000
training accuracy: 1.000000	test accuracy: 0.803197
Average cost in epoch 98: 0.000000
training accuracy: 1.000000	test accuracy: 0.799201
Average cost in epoch 99: 0.000000
training accuracy: 1.000000	test accuracy: 0.800200

dump to weights/memn2n/memn2n_6.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 7, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_7.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 2.13
Starting training...
Average cost in epoch 0: 1.093430
training accuracy: 0.781250	test accuracy: 0.670330
Average cost in epoch 1: 0.715932
training accuracy: 0.843750	test accuracy: 0.703297
Average cost in epoch 2: 0.639440
training accuracy: 0.781250	test accuracy: 0.675325
Average cost in epoch 3: 0.603970
training accuracy: 0.906250	test accuracy: 0.721279
Average cost in epoch 4: 0.518070
training accuracy: 0.781250	test accuracy: 0.751249
Average cost in epoch 5: 0.493957
training accuracy: 0.906250	test accuracy: 0.670330
Average cost in epoch 6: 0.452743
training accuracy: 0.812500	test accuracy: 0.750250
Average cost in epoch 7: 0.384726
training accuracy: 0.906250	test accuracy: 0.753247
Average cost in epoch 8: 0.387869
training accuracy: 0.781250	test accuracy: 0.742258
Average cost in epoch 9: 0.338402
training accuracy: 0.875000	test accuracy: 0.728272
Average cost in epoch 10: 0.318934
training accuracy: 0.875000	test accuracy: 0.723277
Average cost in epoch 11: 0.365609
training accuracy: 0.906250	test accuracy: 0.743257
Average cost in epoch 12: 0.311139
training accuracy: 0.875000	test accuracy: 0.747253
Average cost in epoch 13: 0.280639
training accuracy: 0.843750	test accuracy: 0.749251
Average cost in epoch 14: 0.292411
training accuracy: 0.937500	test accuracy: 0.763237
Average cost in epoch 15: 0.272082
training accuracy: 0.812500	test accuracy: 0.682318
Average cost in epoch 16: 0.214982
training accuracy: 0.875000	test accuracy: 0.717283
Average cost in epoch 17: 0.283017
training accuracy: 0.968750	test accuracy: 0.736264
Average cost in epoch 18: 0.272751
training accuracy: 0.906250	test accuracy: 0.749251
Average cost in epoch 19: 0.259887
training accuracy: 0.875000	test accuracy: 0.751249
Average cost in epoch 20: 0.218818
training accuracy: 0.937500	test accuracy: 0.732268
Average cost in epoch 21: 0.200611
training accuracy: 0.781250	test accuracy: 0.668332
Average cost in epoch 22: 0.289099
training accuracy: 0.906250	test accuracy: 0.749251
Average cost in epoch 23: 0.200294
training accuracy: 0.906250	test accuracy: 0.775225
Average cost in epoch 24: 0.239992
training accuracy: 0.968750	test accuracy: 0.750250
Average cost in epoch 25: 0.214898
training accuracy: 0.812500	test accuracy: 0.714286
lr decays to 0.005000
Average cost in epoch 26: 0.157941
training accuracy: 0.968750	test accuracy: 0.759241
Average cost in epoch 27: 0.133837
training accuracy: 0.937500	test accuracy: 0.744256
Average cost in epoch 28: 0.116294
training accuracy: 0.937500	test accuracy: 0.743257
Average cost in epoch 29: 0.131721
training accuracy: 0.937500	test accuracy: 0.749251
Average cost in epoch 30: 0.093490
training accuracy: 1.000000	test accuracy: 0.748252
Average cost in epoch 31: 0.115830
training accuracy: 1.000000	test accuracy: 0.736264
Average cost in epoch 32: 0.101584
training accuracy: 0.968750	test accuracy: 0.739261
Average cost in epoch 33: 0.093283
training accuracy: 1.000000	test accuracy: 0.744256
Average cost in epoch 34: 0.088822
training accuracy: 1.000000	test accuracy: 0.732268
Average cost in epoch 35: 0.108131
training accuracy: 0.968750	test accuracy: 0.751249
Average cost in epoch 36: 0.078429
training accuracy: 0.968750	test accuracy: 0.740260
Average cost in epoch 37: 0.071588
training accuracy: 1.000000	test accuracy: 0.741259
Average cost in epoch 38: 0.070841
training accuracy: 0.937500	test accuracy: 0.730270
Average cost in epoch 39: 0.085071
training accuracy: 0.906250	test accuracy: 0.736264
Average cost in epoch 40: 0.070424
training accuracy: 0.937500	test accuracy: 0.705295
Average cost in epoch 41: 0.063434
training accuracy: 0.968750	test accuracy: 0.734266
Average cost in epoch 42: 0.047141
training accuracy: 0.937500	test accuracy: 0.733267
Average cost in epoch 43: 0.073840
training accuracy: 1.000000	test accuracy: 0.736264
Average cost in epoch 44: 0.055358
training accuracy: 1.000000	test accuracy: 0.741259
Average cost in epoch 45: 0.058744
training accuracy: 0.937500	test accuracy: 0.716284
Average cost in epoch 46: 0.062484
training accuracy: 1.000000	test accuracy: 0.737263
Average cost in epoch 47: 0.046055
training accuracy: 0.968750	test accuracy: 0.719281
Average cost in epoch 48: 0.042987
training accuracy: 0.968750	test accuracy: 0.707293
Average cost in epoch 49: 0.041408
training accuracy: 1.000000	test accuracy: 0.717283
Average cost in epoch 50: 0.032892
training accuracy: 0.968750	test accuracy: 0.736264
lr decays to 0.002500
Average cost in epoch 51: 0.039201
training accuracy: 1.000000	test accuracy: 0.719281
Average cost in epoch 52: 0.024287
training accuracy: 1.000000	test accuracy: 0.720280
Average cost in epoch 53: 0.018697
training accuracy: 1.000000	test accuracy: 0.726274
Average cost in epoch 54: 0.026951
training accuracy: 1.000000	test accuracy: 0.725275
Average cost in epoch 55: 0.022670
training accuracy: 0.968750	test accuracy: 0.724276
Average cost in epoch 56: 0.024960
training accuracy: 0.968750	test accuracy: 0.724276
Average cost in epoch 57: 0.014155
training accuracy: 1.000000	test accuracy: 0.726274
Average cost in epoch 58: 0.021151
training accuracy: 1.000000	test accuracy: 0.718282
Average cost in epoch 59: 0.030539
training accuracy: 1.000000	test accuracy: 0.721279
Average cost in epoch 60: 0.016042
training accuracy: 1.000000	test accuracy: 0.709291
Average cost in epoch 61: 0.018578
training accuracy: 1.000000	test accuracy: 0.719281
Average cost in epoch 62: 0.017224
training accuracy: 1.000000	test accuracy: 0.711289
Average cost in epoch 63: 0.032915
training accuracy: 1.000000	test accuracy: 0.728272
Average cost in epoch 64: 0.013677
training accuracy: 1.000000	test accuracy: 0.716284
Average cost in epoch 65: 0.015508
training accuracy: 1.000000	test accuracy: 0.715285
Average cost in epoch 66: 0.021816
training accuracy: 1.000000	test accuracy: 0.716284
Average cost in epoch 67: 0.029846
training accuracy: 1.000000	test accuracy: 0.724276
Average cost in epoch 68: 0.017517
training accuracy: 1.000000	test accuracy: 0.719281
Average cost in epoch 69: 0.013100
training accuracy: 1.000000	test accuracy: 0.723277
Average cost in epoch 70: 0.012085
training accuracy: 1.000000	test accuracy: 0.720280
Average cost in epoch 71: 0.013500
training accuracy: 0.968750	test accuracy: 0.716284
Average cost in epoch 72: 0.018256
training accuracy: 1.000000	test accuracy: 0.710290
Average cost in epoch 73: 0.016737
training accuracy: 1.000000	test accuracy: 0.721279
Average cost in epoch 74: 0.016108
training accuracy: 1.000000	test accuracy: 0.718282
Average cost in epoch 75: 0.020398
training accuracy: 1.000000	test accuracy: 0.713287
lr decays to 0.001250
Average cost in epoch 76: 0.010248
training accuracy: 0.968750	test accuracy: 0.719281
Average cost in epoch 77: 0.007625
training accuracy: 1.000000	test accuracy: 0.721279
Average cost in epoch 78: 0.013548
training accuracy: 1.000000	test accuracy: 0.715285
Average cost in epoch 79: 0.012044
training accuracy: 1.000000	test accuracy: 0.717283
Average cost in epoch 80: 0.007977
training accuracy: 1.000000	test accuracy: 0.711289
Average cost in epoch 81: 0.011652
training accuracy: 0.968750	test accuracy: 0.715285
Average cost in epoch 82: 0.011089
training accuracy: 1.000000	test accuracy: 0.714286
Average cost in epoch 83: 0.011273
training accuracy: 1.000000	test accuracy: 0.717283
Average cost in epoch 84: 0.010294
training accuracy: 1.000000	test accuracy: 0.718282
Average cost in epoch 85: 0.010189
training accuracy: 1.000000	test accuracy: 0.717283
Average cost in epoch 86: 0.011248
training accuracy: 1.000000	test accuracy: 0.721279
Average cost in epoch 87: 0.010897
training accuracy: 0.968750	test accuracy: 0.717283
Average cost in epoch 88: 0.011199
training accuracy: 1.000000	test accuracy: 0.719281
Average cost in epoch 89: 0.012156
training accuracy: 1.000000	test accuracy: 0.717283
Average cost in epoch 90: 0.009610
training accuracy: 1.000000	test accuracy: 0.715285
Average cost in epoch 91: 0.011013
training accuracy: 1.000000	test accuracy: 0.719281
Average cost in epoch 92: 0.011207
training accuracy: 1.000000	test accuracy: 0.724276
Average cost in epoch 93: 0.011037
training accuracy: 1.000000	test accuracy: 0.715285
Average cost in epoch 94: 0.009338
training accuracy: 1.000000	test accuracy: 0.721279
Average cost in epoch 95: 0.015752
training accuracy: 1.000000	test accuracy: 0.721279
Average cost in epoch 96: 0.006025
training accuracy: 1.000000	test accuracy: 0.711289
Average cost in epoch 97: 0.011411
training accuracy: 0.968750	test accuracy: 0.724276
Average cost in epoch 98: 0.009111
training accuracy: 0.968750	test accuracy: 0.712288
Average cost in epoch 99: 0.007807
training accuracy: 0.968750	test accuracy: 0.715285

dump to weights/memn2n/memn2n_7.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 8, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_8.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 2.12
Starting training...
Average cost in epoch 0: 1.788496
training accuracy: 0.687500	test accuracy: 0.565435
Average cost in epoch 1: 1.141551
training accuracy: 0.687500	test accuracy: 0.710290
Average cost in epoch 2: 0.787896
training accuracy: 0.781250	test accuracy: 0.722278
Average cost in epoch 3: 0.602736
training accuracy: 0.781250	test accuracy: 0.783217
Average cost in epoch 4: 0.512498
training accuracy: 0.812500	test accuracy: 0.796204
Average cost in epoch 5: 0.460327
training accuracy: 0.875000	test accuracy: 0.781219
Average cost in epoch 6: 0.339228
training accuracy: 0.812500	test accuracy: 0.768232
Average cost in epoch 7: 0.307365
training accuracy: 0.906250	test accuracy: 0.787213
Average cost in epoch 8: 0.279250
training accuracy: 0.937500	test accuracy: 0.812188
Average cost in epoch 9: 0.291514
training accuracy: 0.843750	test accuracy: 0.801199
Average cost in epoch 10: 0.245382
training accuracy: 1.000000	test accuracy: 0.796204
Average cost in epoch 11: 0.208413
training accuracy: 0.937500	test accuracy: 0.814186
Average cost in epoch 12: 0.158876
training accuracy: 0.968750	test accuracy: 0.825175
Average cost in epoch 13: 0.163589
training accuracy: 0.968750	test accuracy: 0.801199
Average cost in epoch 14: 0.222906
training accuracy: 0.968750	test accuracy: 0.796204
Average cost in epoch 15: 0.144209
training accuracy: 1.000000	test accuracy: 0.781219
Average cost in epoch 16: 0.205772
training accuracy: 0.968750	test accuracy: 0.792208
Average cost in epoch 17: 0.099572
training accuracy: 1.000000	test accuracy: 0.806194
Average cost in epoch 18: 0.140030
training accuracy: 0.968750	test accuracy: 0.820180
Average cost in epoch 19: 0.156919
training accuracy: 0.906250	test accuracy: 0.781219
Average cost in epoch 20: 0.126473
training accuracy: 1.000000	test accuracy: 0.831169
Average cost in epoch 21: 0.106580
training accuracy: 0.968750	test accuracy: 0.828172
Average cost in epoch 22: 0.115010
training accuracy: 0.843750	test accuracy: 0.801199
Average cost in epoch 23: 0.157301
training accuracy: 0.843750	test accuracy: 0.807193
Average cost in epoch 24: 0.126732
training accuracy: 0.906250	test accuracy: 0.719281
Average cost in epoch 25: 0.129744
training accuracy: 0.937500	test accuracy: 0.814186
lr decays to 0.005000
Average cost in epoch 26: 0.062467
training accuracy: 1.000000	test accuracy: 0.818182
Average cost in epoch 27: 0.045020
training accuracy: 1.000000	test accuracy: 0.822178
Average cost in epoch 28: 0.048628
training accuracy: 0.968750	test accuracy: 0.833167
Average cost in epoch 29: 0.029444
training accuracy: 0.968750	test accuracy: 0.812188
Average cost in epoch 30: 0.024130
training accuracy: 0.968750	test accuracy: 0.817183
Average cost in epoch 31: 0.041386
training accuracy: 1.000000	test accuracy: 0.794206
Average cost in epoch 32: 0.026389
training accuracy: 0.968750	test accuracy: 0.810190
Average cost in epoch 33: 0.024803
training accuracy: 0.968750	test accuracy: 0.806194
Average cost in epoch 34: 0.027985
training accuracy: 1.000000	test accuracy: 0.822178
Average cost in epoch 35: 0.024773
training accuracy: 1.000000	test accuracy: 0.819181
Average cost in epoch 36: 0.029771
training accuracy: 1.000000	test accuracy: 0.830170
Average cost in epoch 37: 0.017457
training accuracy: 1.000000	test accuracy: 0.820180
Average cost in epoch 38: 0.053966
training accuracy: 1.000000	test accuracy: 0.803197
Average cost in epoch 39: 0.016636
training accuracy: 1.000000	test accuracy: 0.825175
Average cost in epoch 40: 0.015624
training accuracy: 1.000000	test accuracy: 0.821179
Average cost in epoch 41: 0.016275
training accuracy: 1.000000	test accuracy: 0.818182
Average cost in epoch 42: 0.038191
training accuracy: 1.000000	test accuracy: 0.819181
Average cost in epoch 43: 0.007860
training accuracy: 0.968750	test accuracy: 0.830170
Average cost in epoch 44: 0.014670
training accuracy: 1.000000	test accuracy: 0.826174
Average cost in epoch 45: 0.031739
training accuracy: 1.000000	test accuracy: 0.809191
Average cost in epoch 46: 0.018712
training accuracy: 1.000000	test accuracy: 0.817183
Average cost in epoch 47: 0.016255
training accuracy: 1.000000	test accuracy: 0.809191
Average cost in epoch 48: 0.021600
training accuracy: 1.000000	test accuracy: 0.816184
Average cost in epoch 49: 0.012377
training accuracy: 1.000000	test accuracy: 0.817183
Average cost in epoch 50: 0.018673
training accuracy: 1.000000	test accuracy: 0.792208
lr decays to 0.002500
Average cost in epoch 51: 0.010759
training accuracy: 1.000000	test accuracy: 0.817183
Average cost in epoch 52: 0.009173
training accuracy: 1.000000	test accuracy: 0.817183
Average cost in epoch 53: 0.007640
training accuracy: 1.000000	test accuracy: 0.819181
Average cost in epoch 54: 0.008897
training accuracy: 1.000000	test accuracy: 0.822178
Average cost in epoch 55: 0.009561
training accuracy: 1.000000	test accuracy: 0.824176
Average cost in epoch 56: 0.005300
training accuracy: 0.968750	test accuracy: 0.823177
Average cost in epoch 57: 0.004165
training accuracy: 1.000000	test accuracy: 0.819181
Average cost in epoch 58: 0.010429
training accuracy: 1.000000	test accuracy: 0.830170
Average cost in epoch 59: 0.005126
training accuracy: 1.000000	test accuracy: 0.825175
Average cost in epoch 60: 0.006989
training accuracy: 1.000000	test accuracy: 0.823177
Average cost in epoch 61: 0.009763
training accuracy: 1.000000	test accuracy: 0.825175
Average cost in epoch 62: 0.003411
training accuracy: 1.000000	test accuracy: 0.818182
Average cost in epoch 63: 0.005615
training accuracy: 1.000000	test accuracy: 0.827173
Average cost in epoch 64: 0.009222
training accuracy: 1.000000	test accuracy: 0.818182
Average cost in epoch 65: 0.002686
training accuracy: 1.000000	test accuracy: 0.825175
Average cost in epoch 66: 0.006480
training accuracy: 0.968750	test accuracy: 0.818182
Average cost in epoch 67: 0.009127
training accuracy: 1.000000	test accuracy: 0.819181
Average cost in epoch 68: 0.001871
training accuracy: 1.000000	test accuracy: 0.826174
Average cost in epoch 69: 0.007137
training accuracy: 1.000000	test accuracy: 0.826174
Average cost in epoch 70: 0.000618
training accuracy: 1.000000	test accuracy: 0.830170
Average cost in epoch 71: 0.005245
training accuracy: 1.000000	test accuracy: 0.828172
Average cost in epoch 72: 0.010383
training accuracy: 1.000000	test accuracy: 0.816184
Average cost in epoch 73: 0.001285
training accuracy: 1.000000	test accuracy: 0.832168
Average cost in epoch 74: 0.006582
training accuracy: 1.000000	test accuracy: 0.829171
Average cost in epoch 75: 0.003857
training accuracy: 1.000000	test accuracy: 0.817183
lr decays to 0.001250
Average cost in epoch 76: 0.003990
training accuracy: 1.000000	test accuracy: 0.820180
Average cost in epoch 77: 0.003630
training accuracy: 1.000000	test accuracy: 0.821179
Average cost in epoch 78: 0.003253
training accuracy: 1.000000	test accuracy: 0.822178
Average cost in epoch 79: 0.003364
training accuracy: 1.000000	test accuracy: 0.816184
Average cost in epoch 80: 0.003134
training accuracy: 1.000000	test accuracy: 0.820180
Average cost in epoch 81: 0.003563
training accuracy: 1.000000	test accuracy: 0.822178
Average cost in epoch 82: 0.003504
training accuracy: 1.000000	test accuracy: 0.824176
Average cost in epoch 83: 0.002609
training accuracy: 1.000000	test accuracy: 0.821179
Average cost in epoch 84: 0.003131
training accuracy: 1.000000	test accuracy: 0.821179
Average cost in epoch 85: 0.003570
training accuracy: 1.000000	test accuracy: 0.822178
Average cost in epoch 86: 0.003361
training accuracy: 1.000000	test accuracy: 0.818182
Average cost in epoch 87: 0.003359
training accuracy: 1.000000	test accuracy: 0.825175
Average cost in epoch 88: 0.003084
training accuracy: 1.000000	test accuracy: 0.820180
Average cost in epoch 89: 0.003650
training accuracy: 1.000000	test accuracy: 0.822178
Average cost in epoch 90: 0.003125
training accuracy: 1.000000	test accuracy: 0.826174
Average cost in epoch 91: 0.003289
training accuracy: 1.000000	test accuracy: 0.826174
Average cost in epoch 92: 0.003317
training accuracy: 1.000000	test accuracy: 0.829171
Average cost in epoch 93: 0.003217
training accuracy: 1.000000	test accuracy: 0.823177
Average cost in epoch 94: 0.005025
training accuracy: 1.000000	test accuracy: 0.822178
Average cost in epoch 95: 0.001356
training accuracy: 1.000000	test accuracy: 0.823177
Average cost in epoch 96: 0.003828
training accuracy: 1.000000	test accuracy: 0.822178
Average cost in epoch 97: 0.003023
training accuracy: 1.000000	test accuracy: 0.821179
Average cost in epoch 98: 0.004033
training accuracy: 1.000000	test accuracy: 0.825175
Average cost in epoch 99: 0.002898
training accuracy: 1.000000	test accuracy: 0.828172

dump to weights/memn2n/memn2n_8.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 9, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_9.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 2.10
Starting training...
Average cost in epoch 0: 0.958117
training accuracy: 0.593750	test accuracy: 0.637363
Average cost in epoch 1: 0.646927
training accuracy: 0.781250	test accuracy: 0.635365
Average cost in epoch 2: 0.657677
training accuracy: 0.687500	test accuracy: 0.633367
Average cost in epoch 3: 0.650752
training accuracy: 0.718750	test accuracy: 0.642358
Average cost in epoch 4: 0.617493
training accuracy: 0.562500	test accuracy: 0.666334
Average cost in epoch 5: 0.599727
training accuracy: 0.718750	test accuracy: 0.655345
Average cost in epoch 6: 0.578502
training accuracy: 0.750000	test accuracy: 0.662338
Average cost in epoch 7: 0.531842
training accuracy: 0.812500	test accuracy: 0.651349
Average cost in epoch 8: 0.502607
training accuracy: 0.656250	test accuracy: 0.670330
Average cost in epoch 9: 0.463927
training accuracy: 0.937500	test accuracy: 0.712288
Average cost in epoch 10: 0.450050
training accuracy: 0.812500	test accuracy: 0.730270
Average cost in epoch 11: 0.395285
training accuracy: 0.812500	test accuracy: 0.724276
Average cost in epoch 12: 0.372237
training accuracy: 0.843750	test accuracy: 0.738262
Average cost in epoch 13: 0.339377
training accuracy: 0.843750	test accuracy: 0.744256
Average cost in epoch 14: 0.329470
training accuracy: 0.906250	test accuracy: 0.751249
Average cost in epoch 15: 0.315730
training accuracy: 0.843750	test accuracy: 0.772228
Average cost in epoch 16: 0.297027
training accuracy: 0.875000	test accuracy: 0.784216
Average cost in epoch 17: 0.240679
training accuracy: 0.906250	test accuracy: 0.785215
Average cost in epoch 18: 0.222064
training accuracy: 0.968750	test accuracy: 0.787213
Average cost in epoch 19: 0.261262
training accuracy: 0.906250	test accuracy: 0.801199
Average cost in epoch 20: 0.193959
training accuracy: 0.875000	test accuracy: 0.798202
Average cost in epoch 21: 0.172782
training accuracy: 0.968750	test accuracy: 0.802198
Average cost in epoch 22: 0.206336
training accuracy: 0.968750	test accuracy: 0.800200
Average cost in epoch 23: 0.158510
training accuracy: 1.000000	test accuracy: 0.818182
Average cost in epoch 24: 0.193950
training accuracy: 0.875000	test accuracy: 0.808192
Average cost in epoch 25: 0.170593
training accuracy: 1.000000	test accuracy: 0.807193
lr decays to 0.005000
Average cost in epoch 26: 0.092795
training accuracy: 0.937500	test accuracy: 0.820180
Average cost in epoch 27: 0.061538
training accuracy: 0.968750	test accuracy: 0.811189
Average cost in epoch 28: 0.071326
training accuracy: 1.000000	test accuracy: 0.815185
Average cost in epoch 29: 0.056224
training accuracy: 1.000000	test accuracy: 0.819181
Average cost in epoch 30: 0.035287
training accuracy: 0.968750	test accuracy: 0.818182
Average cost in epoch 31: 0.042011
training accuracy: 0.968750	test accuracy: 0.817183
Average cost in epoch 32: 0.039488
training accuracy: 1.000000	test accuracy: 0.829171
Average cost in epoch 33: 0.034872
training accuracy: 0.937500	test accuracy: 0.818182
Average cost in epoch 34: 0.040726
training accuracy: 0.968750	test accuracy: 0.810190
Average cost in epoch 35: 0.053067
training accuracy: 0.937500	test accuracy: 0.826174
Average cost in epoch 36: 0.040273
training accuracy: 1.000000	test accuracy: 0.808192
Average cost in epoch 37: 0.045886
training accuracy: 1.000000	test accuracy: 0.819181
Average cost in epoch 38: 0.020722
training accuracy: 1.000000	test accuracy: 0.824176
Average cost in epoch 39: 0.020577
training accuracy: 1.000000	test accuracy: 0.824176
Average cost in epoch 40: 0.034782
training accuracy: 0.937500	test accuracy: 0.822178
Average cost in epoch 41: 0.058860
training accuracy: 1.000000	test accuracy: 0.825175
Average cost in epoch 42: 0.043084
training accuracy: 1.000000	test accuracy: 0.835165
Average cost in epoch 43: 0.048695
training accuracy: 1.000000	test accuracy: 0.825175
Average cost in epoch 44: 0.031150
training accuracy: 1.000000	test accuracy: 0.832168
Average cost in epoch 45: 0.025842
training accuracy: 1.000000	test accuracy: 0.837163
Average cost in epoch 46: 0.025145
training accuracy: 0.937500	test accuracy: 0.816184
Average cost in epoch 47: 0.024891
training accuracy: 1.000000	test accuracy: 0.824176
Average cost in epoch 48: 0.012263
training accuracy: 1.000000	test accuracy: 0.826174
Average cost in epoch 49: 0.016779
training accuracy: 0.968750	test accuracy: 0.816184
Average cost in epoch 50: 0.064748
training accuracy: 1.000000	test accuracy: 0.828172
lr decays to 0.002500
Average cost in epoch 51: 0.039914
training accuracy: 1.000000	test accuracy: 0.838162
Average cost in epoch 52: 0.009237
training accuracy: 1.000000	test accuracy: 0.834166
Average cost in epoch 53: 0.009369
training accuracy: 1.000000	test accuracy: 0.838162
Average cost in epoch 54: 0.009055
training accuracy: 0.968750	test accuracy: 0.838162
Average cost in epoch 55: 0.005236
training accuracy: 1.000000	test accuracy: 0.835165
Average cost in epoch 56: 0.011276
training accuracy: 1.000000	test accuracy: 0.825175
Average cost in epoch 57: 0.007628
training accuracy: 1.000000	test accuracy: 0.827173
Average cost in epoch 58: 0.006162
training accuracy: 1.000000	test accuracy: 0.818182
Average cost in epoch 59: 0.006451
training accuracy: 0.968750	test accuracy: 0.832168
Average cost in epoch 60: 0.006904
training accuracy: 1.000000	test accuracy: 0.827173
Average cost in epoch 61: 0.008450
training accuracy: 1.000000	test accuracy: 0.825175
Average cost in epoch 62: 0.002932
training accuracy: 1.000000	test accuracy: 0.831169
Average cost in epoch 63: 0.008617
training accuracy: 1.000000	test accuracy: 0.828172
Average cost in epoch 64: 0.006003
training accuracy: 0.968750	test accuracy: 0.824176
Average cost in epoch 65: 0.004688
training accuracy: 1.000000	test accuracy: 0.833167
Average cost in epoch 66: 0.003653
training accuracy: 1.000000	test accuracy: 0.833167
Average cost in epoch 67: 0.007592
training accuracy: 1.000000	test accuracy: 0.832168
Average cost in epoch 68: 0.001805
training accuracy: 1.000000	test accuracy: 0.840160
Average cost in epoch 69: 0.004082
training accuracy: 1.000000	test accuracy: 0.833167
Average cost in epoch 70: 0.005675
training accuracy: 1.000000	test accuracy: 0.838162
Average cost in epoch 71: 0.008018
training accuracy: 1.000000	test accuracy: 0.838162
Average cost in epoch 72: 0.008469
training accuracy: 1.000000	test accuracy: 0.839161
Average cost in epoch 73: 0.007411
training accuracy: 1.000000	test accuracy: 0.830170
Average cost in epoch 74: 0.020743
training accuracy: 1.000000	test accuracy: 0.836164
Average cost in epoch 75: 0.003497
training accuracy: 1.000000	test accuracy: 0.835165
lr decays to 0.001250
Average cost in epoch 76: 0.004018
training accuracy: 1.000000	test accuracy: 0.834166
Average cost in epoch 77: 0.001204
training accuracy: 1.000000	test accuracy: 0.831169
Average cost in epoch 78: 0.004399
training accuracy: 1.000000	test accuracy: 0.834166
Average cost in epoch 79: 0.003449
training accuracy: 1.000000	test accuracy: 0.834166
Average cost in epoch 80: 0.001366
training accuracy: 1.000000	test accuracy: 0.830170
Average cost in epoch 81: 0.004927
training accuracy: 1.000000	test accuracy: 0.835165
Average cost in epoch 82: 0.003671
training accuracy: 1.000000	test accuracy: 0.834166
Average cost in epoch 83: 0.003456
training accuracy: 1.000000	test accuracy: 0.832168
Average cost in epoch 84: 0.003328
training accuracy: 1.000000	test accuracy: 0.829171
Average cost in epoch 85: 0.002977
training accuracy: 1.000000	test accuracy: 0.833167
Average cost in epoch 86: 0.003119
training accuracy: 1.000000	test accuracy: 0.831169
Average cost in epoch 87: 0.003178
training accuracy: 1.000000	test accuracy: 0.834166
Average cost in epoch 88: 0.003243
training accuracy: 1.000000	test accuracy: 0.831169
Average cost in epoch 89: 0.002724
training accuracy: 1.000000	test accuracy: 0.831169
Average cost in epoch 90: 0.003448
training accuracy: 1.000000	test accuracy: 0.831169
Average cost in epoch 91: 0.002422
training accuracy: 0.968750	test accuracy: 0.828172
Average cost in epoch 92: 0.000522
training accuracy: 1.000000	test accuracy: 0.829171
Average cost in epoch 93: 0.003464
training accuracy: 0.968750	test accuracy: 0.837163
Average cost in epoch 94: 0.000249
training accuracy: 1.000000	test accuracy: 0.836164
Average cost in epoch 95: 0.007566
training accuracy: 1.000000	test accuracy: 0.830170
Average cost in epoch 96: 0.002619
training accuracy: 1.000000	test accuracy: 0.834166
Average cost in epoch 97: 0.003355
training accuracy: 1.000000	test accuracy: 0.833167
Average cost in epoch 98: 0.002003
training accuracy: 1.000000	test accuracy: 0.829171
Average cost in epoch 99: 0.001306
training accuracy: 1.000000	test accuracy: 0.831169

dump to weights/memn2n/memn2n_9.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 10, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_10.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 2.10
Starting training...
Average cost in epoch 0: 1.201487
training accuracy: 0.375000	test accuracy: 0.435564
Average cost in epoch 1: 0.979996
training accuracy: 0.562500	test accuracy: 0.435564
Average cost in epoch 2: 0.953263
training accuracy: 0.593750	test accuracy: 0.441558
Average cost in epoch 3: 0.937920
training accuracy: 0.656250	test accuracy: 0.456543
Average cost in epoch 4: 0.930725
training accuracy: 0.468750	test accuracy: 0.442557
Average cost in epoch 5: 0.904233
training accuracy: 0.562500	test accuracy: 0.484515
Average cost in epoch 6: 0.886044
training accuracy: 0.593750	test accuracy: 0.483516
Average cost in epoch 7: 0.807286
training accuracy: 0.468750	test accuracy: 0.509491
Average cost in epoch 8: 0.787937
training accuracy: 0.781250	test accuracy: 0.518482
Average cost in epoch 9: 0.751929
training accuracy: 0.687500	test accuracy: 0.542458
Average cost in epoch 10: 0.711421
training accuracy: 0.687500	test accuracy: 0.550450
Average cost in epoch 11: 0.661322
training accuracy: 0.625000	test accuracy: 0.573427
Average cost in epoch 12: 0.599104
training accuracy: 0.781250	test accuracy: 0.633367
Average cost in epoch 13: 0.561211
training accuracy: 0.656250	test accuracy: 0.664336
Average cost in epoch 14: 0.489457
training accuracy: 0.687500	test accuracy: 0.691309
Average cost in epoch 15: 0.484911
training accuracy: 0.937500	test accuracy: 0.684316
Average cost in epoch 16: 0.417318
training accuracy: 0.687500	test accuracy: 0.709291
Average cost in epoch 17: 0.420481
training accuracy: 0.750000	test accuracy: 0.705295
Average cost in epoch 18: 0.367210
training accuracy: 0.812500	test accuracy: 0.750250
Average cost in epoch 19: 0.342624
training accuracy: 0.718750	test accuracy: 0.757243
Average cost in epoch 20: 0.347474
training accuracy: 0.843750	test accuracy: 0.768232
Average cost in epoch 21: 0.325061
training accuracy: 0.968750	test accuracy: 0.752248
Average cost in epoch 22: 0.332564
training accuracy: 0.875000	test accuracy: 0.731269
Average cost in epoch 23: 0.280963
training accuracy: 0.843750	test accuracy: 0.774226
Average cost in epoch 24: 0.276838
training accuracy: 0.906250	test accuracy: 0.763237
Average cost in epoch 25: 0.284491
training accuracy: 0.843750	test accuracy: 0.794206
lr decays to 0.005000
Average cost in epoch 26: 0.162902
training accuracy: 0.875000	test accuracy: 0.757243
Average cost in epoch 27: 0.146208
training accuracy: 0.937500	test accuracy: 0.784216
Average cost in epoch 28: 0.130453
training accuracy: 1.000000	test accuracy: 0.773227
Average cost in epoch 29: 0.133217
training accuracy: 1.000000	test accuracy: 0.797203
Average cost in epoch 30: 0.123624
training accuracy: 0.968750	test accuracy: 0.787213
Average cost in epoch 31: 0.103066
training accuracy: 0.906250	test accuracy: 0.768232
Average cost in epoch 32: 0.091421
training accuracy: 1.000000	test accuracy: 0.788212
Average cost in epoch 33: 0.081271
training accuracy: 1.000000	test accuracy: 0.800200
Average cost in epoch 34: 0.114276
training accuracy: 0.968750	test accuracy: 0.807193
Average cost in epoch 35: 0.078826
training accuracy: 1.000000	test accuracy: 0.801199
Average cost in epoch 36: 0.072202
training accuracy: 1.000000	test accuracy: 0.793207
Average cost in epoch 37: 0.081302
training accuracy: 0.968750	test accuracy: 0.778222
Average cost in epoch 38: 0.086892
training accuracy: 0.906250	test accuracy: 0.782218
Average cost in epoch 39: 0.078484
training accuracy: 0.968750	test accuracy: 0.797203
Average cost in epoch 40: 0.055122
training accuracy: 1.000000	test accuracy: 0.788212
Average cost in epoch 41: 0.069331
training accuracy: 1.000000	test accuracy: 0.766234
Average cost in epoch 42: 0.068163
training accuracy: 0.968750	test accuracy: 0.789211
Average cost in epoch 43: 0.080855
training accuracy: 1.000000	test accuracy: 0.777223
Average cost in epoch 44: 0.071960
training accuracy: 1.000000	test accuracy: 0.785215
Average cost in epoch 45: 0.063838
training accuracy: 1.000000	test accuracy: 0.758242
Average cost in epoch 46: 0.081555
training accuracy: 1.000000	test accuracy: 0.795205
Average cost in epoch 47: 0.043196
training accuracy: 1.000000	test accuracy: 0.796204
Average cost in epoch 48: 0.091391
training accuracy: 0.906250	test accuracy: 0.762238
Average cost in epoch 49: 0.083289
training accuracy: 1.000000	test accuracy: 0.773227
Average cost in epoch 50: 0.048666
training accuracy: 1.000000	test accuracy: 0.786214
lr decays to 0.002500
Average cost in epoch 51: 0.024307
training accuracy: 1.000000	test accuracy: 0.791209
Average cost in epoch 52: 0.024715
training accuracy: 0.968750	test accuracy: 0.798202
Average cost in epoch 53: 0.028218
training accuracy: 1.000000	test accuracy: 0.786214
Average cost in epoch 54: 0.022714
training accuracy: 1.000000	test accuracy: 0.789211
Average cost in epoch 55: 0.032571
training accuracy: 1.000000	test accuracy: 0.787213
Average cost in epoch 56: 0.018888
training accuracy: 1.000000	test accuracy: 0.786214
Average cost in epoch 57: 0.036487
training accuracy: 1.000000	test accuracy: 0.778222
Average cost in epoch 58: 0.019459
training accuracy: 0.968750	test accuracy: 0.791209
Average cost in epoch 59: 0.019208
training accuracy: 1.000000	test accuracy: 0.796204
Average cost in epoch 60: 0.024479
training accuracy: 1.000000	test accuracy: 0.792208
Average cost in epoch 61: 0.019925
training accuracy: 1.000000	test accuracy: 0.797203
Average cost in epoch 62: 0.018563
training accuracy: 1.000000	test accuracy: 0.784216
Average cost in epoch 63: 0.020187
training accuracy: 0.968750	test accuracy: 0.788212
Average cost in epoch 64: 0.020832
training accuracy: 1.000000	test accuracy: 0.787213
Average cost in epoch 65: 0.024292
training accuracy: 1.000000	test accuracy: 0.791209
Average cost in epoch 66: 0.019276
training accuracy: 1.000000	test accuracy: 0.788212
Average cost in epoch 67: 0.012542
training accuracy: 0.968750	test accuracy: 0.785215
Average cost in epoch 68: 0.015887
training accuracy: 0.968750	test accuracy: 0.791209
Average cost in epoch 69: 0.013515
training accuracy: 1.000000	test accuracy: 0.785215
Average cost in epoch 70: 0.018588
training accuracy: 1.000000	test accuracy: 0.793207
Average cost in epoch 71: 0.012273
training accuracy: 1.000000	test accuracy: 0.787213
Average cost in epoch 72: 0.027596
training accuracy: 1.000000	test accuracy: 0.780220
Average cost in epoch 73: 0.018123
training accuracy: 1.000000	test accuracy: 0.779221
Average cost in epoch 74: 0.012564
training accuracy: 1.000000	test accuracy: 0.785215
Average cost in epoch 75: 0.007303
training accuracy: 1.000000	test accuracy: 0.781219
lr decays to 0.001250
Average cost in epoch 76: 0.011308
training accuracy: 1.000000	test accuracy: 0.782218
Average cost in epoch 77: 0.009770
training accuracy: 1.000000	test accuracy: 0.783217
Average cost in epoch 78: 0.009296
training accuracy: 1.000000	test accuracy: 0.786214
Average cost in epoch 79: 0.010154
training accuracy: 1.000000	test accuracy: 0.793207
Average cost in epoch 80: 0.007101
training accuracy: 1.000000	test accuracy: 0.790210
Average cost in epoch 81: 0.008355
training accuracy: 1.000000	test accuracy: 0.784216
Average cost in epoch 82: 0.006218
training accuracy: 0.968750	test accuracy: 0.787213
Average cost in epoch 83: 0.006200
training accuracy: 0.968750	test accuracy: 0.788212
Average cost in epoch 84: 0.006645
training accuracy: 1.000000	test accuracy: 0.788212
Average cost in epoch 85: 0.009786
training accuracy: 1.000000	test accuracy: 0.785215
Average cost in epoch 86: 0.006466
training accuracy: 0.968750	test accuracy: 0.785215
Average cost in epoch 87: 0.007485
training accuracy: 1.000000	test accuracy: 0.786214
Average cost in epoch 88: 0.006291
training accuracy: 1.000000	test accuracy: 0.784216
Average cost in epoch 89: 0.007444
training accuracy: 1.000000	test accuracy: 0.785215
Average cost in epoch 90: 0.006025
training accuracy: 1.000000	test accuracy: 0.788212
Average cost in epoch 91: 0.007085
training accuracy: 1.000000	test accuracy: 0.776224
Average cost in epoch 92: 0.006300
training accuracy: 1.000000	test accuracy: 0.783217
Average cost in epoch 93: 0.007116
training accuracy: 1.000000	test accuracy: 0.781219
Average cost in epoch 94: 0.006415
training accuracy: 1.000000	test accuracy: 0.783217
Average cost in epoch 95: 0.009591
training accuracy: 1.000000	test accuracy: 0.783217
Average cost in epoch 96: 0.005015
training accuracy: 1.000000	test accuracy: 0.784216
Average cost in epoch 97: 0.009876
training accuracy: 1.000000	test accuracy: 0.785215
Average cost in epoch 98: 0.003335
training accuracy: 1.000000	test accuracy: 0.782218
Average cost in epoch 99: 0.007938
training accuracy: 1.000000	test accuracy: 0.784216

dump to weights/memn2n/memn2n_10.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 11, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_11.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 2.06
Starting training...
Average cost in epoch 0: 1.736862
training accuracy: 0.312500	test accuracy: 0.427572
Average cost in epoch 1: 0.811510
training accuracy: 0.843750	test accuracy: 0.875125
Average cost in epoch 2: 0.450270
training accuracy: 0.843750	test accuracy: 0.902098
Average cost in epoch 3: 0.376612
training accuracy: 0.875000	test accuracy: 0.908092
Average cost in epoch 4: 0.371238
training accuracy: 0.906250	test accuracy: 0.892108
Average cost in epoch 5: 0.309829
training accuracy: 0.906250	test accuracy: 0.891109
Average cost in epoch 6: 0.282427
training accuracy: 0.968750	test accuracy: 0.903097
Average cost in epoch 7: 0.261553
training accuracy: 0.906250	test accuracy: 0.885115
Average cost in epoch 8: 0.203251
training accuracy: 1.000000	test accuracy: 0.898102
Average cost in epoch 9: 0.175674
training accuracy: 0.906250	test accuracy: 0.868132
Average cost in epoch 10: 0.167689
training accuracy: 0.937500	test accuracy: 0.896104
Average cost in epoch 11: 0.128870
training accuracy: 1.000000	test accuracy: 0.887113
Average cost in epoch 12: 0.130955
training accuracy: 0.968750	test accuracy: 0.876124
Average cost in epoch 13: 0.100233
training accuracy: 0.968750	test accuracy: 0.888112
Average cost in epoch 14: 0.076870
training accuracy: 0.937500	test accuracy: 0.895105
Average cost in epoch 15: 0.114894
training accuracy: 1.000000	test accuracy: 0.885115
Average cost in epoch 16: 0.097423
training accuracy: 1.000000	test accuracy: 0.889111
Average cost in epoch 17: 0.058843
training accuracy: 0.968750	test accuracy: 0.898102
Average cost in epoch 18: 0.115206
training accuracy: 1.000000	test accuracy: 0.878122
Average cost in epoch 19: 0.078279
training accuracy: 1.000000	test accuracy: 0.893107
Average cost in epoch 20: 0.050102
training accuracy: 1.000000	test accuracy: 0.906094
Average cost in epoch 21: 0.037078
training accuracy: 1.000000	test accuracy: 0.886114
Average cost in epoch 22: 0.127652
training accuracy: 0.968750	test accuracy: 0.910090
Average cost in epoch 23: 0.087323
training accuracy: 0.906250	test accuracy: 0.896104
Average cost in epoch 24: 0.061121
training accuracy: 1.000000	test accuracy: 0.907093
Average cost in epoch 25: 0.031163
training accuracy: 1.000000	test accuracy: 0.903097
lr decays to 0.005000
Average cost in epoch 26: 0.018776
training accuracy: 1.000000	test accuracy: 0.922078
Average cost in epoch 27: 0.008220
training accuracy: 1.000000	test accuracy: 0.921079
Average cost in epoch 28: 0.003360
training accuracy: 1.000000	test accuracy: 0.926074
Average cost in epoch 29: 0.002862
training accuracy: 1.000000	test accuracy: 0.927073
Average cost in epoch 30: 0.002160
training accuracy: 1.000000	test accuracy: 0.923077
Average cost in epoch 31: 0.010612
training accuracy: 1.000000	test accuracy: 0.931069
Average cost in epoch 32: 0.000884
training accuracy: 1.000000	test accuracy: 0.934066
Average cost in epoch 33: 0.000344
training accuracy: 1.000000	test accuracy: 0.935065
Average cost in epoch 34: 0.000308
training accuracy: 1.000000	test accuracy: 0.939061
Average cost in epoch 35: 0.000129
training accuracy: 1.000000	test accuracy: 0.938062
Average cost in epoch 36: 0.000108
training accuracy: 1.000000	test accuracy: 0.940060
Average cost in epoch 37: 0.001664
training accuracy: 1.000000	test accuracy: 0.947053
Average cost in epoch 38: 0.000126
training accuracy: 1.000000	test accuracy: 0.947053
Average cost in epoch 39: 0.000057
training accuracy: 1.000000	test accuracy: 0.948052
Average cost in epoch 40: 0.000036
training accuracy: 1.000000	test accuracy: 0.950050
Average cost in epoch 41: 0.000027
training accuracy: 1.000000	test accuracy: 0.949051
Average cost in epoch 42: 0.000018
training accuracy: 1.000000	test accuracy: 0.950050
Average cost in epoch 43: 0.000016
training accuracy: 1.000000	test accuracy: 0.948052
Average cost in epoch 44: 0.000021
training accuracy: 1.000000	test accuracy: 0.947053
Average cost in epoch 45: 0.006885
training accuracy: 1.000000	test accuracy: 0.947053
Average cost in epoch 46: 0.002148
training accuracy: 1.000000	test accuracy: 0.945055
Average cost in epoch 47: 0.000407
training accuracy: 1.000000	test accuracy: 0.941059
Average cost in epoch 48: 0.000034
training accuracy: 1.000000	test accuracy: 0.946054
Average cost in epoch 49: 0.000039
training accuracy: 1.000000	test accuracy: 0.943057
Average cost in epoch 50: 0.000010
training accuracy: 1.000000	test accuracy: 0.944056
lr decays to 0.002500
Average cost in epoch 51: 0.000006
training accuracy: 1.000000	test accuracy: 0.944056
Average cost in epoch 52: 0.000005
training accuracy: 1.000000	test accuracy: 0.944056
Average cost in epoch 53: 0.000004
training accuracy: 1.000000	test accuracy: 0.945055
Average cost in epoch 54: 0.000003
training accuracy: 1.000000	test accuracy: 0.947053
Average cost in epoch 55: 0.000002
training accuracy: 1.000000	test accuracy: 0.947053
Average cost in epoch 56: 0.000002
training accuracy: 1.000000	test accuracy: 0.946054
Average cost in epoch 57: 0.000001
training accuracy: 1.000000	test accuracy: 0.950050
Average cost in epoch 58: 0.000001
training accuracy: 1.000000	test accuracy: 0.946054
Average cost in epoch 59: 0.000001
training accuracy: 1.000000	test accuracy: 0.948052
Average cost in epoch 60: 0.000000
training accuracy: 1.000000	test accuracy: 0.948052
Average cost in epoch 61: 0.000000
training accuracy: 1.000000	test accuracy: 0.949051
Average cost in epoch 62: 0.000000
training accuracy: 1.000000	test accuracy: 0.950050
Average cost in epoch 63: 0.000000
training accuracy: 1.000000	test accuracy: 0.954046
Average cost in epoch 64: 0.000000
training accuracy: 1.000000	test accuracy: 0.954046
Average cost in epoch 65: 0.000000
training accuracy: 1.000000	test accuracy: 0.947053
Average cost in epoch 66: 0.000000
training accuracy: 1.000000	test accuracy: 0.951049
Average cost in epoch 67: 0.000000
training accuracy: 1.000000	test accuracy: 0.954046
Average cost in epoch 68: 0.000000
training accuracy: 1.000000	test accuracy: 0.950050
Average cost in epoch 69: 0.000000
training accuracy: 1.000000	test accuracy: 0.955045
Average cost in epoch 70: 0.000000
training accuracy: 1.000000	test accuracy: 0.952048
Average cost in epoch 71: 0.000000
training accuracy: 1.000000	test accuracy: 0.951049
Average cost in epoch 72: 0.000000
training accuracy: 1.000000	test accuracy: 0.953047
Average cost in epoch 73: 0.000000
training accuracy: 1.000000	test accuracy: 0.950050
Average cost in epoch 74: 0.000000
training accuracy: 1.000000	test accuracy: 0.951049
Average cost in epoch 75: 0.000000
training accuracy: 1.000000	test accuracy: 0.952048
lr decays to 0.001250
Average cost in epoch 76: 0.000000
training accuracy: 1.000000	test accuracy: 0.951049
Average cost in epoch 77: 0.000000
training accuracy: 1.000000	test accuracy: 0.951049
Average cost in epoch 78: 0.000000
training accuracy: 1.000000	test accuracy: 0.951049
Average cost in epoch 79: 0.000000
training accuracy: 1.000000	test accuracy: 0.952048
Average cost in epoch 80: 0.000000
training accuracy: 1.000000	test accuracy: 0.952048
Average cost in epoch 81: 0.000000
training accuracy: 1.000000	test accuracy: 0.951049
Average cost in epoch 82: 0.000000
training accuracy: 1.000000	test accuracy: 0.951049
Average cost in epoch 83: 0.000000
training accuracy: 1.000000	test accuracy: 0.951049
Average cost in epoch 84: 0.000000
training accuracy: 1.000000	test accuracy: 0.950050
Average cost in epoch 85: 0.000000
training accuracy: 1.000000	test accuracy: 0.950050
Average cost in epoch 86: 0.000000
training accuracy: 1.000000	test accuracy: 0.950050
Average cost in epoch 87: 0.000000
training accuracy: 1.000000	test accuracy: 0.949051
Average cost in epoch 88: 0.000000
training accuracy: 1.000000	test accuracy: 0.949051
Average cost in epoch 89: 0.000000
training accuracy: 1.000000	test accuracy: 0.949051
Average cost in epoch 90: 0.000000
training accuracy: 1.000000	test accuracy: 0.950050
Average cost in epoch 91: 0.000000
training accuracy: 1.000000	test accuracy: 0.949051
Average cost in epoch 92: 0.000000
training accuracy: 1.000000	test accuracy: 0.949051
Average cost in epoch 93: 0.000000
training accuracy: 1.000000	test accuracy: 0.950050
Average cost in epoch 94: 0.000000
training accuracy: 1.000000	test accuracy: 0.950050
Average cost in epoch 95: 0.000000
training accuracy: 1.000000	test accuracy: 0.949051
Average cost in epoch 96: 0.000000
training accuracy: 1.000000	test accuracy: 0.948052
Average cost in epoch 97: 0.000000
training accuracy: 1.000000	test accuracy: 0.948052
Average cost in epoch 98: 0.000000
training accuracy: 1.000000	test accuracy: 0.948052
Average cost in epoch 99: 0.000000
training accuracy: 1.000000	test accuracy: 0.948052

dump to weights/memn2n/memn2n_11.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 12, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_12.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 2.05
Starting training...
Average cost in epoch 0: 1.910696
training accuracy: 0.500000	test accuracy: 0.277722
Average cost in epoch 1: 1.353002
training accuracy: 0.656250	test accuracy: 0.789211
Average cost in epoch 2: 0.740576
training accuracy: 0.875000	test accuracy: 0.816184
Average cost in epoch 3: 0.289911
training accuracy: 0.968750	test accuracy: 0.950050
Average cost in epoch 4: 0.191706
training accuracy: 0.937500	test accuracy: 0.946054
Average cost in epoch 5: 0.160459
training accuracy: 0.968750	test accuracy: 0.943057
Average cost in epoch 6: 0.077484
training accuracy: 0.843750	test accuracy: 0.903097
Average cost in epoch 7: 0.124763
training accuracy: 1.000000	test accuracy: 0.966034
Average cost in epoch 8: 0.143741
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 9: 0.113460
training accuracy: 1.000000	test accuracy: 0.982018
Average cost in epoch 10: 0.076520
training accuracy: 1.000000	test accuracy: 0.984016
Average cost in epoch 11: 0.136507
training accuracy: 0.968750	test accuracy: 0.960040
Average cost in epoch 12: 0.014904
training accuracy: 1.000000	test accuracy: 0.991009
Average cost in epoch 13: 0.099685
training accuracy: 0.937500	test accuracy: 0.853147
Average cost in epoch 14: 0.113920
training accuracy: 0.968750	test accuracy: 0.958042
Average cost in epoch 15: 0.078410
training accuracy: 0.937500	test accuracy: 0.964036
Average cost in epoch 16: 0.007960
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 17: 0.001276
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 18: 0.000620
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 19: 0.000303
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 20: 0.000146
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 21: 0.000065
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 22: 0.000029
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 23: 0.000014
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 24: 0.000006
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 25: 0.000003
training accuracy: 1.000000	test accuracy: 0.997003
lr decays to 0.005000
Average cost in epoch 26: 0.000001
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 27: 0.000001
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 28: 0.000000
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 29: 0.000000
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 30: 0.000000
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 31: 0.000000
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 32: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 33: 0.032301
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 34: 0.000005
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 35: 0.000024
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 36: 0.000001
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 37: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 38: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 39: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 40: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 41: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 42: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 43: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 44: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 45: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 46: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 47: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 48: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 49: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 50: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
lr decays to 0.002500
Average cost in epoch 51: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 52: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 53: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 54: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 55: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 56: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 57: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 58: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 59: 0.000000
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 60: 0.000000
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 61: 0.000000
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 62: 0.000000
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 63: 0.000000
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 64: 0.000000
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 65: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 66: 0.000000
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 67: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 68: 0.000000
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 69: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 70: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 71: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 72: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 73: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 74: 0.000000
training accuracy: 1.000000	test accuracy: 0.994006
Average cost in epoch 75: 0.002248
training accuracy: 1.000000	test accuracy: 0.995005
lr decays to 0.001250
Average cost in epoch 76: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 77: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 78: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 79: 0.000000
training accuracy: 1.000000	test accuracy: 0.995005
Average cost in epoch 80: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 81: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 82: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 83: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 84: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 85: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 86: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 87: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 88: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 89: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 90: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 91: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 92: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 93: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 94: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 95: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 96: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 97: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 98: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004
Average cost in epoch 99: 0.000000
training accuracy: 1.000000	test accuracy: 0.996004

dump to weights/memn2n/memn2n_12.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 13, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_13.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 2.11
Starting training...
Average cost in epoch 0: 1.588163
training accuracy: 0.875000	test accuracy: 0.945055
Average cost in epoch 1: 0.420625
training accuracy: 0.968750	test accuracy: 0.941059
Average cost in epoch 2: 0.343596
training accuracy: 0.906250	test accuracy: 0.933067
Average cost in epoch 3: 0.303157
training accuracy: 0.968750	test accuracy: 0.926074
Average cost in epoch 4: 0.310072
training accuracy: 0.968750	test accuracy: 0.927073
Average cost in epoch 5: 0.247141
training accuracy: 0.906250	test accuracy: 0.931069
Average cost in epoch 6: 0.259347
training accuracy: 0.906250	test accuracy: 0.922078
Average cost in epoch 7: 0.251018
training accuracy: 1.000000	test accuracy: 0.918082
Average cost in epoch 8: 0.245034
training accuracy: 0.906250	test accuracy: 0.924076
Average cost in epoch 9: 0.200087
training accuracy: 0.937500	test accuracy: 0.902098
Average cost in epoch 10: 0.213405
training accuracy: 0.937500	test accuracy: 0.912088
Average cost in epoch 11: 0.191077
training accuracy: 0.875000	test accuracy: 0.900100
Average cost in epoch 12: 0.174961
training accuracy: 0.906250	test accuracy: 0.891109
Average cost in epoch 13: 0.158534
training accuracy: 0.968750	test accuracy: 0.911089
Average cost in epoch 14: 0.175633
training accuracy: 0.968750	test accuracy: 0.914086
Average cost in epoch 15: 0.165084
training accuracy: 0.906250	test accuracy: 0.904096
Average cost in epoch 16: 0.138622
training accuracy: 1.000000	test accuracy: 0.914086
Average cost in epoch 17: 0.172466
training accuracy: 0.968750	test accuracy: 0.915085
Average cost in epoch 18: 0.109599
training accuracy: 0.937500	test accuracy: 0.913087
Average cost in epoch 19: 0.122073
training accuracy: 0.968750	test accuracy: 0.886114
Average cost in epoch 20: 0.102085
training accuracy: 0.937500	test accuracy: 0.878122
Average cost in epoch 21: 0.142951
training accuracy: 0.968750	test accuracy: 0.891109
Average cost in epoch 22: 0.139628
training accuracy: 1.000000	test accuracy: 0.901099
Average cost in epoch 23: 0.129577
training accuracy: 0.968750	test accuracy: 0.876124
Average cost in epoch 24: 0.111735
training accuracy: 0.937500	test accuracy: 0.893107
Average cost in epoch 25: 0.096599
training accuracy: 0.968750	test accuracy: 0.907093
lr decays to 0.005000
Average cost in epoch 26: 0.075394
training accuracy: 0.968750	test accuracy: 0.899101
Average cost in epoch 27: 0.026533
training accuracy: 0.968750	test accuracy: 0.912088
Average cost in epoch 28: 0.042238
training accuracy: 0.968750	test accuracy: 0.898102
Average cost in epoch 29: 0.042586
training accuracy: 1.000000	test accuracy: 0.885115
Average cost in epoch 30: 0.028699
training accuracy: 0.968750	test accuracy: 0.888112
Average cost in epoch 31: 0.048707
training accuracy: 1.000000	test accuracy: 0.893107
Average cost in epoch 32: 0.027112
training accuracy: 0.968750	test accuracy: 0.892108
Average cost in epoch 33: 0.022856
training accuracy: 1.000000	test accuracy: 0.884116
Average cost in epoch 34: 0.025343
training accuracy: 0.937500	test accuracy: 0.890110
Average cost in epoch 35: 0.026985
training accuracy: 1.000000	test accuracy: 0.893107
Average cost in epoch 36: 0.015822
training accuracy: 1.000000	test accuracy: 0.891109
Average cost in epoch 37: 0.026739
training accuracy: 0.968750	test accuracy: 0.876124
Average cost in epoch 38: 0.018252
training accuracy: 1.000000	test accuracy: 0.881119
Average cost in epoch 39: 0.021924
training accuracy: 0.968750	test accuracy: 0.891109
Average cost in epoch 40: 0.017377
training accuracy: 1.000000	test accuracy: 0.872128
Average cost in epoch 41: 0.017629
training accuracy: 1.000000	test accuracy: 0.888112
Average cost in epoch 42: 0.034822
training accuracy: 0.937500	test accuracy: 0.900100
Average cost in epoch 43: 0.017738
training accuracy: 1.000000	test accuracy: 0.875125
Average cost in epoch 44: 0.045561
training accuracy: 1.000000	test accuracy: 0.875125
Average cost in epoch 45: 0.018720
training accuracy: 1.000000	test accuracy: 0.880120
Average cost in epoch 46: 0.010656
training accuracy: 1.000000	test accuracy: 0.886114
Average cost in epoch 47: 0.012433
training accuracy: 1.000000	test accuracy: 0.888112
Average cost in epoch 48: 0.010657
training accuracy: 1.000000	test accuracy: 0.887113
Average cost in epoch 49: 0.026671
training accuracy: 1.000000	test accuracy: 0.892108
Average cost in epoch 50: 0.007479
training accuracy: 1.000000	test accuracy: 0.884116
lr decays to 0.002500
Average cost in epoch 51: 0.004497
training accuracy: 1.000000	test accuracy: 0.877123
Average cost in epoch 52: 0.003210
training accuracy: 1.000000	test accuracy: 0.878122
Average cost in epoch 53: 0.003820
training accuracy: 1.000000	test accuracy: 0.881119
Average cost in epoch 54: 0.005407
training accuracy: 1.000000	test accuracy: 0.881119
Average cost in epoch 55: 0.002148
training accuracy: 1.000000	test accuracy: 0.881119
Average cost in epoch 56: 0.002841
training accuracy: 1.000000	test accuracy: 0.872128
Average cost in epoch 57: 0.001831
training accuracy: 1.000000	test accuracy: 0.867133
Average cost in epoch 58: 0.001251
training accuracy: 1.000000	test accuracy: 0.882118
Average cost in epoch 59: 0.000837
training accuracy: 1.000000	test accuracy: 0.883117
Average cost in epoch 60: 0.000957
training accuracy: 1.000000	test accuracy: 0.880120
Average cost in epoch 61: 0.001007
training accuracy: 1.000000	test accuracy: 0.870130
Average cost in epoch 62: 0.000540
training accuracy: 1.000000	test accuracy: 0.880120
Average cost in epoch 63: 0.000523
training accuracy: 1.000000	test accuracy: 0.877123
Average cost in epoch 64: 0.002672
training accuracy: 1.000000	test accuracy: 0.886114
Average cost in epoch 65: 0.001337
training accuracy: 1.000000	test accuracy: 0.883117
Average cost in epoch 66: 0.000280
training accuracy: 1.000000	test accuracy: 0.881119
Average cost in epoch 67: 0.000311
training accuracy: 1.000000	test accuracy: 0.880120
Average cost in epoch 68: 0.000220
training accuracy: 1.000000	test accuracy: 0.883117
Average cost in epoch 69: 0.000254
training accuracy: 1.000000	test accuracy: 0.886114
Average cost in epoch 70: 0.000181
training accuracy: 1.000000	test accuracy: 0.887113
Average cost in epoch 71: 0.000212
training accuracy: 1.000000	test accuracy: 0.881119
Average cost in epoch 72: 0.000207
training accuracy: 1.000000	test accuracy: 0.878122
Average cost in epoch 73: 0.000166
training accuracy: 1.000000	test accuracy: 0.878122
Average cost in epoch 74: 0.000099
training accuracy: 1.000000	test accuracy: 0.881119
Average cost in epoch 75: 0.000104
training accuracy: 1.000000	test accuracy: 0.886114
lr decays to 0.001250
Average cost in epoch 76: 0.000248
training accuracy: 1.000000	test accuracy: 0.884116
Average cost in epoch 77: 0.000079
training accuracy: 1.000000	test accuracy: 0.882118
Average cost in epoch 78: 0.000052
training accuracy: 1.000000	test accuracy: 0.884116
Average cost in epoch 79: 0.000038
training accuracy: 1.000000	test accuracy: 0.883117
Average cost in epoch 80: 0.000039
training accuracy: 1.000000	test accuracy: 0.877123
Average cost in epoch 81: 0.000039
training accuracy: 1.000000	test accuracy: 0.882118
Average cost in epoch 82: 0.000031
training accuracy: 1.000000	test accuracy: 0.880120
Average cost in epoch 83: 0.000022
training accuracy: 1.000000	test accuracy: 0.879121
Average cost in epoch 84: 0.000027
training accuracy: 1.000000	test accuracy: 0.883117
Average cost in epoch 85: 0.000015
training accuracy: 1.000000	test accuracy: 0.882118
Average cost in epoch 86: 0.000023
training accuracy: 1.000000	test accuracy: 0.882118
Average cost in epoch 87: 0.000018
training accuracy: 1.000000	test accuracy: 0.879121
Average cost in epoch 88: 0.000011
training accuracy: 1.000000	test accuracy: 0.882118
Average cost in epoch 89: 0.000011
training accuracy: 1.000000	test accuracy: 0.884116
Average cost in epoch 90: 0.000015
training accuracy: 1.000000	test accuracy: 0.880120
Average cost in epoch 91: 0.000007
training accuracy: 1.000000	test accuracy: 0.879121
Average cost in epoch 92: 0.000008
training accuracy: 1.000000	test accuracy: 0.881119
Average cost in epoch 93: 0.000006
training accuracy: 1.000000	test accuracy: 0.882118
Average cost in epoch 94: 0.000006
training accuracy: 1.000000	test accuracy: 0.876124
Average cost in epoch 95: 0.000005
training accuracy: 1.000000	test accuracy: 0.882118
Average cost in epoch 96: 0.000004
training accuracy: 1.000000	test accuracy: 0.885115
Average cost in epoch 97: 0.000004
training accuracy: 1.000000	test accuracy: 0.875125
Average cost in epoch 98: 0.000003
training accuracy: 1.000000	test accuracy: 0.879121
Average cost in epoch 99: 0.000002
training accuracy: 1.000000	test accuracy: 0.881119

dump to weights/memn2n/memn2n_13.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 14, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_14.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 2.12
Starting training...
Average cost in epoch 0: 2.008812
training accuracy: 0.156250	test accuracy: 0.162837
Average cost in epoch 1: 1.739647
training accuracy: 0.375000	test accuracy: 0.239760
Average cost in epoch 2: 1.668772
training accuracy: 0.375000	test accuracy: 0.287712
Average cost in epoch 3: 1.569907
training accuracy: 0.437500	test accuracy: 0.292707
Average cost in epoch 4: 1.455066
training accuracy: 0.593750	test accuracy: 0.442557
Average cost in epoch 5: 1.206743
training accuracy: 0.687500	test accuracy: 0.547453
Average cost in epoch 6: 0.932496
training accuracy: 0.687500	test accuracy: 0.642358
Average cost in epoch 7: 0.774961
training accuracy: 0.750000	test accuracy: 0.658342
Average cost in epoch 8: 0.652667
training accuracy: 0.937500	test accuracy: 0.666334
Average cost in epoch 9: 0.627684
training accuracy: 0.875000	test accuracy: 0.736264
Average cost in epoch 10: 0.549446
training accuracy: 0.937500	test accuracy: 0.709291
Average cost in epoch 11: 0.509578
training accuracy: 0.812500	test accuracy: 0.686314
Average cost in epoch 12: 0.483439
training accuracy: 0.937500	test accuracy: 0.744256
Average cost in epoch 13: 0.431264
training accuracy: 0.843750	test accuracy: 0.724276
Average cost in epoch 14: 0.335537
training accuracy: 0.906250	test accuracy: 0.710290
Average cost in epoch 15: 0.385045
training accuracy: 0.812500	test accuracy: 0.733267
Average cost in epoch 16: 0.336432
training accuracy: 0.906250	test accuracy: 0.725275
Average cost in epoch 17: 0.279688
training accuracy: 0.843750	test accuracy: 0.735265
Average cost in epoch 18: 0.257530
training accuracy: 0.937500	test accuracy: 0.744256
Average cost in epoch 19: 0.289506
training accuracy: 0.875000	test accuracy: 0.727273
Average cost in epoch 20: 0.322219
training accuracy: 0.875000	test accuracy: 0.684316
Average cost in epoch 21: 0.214418
training accuracy: 0.875000	test accuracy: 0.718282
Average cost in epoch 22: 0.299245
training accuracy: 0.937500	test accuracy: 0.724276
Average cost in epoch 23: 0.171924
training accuracy: 0.937500	test accuracy: 0.761239
Average cost in epoch 24: 0.194763
training accuracy: 0.906250	test accuracy: 0.756244
Average cost in epoch 25: 0.148358
training accuracy: 0.968750	test accuracy: 0.762238
lr decays to 0.005000
Average cost in epoch 26: 0.117415
training accuracy: 1.000000	test accuracy: 0.772228
Average cost in epoch 27: 0.078316
training accuracy: 1.000000	test accuracy: 0.773227
Average cost in epoch 28: 0.068521
training accuracy: 0.968750	test accuracy: 0.764236
Average cost in epoch 29: 0.093150
training accuracy: 1.000000	test accuracy: 0.783217
Average cost in epoch 30: 0.038534
training accuracy: 0.937500	test accuracy: 0.764236
Average cost in epoch 31: 0.103763
training accuracy: 0.968750	test accuracy: 0.770230
Average cost in epoch 32: 0.031738
training accuracy: 0.968750	test accuracy: 0.773227
Average cost in epoch 33: 0.078254
training accuracy: 0.968750	test accuracy: 0.765235
Average cost in epoch 34: 0.052053
training accuracy: 0.968750	test accuracy: 0.763237
Average cost in epoch 35: 0.088996
training accuracy: 0.937500	test accuracy: 0.765235
Average cost in epoch 36: 0.042967
training accuracy: 1.000000	test accuracy: 0.772228
Average cost in epoch 37: 0.064613
training accuracy: 1.000000	test accuracy: 0.769231
Average cost in epoch 38: 0.051393
training accuracy: 1.000000	test accuracy: 0.776224
Average cost in epoch 39: 0.049558
training accuracy: 1.000000	test accuracy: 0.779221
Average cost in epoch 40: 0.042531
training accuracy: 0.937500	test accuracy: 0.762238
Average cost in epoch 41: 0.056749
training accuracy: 0.968750	test accuracy: 0.768232
Average cost in epoch 42: 0.029158
training accuracy: 0.937500	test accuracy: 0.770230
Average cost in epoch 43: 0.090067
training accuracy: 1.000000	test accuracy: 0.765235
Average cost in epoch 44: 0.079563
training accuracy: 1.000000	test accuracy: 0.762238
Average cost in epoch 45: 0.031734
training accuracy: 1.000000	test accuracy: 0.764236
Average cost in epoch 46: 0.044533
training accuracy: 1.000000	test accuracy: 0.760240
Average cost in epoch 47: 0.028591
training accuracy: 1.000000	test accuracy: 0.775225
Average cost in epoch 48: 0.026599
training accuracy: 1.000000	test accuracy: 0.781219
Average cost in epoch 49: 0.032851
training accuracy: 0.968750	test accuracy: 0.752248
Average cost in epoch 50: 0.031304
training accuracy: 1.000000	test accuracy: 0.755245
lr decays to 0.002500
Average cost in epoch 51: 0.013890
training accuracy: 1.000000	test accuracy: 0.768232
Average cost in epoch 52: 0.016516
training accuracy: 1.000000	test accuracy: 0.761239
Average cost in epoch 53: 0.006828
training accuracy: 1.000000	test accuracy: 0.765235
Average cost in epoch 54: 0.007299
training accuracy: 1.000000	test accuracy: 0.765235
Average cost in epoch 55: 0.017416
training accuracy: 1.000000	test accuracy: 0.767233
Average cost in epoch 56: 0.003520
training accuracy: 1.000000	test accuracy: 0.768232
Average cost in epoch 57: 0.010732
training accuracy: 1.000000	test accuracy: 0.780220
Average cost in epoch 58: 0.005237
training accuracy: 1.000000	test accuracy: 0.767233
Average cost in epoch 59: 0.007332
training accuracy: 1.000000	test accuracy: 0.774226
Average cost in epoch 60: 0.006819
training accuracy: 1.000000	test accuracy: 0.773227
Average cost in epoch 61: 0.005706
training accuracy: 1.000000	test accuracy: 0.774226
Average cost in epoch 62: 0.004432
training accuracy: 1.000000	test accuracy: 0.773227
Average cost in epoch 63: 0.007890
training accuracy: 1.000000	test accuracy: 0.772228
Average cost in epoch 64: 0.001436
training accuracy: 1.000000	test accuracy: 0.775225
Average cost in epoch 65: 0.011196
training accuracy: 1.000000	test accuracy: 0.775225
Average cost in epoch 66: 0.004177
training accuracy: 1.000000	test accuracy: 0.783217
Average cost in epoch 67: 0.001399
training accuracy: 1.000000	test accuracy: 0.777223
Average cost in epoch 68: 0.001066
training accuracy: 1.000000	test accuracy: 0.774226
Average cost in epoch 69: 0.000822
training accuracy: 1.000000	test accuracy: 0.769231
Average cost in epoch 70: 0.011225
training accuracy: 1.000000	test accuracy: 0.786214
Average cost in epoch 71: 0.004074
training accuracy: 1.000000	test accuracy: 0.783217
Average cost in epoch 72: 0.001850
training accuracy: 1.000000	test accuracy: 0.782218
Average cost in epoch 73: 0.000866
training accuracy: 1.000000	test accuracy: 0.782218
Average cost in epoch 74: 0.000535
training accuracy: 1.000000	test accuracy: 0.781219
Average cost in epoch 75: 0.000664
training accuracy: 1.000000	test accuracy: 0.782218
lr decays to 0.001250
Average cost in epoch 76: 0.000422
training accuracy: 1.000000	test accuracy: 0.783217
Average cost in epoch 77: 0.000260
training accuracy: 1.000000	test accuracy: 0.783217
Average cost in epoch 78: 0.000392
training accuracy: 1.000000	test accuracy: 0.782218
Average cost in epoch 79: 0.000295
training accuracy: 1.000000	test accuracy: 0.780220
Average cost in epoch 80: 0.000264
training accuracy: 1.000000	test accuracy: 0.786214
Average cost in epoch 81: 0.000141
training accuracy: 1.000000	test accuracy: 0.786214
Average cost in epoch 82: 0.000151
training accuracy: 1.000000	test accuracy: 0.788212
Average cost in epoch 83: 0.000112
training accuracy: 1.000000	test accuracy: 0.789211
Average cost in epoch 84: 0.000566
training accuracy: 1.000000	test accuracy: 0.789211
Average cost in epoch 85: 0.000094
training accuracy: 1.000000	test accuracy: 0.793207
Average cost in epoch 86: 0.000062
training accuracy: 1.000000	test accuracy: 0.793207
Average cost in epoch 87: 0.000057
training accuracy: 1.000000	test accuracy: 0.793207
Average cost in epoch 88: 0.000050
training accuracy: 1.000000	test accuracy: 0.789211
Average cost in epoch 89: 0.000051
training accuracy: 1.000000	test accuracy: 0.785215
Average cost in epoch 90: 0.000040
training accuracy: 1.000000	test accuracy: 0.789211
Average cost in epoch 91: 0.000039
training accuracy: 1.000000	test accuracy: 0.788212
Average cost in epoch 92: 0.000033
training accuracy: 1.000000	test accuracy: 0.787213
Average cost in epoch 93: 0.000028
training accuracy: 1.000000	test accuracy: 0.798202
Average cost in epoch 94: 0.000150
training accuracy: 1.000000	test accuracy: 0.791209
Average cost in epoch 95: 0.000021
training accuracy: 1.000000	test accuracy: 0.788212
Average cost in epoch 96: 0.000017
training accuracy: 1.000000	test accuracy: 0.792208
Average cost in epoch 97: 0.000016
training accuracy: 1.000000	test accuracy: 0.793207
Average cost in epoch 98: 0.000011
training accuracy: 1.000000	test accuracy: 0.793207
Average cost in epoch 99: 0.000013
training accuracy: 1.000000	test accuracy: 0.795205

dump to weights/memn2n/memn2n_14.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 15, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_15.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 2.10
Starting training...
Average cost in epoch 0: 1.587771
training accuracy: 0.250000	test accuracy: 0.260739
Average cost in epoch 1: 1.299891
training accuracy: 0.375000	test accuracy: 0.410589
Average cost in epoch 2: 1.173201
training accuracy: 0.656250	test accuracy: 0.455544
Average cost in epoch 3: 1.124384
training accuracy: 0.718750	test accuracy: 0.499500
Average cost in epoch 4: 1.007331
training accuracy: 0.593750	test accuracy: 0.621379
Average cost in epoch 5: 0.573956
training accuracy: 0.937500	test accuracy: 0.936064
Average cost in epoch 6: 0.045208
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 7: 0.004350
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 8: 0.001885
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 9: 0.000491
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 10: 0.000207
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 11: 0.000085
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 12: 0.000037
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 13: 0.000016
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 14: 0.000007
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 15: 0.000003
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 16: 0.000001
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 17: 0.000001
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 18: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 19: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 20: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 21: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 22: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 23: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 24: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 25: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
lr decays to 0.005000
Average cost in epoch 26: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 27: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 28: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 29: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 30: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 31: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 32: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 33: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 34: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 35: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 36: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 37: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 38: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 39: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 40: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 41: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 42: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 43: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 44: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 45: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 46: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 47: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 48: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 49: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 50: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
lr decays to 0.002500
Average cost in epoch 51: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 52: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 53: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 54: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 55: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 56: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 57: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 58: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 59: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 60: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 61: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 62: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 63: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 64: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 65: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 66: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 67: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 68: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 69: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 70: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 71: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 72: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 73: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 74: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 75: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
lr decays to 0.001250
Average cost in epoch 76: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 77: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 78: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 79: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 80: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 81: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 82: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 83: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 84: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 85: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 86: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 87: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 88: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 89: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 90: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 91: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 92: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 93: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 94: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 95: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 96: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 97: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 98: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 99: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000

dump to weights/memn2n/memn2n_15.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 16, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_16.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 2.12
Starting training...
Average cost in epoch 0: 1.494641
training accuracy: 0.406250	test accuracy: 0.351648
Average cost in epoch 1: 1.226894
training accuracy: 0.468750	test accuracy: 0.477522
Average cost in epoch 2: 1.152892
training accuracy: 0.437500	test accuracy: 0.490509
Average cost in epoch 3: 1.103356
training accuracy: 0.437500	test accuracy: 0.446553
Average cost in epoch 4: 1.068820
training accuracy: 0.406250	test accuracy: 0.482517
Average cost in epoch 5: 1.048278
training accuracy: 0.406250	test accuracy: 0.481518
Average cost in epoch 6: 1.002918
training accuracy: 0.656250	test accuracy: 0.466533
Average cost in epoch 7: 0.997604
training accuracy: 0.562500	test accuracy: 0.460539
Average cost in epoch 8: 0.951726
training accuracy: 0.625000	test accuracy: 0.467532
Average cost in epoch 9: 0.911723
training accuracy: 0.531250	test accuracy: 0.464535
Average cost in epoch 10: 0.940865
training accuracy: 0.593750	test accuracy: 0.459540
Average cost in epoch 11: 0.873252
training accuracy: 0.562500	test accuracy: 0.471528
Average cost in epoch 12: 0.904307
training accuracy: 0.562500	test accuracy: 0.466533
Average cost in epoch 13: 0.859827
training accuracy: 0.531250	test accuracy: 0.458541
Average cost in epoch 14: 0.864846
training accuracy: 0.843750	test accuracy: 0.445554
Average cost in epoch 15: 0.840943
training accuracy: 0.500000	test accuracy: 0.434565
Average cost in epoch 16: 0.781913
training accuracy: 0.750000	test accuracy: 0.458541
Average cost in epoch 17: 0.825362
training accuracy: 0.656250	test accuracy: 0.463536
Average cost in epoch 18: 0.762267
training accuracy: 0.593750	test accuracy: 0.451548
Average cost in epoch 19: 0.768953
training accuracy: 0.718750	test accuracy: 0.451548
Average cost in epoch 20: 0.784655
training accuracy: 0.625000	test accuracy: 0.444555
Average cost in epoch 21: 0.759990
training accuracy: 0.593750	test accuracy: 0.442557
Average cost in epoch 22: 0.706630
training accuracy: 0.531250	test accuracy: 0.442557
Average cost in epoch 23: 0.749958
training accuracy: 0.656250	test accuracy: 0.450549
Average cost in epoch 24: 0.723324
training accuracy: 0.625000	test accuracy: 0.473526
Average cost in epoch 25: 0.693342
training accuracy: 0.781250	test accuracy: 0.456543
lr decays to 0.005000
Average cost in epoch 26: 0.641391
training accuracy: 0.718750	test accuracy: 0.469530
Average cost in epoch 27: 0.566267
training accuracy: 0.625000	test accuracy: 0.455544
Average cost in epoch 28: 0.572331
training accuracy: 0.687500	test accuracy: 0.441558
Average cost in epoch 29: 0.556577
training accuracy: 0.781250	test accuracy: 0.434565
Average cost in epoch 30: 0.537586
training accuracy: 0.781250	test accuracy: 0.443556
Average cost in epoch 31: 0.532719
training accuracy: 0.687500	test accuracy: 0.440559
Average cost in epoch 32: 0.507548
training accuracy: 0.812500	test accuracy: 0.433566
Average cost in epoch 33: 0.503769
training accuracy: 0.687500	test accuracy: 0.449550
Average cost in epoch 34: 0.513150
training accuracy: 0.687500	test accuracy: 0.447552
Average cost in epoch 35: 0.480154
training accuracy: 0.843750	test accuracy: 0.450549
Average cost in epoch 36: 0.475450
training accuracy: 0.937500	test accuracy: 0.444555
Average cost in epoch 37: 0.478088
training accuracy: 0.718750	test accuracy: 0.440559
Average cost in epoch 38: 0.481816
training accuracy: 0.843750	test accuracy: 0.442557
Average cost in epoch 39: 0.452038
training accuracy: 0.718750	test accuracy: 0.455544
Average cost in epoch 40: 0.445686
training accuracy: 0.812500	test accuracy: 0.448551
Average cost in epoch 41: 0.449142
training accuracy: 0.875000	test accuracy: 0.444555
Average cost in epoch 42: 0.427806
training accuracy: 0.812500	test accuracy: 0.466533
Average cost in epoch 43: 0.455460
training accuracy: 0.812500	test accuracy: 0.462537
Average cost in epoch 44: 0.448253
training accuracy: 0.781250	test accuracy: 0.444555
Average cost in epoch 45: 0.414339
training accuracy: 0.875000	test accuracy: 0.445554
Average cost in epoch 46: 0.409047
training accuracy: 0.843750	test accuracy: 0.450549
Average cost in epoch 47: 0.408159
training accuracy: 0.812500	test accuracy: 0.454545
Average cost in epoch 48: 0.405373
training accuracy: 0.781250	test accuracy: 0.427572
Average cost in epoch 49: 0.398573
training accuracy: 0.843750	test accuracy: 0.449550
Average cost in epoch 50: 0.432215
training accuracy: 0.875000	test accuracy: 0.446553
lr decays to 0.002500
Average cost in epoch 51: 0.331815
training accuracy: 0.906250	test accuracy: 0.444555
Average cost in epoch 52: 0.315319
training accuracy: 0.875000	test accuracy: 0.445554
Average cost in epoch 53: 0.319002
training accuracy: 0.906250	test accuracy: 0.446553
Average cost in epoch 54: 0.309692
training accuracy: 0.843750	test accuracy: 0.461538
Average cost in epoch 55: 0.316678
training accuracy: 0.906250	test accuracy: 0.436563
Average cost in epoch 56: 0.304131
training accuracy: 0.875000	test accuracy: 0.450549
Average cost in epoch 57: 0.281541
training accuracy: 0.875000	test accuracy: 0.445554
Average cost in epoch 58: 0.286766
training accuracy: 0.875000	test accuracy: 0.439560
Average cost in epoch 59: 0.291901
training accuracy: 0.843750	test accuracy: 0.440559
Average cost in epoch 60: 0.293834
training accuracy: 0.781250	test accuracy: 0.447552
Average cost in epoch 61: 0.285805
training accuracy: 0.906250	test accuracy: 0.441558
Average cost in epoch 62: 0.252006
training accuracy: 0.875000	test accuracy: 0.449550
Average cost in epoch 63: 0.276380
training accuracy: 0.937500	test accuracy: 0.452547
Average cost in epoch 64: 0.254225
training accuracy: 0.875000	test accuracy: 0.443556
Average cost in epoch 65: 0.272629
training accuracy: 0.812500	test accuracy: 0.448551
Average cost in epoch 66: 0.245741
training accuracy: 0.937500	test accuracy: 0.453546
Average cost in epoch 67: 0.265626
training accuracy: 0.843750	test accuracy: 0.450549
Average cost in epoch 68: 0.251152
training accuracy: 0.843750	test accuracy: 0.449550
Average cost in epoch 69: 0.251935
training accuracy: 0.812500	test accuracy: 0.448551
Average cost in epoch 70: 0.243176
training accuracy: 0.906250	test accuracy: 0.446553
Average cost in epoch 71: 0.251104
training accuracy: 0.937500	test accuracy: 0.439560
Average cost in epoch 72: 0.219613
training accuracy: 0.843750	test accuracy: 0.455544
Average cost in epoch 73: 0.254029
training accuracy: 0.906250	test accuracy: 0.441558
Average cost in epoch 74: 0.229439
training accuracy: 0.937500	test accuracy: 0.451548
Average cost in epoch 75: 0.229292
training accuracy: 0.750000	test accuracy: 0.446553
lr decays to 0.001250
Average cost in epoch 76: 0.196225
training accuracy: 0.843750	test accuracy: 0.442557
Average cost in epoch 77: 0.179572
training accuracy: 0.875000	test accuracy: 0.447552
Average cost in epoch 78: 0.187748
training accuracy: 0.875000	test accuracy: 0.444555
Average cost in epoch 79: 0.196381
training accuracy: 0.968750	test accuracy: 0.453546
Average cost in epoch 80: 0.191758
training accuracy: 0.968750	test accuracy: 0.448551
Average cost in epoch 81: 0.177513
training accuracy: 0.875000	test accuracy: 0.443556
Average cost in epoch 82: 0.183992
training accuracy: 0.875000	test accuracy: 0.445554
Average cost in epoch 83: 0.175761
training accuracy: 0.968750	test accuracy: 0.442557
Average cost in epoch 84: 0.183105
training accuracy: 0.875000	test accuracy: 0.437562
Average cost in epoch 85: 0.170319
training accuracy: 0.875000	test accuracy: 0.444555
Average cost in epoch 86: 0.174111
training accuracy: 1.000000	test accuracy: 0.438561
Average cost in epoch 87: 0.171779
training accuracy: 0.875000	test accuracy: 0.436563
Average cost in epoch 88: 0.171130
training accuracy: 0.937500	test accuracy: 0.441558
Average cost in epoch 89: 0.165747
training accuracy: 0.968750	test accuracy: 0.437562
Average cost in epoch 90: 0.176888
training accuracy: 0.968750	test accuracy: 0.440559
Average cost in epoch 91: 0.162806
training accuracy: 0.937500	test accuracy: 0.446553
Average cost in epoch 92: 0.163256
training accuracy: 0.937500	test accuracy: 0.441558
Average cost in epoch 93: 0.159288
training accuracy: 1.000000	test accuracy: 0.439560
Average cost in epoch 94: 0.159920
training accuracy: 0.906250	test accuracy: 0.444555
Average cost in epoch 95: 0.159982
training accuracy: 0.968750	test accuracy: 0.443556
Average cost in epoch 96: 0.150058
training accuracy: 0.968750	test accuracy: 0.441558
Average cost in epoch 97: 0.163020
training accuracy: 0.843750	test accuracy: 0.437562
Average cost in epoch 98: 0.137443
training accuracy: 1.000000	test accuracy: 0.430569
Average cost in epoch 99: 0.163107
training accuracy: 1.000000	test accuracy: 0.440559

dump to weights/memn2n/memn2n_16.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 17, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_17.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 2.11
Starting training...
Average cost in epoch 0: 0.928570
training accuracy: 0.625000	test accuracy: 0.479520
Average cost in epoch 1: 0.710707
training accuracy: 0.406250	test accuracy: 0.520480
Average cost in epoch 2: 0.727186
training accuracy: 0.500000	test accuracy: 0.520480
Average cost in epoch 3: 0.715359
training accuracy: 0.531250	test accuracy: 0.479520
Average cost in epoch 4: 0.701483
training accuracy: 0.468750	test accuracy: 0.516484
Average cost in epoch 5: 0.704477
training accuracy: 0.500000	test accuracy: 0.520480
Average cost in epoch 6: 0.683443
training accuracy: 0.562500	test accuracy: 0.548452
Average cost in epoch 7: 0.677207
training accuracy: 0.593750	test accuracy: 0.488511
Average cost in epoch 8: 0.661701
training accuracy: 0.750000	test accuracy: 0.551449
Average cost in epoch 9: 0.658266
training accuracy: 0.625000	test accuracy: 0.557443
Average cost in epoch 10: 0.644284
training accuracy: 0.625000	test accuracy: 0.576424
Average cost in epoch 11: 0.648601
training accuracy: 0.625000	test accuracy: 0.580420
Average cost in epoch 12: 0.622692
training accuracy: 0.593750	test accuracy: 0.591409
Average cost in epoch 13: 0.628898
training accuracy: 0.718750	test accuracy: 0.567433
Average cost in epoch 14: 0.629596
training accuracy: 0.593750	test accuracy: 0.590410
Average cost in epoch 15: 0.623607
training accuracy: 0.687500	test accuracy: 0.558442
Average cost in epoch 16: 0.608764
training accuracy: 0.687500	test accuracy: 0.581419
Average cost in epoch 17: 0.605362
training accuracy: 0.718750	test accuracy: 0.586414
Average cost in epoch 18: 0.618312
training accuracy: 0.781250	test accuracy: 0.569431
Average cost in epoch 19: 0.588573
training accuracy: 0.593750	test accuracy: 0.586414
Average cost in epoch 20: 0.596886
training accuracy: 0.687500	test accuracy: 0.575425
Average cost in epoch 21: 0.584155
training accuracy: 0.687500	test accuracy: 0.590410
Average cost in epoch 22: 0.602224
training accuracy: 0.593750	test accuracy: 0.584416
Average cost in epoch 23: 0.587305
training accuracy: 0.750000	test accuracy: 0.578422
Average cost in epoch 24: 0.606635
training accuracy: 0.750000	test accuracy: 0.564436
Average cost in epoch 25: 0.607936
training accuracy: 0.593750	test accuracy: 0.580420
lr decays to 0.005000
Average cost in epoch 26: 0.558388
training accuracy: 0.781250	test accuracy: 0.582418
Average cost in epoch 27: 0.581778
training accuracy: 0.593750	test accuracy: 0.585415
Average cost in epoch 28: 0.543203
training accuracy: 0.625000	test accuracy: 0.573427
Average cost in epoch 29: 0.575187
training accuracy: 0.750000	test accuracy: 0.569431
Average cost in epoch 30: 0.551910
training accuracy: 0.687500	test accuracy: 0.568432
Average cost in epoch 31: 0.553106
training accuracy: 0.687500	test accuracy: 0.570430
Average cost in epoch 32: 0.542166
training accuracy: 0.687500	test accuracy: 0.585415
Average cost in epoch 33: 0.535614
training accuracy: 0.593750	test accuracy: 0.563437
Average cost in epoch 34: 0.556234
training accuracy: 0.750000	test accuracy: 0.566434
Average cost in epoch 35: 0.545433
training accuracy: 0.687500	test accuracy: 0.555445
Average cost in epoch 36: 0.536008
training accuracy: 0.562500	test accuracy: 0.555445
Average cost in epoch 37: 0.555203
training accuracy: 0.718750	test accuracy: 0.543457
Average cost in epoch 38: 0.544901
training accuracy: 0.781250	test accuracy: 0.564436
Average cost in epoch 39: 0.541093
training accuracy: 0.687500	test accuracy: 0.561439
Average cost in epoch 40: 0.540190
training accuracy: 0.750000	test accuracy: 0.561439
Average cost in epoch 41: 0.540517
training accuracy: 0.812500	test accuracy: 0.559441
Average cost in epoch 42: 0.534683
training accuracy: 0.718750	test accuracy: 0.560440
Average cost in epoch 43: 0.535539
training accuracy: 0.656250	test accuracy: 0.555445
Average cost in epoch 44: 0.527287
training accuracy: 0.625000	test accuracy: 0.576424
Average cost in epoch 45: 0.532596
training accuracy: 0.656250	test accuracy: 0.551449
Average cost in epoch 46: 0.523781
training accuracy: 0.843750	test accuracy: 0.550450
Average cost in epoch 47: 0.535673
training accuracy: 0.750000	test accuracy: 0.556444
Average cost in epoch 48: 0.511095
training accuracy: 0.906250	test accuracy: 0.558442
Average cost in epoch 49: 0.521987
training accuracy: 0.812500	test accuracy: 0.568432
Average cost in epoch 50: 0.514800
training accuracy: 0.812500	test accuracy: 0.547453
lr decays to 0.002500
Average cost in epoch 51: 0.498382
training accuracy: 0.750000	test accuracy: 0.551449
Average cost in epoch 52: 0.490084
training accuracy: 0.750000	test accuracy: 0.545455
Average cost in epoch 53: 0.490079
training accuracy: 0.687500	test accuracy: 0.547453
Average cost in epoch 54: 0.479507
training accuracy: 0.843750	test accuracy: 0.541459
Average cost in epoch 55: 0.472632
training accuracy: 0.812500	test accuracy: 0.559441
Average cost in epoch 56: 0.504082
training accuracy: 0.781250	test accuracy: 0.549451
Average cost in epoch 57: 0.466070
training accuracy: 0.812500	test accuracy: 0.551449
Average cost in epoch 58: 0.485830
training accuracy: 0.687500	test accuracy: 0.536464
Average cost in epoch 59: 0.462461
training accuracy: 0.781250	test accuracy: 0.559441
Average cost in epoch 60: 0.461046
training accuracy: 0.781250	test accuracy: 0.547453
Average cost in epoch 61: 0.507127
training accuracy: 0.718750	test accuracy: 0.546454
Average cost in epoch 62: 0.459042
training accuracy: 0.625000	test accuracy: 0.546454
Average cost in epoch 63: 0.471429
training accuracy: 0.781250	test accuracy: 0.534466
Average cost in epoch 64: 0.476048
training accuracy: 0.843750	test accuracy: 0.548452
Average cost in epoch 65: 0.471328
training accuracy: 0.718750	test accuracy: 0.542458
Average cost in epoch 66: 0.464377
training accuracy: 0.718750	test accuracy: 0.540460
Average cost in epoch 67: 0.461709
training accuracy: 0.781250	test accuracy: 0.544456
Average cost in epoch 68: 0.455541
training accuracy: 0.937500	test accuracy: 0.546454
Average cost in epoch 69: 0.466733
training accuracy: 0.687500	test accuracy: 0.544456
Average cost in epoch 70: 0.453898
training accuracy: 0.656250	test accuracy: 0.533467
Average cost in epoch 71: 0.471302
training accuracy: 0.750000	test accuracy: 0.542458
Average cost in epoch 72: 0.463086
training accuracy: 0.750000	test accuracy: 0.544456
Average cost in epoch 73: 0.438530
training accuracy: 0.531250	test accuracy: 0.537463
Average cost in epoch 74: 0.466678
training accuracy: 0.718750	test accuracy: 0.544456
Average cost in epoch 75: 0.445870
training accuracy: 0.656250	test accuracy: 0.548452
lr decays to 0.001250
Average cost in epoch 76: 0.448460
training accuracy: 0.906250	test accuracy: 0.536464
Average cost in epoch 77: 0.437645
training accuracy: 0.812500	test accuracy: 0.532468
Average cost in epoch 78: 0.446260
training accuracy: 0.687500	test accuracy: 0.535465
Average cost in epoch 79: 0.423350
training accuracy: 0.718750	test accuracy: 0.531469
Average cost in epoch 80: 0.447755
training accuracy: 0.625000	test accuracy: 0.534466
Average cost in epoch 81: 0.417163
training accuracy: 0.906250	test accuracy: 0.546454
Average cost in epoch 82: 0.440406
training accuracy: 0.718750	test accuracy: 0.534466
Average cost in epoch 83: 0.428916
training accuracy: 0.812500	test accuracy: 0.536464
Average cost in epoch 84: 0.432134
training accuracy: 0.718750	test accuracy: 0.542458
Average cost in epoch 85: 0.430279
training accuracy: 0.718750	test accuracy: 0.537463
Average cost in epoch 86: 0.433147
training accuracy: 0.718750	test accuracy: 0.533467
Average cost in epoch 87: 0.429471
training accuracy: 0.843750	test accuracy: 0.546454
Average cost in epoch 88: 0.429224
training accuracy: 0.843750	test accuracy: 0.531469
Average cost in epoch 89: 0.428291
training accuracy: 0.812500	test accuracy: 0.532468
Average cost in epoch 90: 0.428743
training accuracy: 0.843750	test accuracy: 0.544456
Average cost in epoch 91: 0.438051
training accuracy: 0.562500	test accuracy: 0.539461
Average cost in epoch 92: 0.420773
training accuracy: 0.656250	test accuracy: 0.540460
Average cost in epoch 93: 0.415934
training accuracy: 0.750000	test accuracy: 0.544456
Average cost in epoch 94: 0.425499
training accuracy: 0.718750	test accuracy: 0.543457
Average cost in epoch 95: 0.427055
training accuracy: 0.687500	test accuracy: 0.542458
Average cost in epoch 96: 0.420106
training accuracy: 0.781250	test accuracy: 0.532468
Average cost in epoch 97: 0.433832
training accuracy: 0.750000	test accuracy: 0.537463
Average cost in epoch 98: 0.415308
training accuracy: 0.875000	test accuracy: 0.538462
Average cost in epoch 99: 0.412199
training accuracy: 0.781250	test accuracy: 0.536464

dump to weights/memn2n/memn2n_17.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 18, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_18.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 2.10
Starting training...
Average cost in epoch 0: 1.002456
training accuracy: 0.343750	test accuracy: 0.483516
Average cost in epoch 1: 0.717201
training accuracy: 0.593750	test accuracy: 0.532468
Average cost in epoch 2: 0.715827
training accuracy: 0.562500	test accuracy: 0.504496
Average cost in epoch 3: 0.695975
training accuracy: 0.437500	test accuracy: 0.478521
Average cost in epoch 4: 0.685848
training accuracy: 0.468750	test accuracy: 0.521479
Average cost in epoch 5: 0.682297
training accuracy: 0.500000	test accuracy: 0.523477
Average cost in epoch 6: 0.667200
training accuracy: 0.656250	test accuracy: 0.512488
Average cost in epoch 7: 0.673775
training accuracy: 0.562500	test accuracy: 0.547453
Average cost in epoch 8: 0.662701
training accuracy: 0.625000	test accuracy: 0.523477
Average cost in epoch 9: 0.652977
training accuracy: 0.656250	test accuracy: 0.529471
Average cost in epoch 10: 0.640846
training accuracy: 0.562500	test accuracy: 0.533467
Average cost in epoch 11: 0.621920
training accuracy: 0.718750	test accuracy: 0.550450
Average cost in epoch 12: 0.644590
training accuracy: 0.625000	test accuracy: 0.543457
Average cost in epoch 13: 0.611065
training accuracy: 0.781250	test accuracy: 0.564436
Average cost in epoch 14: 0.615194
training accuracy: 0.781250	test accuracy: 0.542458
Average cost in epoch 15: 0.583085
training accuracy: 0.656250	test accuracy: 0.527473
Average cost in epoch 16: 0.576985
training accuracy: 0.562500	test accuracy: 0.527473
Average cost in epoch 17: 0.577077
training accuracy: 0.625000	test accuracy: 0.536464
Average cost in epoch 18: 0.586821
training accuracy: 0.625000	test accuracy: 0.541459
Average cost in epoch 19: 0.563492
training accuracy: 0.531250	test accuracy: 0.526474
Average cost in epoch 20: 0.544979
training accuracy: 0.625000	test accuracy: 0.556444
Average cost in epoch 21: 0.568739
training accuracy: 0.718750	test accuracy: 0.534466
Average cost in epoch 22: 0.564649
training accuracy: 0.812500	test accuracy: 0.519481
Average cost in epoch 23: 0.577516
training accuracy: 0.781250	test accuracy: 0.519481
Average cost in epoch 24: 0.550081
training accuracy: 0.718750	test accuracy: 0.537463
Average cost in epoch 25: 0.569797
training accuracy: 0.781250	test accuracy: 0.531469
lr decays to 0.005000
Average cost in epoch 26: 0.496543
training accuracy: 0.718750	test accuracy: 0.536464
Average cost in epoch 27: 0.499889
training accuracy: 0.593750	test accuracy: 0.540460
Average cost in epoch 28: 0.479109
training accuracy: 0.781250	test accuracy: 0.543457
Average cost in epoch 29: 0.496963
training accuracy: 0.593750	test accuracy: 0.513487
Average cost in epoch 30: 0.475818
training accuracy: 0.781250	test accuracy: 0.530470
Average cost in epoch 31: 0.488203
training accuracy: 0.687500	test accuracy: 0.545455
Average cost in epoch 32: 0.485478
training accuracy: 0.812500	test accuracy: 0.534466
Average cost in epoch 33: 0.471312
training accuracy: 0.781250	test accuracy: 0.542458
Average cost in epoch 34: 0.478553
training accuracy: 0.718750	test accuracy: 0.535465
Average cost in epoch 35: 0.471233
training accuracy: 0.875000	test accuracy: 0.508492
Average cost in epoch 36: 0.460505
training accuracy: 0.718750	test accuracy: 0.524476
Average cost in epoch 37: 0.451229
training accuracy: 0.843750	test accuracy: 0.532468
Average cost in epoch 38: 0.467230
training accuracy: 0.750000	test accuracy: 0.524476
Average cost in epoch 39: 0.461098
training accuracy: 0.781250	test accuracy: 0.528472
Average cost in epoch 40: 0.459829
training accuracy: 0.750000	test accuracy: 0.501499
Average cost in epoch 41: 0.456670
training accuracy: 0.593750	test accuracy: 0.519481
Average cost in epoch 42: 0.455552
training accuracy: 0.781250	test accuracy: 0.512488
Average cost in epoch 43: 0.444430
training accuracy: 0.750000	test accuracy: 0.492507
Average cost in epoch 44: 0.449733
training accuracy: 0.781250	test accuracy: 0.517483
Average cost in epoch 45: 0.432782
training accuracy: 0.875000	test accuracy: 0.524476
Average cost in epoch 46: 0.443452
training accuracy: 0.750000	test accuracy: 0.524476
Average cost in epoch 47: 0.439699
training accuracy: 0.937500	test accuracy: 0.514486
Average cost in epoch 48: 0.454731
training accuracy: 0.781250	test accuracy: 0.521479
Average cost in epoch 49: 0.441880
training accuracy: 0.718750	test accuracy: 0.504496
Average cost in epoch 50: 0.419120
training accuracy: 0.812500	test accuracy: 0.518482
lr decays to 0.002500
Average cost in epoch 51: 0.423783
training accuracy: 0.843750	test accuracy: 0.536464
Average cost in epoch 52: 0.403170
training accuracy: 0.906250	test accuracy: 0.539461
Average cost in epoch 53: 0.401079
training accuracy: 0.750000	test accuracy: 0.516484
Average cost in epoch 54: 0.397117
training accuracy: 0.781250	test accuracy: 0.539461
Average cost in epoch 55: 0.401584
training accuracy: 0.781250	test accuracy: 0.526474
Average cost in epoch 56: 0.387135
training accuracy: 0.750000	test accuracy: 0.512488
Average cost in epoch 57: 0.382285
training accuracy: 0.750000	test accuracy: 0.515485
Average cost in epoch 58: 0.413112
training accuracy: 0.875000	test accuracy: 0.528472
Average cost in epoch 59: 0.391114
training accuracy: 0.843750	test accuracy: 0.518482
Average cost in epoch 60: 0.389401
training accuracy: 0.750000	test accuracy: 0.532468
Average cost in epoch 61: 0.387963
training accuracy: 0.812500	test accuracy: 0.516484
Average cost in epoch 62: 0.401293
training accuracy: 0.781250	test accuracy: 0.520480
Average cost in epoch 63: 0.377627
training accuracy: 0.906250	test accuracy: 0.517483
Average cost in epoch 64: 0.382734
training accuracy: 0.812500	test accuracy: 0.523477
Average cost in epoch 65: 0.387528
training accuracy: 0.812500	test accuracy: 0.511489
Average cost in epoch 66: 0.392487
training accuracy: 0.750000	test accuracy: 0.533467
Average cost in epoch 67: 0.381348
training accuracy: 0.906250	test accuracy: 0.522478
Average cost in epoch 68: 0.389896
training accuracy: 0.812500	test accuracy: 0.514486
Average cost in epoch 69: 0.364258
training accuracy: 0.718750	test accuracy: 0.523477
Average cost in epoch 70: 0.388526
training accuracy: 0.875000	test accuracy: 0.518482
Average cost in epoch 71: 0.377745
training accuracy: 0.781250	test accuracy: 0.517483
Average cost in epoch 72: 0.374656
training accuracy: 0.812500	test accuracy: 0.533467
Average cost in epoch 73: 0.387074
training accuracy: 0.781250	test accuracy: 0.523477
Average cost in epoch 74: 0.376197
training accuracy: 0.875000	test accuracy: 0.508492
Average cost in epoch 75: 0.385041
training accuracy: 0.750000	test accuracy: 0.511489
lr decays to 0.001250
Average cost in epoch 76: 0.348081
training accuracy: 0.843750	test accuracy: 0.506494
Average cost in epoch 77: 0.357326
training accuracy: 0.718750	test accuracy: 0.512488
Average cost in epoch 78: 0.351010
training accuracy: 0.656250	test accuracy: 0.519481
Average cost in epoch 79: 0.355209
training accuracy: 0.718750	test accuracy: 0.509491
Average cost in epoch 80: 0.355542
training accuracy: 0.750000	test accuracy: 0.500500
Average cost in epoch 81: 0.354437
training accuracy: 0.906250	test accuracy: 0.523477
Average cost in epoch 82: 0.352479
training accuracy: 0.906250	test accuracy: 0.502498
Average cost in epoch 83: 0.359328
training accuracy: 0.750000	test accuracy: 0.505495
Average cost in epoch 84: 0.346331
training accuracy: 0.812500	test accuracy: 0.506494
Average cost in epoch 85: 0.360285
training accuracy: 0.781250	test accuracy: 0.514486
Average cost in epoch 86: 0.351607
training accuracy: 0.937500	test accuracy: 0.512488
Average cost in epoch 87: 0.356940
training accuracy: 0.875000	test accuracy: 0.513487
Average cost in epoch 88: 0.348638
training accuracy: 0.781250	test accuracy: 0.505495
Average cost in epoch 89: 0.352553
training accuracy: 1.000000	test accuracy: 0.521479
Average cost in epoch 90: 0.355933
training accuracy: 0.781250	test accuracy: 0.510490
Average cost in epoch 91: 0.349223
training accuracy: 0.906250	test accuracy: 0.504496
Average cost in epoch 92: 0.348318
training accuracy: 0.750000	test accuracy: 0.507493
Average cost in epoch 93: 0.358285
training accuracy: 0.843750	test accuracy: 0.507493
Average cost in epoch 94: 0.342851
training accuracy: 0.843750	test accuracy: 0.516484
Average cost in epoch 95: 0.354514
training accuracy: 0.812500	test accuracy: 0.505495
Average cost in epoch 96: 0.359454
training accuracy: 0.750000	test accuracy: 0.497502
Average cost in epoch 97: 0.329990
training accuracy: 0.687500	test accuracy: 0.502498
Average cost in epoch 98: 0.346099
training accuracy: 0.875000	test accuracy: 0.499500
Average cost in epoch 99: 0.356699
training accuracy: 0.875000	test accuracy: 0.508492

dump to weights/memn2n/memn2n_18.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 19, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_19.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 2.08
Starting training...
Average cost in epoch 0: 2.703450
training accuracy: 0.031250	test accuracy: 0.082917
Average cost in epoch 1: 2.527806
training accuracy: 0.031250	test accuracy: 0.076923
Average cost in epoch 2: 2.520286
training accuracy: 0.125000	test accuracy: 0.085914
Average cost in epoch 3: 2.510511
training accuracy: 0.062500	test accuracy: 0.090909
Average cost in epoch 4: 2.502472
training accuracy: 0.125000	test accuracy: 0.090909
Average cost in epoch 5: 2.487701
training accuracy: 0.156250	test accuracy: 0.063936
Average cost in epoch 6: 2.502492
training accuracy: 0.000000	test accuracy: 0.088911
Average cost in epoch 7: 2.490915
training accuracy: 0.093750	test accuracy: 0.087912
Average cost in epoch 8: 2.478989
training accuracy: 0.093750	test accuracy: 0.098901
Average cost in epoch 9: 2.478041
training accuracy: 0.125000	test accuracy: 0.094905
Average cost in epoch 10: 2.460432
training accuracy: 0.156250	test accuracy: 0.079920
Average cost in epoch 11: 2.438860
training accuracy: 0.187500	test accuracy: 0.104895
Average cost in epoch 12: 2.428600
training accuracy: 0.125000	test accuracy: 0.087912
Average cost in epoch 13: 2.390050
training accuracy: 0.125000	test accuracy: 0.084915
Average cost in epoch 14: 2.383376
training accuracy: 0.093750	test accuracy: 0.082917
Average cost in epoch 15: 2.360541
training accuracy: 0.125000	test accuracy: 0.097902
Average cost in epoch 16: 2.335157
training accuracy: 0.125000	test accuracy: 0.079920
Average cost in epoch 17: 2.295047
training accuracy: 0.187500	test accuracy: 0.084915
Average cost in epoch 18: 2.303666
training accuracy: 0.281250	test accuracy: 0.092907
Average cost in epoch 19: 2.309491
training accuracy: 0.156250	test accuracy: 0.101898
Average cost in epoch 20: 2.264745
training accuracy: 0.312500	test accuracy: 0.093906
Average cost in epoch 21: 2.250186
training accuracy: 0.250000	test accuracy: 0.098901
Average cost in epoch 22: 2.256230
training accuracy: 0.187500	test accuracy: 0.096903
Average cost in epoch 23: 2.216039
training accuracy: 0.281250	test accuracy: 0.094905
Average cost in epoch 24: 2.213004
training accuracy: 0.125000	test accuracy: 0.104895
Average cost in epoch 25: 2.208256
training accuracy: 0.218750	test accuracy: 0.095904
lr decays to 0.005000
Average cost in epoch 26: 2.111866
training accuracy: 0.281250	test accuracy: 0.086913
Average cost in epoch 27: 2.084769
training accuracy: 0.281250	test accuracy: 0.106893
Average cost in epoch 28: 2.042911
training accuracy: 0.343750	test accuracy: 0.093906
Average cost in epoch 29: 2.044544
training accuracy: 0.250000	test accuracy: 0.090909
Average cost in epoch 30: 2.006095
training accuracy: 0.312500	test accuracy: 0.103896
Average cost in epoch 31: 1.996452
training accuracy: 0.281250	test accuracy: 0.098901
Average cost in epoch 32: 1.959063
training accuracy: 0.156250	test accuracy: 0.109890
Average cost in epoch 33: 1.966439
training accuracy: 0.312500	test accuracy: 0.095904
Average cost in epoch 34: 1.935952
training accuracy: 0.218750	test accuracy: 0.089910
Average cost in epoch 35: 1.912328
training accuracy: 0.406250	test accuracy: 0.096903
Average cost in epoch 36: 1.919006
training accuracy: 0.281250	test accuracy: 0.097902
Average cost in epoch 37: 1.895668
training accuracy: 0.500000	test accuracy: 0.098901
Average cost in epoch 38: 1.895540
training accuracy: 0.343750	test accuracy: 0.102897
Average cost in epoch 39: 1.869390
training accuracy: 0.250000	test accuracy: 0.098901
Average cost in epoch 40: 1.831773
training accuracy: 0.375000	test accuracy: 0.098901
Average cost in epoch 41: 1.850743
training accuracy: 0.250000	test accuracy: 0.097902
Average cost in epoch 42: 1.811864
training accuracy: 0.250000	test accuracy: 0.094905
Average cost in epoch 43: 1.832318
training accuracy: 0.406250	test accuracy: 0.101898
Average cost in epoch 44: 1.815708
training accuracy: 0.406250	test accuracy: 0.097902
Average cost in epoch 45: 1.786025
training accuracy: 0.500000	test accuracy: 0.105894
Average cost in epoch 46: 1.774461
training accuracy: 0.468750	test accuracy: 0.102897
Average cost in epoch 47: 1.778286
training accuracy: 0.406250	test accuracy: 0.100899
Average cost in epoch 48: 1.760379
training accuracy: 0.468750	test accuracy: 0.093906
Average cost in epoch 49: 1.727709
training accuracy: 0.343750	test accuracy: 0.091908
Average cost in epoch 50: 1.721909
training accuracy: 0.406250	test accuracy: 0.098901
lr decays to 0.002500
Average cost in epoch 51: 1.650619
training accuracy: 0.406250	test accuracy: 0.095904
Average cost in epoch 52: 1.633397
training accuracy: 0.406250	test accuracy: 0.096903
Average cost in epoch 53: 1.580222
training accuracy: 0.375000	test accuracy: 0.093906
Average cost in epoch 54: 1.602813
training accuracy: 0.468750	test accuracy: 0.089910
Average cost in epoch 55: 1.614987
training accuracy: 0.406250	test accuracy: 0.098901
Average cost in epoch 56: 1.569053
training accuracy: 0.468750	test accuracy: 0.101898
Average cost in epoch 57: 1.561266
training accuracy: 0.656250	test accuracy: 0.093906
Average cost in epoch 58: 1.573583
training accuracy: 0.437500	test accuracy: 0.096903
Average cost in epoch 59: 1.559599
training accuracy: 0.437500	test accuracy: 0.103896
Average cost in epoch 60: 1.471401
training accuracy: 0.656250	test accuracy: 0.093906
Average cost in epoch 61: 1.583757
training accuracy: 0.406250	test accuracy: 0.088911
Average cost in epoch 62: 1.528482
training accuracy: 0.375000	test accuracy: 0.096903
Average cost in epoch 63: 1.521290
training accuracy: 0.406250	test accuracy: 0.100899
Average cost in epoch 64: 1.448776
training accuracy: 0.406250	test accuracy: 0.109890
Average cost in epoch 65: 1.526737
training accuracy: 0.406250	test accuracy: 0.103896
Average cost in epoch 66: 1.490254
training accuracy: 0.281250	test accuracy: 0.095904
Average cost in epoch 67: 1.504684
training accuracy: 0.406250	test accuracy: 0.092907
Average cost in epoch 68: 1.447264
training accuracy: 0.500000	test accuracy: 0.102897
Average cost in epoch 69: 1.477814
training accuracy: 0.500000	test accuracy: 0.094905
Average cost in epoch 70: 1.437170
training accuracy: 0.562500	test accuracy: 0.101898
Average cost in epoch 71: 1.512938
training accuracy: 0.562500	test accuracy: 0.095904
Average cost in epoch 72: 1.416114
training accuracy: 0.375000	test accuracy: 0.094905
Average cost in epoch 73: 1.431686
training accuracy: 0.343750	test accuracy: 0.101898
Average cost in epoch 74: 1.463045
training accuracy: 0.562500	test accuracy: 0.095904
Average cost in epoch 75: 1.389470
training accuracy: 0.500000	test accuracy: 0.090909
lr decays to 0.001250
Average cost in epoch 76: 1.403923
training accuracy: 0.531250	test accuracy: 0.104895
Average cost in epoch 77: 1.360088
training accuracy: 0.500000	test accuracy: 0.099900
Average cost in epoch 78: 1.335078
training accuracy: 0.531250	test accuracy: 0.093906
Average cost in epoch 79: 1.367026
training accuracy: 0.500000	test accuracy: 0.101898
Average cost in epoch 80: 1.314290
training accuracy: 0.593750	test accuracy: 0.098901
Average cost in epoch 81: 1.347980
training accuracy: 0.531250	test accuracy: 0.098901
Average cost in epoch 82: 1.330353
training accuracy: 0.531250	test accuracy: 0.089910
Average cost in epoch 83: 1.331618
training accuracy: 0.500000	test accuracy: 0.097902
Average cost in epoch 84: 1.327246
training accuracy: 0.625000	test accuracy: 0.098901
Average cost in epoch 85: 1.305270
training accuracy: 0.468750	test accuracy: 0.097902
Average cost in epoch 86: 1.314993
training accuracy: 0.562500	test accuracy: 0.095904
Average cost in epoch 87: 1.309310
training accuracy: 0.656250	test accuracy: 0.091908
Average cost in epoch 88: 1.293536
training accuracy: 0.531250	test accuracy: 0.090909
Average cost in epoch 89: 1.306600
training accuracy: 0.468750	test accuracy: 0.094905
Average cost in epoch 90: 1.287116
training accuracy: 0.562500	test accuracy: 0.097902
Average cost in epoch 91: 1.277307
training accuracy: 0.500000	test accuracy: 0.094905
Average cost in epoch 92: 1.256885
training accuracy: 0.562500	test accuracy: 0.094905
Average cost in epoch 93: 1.305888
training accuracy: 0.531250	test accuracy: 0.094905
Average cost in epoch 94: 1.259976
training accuracy: 0.687500	test accuracy: 0.096903
Average cost in epoch 95: 1.274951
training accuracy: 0.375000	test accuracy: 0.100899
Average cost in epoch 96: 1.224120
training accuracy: 0.625000	test accuracy: 0.090909
Average cost in epoch 97: 1.259300
training accuracy: 0.531250	test accuracy: 0.093906
Average cost in epoch 98: 1.254054
training accuracy: 0.593750	test accuracy: 0.096903
Average cost in epoch 99: 1.250896
training accuracy: 0.593750	test accuracy: 0.096903

dump to weights/memn2n/memn2n_19.pkl

options:
{
    "log_options": {
        "dump_config": false, 
        "dump_name": "memn2n.json", 
        "dump_epoch": -1, 
        "dump_path": "configs"
    }, 
    "data_options": {
        "task_number": 20, 
        "data_path": "bAbI", 
        "language": "en", 
        "reader": "minibatch"
    }, 
    "optimization_options": {
        "disp_iter": 20, 
        "p_dropout": 0.5, 
        "optimizer": "rmsprop", 
        "verbose": true, 
        "shuffle": true, 
        "batch_size_train": 32, 
        "max_epoch": 100, 
        "learning_rate": 0.01, 
        "decay": 0.5, 
        "load_params": false, 
        "load_name": "memn2n.pkl", 
        "dump_params": true, 
        "weight_path": "weights/memn2n", 
        "linear_start": false, 
        "reg_weight": 0.004, 
        "linear_start_lazy": 5, 
        "dump_name": "memn2n_20.pkl", 
        "batch_size_test": null, 
        "decay_period": 25, 
        "dropout": false, 
        "reg": null
    }, 
    "model_options": {
        "vocab_size": null, 
        "embedding_size": 20, 
        "temporal_encode": true, 
        "position_encode": false, 
        "num_hid": 32, 
        "context_length": 32, 
        "sentence_length": 20, 
        "model_name": "memn2n", 
        "n_hops": 3
    }
}
Starting compiling...
['c_combine_2', 'c_combine_1', 'c_combine_0', 'attention_0', 'attention_1', 'attention_2', 'c_emb_0', 'c_emb_1', 'c_emb_2', 'o_1', 'o_0', 'o_2', 'a_emb_2', 'a_emb_0', 'a_emb_1', 'a_combine_1', 'a_combine_0', 'a_combine_2', 'u_combine_1', 'u_combine_0', 'u_combine_2', 'u_emb_0', 'output', 'ou']
Ending compiling...
Compiling time: 2.11
Starting training...
Average cost in epoch 0: 1.124514
training accuracy: 0.812500	test accuracy: 0.766234
Average cost in epoch 1: 0.307806
training accuracy: 0.937500	test accuracy: 0.902098
Average cost in epoch 2: 0.124993
training accuracy: 1.000000	test accuracy: 0.971029
Average cost in epoch 3: 0.061557
training accuracy: 0.968750	test accuracy: 0.989011
Average cost in epoch 4: 0.044161
training accuracy: 1.000000	test accuracy: 0.990010
Average cost in epoch 5: 0.025225
training accuracy: 0.968750	test accuracy: 0.993007
Average cost in epoch 6: 0.007908
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 7: 0.021125
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 8: 0.003973
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 9: 0.000341
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 10: 0.000174
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 11: 0.000074
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 12: 0.000039
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 13: 0.000018
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 14: 0.000006
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 15: 0.000004
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 16: 0.000001
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 17: 0.000001
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 18: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 19: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 20: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 21: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 22: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 23: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 24: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 25: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
lr decays to 0.005000
Average cost in epoch 26: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 27: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 28: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 29: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 30: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 31: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 32: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 33: 0.000000
training accuracy: 1.000000	test accuracy: 1.000000
Average cost in epoch 34: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 35: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 36: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 37: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 38: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 39: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 40: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 41: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 42: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 43: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 44: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 45: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 46: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 47: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 48: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 49: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 50: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
lr decays to 0.002500
Average cost in epoch 51: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 52: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 53: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 54: 0.000000
training accuracy: 1.000000	test accuracy: 0.999001
Average cost in epoch 55: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 56: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 57: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 58: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 59: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 60: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 61: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 62: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 63: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 64: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 65: 0.000000
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 66: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 67: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 68: 0.000000
training accuracy: 1.000000	test accuracy: 0.997003
Average cost in epoch 69: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 70: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 71: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 72: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 73: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 74: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 75: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
lr decays to 0.001250
Average cost in epoch 76: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 77: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 78: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 79: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 80: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 81: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 82: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 83: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 84: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 85: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 86: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 87: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 88: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 89: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 90: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 91: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 92: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 93: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 94: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 95: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 96: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 97: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 98: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002
Average cost in epoch 99: 0.000000
training accuracy: 1.000000	test accuracy: 0.998002

dump to weights/memn2n/memn2n_20.pkl

